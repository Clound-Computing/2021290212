2024-06-22 18:29:39.341167: I tensorflow/core/util/port.cc:110] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-06-22 18:29:41.770822: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-06-22 18:29:45.954259: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
WARNING:tensorflow:From /home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/tensorflow/python/compat/v2_compat.py:107: disable_resource_variables (from tensorflow.python.ops.variable_scope) is deprecated and will be removed in a future version.
Instructions for updating:
non-resource variables are not supported in the long term
WARNING:tensorflow:From /home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/tensorflow/python/util/dispatch.py:1176: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
W0622 18:29:57.846091 140397140501696 deprecation.py:569] From /home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/tensorflow/python/util/dispatch.py:1176: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
/home/oycj/code/ECPE-master/utils/tf_funcs.py:181: UserWarning: `tf.nn.rnn_cell.LSTMCell` is deprecated and will be removed in a future version. This class is equivalent as `tf.keras.layers.LSTMCell`, and will be replaced by that in Tensorflow 2.0.
  cell_fw=tf.nn.rnn_cell.LSTMCell(n_hidden),
/home/oycj/code/ECPE-master/utils/tf_funcs.py:182: UserWarning: `tf.nn.rnn_cell.LSTMCell` is deprecated and will be removed in a future version. This class is equivalent as `tf.keras.layers.LSTMCell`, and will be replaced by that in Tensorflow 2.0.
  cell_bw=tf.nn.rnn_cell.LSTMCell(n_hidden),
WARNING:tensorflow:From /home/oycj/code/ECPE-master/utils/tf_funcs.py:180: bidirectional_dynamic_rnn (from tensorflow.python.ops.rnn) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `keras.layers.Bidirectional(keras.layers.RNN(cell))`, which is equivalent to this API
W0622 18:29:58.004770 140397140501696 deprecation.py:364] From /home/oycj/code/ECPE-master/utils/tf_funcs.py:180: bidirectional_dynamic_rnn (from tensorflow.python.ops.rnn) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `keras.layers.Bidirectional(keras.layers.RNN(cell))`, which is equivalent to this API
WARNING:tensorflow:From /home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/tensorflow/python/ops/rnn.py:440: dynamic_rnn (from tensorflow.python.ops.rnn) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `keras.layers.RNN(cell)`, which is equivalent to this API
W0622 18:29:58.005376 140397140501696 deprecation.py:364] From /home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/tensorflow/python/ops/rnn.py:440: dynamic_rnn (from tensorflow.python.ops.rnn) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `keras.layers.RNN(cell)`, which is equivalent to this API
WARNING:tensorflow:From /home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/keras/src/layers/rnn/legacy_cells.py:1043: calling Zeros.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
W0622 18:29:58.073745 140397140501696 deprecation.py:569] From /home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/keras/src/layers/rnn/legacy_cells.py:1043: calling Zeros.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
2024-06-22 18:30:03.271511: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1639] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 12703 MB memory:  -> device: 0, name: NVIDIA GeForce RTX 4080, pci bus id: 0000:3b:00.0, compute capability: 8.9
2024-06-22 18:30:03.391372: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:375] MLIR V1 optimization pass is not enabled
2024-06-22 18:30:08.444343: I tensorflow/compiler/xla/stream_executor/cuda/cuda_blas.cc:606] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.

----------2024-06-22 18:29:56----------

load embedding...
w2v_file: data_en/w2v_200.txt
all_words: 14316 hit_words: 10987
embedding.shape: (14317, 200) embedding_pos.shape: (201, 50)
load embedding done!

build model...
build model done!



>>>>>>>>>>>>>>>>>>>>TRAINING INFO:

batch-32, lr-0.005, kb1-0.8, kb2-1.0, l2_reg-1e-05
training_iter-15, scope-Ind_BiLSTM_1

############# fold 1 begin ###############
load data_file: data_combine_en/fold_1_train.txt
y_position.shape (2275, 75, 2)
y_cause.shape (2275, 75, 2)
x.shape (2275, 75, 30)
sen_len.shape (2275, 75)
doc_len.shape (2275,)
n_cut 107
load data done!

load data_file: data_combine_en/fold_1_test.txt
y_position.shape (284, 75, 2)
y_cause.shape (284, 75, 2)
x.shape (284, 75, 30)
sen_len.shape (284, 75)
doc_len.shape (284,)
n_cut 22
load data done!

train docs: 2275    test docs: 284
step 10: train loss 0.8397 
cause_predict: train acc 0.8465 p 0.0000 r 0.0000 f1 0.0000
position_predict: train acc 0.8596 p 0.0000 r 0.0000 f1 0.0000
step 20: train loss 0.8194 
cause_predict: train acc 0.8108 p 0.0000 r 0.0000 f1 0.0000
position_predict: train acc 0.8559 p 0.0000 r 0.0000 f1 0.0000
step 30: train loss 0.6834 
cause_predict: train acc 0.8452 p 0.0000 r 0.0000 f1 0.0000
position_predict: train acc 0.8730 p 0.0000 r 0.0000 f1 0.0000
step 40: train loss 0.5623 
cause_predict: train acc 0.8647 p 0.0000 r 0.0000 f1 0.0000
position_predict: train acc 0.8910 p 0.6111 r 0.3333 f1 0.4314
step 50: train loss 0.6584 
cause_predict: train acc 0.8632 p 1.0000 r 0.0303 f1 0.0588
position_predict: train acc 0.8803 p 0.6087 r 0.4242 f1 0.5000
step 60: train loss 0.7245 
cause_predict: train acc 0.8364 p 1.0000 r 0.0769 f1 0.1429
position_predict: train acc 0.8591 p 0.5238 r 0.3438 f1 0.4151
step 70: train loss 0.6029 
cause_predict: train acc 0.8443 p 0.5385 r 0.1795 f1 0.2692
position_predict: train acc 0.8975 p 0.6842 r 0.4062 f1 0.5098

epoch 0: test loss 0.5193 cost time: 15.9s

cause_predict: test acc 0.8852 p 0.7830 r 0.2618 f1 0.3924
max_acc 0.8852 max_p 0.7830 max_r 0.2618 max_f1 0.3924

position_predict: test acc 0.9115 p 0.6718 r 0.6063 f1 0.6374
max_acc 0.9115 max_p 0.6718 max_r 0.6063 max_f1 0.6374

Average max cause: max_acc 0.8852 max_p 0.7830 max_r 0.2618 max_f1 0.3924
Average max pos: max_acc 0.9115 max_p 0.6718 max_r 0.6063 max_f1 0.6374

step 10: train loss 0.6221 
cause_predict: train acc 0.8224 p 0.4000 r 0.2353 f1 0.2963
position_predict: train acc 0.8925 p 0.6667 r 0.6061 f1 0.6349
step 20: train loss 0.5073 
cause_predict: train acc 0.8911 p 0.7500 r 0.3333 f1 0.4615
position_predict: train acc 0.9105 p 0.6786 r 0.5758 f1 0.6230
step 30: train loss 0.6049 
cause_predict: train acc 0.8426 p 0.6364 r 0.1750 f1 0.2745
position_predict: train acc 0.9191 p 0.7826 r 0.5625 f1 0.6545
step 40: train loss 0.5976 
cause_predict: train acc 0.8750 p 0.7500 r 0.4412 f1 0.5556
position_predict: train acc 0.9115 p 0.7143 r 0.7812 f1 0.7463
step 50: train loss 0.6759 
cause_predict: train acc 0.7962 p 0.7778 r 0.1458 f1 0.2456
position_predict: train acc 0.9005 p 0.6897 r 0.6250 f1 0.6557
step 60: train loss 0.4964 
cause_predict: train acc 0.8697 p 0.6000 r 0.3429 f1 0.4364
position_predict: train acc 0.9202 p 0.7188 r 0.6970 f1 0.7077
step 70: train loss 0.5065 
cause_predict: train acc 0.8421 p 0.6364 r 0.3889 f1 0.4828
position_predict: train acc 0.9316 p 0.8276 r 0.7500 f1 0.7869

epoch 1: test loss 0.4790 cost time: 10.7s

cause_predict: test acc 0.8905 p 0.6915 r 0.4101 f1 0.5149
max_acc 0.8905 max_p 0.6915 max_r 0.4101 max_f1 0.5149

position_predict: test acc 0.9214 p 0.7004 r 0.6760 f1 0.6879
max_acc 0.9214 max_p 0.7004 max_r 0.6760 max_f1 0.6879

Average max cause: max_acc 0.8905 max_p 0.6915 max_r 0.4101 max_f1 0.5149
Average max pos: max_acc 0.9214 max_p 0.7004 max_r 0.6760 max_f1 0.6879

step 10: train loss 0.4366 
cause_predict: train acc 0.9021 p 0.9091 r 0.2703 f1 0.4167
position_predict: train acc 0.9510 p 0.8462 r 0.6875 f1 0.7586
step 20: train loss 0.3552 
cause_predict: train acc 0.9000 p 0.5556 r 0.4412 f1 0.4918
position_predict: train acc 0.9323 p 0.6774 r 0.6562 f1 0.6667
step 30: train loss 0.5039 
cause_predict: train acc 0.8989 p 0.7368 r 0.3889 f1 0.5091
position_predict: train acc 0.9139 p 0.6957 r 0.5000 f1 0.5818
step 40: train loss 0.3837 
cause_predict: train acc 0.9003 p 0.6111 r 0.3056 f1 0.4074
position_predict: train acc 0.9408 p 0.7692 r 0.6061 f1 0.6780
step 50: train loss 0.4012 
cause_predict: train acc 0.8915 p 0.6842 r 0.3714 f1 0.4815
position_predict: train acc 0.9302 p 0.7500 r 0.6562 f1 0.7000
step 60: train loss 0.5916 
cause_predict: train acc 0.8737 p 0.7391 r 0.4722 f1 0.5763
position_predict: train acc 0.9091 p 0.7333 r 0.6875 f1 0.7097
step 70: train loss 0.5037 
cause_predict: train acc 0.8736 p 0.7333 r 0.2750 f1 0.4000
position_predict: train acc 0.9272 p 0.8095 r 0.5312 f1 0.6415

epoch 2: test loss 0.4654 cost time: 10.8s

cause_predict: test acc 0.8972 p 0.7208 r 0.4479 f1 0.5525
max_acc 0.8972 max_p 0.7208 max_r 0.4479 max_f1 0.5525

position_predict: test acc 0.9227 p 0.7298 r 0.6307 f1 0.6766
max_acc 0.9214 max_p 0.7004 max_r 0.6760 max_f1 0.6879

Average max cause: max_acc 0.8972 max_p 0.7208 max_r 0.4479 max_f1 0.5525
Average max pos: max_acc 0.9227 max_p 0.7298 max_r 0.6307 max_f1 0.6766

step 10: train loss 0.5358 
cause_predict: train acc 0.8468 p 0.5333 r 0.2051 f1 0.2963
position_predict: train acc 0.9073 p 0.6923 r 0.5455 f1 0.6102
step 20: train loss 0.5539 
cause_predict: train acc 0.8482 p 0.5862 r 0.5000 f1 0.5397
position_predict: train acc 0.9162 p 0.8148 r 0.6667 f1 0.7333
step 30: train loss 0.4199 
cause_predict: train acc 0.9234 p 0.8333 r 0.5882 f1 0.6897
position_predict: train acc 0.9234 p 0.7419 r 0.6970 f1 0.7188
step 40: train loss 0.5153 
cause_predict: train acc 0.8448 p 0.7391 r 0.4474 f1 0.5574
position_predict: train acc 0.9310 p 0.8846 r 0.7188 f1 0.7931
step 50: train loss 0.4990 
cause_predict: train acc 0.8996 p 0.6800 r 0.4857 f1 0.5667
position_predict: train acc 0.9035 p 0.6400 r 0.5000 f1 0.5614
step 60: train loss 0.3596 
cause_predict: train acc 0.8961 p 0.5000 r 0.1892 f1 0.2745
position_predict: train acc 0.9494 p 0.8636 r 0.5588 f1 0.6786
step 70: train loss 0.5999 
cause_predict: train acc 0.8133 p 0.3913 r 0.2432 f1 0.3000
position_predict: train acc 0.9156 p 0.7241 r 0.6562 f1 0.6885

epoch 3: test loss 0.4666 cost time: 10.9s

cause_predict: test acc 0.8883 p 0.6831 r 0.3943 f1 0.5000
max_acc 0.8972 max_p 0.7208 max_r 0.4479 max_f1 0.5525

position_predict: test acc 0.9285 p 0.7530 r 0.6585 f1 0.7026
max_acc 0.9285 max_p 0.7530 max_r 0.6585 max_f1 0.7026

Average max cause: max_acc 0.8972 max_p 0.7208 max_r 0.4479 max_f1 0.5525
Average max pos: max_acc 0.9227 max_p 0.7298 max_r 0.6307 max_f1 0.6766

step 10: train loss 0.3258 
cause_predict: train acc 0.9027 p 0.6296 r 0.4722 f1 0.5397
position_predict: train acc 0.9597 p 0.7941 r 0.8438 f1 0.8182
step 20: train loss 0.2659 
cause_predict: train acc 0.9435 p 0.8462 r 0.6471 f1 0.7333
position_predict: train acc 0.9647 p 0.8056 r 0.9062 f1 0.8529
step 30: train loss 0.3741 
cause_predict: train acc 0.9013 p 0.7727 r 0.4857 f1 0.5965
position_predict: train acc 0.9442 p 0.8276 r 0.7500 f1 0.7869
step 40: train loss 0.3426 
cause_predict: train acc 0.9157 p 0.8235 r 0.4375 f1 0.5714
position_predict: train acc 0.9598 p 0.8966 r 0.7879 f1 0.8387
step 50: train loss 0.5108 
cause_predict: train acc 0.8688 p 0.6667 r 0.4324 f1 0.5246
position_predict: train acc 0.9186 p 0.7857 r 0.6471 f1 0.7097
step 60: train loss 0.4462 
cause_predict: train acc 0.9019 p 0.7586 r 0.6111 f1 0.6769
position_predict: train acc 0.9206 p 0.7857 r 0.6667 f1 0.7213
step 70: train loss 0.4196 
cause_predict: train acc 0.9135 p 0.7857 r 0.6471 f1 0.7097
position_predict: train acc 0.9038 p 0.7308 r 0.5938 f1 0.6552

epoch 4: test loss 0.4780 cost time: 10.8s

cause_predict: test acc 0.8905 p 0.6565 r 0.4763 f1 0.5521
max_acc 0.8972 max_p 0.7208 max_r 0.4479 max_f1 0.5525

position_predict: test acc 0.9285 p 0.7571 r 0.6516 f1 0.7004
max_acc 0.9285 max_p 0.7530 max_r 0.6585 max_f1 0.7026

Average max cause: max_acc 0.8905 max_p 0.6565 max_r 0.4763 max_f1 0.5521
Average max pos: max_acc 0.9285 max_p 0.7571 max_r 0.6516 max_f1 0.7004

step 10: train loss 0.3282 
cause_predict: train acc 0.9167 p 0.8276 r 0.6154 f1 0.7059
position_predict: train acc 0.9583 p 0.8438 r 0.8438 f1 0.8438
step 20: train loss 0.3499 
cause_predict: train acc 0.9310 p 0.8889 r 0.6857 f1 0.7742
position_predict: train acc 0.9409 p 0.8125 r 0.8125 f1 0.8125
step 30: train loss 0.3222 
cause_predict: train acc 0.8858 p 0.6875 r 0.5946 f1 0.6377
position_predict: train acc 0.9635 p 0.9000 r 0.8438 f1 0.8710
step 40: train loss 0.4032 
cause_predict: train acc 0.8681 p 0.7188 r 0.6053 f1 0.6571
position_predict: train acc 0.9725 p 0.9091 r 0.9375 f1 0.9231
step 50: train loss 0.4250 
cause_predict: train acc 0.8858 p 0.7407 r 0.5263 f1 0.6154
position_predict: train acc 0.9224 p 0.7586 r 0.6875 f1 0.7213
step 60: train loss 0.3720 
cause_predict: train acc 0.8839 p 0.6786 r 0.5278 f1 0.5937
position_predict: train acc 0.9420 p 0.7714 r 0.8438 f1 0.8060
step 70: train loss 0.3391 
cause_predict: train acc 0.9151 p 0.8500 r 0.4722 f1 0.6071
position_predict: train acc 0.9498 p 0.7879 r 0.8125 f1 0.8000

epoch 5: test loss 0.4886 cost time: 11.0s

cause_predict: test acc 0.8910 p 0.6553 r 0.4858 f1 0.5580
max_acc 0.8910 max_p 0.6553 max_r 0.4858 max_f1 0.5580

position_predict: test acc 0.9240 p 0.7259 r 0.6551 f1 0.6886
max_acc 0.9285 max_p 0.7530 max_r 0.6585 max_f1 0.7026

Average max cause: max_acc 0.8905 max_p 0.6565 max_r 0.4763 max_f1 0.5521
Average max pos: max_acc 0.9285 max_p 0.7571 max_r 0.6516 max_f1 0.7004

step 10: train loss 0.2585 
cause_predict: train acc 0.9412 p 0.9000 r 0.7105 f1 0.7941
position_predict: train acc 0.9664 p 0.8750 r 0.8750 f1 0.8750
step 20: train loss 0.3239 
cause_predict: train acc 0.9224 p 0.8333 r 0.6757 f1 0.7463
position_predict: train acc 0.9498 p 0.8235 r 0.8485 f1 0.8358
step 30: train loss 0.2255 
cause_predict: train acc 0.9498 p 0.8750 r 0.7778 f1 0.8235
position_predict: train acc 0.9707 p 0.8788 r 0.9062 f1 0.8923
step 40: train loss 0.2534 
cause_predict: train acc 0.9402 p 0.8571 r 0.6857 f1 0.7619
position_predict: train acc 0.9442 p 0.7812 r 0.7812 f1 0.7812
step 50: train loss 0.3777 
cause_predict: train acc 0.9057 p 0.7429 r 0.6500 f1 0.6933
position_predict: train acc 0.9385 p 0.7576 r 0.7812 f1 0.7692
step 60: train loss 0.3885 
cause_predict: train acc 0.9043 p 0.7353 r 0.5814 f1 0.6494
position_predict: train acc 0.9433 p 0.7857 r 0.6875 f1 0.7333
step 70: train loss 0.2203 
cause_predict: train acc 0.9472 p 0.9167 r 0.6286 f1 0.7458
position_predict: train acc 0.9824 p 0.9667 r 0.8788 f1 0.9206

epoch 6: test loss 0.5321 cost time: 10.7s

cause_predict: test acc 0.8914 p 0.6609 r 0.4795 f1 0.5558
max_acc 0.8910 max_p 0.6553 max_r 0.4858 max_f1 0.5580

position_predict: test acc 0.9227 p 0.7375 r 0.6167 f1 0.6717
max_acc 0.9285 max_p 0.7530 max_r 0.6585 max_f1 0.7026

Average max cause: max_acc 0.8905 max_p 0.6565 max_r 0.4763 max_f1 0.5521
Average max pos: max_acc 0.9285 max_p 0.7571 max_r 0.6516 max_f1 0.7004

step 10: train loss 0.1863 
cause_predict: train acc 0.9603 p 0.9062 r 0.7838 f1 0.8406
position_predict: train acc 0.9639 p 0.8485 r 0.8485 f1 0.8485
step 20: train loss 0.2436 
cause_predict: train acc 0.9462 p 0.8333 r 0.7692 f1 0.8000
position_predict: train acc 0.9677 p 0.8710 r 0.8438 f1 0.8571
step 30: train loss 0.1818 
cause_predict: train acc 0.9648 p 0.8438 r 0.8438 f1 0.8438
position_predict: train acc 0.9542 p 0.8387 r 0.7647 f1 0.8000
step 40: train loss 0.2125 
cause_predict: train acc 0.9416 p 0.8889 r 0.6154 f1 0.7273
position_predict: train acc 0.9740 p 0.9000 r 0.8438 f1 0.8710
step 50: train loss 0.2168 
cause_predict: train acc 0.9524 p 0.8485 r 0.7179 f1 0.7778
position_predict: train acc 0.9554 p 0.7429 r 0.8125 f1 0.7761
step 60: train loss 0.3935 
cause_predict: train acc 0.9022 p 0.7778 r 0.5676 f1 0.6562
position_predict: train acc 0.9378 p 0.7647 r 0.8125 f1 0.7879
step 70: train loss 0.2819 
cause_predict: train acc 0.9310 p 0.8065 r 0.7143 f1 0.7576
position_predict: train acc 0.9397 p 0.7812 r 0.7812 f1 0.7812

epoch 7: test loss 0.5499 cost time: 10.8s

cause_predict: test acc 0.8829 p 0.5920 r 0.5584 f1 0.5747
max_acc 0.8829 max_p 0.5920 max_r 0.5584 max_f1 0.5747

position_predict: test acc 0.9147 p 0.6714 r 0.6551 f1 0.6631
max_acc 0.9285 max_p 0.7530 max_r 0.6585 max_f1 0.7026

Average max cause: max_acc 0.8905 max_p 0.6565 max_r 0.4763 max_f1 0.5521
Average max pos: max_acc 0.9285 max_p 0.7571 max_r 0.6516 max_f1 0.7004

step 10: train loss 0.2149 
cause_predict: train acc 0.9509 p 0.8667 r 0.7879 f1 0.8254
position_predict: train acc 0.9598 p 0.8485 r 0.8750 f1 0.8615
step 20: train loss 0.1717 
cause_predict: train acc 0.9522 p 0.8182 r 0.8182 f1 0.8182
position_predict: train acc 0.9920 p 0.9412 r 1.0000 f1 0.9697
step 30: train loss 0.2092 
cause_predict: train acc 0.9462 p 0.9091 r 0.7692 f1 0.8333
position_predict: train acc 0.9821 p 0.9375 r 0.9375 f1 0.9375
step 40: train loss 0.2493 
cause_predict: train acc 0.9421 p 0.8214 r 0.6970 f1 0.7541
position_predict: train acc 0.9575 p 0.8667 r 0.7879 f1 0.8254
step 50: train loss 0.3273 
cause_predict: train acc 0.9327 p 0.8065 r 0.7353 f1 0.7692
position_predict: train acc 0.9596 p 0.8710 r 0.8438 f1 0.8571
step 60: train loss 0.3874 
cause_predict: train acc 0.9156 p 0.8148 r 0.6111 f1 0.6984
position_predict: train acc 0.9333 p 0.7576 r 0.7812 f1 0.7692
step 70: train loss 0.3304 
cause_predict: train acc 0.9189 p 0.7742 r 0.6857 f1 0.7273
position_predict: train acc 0.9459 p 0.8333 r 0.7812 f1 0.8065

epoch 8: test loss 0.6072 cost time: 10.8s

cause_predict: test acc 0.8887 p 0.6360 r 0.5016 f1 0.5608
max_acc 0.8829 max_p 0.5920 max_r 0.5584 max_f1 0.5747

position_predict: test acc 0.9191 p 0.6934 r 0.6620 f1 0.6774
max_acc 0.9285 max_p 0.7530 max_r 0.6585 max_f1 0.7026

Average max cause: max_acc 0.8905 max_p 0.6565 max_r 0.4763 max_f1 0.5521
Average max pos: max_acc 0.9285 max_p 0.7571 max_r 0.6516 max_f1 0.7004

step 10: train loss 0.2087 
cause_predict: train acc 0.9615 p 0.9167 r 0.8462 f1 0.8800
position_predict: train acc 0.9573 p 0.8235 r 0.8750 f1 0.8485
step 20: train loss 0.1581 
cause_predict: train acc 0.9703 p 0.9333 r 0.8235 f1 0.8750
position_predict: train acc 0.9777 p 0.9333 r 0.8750 f1 0.9032
step 30: train loss 0.1518 
cause_predict: train acc 0.9801 p 0.9412 r 0.9143 f1 0.9275
position_predict: train acc 0.9602 p 0.8056 r 0.9062 f1 0.8529
step 40: train loss 0.2456 
cause_predict: train acc 0.9289 p 0.8286 r 0.7632 f1 0.7945
position_predict: train acc 0.9526 p 0.8667 r 0.8125 f1 0.8387
step 50: train loss 0.1754 
cause_predict: train acc 0.9341 p 0.7812 r 0.7143 f1 0.7463
position_predict: train acc 0.9922 p 1.0000 r 0.9394 f1 0.9688
step 60: train loss 0.2186 
cause_predict: train acc 0.9398 p 0.8125 r 0.6842 f1 0.7429
position_predict: train acc 0.9732 p 0.8750 r 0.8750 f1 0.8750
step 70: train loss 0.2363 
cause_predict: train acc 0.9326 p 0.8286 r 0.8286 f1 0.8286
position_predict: train acc 0.9663 p 0.9062 r 0.9062 f1 0.9062

epoch 9: test loss 0.6340 cost time: 11.1s

cause_predict: test acc 0.8861 p 0.6202 r 0.5047 f1 0.5565
max_acc 0.8829 max_p 0.5920 max_r 0.5584 max_f1 0.5747

position_predict: test acc 0.9138 p 0.6655 r 0.6585 f1 0.6620
max_acc 0.9285 max_p 0.7530 max_r 0.6585 max_f1 0.7026

Average max cause: max_acc 0.8905 max_p 0.6565 max_r 0.4763 max_f1 0.5521
Average max pos: max_acc 0.9285 max_p 0.7571 max_r 0.6516 max_f1 0.7004

step 10: train loss 0.1881 
cause_predict: train acc 0.9318 p 0.8684 r 0.8250 f1 0.8462
position_predict: train acc 0.9830 p 0.9677 r 0.9375 f1 0.9524
step 20: train loss 0.1440 
cause_predict: train acc 0.9777 p 0.9412 r 0.9412 f1 0.9412
position_predict: train acc 0.9665 p 0.9333 r 0.8750 f1 0.9032
step 30: train loss 0.1211 
cause_predict: train acc 0.9659 p 0.9412 r 0.8649 f1 0.9014
position_predict: train acc 0.9805 p 0.9412 r 0.9412 f1 0.9412
step 40: train loss 0.1250 
cause_predict: train acc 0.9798 p 1.0000 r 0.8649 f1 0.9275
position_predict: train acc 0.9798 p 0.8857 r 0.9688 f1 0.9254
step 50: train loss 0.1939 
cause_predict: train acc 0.9582 p 0.8485 r 0.8000 f1 0.8235
2024-06-22 18:32:59.900720: W tensorflow/c/c_api.cc:304] Operation '{name:'softmax_b_pos/Adam_1/Assign' id:5023 op device:{requested: '', assigned: ''} def:{{{node softmax_b_pos/Adam_1/Assign}} = Assign[T=DT_FLOAT, _class=["loc:@softmax_b_pos"], _has_manual_control_dependencies=true, use_locking=true, validate_shape=true](softmax_b_pos/Adam_1, softmax_b_pos/Adam_1/Initializer/zeros)}}' was changed by setting attribute after it was run by a session. This mutation will have no effect, and will trigger an error in the future. Either don't modify nodes after running them or create a new session.
position_predict: train acc 0.9582 p 0.8125 r 0.8125 f1 0.8125
step 60: train loss 0.1504 
cause_predict: train acc 0.9929 p 1.0000 r 0.9412 f1 0.9697
position_predict: train acc 0.9537 p 0.7879 r 0.8125 f1 0.8000
step 70: train loss 0.2182 
cause_predict: train acc 0.9825 p 0.9706 r 0.9167 f1 0.9429
position_predict: train acc 0.9518 p 0.8182 r 0.8438 f1 0.8308

epoch 10: test loss 0.6704 cost time: 11.0s

cause_predict: test acc 0.8892 p 0.6255 r 0.5426 f1 0.5811
max_acc 0.8892 max_p 0.6255 max_r 0.5426 max_f1 0.5811

position_predict: test acc 0.9129 p 0.6565 r 0.6725 f1 0.6644
max_acc 0.9285 max_p 0.7530 max_r 0.6585 max_f1 0.7026

Average max cause: max_acc 0.8905 max_p 0.6565 max_r 0.4763 max_f1 0.5521
Average max pos: max_acc 0.9285 max_p 0.7571 max_r 0.6516 max_f1 0.7004

step 10: train loss 0.0996 
cause_predict: train acc 0.9835 p 0.9394 r 0.9394 f1 0.9394
position_predict: train acc 0.9835 p 0.9375 r 0.9375 f1 0.9375
step 20: train loss 0.1218 
cause_predict: train acc 0.9906 p 1.0000 r 0.9091 f1 0.9524
position_predict: train acc 0.9717 p 0.8966 r 0.8125 f1 0.8525
step 30: train loss 0.1348 
cause_predict: train acc 0.9712 p 0.9429 r 0.8684 f1 0.9041
position_predict: train acc 0.9794 p 0.9355 r 0.9062 f1 0.9206
step 40: train loss 0.1916 
cause_predict: train acc 0.9628 p 0.8667 r 0.7879 f1 0.8254
position_predict: train acc 0.9628 p 0.8235 r 0.8485 f1 0.8358
step 50: train loss 0.1569 
cause_predict: train acc 0.9627 p 0.8947 r 0.8718 f1 0.8831
position_predict: train acc 0.9627 p 0.8485 r 0.8750 f1 0.8615
step 60: train loss 0.2754 
cause_predict: train acc 0.9402 p 0.8182 r 0.7714 f1 0.7941
position_predict: train acc 0.9573 p 0.8235 r 0.8750 f1 0.8485
step 70: train loss 0.1341 
cause_predict: train acc 0.9836 p 0.9706 r 0.9167 f1 0.9429
position_predict: train acc 0.9754 p 0.9062 r 0.9062 f1 0.9062

epoch 11: test loss 0.6679 cost time: 10.9s

cause_predict: test acc 0.8749 p 0.5623 r 0.5268 f1 0.5440
max_acc 0.8892 max_p 0.6255 max_r 0.5426 max_f1 0.5811

position_predict: test acc 0.9155 p 0.6815 r 0.6411 f1 0.6607
max_acc 0.9285 max_p 0.7530 max_r 0.6585 max_f1 0.7026

Average max cause: max_acc 0.8905 max_p 0.6565 max_r 0.4763 max_f1 0.5521
Average max pos: max_acc 0.9285 max_p 0.7571 max_r 0.6516 max_f1 0.7004

step 10: train loss 0.1032 
cause_predict: train acc 0.9746 p 0.9429 r 0.8919 f1 0.9167
position_predict: train acc 0.9746 p 0.9091 r 0.9091 f1 0.9091
step 20: train loss 0.0870 
cause_predict: train acc 0.9884 p 0.9714 r 0.9444 f1 0.9577
position_predict: train acc 0.9884 p 0.9677 r 0.9375 f1 0.9524
step 30: train loss 0.1300 
cause_predict: train acc 0.9934 p 0.9722 r 0.9722 f1 0.9722
position_predict: train acc 0.9702 p 0.8529 r 0.8788 f1 0.8657
step 40: train loss 0.1916 
cause_predict: train acc 0.9535 p 0.8485 r 0.8000 f1 0.8235
position_predict: train acc 0.9651 p 0.8485 r 0.8750 f1 0.8615
step 50: train loss 0.2041 
cause_predict: train acc 0.9765 p 0.9412 r 0.9143 f1 0.9275
position_predict: train acc 0.9577 p 0.8529 r 0.8788 f1 0.8657
step 60: train loss 0.1328 
cause_predict: train acc 0.9757 p 0.9189 r 0.9444 f1 0.9315
position_predict: train acc 0.9757 p 0.9355 r 0.9062 f1 0.9206
step 70: train loss 0.1099 
cause_predict: train acc 0.9770 p 0.9697 r 0.8889 f1 0.9275
position_predict: train acc 0.9770 p 0.9091 r 0.9375 f1 0.9231

epoch 12: test loss 0.6989 cost time: 10.9s

cause_predict: test acc 0.8798 p 0.5938 r 0.4795 f1 0.5305
max_acc 0.8892 max_p 0.6255 max_r 0.5426 max_f1 0.5811

position_predict: test acc 0.9142 p 0.6655 r 0.6655 f1 0.6655
max_acc 0.9285 max_p 0.7530 max_r 0.6585 max_f1 0.7026

Average max cause: max_acc 0.8905 max_p 0.6565 max_r 0.4763 max_f1 0.5521
Average max pos: max_acc 0.9285 max_p 0.7571 max_r 0.6516 max_f1 0.7004

step 10: train loss 0.1061 
cause_predict: train acc 0.9779 p 0.8810 r 0.9250 f1 0.9024
position_predict: train acc 0.9751 p 0.8485 r 0.8750 f1 0.8615
step 20: train loss 0.2027 
cause_predict: train acc 0.9576 p 0.8286 r 0.8286 f1 0.8286
position_predict: train acc 0.9576 p 0.8125 r 0.8125 f1 0.8125
step 30: train loss 0.1376 
cause_predict: train acc 0.9733 p 0.9444 r 0.8947 f1 0.9189
position_predict: train acc 0.9733 p 0.8824 r 0.9375 f1 0.9091
step 40: train loss 0.0873 
cause_predict: train acc 0.9949 p 0.9722 r 1.0000 f1 0.9859
position_predict: train acc 0.9695 p 0.9062 r 0.9062 f1 0.9062
step 50: train loss 0.0666 
cause_predict: train acc 0.9922 p 0.9412 r 1.0000 f1 0.9697
position_predict: train acc 0.9922 p 0.9688 r 0.9688 f1 0.9688
step 60: train loss 0.1652 
cause_predict: train acc 0.9623 p 0.8750 r 0.8974 f1 0.8861
position_predict: train acc 0.9791 p 0.9091 r 0.9375 f1 0.9231
step 70: train loss 0.0835 
cause_predict: train acc 0.9868 p 0.9697 r 0.9412 f1 0.9552
position_predict: train acc 0.9868 p 0.9677 r 0.9375 f1 0.9524

epoch 13: test loss 0.7484 cost time: 10.8s

cause_predict: test acc 0.8825 p 0.6055 r 0.4890 f1 0.5410
max_acc 0.8892 max_p 0.6255 max_r 0.5426 max_f1 0.5811

position_predict: test acc 0.9151 p 0.6690 r 0.6690 f1 0.6690
max_acc 0.9285 max_p 0.7530 max_r 0.6585 max_f1 0.7026

Average max cause: max_acc 0.8905 max_p 0.6565 max_r 0.4763 max_f1 0.5521
Average max pos: max_acc 0.9285 max_p 0.7571 max_r 0.6516 max_f1 0.7004

step 10: train loss 0.1141 
cause_predict: train acc 0.9844 p 0.9429 r 0.9429 f1 0.9429
position_predict: train acc 0.9650 p 0.8966 r 0.8125 f1 0.8525
step 20: train loss 0.0619 
cause_predict: train acc 0.9775 p 0.9730 r 0.8780 f1 0.9231
position_predict: train acc 0.9963 p 1.0000 r 0.9697 f1 0.9846
step 30: train loss 0.0940 
cause_predict: train acc 0.9769 p 0.8947 r 0.9444 f1 0.9189
position_predict: train acc 0.9885 p 0.9394 r 0.9688 f1 0.9538
step 40: train loss 0.0849 
cause_predict: train acc 0.9773 p 0.9189 r 0.9444 f1 0.9315
position_predict: train acc 0.9909 p 0.9688 r 0.9688 f1 0.9688
step 50: train loss 0.1619 
cause_predict: train acc 0.9560 p 0.8485 r 0.8000 f1 0.8235
position_predict: train acc 0.9524 p 0.8065 r 0.7812 f1 0.7937
step 60: train loss 0.1984 
cause_predict: train acc 0.9480 p 0.8788 r 0.7632 f1 0.8169
position_predict: train acc 0.9480 p 0.7941 r 0.8182 f1 0.8060
step 70: train loss 0.1793 
cause_predict: train acc 0.9540 p 0.8286 r 0.8529 f1 0.8406
position_predict: train acc 0.9749 p 0.9333 r 0.8750 f1 0.9032

epoch 14: test loss 0.7834 cost time: 10.7s

cause_predict: test acc 0.8883 p 0.6304 r 0.5110 f1 0.5645
max_acc 0.8892 max_p 0.6255 max_r 0.5426 max_f1 0.5811

position_predict: test acc 0.9133 p 0.6632 r 0.6585 f1 0.6608
max_acc 0.9285 max_p 0.7530 max_r 0.6585 max_f1 0.7026

Average max cause: max_acc 0.8905 max_p 0.6565 max_r 0.4763 max_f1 0.5521
Average max pos: max_acc 0.9285 max_p 0.7571 max_r 0.6516 max_f1 0.7004

write pair_data/Ind_BiLSTM_1/fold_1_test.txt done
write pair_data/Ind_BiLSTM_1/fold_1_train.txt done
Optimization Finished!

############# fold 1 end ###############
############# fold 2 begin ###############
load data_file: data_combine_en/fold_2_train.txt
y_position.shape (2275, 75, 2)
y_cause.shape (2275, 75, 2)
x.shape (2275, 75, 30)
sen_len.shape (2275, 75)
doc_len.shape (2275,)
n_cut 107
load data done!

load data_file: data_combine_en/fold_2_test.txt
y_position.shape (284, 75, 2)
y_cause.shape (284, 75, 2)
x.shape (284, 75, 30)
sen_len.shape (284, 75)
doc_len.shape (284,)
n_cut 22
load data done!

train docs: 2275    test docs: 284
step 10: train loss 0.7849 
cause_predict: train acc 0.8584 p 0.0000 r 0.0000 f1 0.0000
position_predict: train acc 0.8627 p 0.0000 r 0.0000 f1 0.0000
step 20: train loss 0.6872 
cause_predict: train acc 0.8531 p 0.0000 r 0.0000 f1 0.0000
position_predict: train acc 0.8694 p 0.0000 r 0.0000 f1 0.0000
step 30: train loss 0.6420 
cause_predict: train acc 0.8556 p 0.0000 r 0.0000 f1 0.0000
position_predict: train acc 0.8845 p 0.0000 r 0.0000 f1 0.0000
step 40: train loss 0.5882 
cause_predict: train acc 0.8655 p 0.0000 r 0.0000 f1 0.0000
position_predict: train acc 0.8727 p 0.4615 r 0.5625 f1 0.5070
step 50: train loss 0.6179 
cause_predict: train acc 0.8696 p 1.0000 r 0.0571 f1 0.1081
position_predict: train acc 0.8814 p 0.5556 r 0.3125 f1 0.4000
step 60: train loss 0.5134 
cause_predict: train acc 0.8667 p 0.6000 r 0.0857 f1 0.1500
position_predict: train acc 0.9216 p 0.7308 r 0.5938 f1 0.6552
step 70: train loss 0.5539 
cause_predict: train acc 0.8750 p 0.8000 r 0.2353 f1 0.3636
position_predict: train acc 0.9107 p 0.7000 r 0.6562 f1 0.6774

epoch 0: test loss 0.5086 cost time: 10.6s

cause_predict: test acc 0.8820 p 0.8193 r 0.2145 f1 0.3400
max_acc 0.8820 max_p 0.8193 max_r 0.2145 max_f1 0.3400

position_predict: test acc 0.9196 p 0.7512 r 0.5575 f1 0.6400
max_acc 0.9196 max_p 0.7512 max_r 0.5575 max_f1 0.6400

Average max cause: max_acc 0.8820 max_p 0.8193 max_r 0.2145 max_f1 0.3400
Average max pos: max_acc 0.9196 max_p 0.7512 max_r 0.5575 max_f1 0.6400

step 10: train loss 0.5925 
cause_predict: train acc 0.8513 p 0.6154 r 0.2500 f1 0.3556
position_predict: train acc 0.9077 p 0.7692 r 0.6250 f1 0.6897
step 20: train loss 0.4936 
cause_predict: train acc 0.8815 p 0.7143 r 0.2500 f1 0.3704
position_predict: train acc 0.9443 p 0.7500 r 0.7500 f1 0.7500
step 30: train loss 0.5508 
cause_predict: train acc 0.8435 p 0.5625 r 0.2368 f1 0.3333
position_predict: train acc 0.9217 p 0.7333 r 0.6875 f1 0.7097
step 40: train loss 0.4851 
cause_predict: train acc 0.8810 p 0.8235 r 0.3889 f1 0.5283
position_predict: train acc 0.9286 p 0.9048 r 0.5938 f1 0.7170
step 50: train loss 0.5663 
cause_predict: train acc 0.8675 p 0.7500 r 0.1622 f1 0.2667
position_predict: train acc 0.9116 p 0.7000 r 0.6176 f1 0.6562
step 60: train loss 0.5136 
cause_predict: train acc 0.8996 p 0.8667 r 0.3514 f1 0.5000
position_predict: train acc 0.8996 p 0.5938 r 0.5938 f1 0.5938
step 70: train loss 0.5240 
cause_predict: train acc 0.8559 p 0.7143 r 0.1351 f1 0.2273
position_predict: train acc 0.9237 p 0.7917 r 0.5938 f1 0.6786

epoch 1: test loss 0.4735 cost time: 10.8s

cause_predict: test acc 0.8928 p 0.7016 r 0.4227 f1 0.5276
max_acc 0.8928 max_p 0.7016 max_r 0.4227 max_f1 0.5276

position_predict: test acc 0.9227 p 0.7111 r 0.6690 f1 0.6894
max_acc 0.9227 max_p 0.7111 max_r 0.6690 max_f1 0.6894

Average max cause: max_acc 0.8928 max_p 0.7016 max_r 0.4227 max_f1 0.5276
Average max pos: max_acc 0.9227 max_p 0.7111 max_r 0.6690 max_f1 0.6894

step 10: train loss 0.4827 
cause_predict: train acc 0.9013 p 0.8125 r 0.3939 f1 0.5306
position_predict: train acc 0.9099 p 0.6667 r 0.6875 f1 0.6769
step 20: train loss 0.4678 
cause_predict: train acc 0.8750 p 0.6250 r 0.3947 f1 0.4839
position_predict: train acc 0.9219 p 0.6765 r 0.7188 f1 0.6970
step 30: train loss 0.5181 
cause_predict: train acc 0.8368 p 0.4800 r 0.3158 f1 0.3810
position_predict: train acc 0.9540 p 0.8621 r 0.7812 f1 0.8197
step 40: train loss 0.4747 
cause_predict: train acc 0.8922 p 0.7273 r 0.2105 f1 0.3265
position_predict: train acc 0.9183 p 0.6296 r 0.5312 f1 0.5763
step 50: train loss 0.4226 
cause_predict: train acc 0.9151 p 1.0000 r 0.4054 f1 0.5769
position_predict: train acc 0.9537 p 0.8125 r 0.8125 f1 0.8125
step 60: train loss 0.5233 
cause_predict: train acc 0.8670 p 0.7000 r 0.2000 f1 0.3111
position_predict: train acc 0.9056 p 0.7000 r 0.6176 f1 0.6562
step 70: train loss 0.4015 
cause_predict: train acc 0.8922 p 0.6667 r 0.4324 f1 0.5246
position_predict: train acc 0.9405 p 0.8636 r 0.5938 f1 0.7037

epoch 2: test loss 0.4636 cost time: 10.9s

cause_predict: test acc 0.8968 p 0.6937 r 0.4858 f1 0.5714
max_acc 0.8968 max_p 0.6937 max_r 0.4858 max_f1 0.5714

position_predict: test acc 0.9249 p 0.7598 r 0.6063 f1 0.6744
max_acc 0.9227 max_p 0.7111 max_r 0.6690 max_f1 0.6894

Average max cause: max_acc 0.8968 max_p 0.6937 max_r 0.4858 max_f1 0.5714
Average max pos: max_acc 0.9249 max_p 0.7598 max_r 0.6063 max_f1 0.6744

step 10: train loss 0.3565 
cause_predict: train acc 0.9123 p 0.7500 r 0.4286 f1 0.5455
position_predict: train acc 0.9509 p 0.8214 r 0.7188 f1 0.7667
step 20: train loss 0.5082 
cause_predict: train acc 0.8700 p 0.6154 r 0.4571 f1 0.5246
position_predict: train acc 0.9013 p 0.6667 r 0.6250 f1 0.6452
step 30: train loss 0.3718 
cause_predict: train acc 0.9183 p 0.7826 r 0.5294 f1 0.6316
position_predict: train acc 0.9416 p 0.7812 r 0.7576 f1 0.7692
step 40: train loss 0.3724 
cause_predict: train acc 0.9206 p 0.8261 r 0.5429 f1 0.6552
position_predict: train acc 0.9484 p 0.7879 r 0.8125 f1 0.8000
step 50: train loss 0.4024 
cause_predict: train acc 0.8833 p 0.8000 r 0.3243 f1 0.4615
position_predict: train acc 0.9583 p 0.8667 r 0.8125 f1 0.8387
step 60: train loss 0.4316 
cause_predict: train acc 0.8844 p 0.8235 r 0.3784 f1 0.5185
position_predict: train acc 0.9200 p 0.7188 r 0.7188 f1 0.7188
step 70: train loss 0.5141 
cause_predict: train acc 0.8760 p 0.6786 r 0.4634 f1 0.5507
position_predict: train acc 0.9400 p 0.7931 r 0.7188 f1 0.7541

epoch 3: test loss 0.4807 cost time: 11.1s

cause_predict: test acc 0.8843 p 0.6151 r 0.4890 f1 0.5448
max_acc 0.8968 max_p 0.6937 max_r 0.4858 max_f1 0.5714

position_predict: test acc 0.9249 p 0.7490 r 0.6237 f1 0.6806
max_acc 0.9227 max_p 0.7111 max_r 0.6690 max_f1 0.6894

Average max cause: max_acc 0.8968 max_p 0.6937 max_r 0.4858 max_f1 0.5714
Average max pos: max_acc 0.9249 max_p 0.7598 max_r 0.6063 max_f1 0.6744

step 10: train loss 0.4523 
cause_predict: train acc 0.9045 p 0.7826 r 0.5294 f1 0.6316
position_predict: train acc 0.9091 p 0.7143 r 0.6250 f1 0.6667
step 20: train loss 0.2563 
cause_predict: train acc 0.9298 p 0.7742 r 0.7273 f1 0.7500
position_predict: train acc 0.9649 p 0.8529 r 0.9062 f1 0.8788
step 30: train loss 0.5452 
cause_predict: train acc 0.8369 p 0.5000 r 0.1842 f1 0.2692
position_predict: train acc 0.9270 p 0.7778 r 0.6562 f1 0.7119
step 40: train loss 0.4069 
cause_predict: train acc 0.9091 p 0.7500 r 0.5833 f1 0.6562
position_predict: train acc 0.9339 p 0.8148 r 0.6667 f1 0.7333
step 50: train loss 0.3427 
cause_predict: train acc 0.9041 p 0.6957 r 0.4324 f1 0.5333
position_predict: train acc 0.9452 p 0.8214 r 0.6765 f1 0.7419
step 60: train loss 0.4584 
cause_predict: train acc 0.8863 p 0.7619 r 0.4571 f1 0.5714
position_predict: train acc 0.9100 p 0.7097 r 0.6875 f1 0.6984
step 70: train loss 0.4035 
cause_predict: train acc 0.9160 p 0.8889 r 0.4444 f1 0.5926
position_predict: train acc 0.9504 p 0.8519 r 0.7188 f1 0.7797

epoch 4: test loss 0.4944 cost time: 11.0s

cause_predict: test acc 0.8838 p 0.6338 r 0.4259 f1 0.5094
max_acc 0.8968 max_p 0.6937 max_r 0.4858 max_f1 0.5714

position_predict: test acc 0.9240 p 0.7427 r 0.6237 f1 0.6780
max_acc 0.9227 max_p 0.7111 max_r 0.6690 max_f1 0.6894

Average max cause: max_acc 0.8968 max_p 0.6937 max_r 0.4858 max_f1 0.5714
Average max pos: max_acc 0.9249 max_p 0.7598 max_r 0.6063 max_f1 0.6744

step 10: train loss 0.3207 
cause_predict: train acc 0.9173 p 0.7333 r 0.6286 f1 0.6769
position_predict: train acc 0.9409 p 0.7576 r 0.7812 f1 0.7692
step 20: train loss 0.3921 
cause_predict: train acc 0.8835 p 0.7188 r 0.6053 f1 0.6571
position_predict: train acc 0.9369 p 0.9167 r 0.6667 f1 0.7719
step 30: train loss 0.3439 
cause_predict: train acc 0.9292 p 0.8387 r 0.7027 f1 0.7647
position_predict: train acc 0.9336 p 0.7742 r 0.7500 f1 0.7619
step 40: train loss 0.3113 
cause_predict: train acc 0.9122 p 0.8519 r 0.5476 f1 0.6667
position_predict: train acc 0.9618 p 0.8710 r 0.8182 f1 0.8438
step 50: train loss 0.4131 
cause_predict: train acc 0.9055 p 0.7308 r 0.5000 f1 0.5937
position_predict: train acc 0.9127 p 0.6333 r 0.5938 f1 0.6129
step 60: train loss 0.4213 
cause_predict: train acc 0.8857 p 0.6400 r 0.4571 f1 0.5333
position_predict: train acc 0.9429 p 0.8214 r 0.7188 f1 0.7667
step 70: train loss 0.4081 
cause_predict: train acc 0.8893 p 0.6538 r 0.4857 f1 0.5574
position_predict: train acc 0.9426 p 0.7812 r 0.7812 f1 0.7812

epoch 5: test loss 0.4960 cost time: 11.0s

cause_predict: test acc 0.8896 p 0.6923 r 0.3975 f1 0.5050
max_acc 0.8968 max_p 0.6937 max_r 0.4858 max_f1 0.5714

position_predict: test acc 0.9223 p 0.7085 r 0.6690 f1 0.6882
max_acc 0.9227 max_p 0.7111 max_r 0.6690 max_f1 0.6894

Average max cause: max_acc 0.8968 max_p 0.6937 max_r 0.4858 max_f1 0.5714
Average max pos: max_acc 0.9249 max_p 0.7598 max_r 0.6063 max_f1 0.6744

step 10: train loss 0.3072 
cause_predict: train acc 0.9206 p 0.7576 r 0.7353 f1 0.7463
position_predict: train acc 0.9346 p 0.8000 r 0.7500 f1 0.7742
step 20: train loss 0.2545 
cause_predict: train acc 0.9433 p 0.8276 r 0.7273 f1 0.7742
position_predict: train acc 0.9555 p 0.8056 r 0.8788 f1 0.8406
step 30: train loss 0.2629 
cause_predict: train acc 0.9384 p 0.7576 r 0.7353 f1 0.7463
position_predict: train acc 0.9493 p 0.8276 r 0.7273 f1 0.7742
step 40: train loss 0.3424 
cause_predict: train acc 0.9324 p 0.8158 r 0.7949 f1 0.8052
position_predict: train acc 0.9324 p 0.8214 r 0.6970 f1 0.7541
step 50: train loss 0.2688 
cause_predict: train acc 0.9478 p 0.8125 r 0.7879 f1 0.8000
position_predict: train acc 0.9598 p 0.8438 r 0.8438 f1 0.8438
step 60: train loss 0.2714 
cause_predict: train acc 0.9377 p 0.8333 r 0.5556 f1 0.6667
position_predict: train acc 0.9502 p 0.8077 r 0.6562 f1 0.7241
step 70: train loss 0.3121 
cause_predict: train acc 0.9543 p 0.9062 r 0.8286 f1 0.8657
position_predict: train acc 0.9188 p 0.7500 r 0.7500 f1 0.7500

epoch 6: test loss 0.5296 cost time: 11.0s

cause_predict: test acc 0.8834 p 0.6061 r 0.5047 f1 0.5508
max_acc 0.8968 max_p 0.6937 max_r 0.4858 max_f1 0.5714

position_predict: test acc 0.9236 p 0.7148 r 0.6725 f1 0.6930
max_acc 0.9236 max_p 0.7148 max_r 0.6725 max_f1 0.6930

Average max cause: max_acc 0.8968 max_p 0.6937 max_r 0.4858 max_f1 0.5714
Average max pos: max_acc 0.9249 max_p 0.7598 max_r 0.6063 max_f1 0.6744

step 10: train loss 0.2120 
cause_predict: train acc 0.9505 p 0.9583 r 0.6970 f1 0.8070
position_predict: train acc 0.9685 p 0.9032 r 0.8750 f1 0.8889
step 20: train loss 0.1292 
cause_predict: train acc 0.9854 p 0.9412 r 0.9697 f1 0.9552
position_predict: train acc 0.9659 p 0.8788 r 0.9062 f1 0.8923
step 30: train loss 0.3180 
cause_predict: train acc 0.9315 p 0.7576 r 0.7812 f1 0.7692
position_predict: train acc 0.9498 p 0.8438 r 0.8182 f1 0.8308
step 40: train loss 0.2138 
cause_predict: train acc 0.9464 p 0.8276 r 0.7059 f1 0.7619
position_predict: train acc 0.9607 p 0.8182 r 0.8438 f1 0.8308
step 50: train loss 0.3070 
cause_predict: train acc 0.9421 p 0.8108 r 0.8108 f1 0.8108
position_predict: train acc 0.9463 p 0.7879 r 0.8125 f1 0.8000
step 60: train loss 0.2827 
cause_predict: train acc 0.9249 p 0.6774 r 0.6364 f1 0.6562
position_predict: train acc 0.9488 p 0.7742 r 0.7500 f1 0.7619
step 70: train loss 0.2523 
cause_predict: train acc 0.9383 p 0.8438 r 0.7297 f1 0.7826
position_predict: train acc 0.9712 p 0.9032 r 0.8750 f1 0.8889

epoch 7: test loss 0.5454 cost time: 11.0s

cause_predict: test acc 0.8785 p 0.5830 r 0.4984 f1 0.5374
max_acc 0.8968 max_p 0.6937 max_r 0.4858 max_f1 0.5714

position_predict: test acc 0.9178 p 0.6758 r 0.6899 f1 0.6828
max_acc 0.9236 max_p 0.7148 max_r 0.6725 max_f1 0.6930

Average max cause: max_acc 0.8968 max_p 0.6937 max_r 0.4858 max_f1 0.5714
Average max pos: max_acc 0.9249 max_p 0.7598 max_r 0.6063 max_f1 0.6744

step 10: train loss 0.1620 
cause_predict: train acc 0.9655 p 0.8857 r 0.8378 f1 0.8611
position_predict: train acc 0.9793 p 0.9062 r 0.9062 f1 0.9062
step 20: train loss 0.2012 
cause_predict: train acc 0.9417 p 0.9412 r 0.7619 f1 0.8421
position_predict: train acc 0.9806 p 0.9118 r 0.9688 f1 0.9394
step 30: train loss 0.2044 
cause_predict: train acc 0.9693 p 0.9143 r 0.8649 f1 0.8889
position_predict: train acc 0.9693 p 0.8750 r 0.8750 f1 0.8750
step 40: train loss 0.2382 
cause_predict: train acc 0.9510 p 0.9630 r 0.6667 f1 0.7879
position_predict: train acc 0.9406 p 0.7143 r 0.7812 f1 0.7463
step 50: train loss 0.1996 
cause_predict: train acc 0.9635 p 0.9355 r 0.8529 f1 0.8923
position_predict: train acc 0.9688 p 0.9643 r 0.8438 f1 0.9000
step 60: train loss 0.2548 
cause_predict: train acc 0.9429 p 0.8000 r 0.8000 f1 0.8000
position_predict: train acc 0.9469 p 0.8571 r 0.7273 f1 0.7869
step 70: train loss 0.2041 
cause_predict: train acc 0.9707 p 0.9032 r 0.8750 f1 0.8889
position_predict: train acc 0.9749 p 0.8824 r 0.9375 f1 0.9091

epoch 8: test loss 0.5931 cost time: 10.7s

cause_predict: test acc 0.8874 p 0.6190 r 0.5331 f1 0.5729
max_acc 0.8874 max_p 0.6190 max_r 0.5331 max_f1 0.5729

position_predict: test acc 0.9138 p 0.6643 r 0.6620 f1 0.6632
max_acc 0.9236 max_p 0.7148 max_r 0.6725 max_f1 0.6930

Average max cause: max_acc 0.8968 max_p 0.6937 max_r 0.4858 max_f1 0.5714
Average max pos: max_acc 0.9249 max_p 0.7598 max_r 0.6063 max_f1 0.6744

step 10: train loss 0.2092 
cause_predict: train acc 0.9437 p 0.8286 r 0.7436 f1 0.7838
position_predict: train acc 0.9648 p 0.8438 r 0.8438 f1 0.8438
step 20: train loss 0.1840 
cause_predict: train acc 0.9826 p 0.9394 r 0.9394 f1 0.9394
position_predict: train acc 0.9522 p 0.8621 r 0.7812 f1 0.8197
step 30: train loss 0.2455 
cause_predict: train acc 0.9707 p 0.8857 r 0.9118 f1 0.8986
position_predict: train acc 0.9540 p 0.8621 r 0.7812 f1 0.8197
step 40: train loss 0.2411 
cause_predict: train acc 0.9540 p 0.8529 r 0.8286 f1 0.8406
position_predict: train acc 0.9540 p 0.8667 r 0.7879 f1 0.8254
step 50: train loss 0.2799 
cause_predict: train acc 0.9476 p 0.8387 r 0.7429 f1 0.7879
position_predict: train acc 0.9588 p 0.8182 r 0.8438 f1 0.8308
step 60: train loss 0.2224 
cause_predict: train acc 0.9277 p 0.7895 r 0.7692 f1 0.7792
position_predict: train acc 0.9532 p 0.8387 r 0.8125 f1 0.8254
step 70: train loss 0.2190 
cause_predict: train acc 0.9522 p 0.9412 r 0.8000 f1 0.8649
position_predict: train acc 0.9761 p 0.9355 r 0.9062 f1 0.9206

epoch 9: test loss 0.6006 cost time: 11.0s

cause_predict: test acc 0.8798 p 0.5774 r 0.5647 f1 0.5710
max_acc 0.8874 max_p 0.6190 max_r 0.5331 max_f1 0.5729

position_predict: test acc 0.9169 p 0.6760 r 0.6760 f1 0.6760
max_acc 0.9236 max_p 0.7148 max_r 0.6725 max_f1 0.6930

Average max cause: max_acc 0.8798 max_p 0.5774 max_r 0.5647 max_f1 0.5710
Average max pos: max_acc 0.9169 max_p 0.6760 max_r 0.6760 max_f1 0.6760

step 10: train loss 0.0936 
cause_predict: train acc 0.9772 p 0.9412 r 0.9143 f1 0.9275
position_predict: train acc 1.0000 p 1.0000 r 1.0000 f1 1.0000
step 20: train loss 0.1889 
cause_predict: train acc 0.9558 p 0.8611 r 0.8378 f1 0.8493
position_predict: train acc 0.9478 p 0.7879 r 0.8125 f1 0.8000
step 30: train loss 0.1865 
cause_predict: train acc 0.9472 p 0.7838 r 0.8056 f1 0.7945
position_predict: train acc 0.9824 p 0.9118 r 0.9394 f1 0.9254
step 40: train loss 0.2551 
cause_predict: train acc 0.9602 p 0.8750 r 0.8750 f1 0.8750
position_predict: train acc 0.9363 p 0.7353 r 0.7812 f1 0.7576
step 50: train loss 0.1951 
cause_predict: train acc 0.9646 p 0.8889 r 0.9143 f1 0.9014
position_predict: train acc 0.9747 p 0.9355 r 0.9062 f1 0.9206
step 60: train loss 0.2182 
cause_predict: train acc 0.9604 p 0.8857 r 0.8158 f1 0.8493
position_predict: train acc 0.9568 p 0.8387 r 0.7879 f1 0.8125
step 70: train loss 0.1553 
cause_predict: train acc 0.9520 p 0.8889 r 0.8205 f1 0.8533
position_predict: train acc 0.9956 p 0.9697 r 1.0000 f1 0.9846

epoch 10: test loss 0.6914 cost time: 11.1s

cause_predict: test acc 0.8731 p 0.5531 r 0.5426 f1 0.5478
max_acc 0.8874 max_p 0.6190 max_r 0.5331 max_f1 0.5729

position_predict: test acc 0.9205 p 0.6996 r 0.6655 f1 0.6821
max_acc 0.9236 max_p 0.7148 max_r 0.6725 max_f1 0.6930

Average max cause: max_acc 0.8798 max_p 0.5774 max_r 0.5647 max_f1 0.5710
Average max pos: max_acc 0.9169 max_p 0.6760 max_r 0.6760 max_f1 0.6760

step 10: train loss 0.0781 
cause_predict: train acc 0.9778 p 0.8857 r 0.9394 f1 0.9118
position_predict: train acc 0.9889 p 0.9394 r 0.9688 f1 0.9538
step 20: train loss 0.1623 
cause_predict: train acc 0.9818 p 0.9722 r 0.9211 f1 0.9459
position_predict: train acc 0.9636 p 0.8529 r 0.9062 f1 0.8788
step 30: train loss 0.1777 
cause_predict: train acc 0.9588 p 0.8421 r 0.8889 f1 0.8649
position_predict: train acc 0.9794 p 0.9355 r 0.9062 f1 0.9206
step 40: train loss 0.1157 
cause_predict: train acc 0.9835 p 0.9429 r 0.9429 f1 0.9429
position_predict: train acc 0.9712 p 0.9032 r 0.8750 f1 0.8889
step 50: train loss 0.2848 
cause_predict: train acc 0.9414 p 0.8333 r 0.7143 f1 0.7692
position_predict: train acc 0.9414 p 0.7297 r 0.8438 f1 0.7826
step 60: train loss 0.1605 
2024-06-22 18:35:51.399752: W tensorflow/c/c_api.cc:304] Operation '{name:'softmax_b_pos/Adam_1/Assign' id:5023 op device:{requested: '', assigned: ''} def:{{{node softmax_b_pos/Adam_1/Assign}} = Assign[T=DT_FLOAT, _class=["loc:@softmax_b_pos"], _has_manual_control_dependencies=true, use_locking=true, validate_shape=true](softmax_b_pos/Adam_1, softmax_b_pos/Adam_1/Initializer/zeros)}}' was changed by setting attribute after it was run by a session. This mutation will have no effect, and will trigger an error in the future. Either don't modify nodes after running them or create a new session.
cause_predict: train acc 0.9716 p 0.9444 r 0.8293 f1 0.8831
position_predict: train acc 0.9653 p 0.8387 r 0.8125 f1 0.8254
step 70: train loss 0.2182 
cause_predict: train acc 0.9619 p 0.8684 r 0.8919 f1 0.8800
position_predict: train acc 0.9703 p 0.9032 r 0.8750 f1 0.8889

epoch 11: test loss 0.6599 cost time: 10.9s

cause_predict: test acc 0.8811 p 0.5882 r 0.5363 f1 0.5611
max_acc 0.8874 max_p 0.6190 max_r 0.5331 max_f1 0.5729

position_predict: test acc 0.9169 p 0.6850 r 0.6516 f1 0.6679
max_acc 0.9236 max_p 0.7148 max_r 0.6725 max_f1 0.6930

Average max cause: max_acc 0.8798 max_p 0.5774 max_r 0.5647 max_f1 0.5710
Average max pos: max_acc 0.9169 max_p 0.6760 max_r 0.6760 max_f1 0.6760

step 10: train loss 0.1906 
cause_predict: train acc 0.9721 p 0.9459 r 0.8974 f1 0.9211
position_predict: train acc 0.9395 p 0.7941 r 0.8182 f1 0.8060
step 20: train loss 0.0736 
cause_predict: train acc 0.9756 p 0.9412 r 0.8649 f1 0.9014
position_predict: train acc 0.9930 p 0.9688 r 0.9688 f1 0.9688
step 30: train loss 0.1800 
cause_predict: train acc 0.9623 p 0.8889 r 0.8889 f1 0.8889
position_predict: train acc 0.9481 p 0.8000 r 0.8750 f1 0.8358
step 40: train loss 0.2294 
cause_predict: train acc 0.9502 p 0.8378 r 0.8857 f1 0.8611
position_predict: train acc 0.9502 p 0.8438 r 0.8438 f1 0.8438
step 50: train loss 0.2132 
cause_predict: train acc 0.9641 p 0.8611 r 0.8857 f1 0.8732
position_predict: train acc 0.9562 p 0.8387 r 0.8125 f1 0.8254
step 60: train loss 0.1130 
cause_predict: train acc 0.9758 p 0.9118 r 0.8857 f1 0.8986
position_predict: train acc 0.9758 p 0.8571 r 0.9375 f1 0.8955
step 70: train loss 0.1379 
cause_predict: train acc 0.9621 p 0.8056 r 0.8788 f1 0.8406
position_predict: train acc 0.9621 p 0.8889 r 0.7500 f1 0.8136

epoch 12: test loss 0.6951 cost time: 10.8s

cause_predict: test acc 0.8780 p 0.5791 r 0.5079 f1 0.5412
max_acc 0.8874 max_p 0.6190 max_r 0.5331 max_f1 0.5729

position_predict: test acc 0.9196 p 0.6960 r 0.6620 f1 0.6786
max_acc 0.9236 max_p 0.7148 max_r 0.6725 max_f1 0.6930

Average max cause: max_acc 0.8798 max_p 0.5774 max_r 0.5647 max_f1 0.5710
Average max pos: max_acc 0.9169 max_p 0.6760 max_r 0.6760 max_f1 0.6760

step 10: train loss 0.1072 
cause_predict: train acc 0.9727 p 0.9118 r 0.9394 f1 0.9254
position_predict: train acc 0.9781 p 0.8919 r 1.0000 f1 0.9429
step 20: train loss 0.0832 
cause_predict: train acc 0.9836 p 0.9167 r 1.0000 f1 0.9565
position_predict: train acc 0.9891 p 0.9688 r 0.9688 f1 0.9688
step 30: train loss 0.1721 
cause_predict: train acc 0.9547 p 0.8947 r 0.8293 f1 0.8608
position_predict: train acc 0.9671 p 0.9000 r 0.8438 f1 0.8710
step 40: train loss 0.1177 
cause_predict: train acc 0.9872 p 1.0000 r 0.9118 f1 0.9538
position_predict: train acc 0.9702 p 0.8824 r 0.9091 f1 0.8955
step 50: train loss 0.1443 
cause_predict: train acc 0.9640 p 0.8421 r 0.9143 f1 0.8767
position_predict: train acc 0.9760 p 0.8824 r 0.9375 f1 0.9091
step 60: train loss 0.1308 
cause_predict: train acc 0.9859 p 0.9730 r 0.9474 f1 0.9600
position_predict: train acc 0.9531 p 0.8235 r 0.8750 f1 0.8485
step 70: train loss 0.2073 
cause_predict: train acc 0.9578 p 0.9375 r 0.7895 f1 0.8571
position_predict: train acc 0.9620 p 0.8485 r 0.8750 f1 0.8615

epoch 13: test loss 0.7485 cost time: 10.9s

cause_predict: test acc 0.8776 p 0.5700 r 0.5521 f1 0.5609
max_acc 0.8874 max_p 0.6190 max_r 0.5331 max_f1 0.5729

position_predict: test acc 0.9178 p 0.6859 r 0.6620 f1 0.6738
max_acc 0.9236 max_p 0.7148 max_r 0.6725 max_f1 0.6930

Average max cause: max_acc 0.8798 max_p 0.5774 max_r 0.5647 max_f1 0.5710
Average max pos: max_acc 0.9169 max_p 0.6760 max_r 0.6760 max_f1 0.6760

step 10: train loss 0.0886 
cause_predict: train acc 0.9924 p 0.9714 r 0.9714 f1 0.9714
position_predict: train acc 0.9659 p 0.8485 r 0.8750 f1 0.8615
step 20: train loss 0.0999 
cause_predict: train acc 0.9841 p 0.9412 r 0.9697 f1 0.9552
position_predict: train acc 0.9735 p 0.9091 r 0.9375 f1 0.9231
step 30: train loss 0.1083 
cause_predict: train acc 0.9847 p 1.0000 r 0.9118 f1 0.9538
position_predict: train acc 0.9745 p 0.9091 r 0.9375 f1 0.9231
step 40: train loss 0.1402 
cause_predict: train acc 0.9694 p 0.9231 r 0.9231 f1 0.9231
position_predict: train acc 0.9694 p 0.8611 r 0.9688 f1 0.9118
step 50: train loss 0.0617 
cause_predict: train acc 1.0000 p 1.0000 r 1.0000 f1 1.0000
position_predict: train acc 0.9842 p 0.9677 r 0.9375 f1 0.9524
step 60: train loss 0.1610 
cause_predict: train acc 0.9718 p 0.8857 r 0.9118 f1 0.8986
position_predict: train acc 0.9637 p 0.8485 r 0.8750 f1 0.8615
step 70: train loss 0.0905 
cause_predict: train acc 0.9829 p 0.8947 r 1.0000 f1 0.9444
position_predict: train acc 0.9872 p 0.9677 r 0.9375 f1 0.9524

epoch 14: test loss 0.7601 cost time: 11.1s

cause_predict: test acc 0.8758 p 0.5689 r 0.5079 f1 0.5367
max_acc 0.8874 max_p 0.6190 max_r 0.5331 max_f1 0.5729

position_predict: test acc 0.9200 p 0.6837 r 0.7003 f1 0.6919
max_acc 0.9236 max_p 0.7148 max_r 0.6725 max_f1 0.6930

Average max cause: max_acc 0.8798 max_p 0.5774 max_r 0.5647 max_f1 0.5710
Average max pos: max_acc 0.9169 max_p 0.6760 max_r 0.6760 max_f1 0.6760

write pair_data/Ind_BiLSTM_1/fold_2_test.txt done
write pair_data/Ind_BiLSTM_1/fold_2_train.txt done
Optimization Finished!

############# fold 2 end ###############
############# fold 3 begin ###############
load data_file: data_combine_en/fold_3_train.txt
y_position.shape (2275, 75, 2)
y_cause.shape (2275, 75, 2)
x.shape (2275, 75, 30)
sen_len.shape (2275, 75)
doc_len.shape (2275,)
n_cut 107
load data done!

load data_file: data_combine_en/fold_3_test.txt
y_position.shape (284, 75, 2)
y_cause.shape (284, 75, 2)
x.shape (284, 75, 30)
sen_len.shape (284, 75)
doc_len.shape (284,)
n_cut 22
load data done!

train docs: 2275    test docs: 284
step 10: train loss 0.7811 
cause_predict: train acc 0.8522 p 0.0000 r 0.0000 f1 0.0000
position_predict: train acc 0.8609 p 0.0000 r 0.0000 f1 0.0000
step 20: train loss 0.7461 
cause_predict: train acc 0.8555 p 0.0000 r 0.0000 f1 0.0000
position_predict: train acc 0.8783 p 0.0000 r 0.0000 f1 0.0000
step 30: train loss 0.5871 
cause_predict: train acc 0.8868 p 0.0000 r 0.0000 f1 0.0000
position_predict: train acc 0.8994 p 0.0000 r 0.0000 f1 0.0000
step 40: train loss 0.5487 
cause_predict: train acc 0.8577 p 0.0000 r 0.0000 f1 0.0000
position_predict: train acc 0.8787 p 0.6364 r 0.2188 f1 0.3256
step 50: train loss 0.6187 
cause_predict: train acc 0.8416 p 0.0000 r 0.0000 f1 0.0000
position_predict: train acc 0.9095 p 0.7097 r 0.6667 f1 0.6875
step 60: train loss 0.5872 
cause_predict: train acc 0.8455 p 0.0000 r 0.0000 f1 0.0000
position_predict: train acc 0.9045 p 0.6571 r 0.7188 f1 0.6866
step 70: train loss 0.6910 
cause_predict: train acc 0.8259 p 0.7500 r 0.1538 f1 0.2553
position_predict: train acc 0.9005 p 0.7308 r 0.5938 f1 0.6552

epoch 0: test loss 0.5163 cost time: 10.6s

cause_predict: test acc 0.8722 p 0.9429 r 0.1041 f1 0.1875
max_acc 0.8722 max_p 0.9429 max_r 0.1041 max_f1 0.1875

position_predict: test acc 0.9227 p 0.7879 r 0.5436 f1 0.6433
max_acc 0.9227 max_p 0.7879 max_r 0.5436 max_f1 0.6433

Average max cause: max_acc 0.8722 max_p 0.9429 max_r 0.1041 max_f1 0.1875
Average max pos: max_acc 0.9227 max_p 0.7879 max_r 0.5436 max_f1 0.6433

step 10: train loss 0.5709 
cause_predict: train acc 0.8638 p 0.6000 r 0.2368 f1 0.3396
position_predict: train acc 0.8949 p 0.5714 r 0.6250 f1 0.5970
step 20: train loss 0.5455 
cause_predict: train acc 0.8828 p 0.6000 r 0.3750 f1 0.4615
position_predict: train acc 0.9331 p 0.7857 r 0.6875 f1 0.7333
step 30: train loss 0.6302 
cause_predict: train acc 0.8551 p 0.7333 r 0.2973 f1 0.4231
position_predict: train acc 0.8889 p 0.6800 r 0.5312 f1 0.5965
step 40: train loss 0.5244 
cause_predict: train acc 0.9004 p 0.7857 r 0.3438 f1 0.4783
position_predict: train acc 0.9170 p 0.7727 r 0.5312 f1 0.6296
step 50: train loss 0.4236 
cause_predict: train acc 0.9125 p 0.6000 r 0.1875 f1 0.2857
position_predict: train acc 0.9329 p 0.7500 r 0.4545 f1 0.5660
step 60: train loss 0.4691 
cause_predict: train acc 0.8879 p 0.7222 r 0.3824 f1 0.5000
position_predict: train acc 0.9052 p 0.6923 r 0.5625 f1 0.6207
step 70: train loss 0.5480 
cause_predict: train acc 0.8794 p 0.6875 r 0.2973 f1 0.4151
position_predict: train acc 0.9222 p 0.7500 r 0.5625 f1 0.6429

epoch 1: test loss 0.4832 cost time: 11.0s

cause_predict: test acc 0.8856 p 0.7047 r 0.3312 f1 0.4506
max_acc 0.8856 max_p 0.7047 max_r 0.3312 max_f1 0.4506

position_predict: test acc 0.9276 p 0.7729 r 0.6167 f1 0.6860
max_acc 0.9276 max_p 0.7729 max_r 0.6167 max_f1 0.6860

Average max cause: max_acc 0.8856 max_p 0.7047 max_r 0.3312 max_f1 0.4506
Average max pos: max_acc 0.9276 max_p 0.7729 max_r 0.6167 max_f1 0.6860

step 10: train loss 0.3997 
cause_predict: train acc 0.9139 p 0.8421 r 0.4444 f1 0.5818
position_predict: train acc 0.9401 p 0.8750 r 0.6176 f1 0.7241
step 20: train loss 0.5737 
cause_predict: train acc 0.8495 p 0.6923 r 0.2500 f1 0.3673
position_predict: train acc 0.8883 p 0.6552 r 0.5938 f1 0.6230
step 30: train loss 0.4520 
cause_predict: train acc 0.8996 p 0.7727 r 0.4595 f1 0.5763
position_predict: train acc 0.9357 p 0.7500 r 0.7500 f1 0.7500
step 40: train loss 0.3853 
cause_predict: train acc 0.8745 p 0.4545 r 0.1515 f1 0.2273
position_predict: train acc 0.9594 p 0.8667 r 0.7879 f1 0.8254
step 50: train loss 0.5198 
cause_predict: train acc 0.8829 p 0.6923 r 0.5294 f1 0.6000
position_predict: train acc 0.9122 p 0.7273 r 0.7273 f1 0.7273
step 60: train loss 0.4928 
cause_predict: train acc 0.8776 p 0.7273 r 0.4103 f1 0.5246
position_predict: train acc 0.9198 p 0.7500 r 0.6364 f1 0.6885
step 70: train loss 0.5433 
cause_predict: train acc 0.8876 p 0.6250 r 0.3030 f1 0.4082
position_predict: train acc 0.8837 p 0.5385 r 0.4375 f1 0.4828

epoch 2: test loss 0.4741 cost time: 11.0s

cause_predict: test acc 0.8874 p 0.6857 r 0.3785 f1 0.4878
max_acc 0.8874 max_p 0.6857 max_r 0.3785 max_f1 0.4878

position_predict: test acc 0.9272 p 0.7263 r 0.6934 f1 0.7094
max_acc 0.9272 max_p 0.7263 max_r 0.6934 max_f1 0.7094

Average max cause: max_acc 0.8874 max_p 0.6857 max_r 0.3785 max_f1 0.4878
Average max pos: max_acc 0.9272 max_p 0.7263 max_r 0.6934 max_f1 0.7094

step 10: train loss 0.5132 
cause_predict: train acc 0.8708 p 0.5926 r 0.4444 f1 0.5079
position_predict: train acc 0.9125 p 0.6897 r 0.6250 f1 0.6557
step 20: train loss 0.4217 
cause_predict: train acc 0.8936 p 0.6522 r 0.4054 f1 0.5000
position_predict: train acc 0.9433 p 0.8696 r 0.6061 f1 0.7143
step 30: train loss 0.4836 
cause_predict: train acc 0.9141 p 0.8462 r 0.6286 f1 0.7213
position_predict: train acc 0.9394 p 0.8387 r 0.7879 f1 0.8125
step 40: train loss 0.4718 
cause_predict: train acc 0.8908 p 0.8500 r 0.4359 f1 0.5763
position_predict: train acc 0.9301 p 0.8077 r 0.6562 f1 0.7241
step 50: train loss 0.3719 
cause_predict: train acc 0.9183 p 0.9474 r 0.5294 f1 0.6792
position_predict: train acc 0.9519 p 0.8929 r 0.7812 f1 0.8333
step 60: train loss 0.4684 
cause_predict: train acc 0.8793 p 0.6957 r 0.4324 f1 0.5333
position_predict: train acc 0.9310 p 0.7667 r 0.7188 f1 0.7419
step 70: train loss 0.4006 
cause_predict: train acc 0.8976 p 0.6667 r 0.4211 f1 0.5161
position_predict: train acc 0.9386 p 0.7692 r 0.6250 f1 0.6897

epoch 3: test loss 0.4782 cost time: 10.9s

cause_predict: test acc 0.8861 p 0.6220 r 0.4984 f1 0.5534
max_acc 0.8861 max_p 0.6220 max_r 0.4984 max_f1 0.5534

position_predict: test acc 0.9214 p 0.7342 r 0.6063 f1 0.6641
max_acc 0.9272 max_p 0.7263 max_r 0.6934 max_f1 0.7094

Average max cause: max_acc 0.8861 max_p 0.6220 max_r 0.4984 max_f1 0.5534
Average max pos: max_acc 0.9214 max_p 0.7342 max_r 0.6063 max_f1 0.6641

step 10: train loss 0.3525 
cause_predict: train acc 0.9426 p 0.8889 r 0.7273 f1 0.8000
position_predict: train acc 0.9330 p 0.7368 r 0.8750 f1 0.8000
step 20: train loss 0.2435 
cause_predict: train acc 0.9464 p 0.8750 r 0.6364 f1 0.7368
position_predict: train acc 0.9893 p 0.9394 r 0.9688 f1 0.9538
step 30: train loss 0.4084 
cause_predict: train acc 0.8977 p 0.7273 r 0.4324 f1 0.5424
position_predict: train acc 0.9470 p 0.8214 r 0.7188 f1 0.7667
step 40: train loss 0.4736 
cause_predict: train acc 0.8894 p 0.8000 r 0.5128 f1 0.6250
position_predict: train acc 0.9263 p 0.8077 r 0.6562 f1 0.7241
step 50: train loss 0.4396 
cause_predict: train acc 0.8927 p 0.7500 r 0.4500 f1 0.5625
position_predict: train acc 0.9234 p 0.7500 r 0.5625 f1 0.6429
step 60: train loss 0.5277 
cause_predict: train acc 0.8849 p 0.6957 r 0.4211 f1 0.5246
position_predict: train acc 0.9365 p 0.7667 r 0.7188 f1 0.7419
step 70: train loss 0.3222 
cause_predict: train acc 0.9176 p 0.6923 r 0.5455 f1 0.6102
position_predict: train acc 0.9391 p 0.7273 r 0.7500 f1 0.7385

epoch 4: test loss 0.4903 cost time: 10.6s

cause_predict: test acc 0.8838 p 0.6477 r 0.3943 f1 0.4902
max_acc 0.8861 max_p 0.6220 max_r 0.4984 max_f1 0.5534

position_predict: test acc 0.9267 p 0.7173 r 0.7073 f1 0.7123
max_acc 0.9267 max_p 0.7173 max_r 0.7073 max_f1 0.7123

Average max cause: max_acc 0.8861 max_p 0.6220 max_r 0.4984 max_f1 0.5534
Average max pos: max_acc 0.9214 max_p 0.7342 max_r 0.6063 max_f1 0.6641

step 10: train loss 0.3518 
cause_predict: train acc 0.9404 p 0.8571 r 0.7895 f1 0.8219
position_predict: train acc 0.9266 p 0.7742 r 0.7273 f1 0.7500
step 20: train loss 0.3518 
cause_predict: train acc 0.9141 p 0.7353 r 0.7576 f1 0.7463
position_predict: train acc 0.9646 p 0.9643 r 0.8182 f1 0.8852
step 30: train loss 0.2732 
cause_predict: train acc 0.9298 p 0.7333 r 0.6471 f1 0.6875
position_predict: train acc 0.9684 p 0.8966 r 0.8125 f1 0.8525
step 40: train loss 0.3738 
cause_predict: train acc 0.9138 p 0.7500 r 0.6176 f1 0.6774
position_predict: train acc 0.9397 p 0.7879 r 0.7879 f1 0.7879
step 50: train loss 0.3453 
cause_predict: train acc 0.9223 p 0.8800 r 0.6471 f1 0.7458
position_predict: train acc 0.9585 p 0.8750 r 0.8750 f1 0.8750
step 60: train loss 0.3961 
cause_predict: train acc 0.9095 p 0.7500 r 0.5625 f1 0.6429
position_predict: train acc 0.9321 p 0.7931 r 0.7188 f1 0.7541
step 70: train loss 0.3871 
cause_predict: train acc 0.8893 p 0.6765 r 0.5897 f1 0.6301
position_predict: train acc 0.9344 p 0.7857 r 0.6875 f1 0.7333

epoch 5: test loss 0.5160 cost time: 10.9s

cause_predict: test acc 0.8865 p 0.6413 r 0.4511 f1 0.5296
max_acc 0.8861 max_p 0.6220 max_r 0.4984 max_f1 0.5534

position_predict: test acc 0.9205 p 0.6940 r 0.6794 f1 0.6866
max_acc 0.9267 max_p 0.7173 max_r 0.7073 max_f1 0.7123

Average max cause: max_acc 0.8861 max_p 0.6220 max_r 0.4984 max_f1 0.5534
Average max pos: max_acc 0.9214 max_p 0.7342 max_r 0.6063 max_f1 0.6641

step 10: train loss 0.3127 
cause_predict: train acc 0.9087 p 0.8276 r 0.6000 f1 0.6957
position_predict: train acc 0.9522 p 0.9259 r 0.7353 f1 0.8197
step 20: train loss 0.2361 
cause_predict: train acc 0.9496 p 0.8710 r 0.7500 f1 0.8060
position_predict: train acc 0.9729 p 0.9310 r 0.8438 f1 0.8852
step 30: train loss 0.3739 
cause_predict: train acc 0.9035 p 0.7941 r 0.6429 f1 0.7105
position_predict: train acc 0.9605 p 0.8529 r 0.8788 f1 0.8657
step 40: train loss 0.2862 
cause_predict: train acc 0.9301 p 0.8077 r 0.5833 f1 0.6774
position_predict: train acc 0.9580 p 0.8125 r 0.8125 f1 0.8125
step 50: train loss 0.2981 
cause_predict: train acc 0.9286 p 0.7222 r 0.7647 f1 0.7429
position_predict: train acc 0.9484 p 0.8276 r 0.7500 f1 0.7869
step 60: train loss 0.3188 
cause_predict: train acc 0.8909 p 0.6207 r 0.4865 f1 0.5455
position_predict: train acc 0.9527 p 0.8889 r 0.7059 f1 0.7869
step 70: train loss 0.2477 
cause_predict: train acc 0.9363 p 0.7895 r 0.7895 f1 0.7895
position_predict: train acc 0.9681 p 0.9032 r 0.8485 f1 0.8750

epoch 6: test loss 0.5339 cost time: 11.0s

cause_predict: test acc 0.8847 p 0.6255 r 0.4637 f1 0.5326
max_acc 0.8861 max_p 0.6220 max_r 0.4984 max_f1 0.5534

position_predict: test acc 0.9173 p 0.6835 r 0.6620 f1 0.6726
max_acc 0.9267 max_p 0.7173 max_r 0.7073 max_f1 0.7123

Average max cause: max_acc 0.8861 max_p 0.6220 max_r 0.4984 max_f1 0.5534
Average max pos: max_acc 0.9214 max_p 0.7342 max_r 0.6063 max_f1 0.6641

step 10: train loss 0.1721 
cause_predict: train acc 0.9549 p 0.9091 r 0.7500 f1 0.8219
position_predict: train acc 0.9688 p 0.8485 r 0.8750 f1 0.8615
step 20: train loss 0.2509 
cause_predict: train acc 0.9438 p 0.8966 r 0.7027 f1 0.7879
position_predict: train acc 0.9719 p 0.8788 r 0.9062 f1 0.8923
step 30: train loss 0.2528 
cause_predict: train acc 0.9272 p 0.8462 r 0.6667 f1 0.7458
position_predict: train acc 0.9709 p 0.9333 r 0.8750 f1 0.9032
step 40: train loss 0.3360 
cause_predict: train acc 0.9348 p 0.8182 r 0.7500 f1 0.7826
position_predict: train acc 0.9522 p 0.8182 r 0.8438 f1 0.8308
step 50: train loss 0.2400 
cause_predict: train acc 0.9528 p 0.9091 r 0.7895 f1 0.8451
position_predict: train acc 0.9614 p 0.9062 r 0.8286 f1 0.8657
step 60: train loss 0.2232 
cause_predict: train acc 0.9543 p 0.9355 r 0.7838 f1 0.8529
position_predict: train acc 0.9680 p 0.9310 r 0.8438 f1 0.8852
step 70: train loss 0.2383 
cause_predict: train acc 0.9234 p 0.7941 r 0.6585 f1 0.7200
position_predict: train acc 0.9635 p 0.8438 r 0.8438 f1 0.8438

epoch 7: test loss 0.5993 cost time: 10.9s

cause_predict: test acc 0.8722 p 0.5576 r 0.4732 f1 0.5119
max_acc 0.8861 max_p 0.6220 max_r 0.4984 max_f1 0.5534

position_predict: test acc 0.9236 p 0.6959 r 0.7178 f1 0.7067
max_acc 0.9267 max_p 0.7173 max_r 0.7073 max_f1 0.7123

Average max cause: max_acc 0.8722 max_p 0.5576 max_r 0.4732 max_f1 0.5119
Average max pos: max_acc 0.9236 max_p 0.6959 max_r 0.7178 max_f1 0.7067

step 10: train loss 0.2048 
cause_predict: train acc 0.9395 p 0.7568 r 0.7778 f1 0.7671
position_predict: train acc 0.9680 p 0.8485 r 0.8750 f1 0.8615
step 20: train loss 0.2248 
cause_predict: train acc 0.9541 p 0.9062 r 0.8056 f1 0.8529
position_predict: train acc 0.9587 p 0.8108 r 0.9375 f1 0.8696
step 30: train loss 0.1810 
cause_predict: train acc 0.9838 p 0.9697 r 0.9412 f1 0.9552
position_predict: train acc 0.9514 p 0.8710 r 0.8438 f1 0.8571
step 40: train loss 0.3302 
cause_predict: train acc 0.9424 p 0.8378 r 0.7949 f1 0.8158
position_predict: train acc 0.9383 p 0.7931 r 0.7188 f1 0.7541
step 50: train loss 0.2558 
cause_predict: train acc 0.9289 p 0.8929 r 0.6757 f1 0.7692
position_predict: train acc 0.9573 p 0.8710 r 0.8438 f1 0.8571
step 60: train loss 0.2090 
cause_predict: train acc 0.9444 p 0.8182 r 0.7500 f1 0.7826
position_predict: train acc 0.9778 p 0.8857 r 0.9394 f1 0.9118
step 70: train loss 0.2211 
cause_predict: train acc 0.9742 p 0.8919 r 0.9429 f1 0.9167
position_predict: train acc 0.9356 p 0.7576 r 0.7812 f1 0.7692

epoch 8: test loss 0.5944 cost time: 11.0s

cause_predict: test acc 0.8811 p 0.5876 r 0.5394 f1 0.5625
max_acc 0.8811 max_p 0.5876 max_r 0.5394 max_f1 0.5625

position_predict: test acc 0.9169 p 0.6656 r 0.7073 f1 0.6858
max_acc 0.9267 max_p 0.7173 max_r 0.7073 max_f1 0.7123

Average max cause: max_acc 0.8811 max_p 0.5876 max_r 0.5394 max_f1 0.5625
Average max pos: max_acc 0.9169 max_p 0.6656 max_r 0.7073 max_f1 0.6858

step 10: train loss 0.1645 
cause_predict: train acc 0.9777 p 0.9143 r 0.9412 f1 0.9275
position_predict: train acc 0.9732 p 0.9062 r 0.9062 f1 0.9062
step 20: train loss 0.1467 
cause_predict: train acc 0.9751 p 0.8947 r 0.9714 f1 0.9315
position_predict: train acc 0.9701 p 0.9333 r 0.8750 f1 0.9032
step 30: train loss 0.1478 
cause_predict: train acc 0.9784 p 0.8780 r 1.0000 f1 0.9351
position_predict: train acc 0.9654 p 0.8750 r 0.8750 f1 0.8750
step 40: train loss 0.2331 
cause_predict: train acc 0.9514 p 0.8333 r 0.8333 f1 0.8333
position_predict: train acc 0.9474 p 0.7778 r 0.8485 f1 0.8116
step 50: train loss 0.2650 
cause_predict: train acc 0.9466 p 0.8293 r 0.8947 f1 0.8608
position_predict: train acc 0.9466 p 0.8387 r 0.8125 f1 0.8254
step 60: train loss 0.2010 
cause_predict: train acc 0.9681 p 0.9062 r 0.8286 f1 0.8657
position_predict: train acc 0.9574 p 0.8387 r 0.7879 f1 0.8125
step 70: train loss 0.2990 
cause_predict: train acc 0.9261 p 0.9394 r 0.7381 f1 0.8267
position_predict: train acc 0.9432 p 0.8438 r 0.8438 f1 0.8438

epoch 9: test loss 0.6285 cost time: 11.1s

cause_predict: test acc 0.8883 p 0.6236 r 0.5331 f1 0.5748
max_acc 0.8883 max_p 0.6236 max_r 0.5331 max_f1 0.5748

position_predict: test acc 0.9187 p 0.6817 r 0.6864 f1 0.6840
max_acc 0.9267 max_p 0.7173 max_r 0.7073 max_f1 0.7123

Average max cause: max_acc 0.8883 max_p 0.6236 max_r 0.5331 max_f1 0.5748
Average max pos: max_acc 0.9187 max_p 0.6817 max_r 0.6864 max_f1 0.6840

step 10: train loss 0.1310 
cause_predict: train acc 0.9690 p 0.8889 r 0.9143 f1 0.9014
position_predict: train acc 0.9735 p 0.8824 r 0.9375 f1 0.9091
step 20: train loss 0.1165 
cause_predict: train acc 0.9813 p 0.9444 r 0.9189 f1 0.9315
position_predict: train acc 0.9739 p 0.9032 r 0.8750 f1 0.8889
step 30: train loss 0.1628 
cause_predict: train acc 0.9720 p 0.8857 r 0.9118 f1 0.8986
position_predict: train acc 0.9640 p 0.8485 r 0.8750 f1 0.8615
step 40: train loss 0.2206 
cause_predict: train acc 0.9595 p 0.8824 r 0.8571 f1 0.8696
position_predict: train acc 0.9595 p 0.8485 r 0.8750 f1 0.8615
step 50: train loss 0.1558 
cause_predict: train acc 0.9430 p 0.7838 r 0.8056 f1 0.7945
position_predict: train acc 0.9772 p 0.8824 r 0.9375 f1 0.9091
step 60: train loss 0.2453 
cause_predict: train acc 0.9585 p 0.8710 r 0.8182 f1 0.8438
position_predict: train acc 0.9502 p 0.8125 r 0.8125 f1 0.8125
step 70: train loss 0.2064 
cause_predict: train acc 0.9638 p 0.8649 r 0.8649 f1 0.8649
position_predict: train acc 0.9638 p 0.8710 r 0.8182 f1 0.8438

epoch 10: test loss 0.6552 cost time: 10.7s

cause_predict: test acc 0.8780 p 0.5791 r 0.5079 f1 0.5412
max_acc 0.8883 max_p 0.6236 max_r 0.5331 max_f1 0.5748

position_predict: test acc 0.9124 p 0.6619 r 0.6481 f1 0.6549
max_acc 0.9267 max_p 0.7173 max_r 0.7073 max_f1 0.7123

Average max cause: max_acc 0.8883 max_p 0.6236 max_r 0.5331 max_f1 0.5748
Average max pos: max_acc 0.9187 max_p 0.6817 max_r 0.6864 max_f1 0.6840

step 10: train loss 0.1517 
cause_predict: train acc 0.9714 p 0.9333 r 0.8485 f1 0.8889
position_predict: train acc 0.9673 p 0.9000 r 0.8438 f1 0.8710
step 20: train loss 0.0992 
cause_predict: train acc 0.9902 p 0.9697 r 0.9697 f1 0.9697
position_predict: train acc 0.9853 p 0.9394 r 0.9688 f1 0.9538
step 30: train loss 0.1040 
cause_predict: train acc 0.9793 p 0.9730 r 0.9000 f1 0.9351
position_predict: train acc 0.9752 p 0.9355 r 0.8788 f1 0.9062
step 40: train loss 0.1297 
cause_predict: train acc 0.9652 p 0.8571 r 0.8333 f1 0.8451
position_predict: train acc 0.9873 p 1.0000 r 0.8788 f1 0.9355
step 50: train loss 0.1974 
cause_predict: train acc 0.9535 p 0.8718 r 0.8718 f1 0.8718
position_predict: train acc 0.9767 p 0.9355 r 0.9062 f1 0.9206
step 60: train loss 0.2214 
cause_predict: train acc 0.9578 p 0.8788 r 0.8286 f1 0.8529
position_predict: train acc 0.9578 p 0.8438 r 0.8438 f1 0.8438
step 70: train loss 0.1650 
cause_predict: train acc 0.9684 p 0.8889 r 0.8889 f1 0.8889
position_predict: train acc 0.9684 p 0.9000 r 0.8438 f1 0.8710

epoch 11: test loss 0.6861 cost time: 10.9s

cause_predict: test acc 0.8919 p 0.6316 r 0.5678 f1 0.5980
max_acc 0.8919 max_p 0.6316 max_r 0.5678 max_f1 0.5980

position_predict: test acc 0.9120 p 0.6585 r 0.6516 f1 0.6550
max_acc 0.9267 max_p 0.7173 max_r 0.7073 max_f1 0.7123

Average max cause: max_acc 0.8883 max_p 0.6236 max_r 0.5331 max_f1 0.5748
Average max pos: max_acc 0.9187 max_p 0.6817 max_r 0.6864 max_f1 0.6840

step 10: train loss 0.1663 
cause_predict: train acc 0.9649 p 0.8667 r 0.7879 f1 0.8254
position_predict: train acc 0.9553 p 0.7879 r 0.7879 f1 0.7879
step 20: train loss 0.1480 
cause_predict: train acc 0.9697 p 0.8824 r 0.8824 f1 0.8824
position_predict: train acc 0.9697 p 0.8529 r 0.9062 f1 0.8788
step 30: train loss 0.1485 
cause_predict: train acc 0.9707 p 0.8947 r 0.9444 f1 0.9189
position_predict: train acc 0.9707 p 0.9355 r 0.8788 f1 0.9062
step 40: train loss 0.0742 
cause_predict: train acc 0.9725 p 0.9268 r 0.9048 f1 0.9157
position_predict: train acc 1.0000 p 1.0000 r 1.0000 f1 1.0000
step 50: train loss 0.1716 
cause_predict: train acc 0.9641 p 0.8857 r 0.8611 f1 0.8732
position_predict: train acc 0.9641 p 0.8485 r 0.8750 f1 0.8615
step 60: train loss 0.1858 
cause_predict: train acc 0.9671 p 0.9118 r 0.8611 f1 0.8857
position_predict: train acc 0.9671 p 0.9286 r 0.8125 f1 0.8667
step 70: train loss 0.2084 
2024-06-22 18:38:47.696400: W tensorflow/c/c_api.cc:304] Operation '{name:'softmax_b_pos/Adam_1/Assign' id:5023 op device:{requested: '', assigned: ''} def:{{{node softmax_b_pos/Adam_1/Assign}} = Assign[T=DT_FLOAT, _class=["loc:@softmax_b_pos"], _has_manual_control_dependencies=true, use_locking=true, validate_shape=true](softmax_b_pos/Adam_1, softmax_b_pos/Adam_1/Initializer/zeros)}}' was changed by setting attribute after it was run by a session. This mutation will have no effect, and will trigger an error in the future. Either don't modify nodes after running them or create a new session.
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
cause_predict: train acc 0.9541 p 0.8824 r 0.8333 f1 0.8571
position_predict: train acc 0.9541 p 0.8667 r 0.8125 f1 0.8387

epoch 12: test loss 0.7154 cost time: 11.0s

cause_predict: test acc 0.8820 p 0.5923 r 0.5363 f1 0.5629
max_acc 0.8919 max_p 0.6316 max_r 0.5678 max_f1 0.5980

position_predict: test acc 0.9173 p 0.6903 r 0.6446 f1 0.6667
max_acc 0.9267 max_p 0.7173 max_r 0.7073 max_f1 0.7123

Average max cause: max_acc 0.8883 max_p 0.6236 max_r 0.5331 max_f1 0.5748
Average max pos: max_acc 0.9187 max_p 0.6817 max_r 0.6864 max_f1 0.6840

step 10: train loss 0.1467 
cause_predict: train acc 0.9828 p 0.9429 r 0.9429 f1 0.9429
position_predict: train acc 0.9442 p 0.8276 r 0.7500 f1 0.7869
step 20: train loss 0.0808 
cause_predict: train acc 0.9858 p 0.9167 r 1.0000 f1 0.9565
position_predict: train acc 0.9906 p 0.9688 r 0.9688 f1 0.9688
step 30: train loss 0.1443 
cause_predict: train acc 0.9593 p 0.8824 r 0.8333 f1 0.8571
position_predict: train acc 0.9797 p 0.9091 r 0.9375 f1 0.9231
step 40: train loss 0.1419 
cause_predict: train acc 0.9695 p 0.8824 r 0.8824 f1 0.8824
position_predict: train acc 0.9733 p 0.8611 r 0.9394 f1 0.8986
step 50: train loss 0.0881 
cause_predict: train acc 0.9959 p 0.9730 r 1.0000 f1 0.9863
position_predict: train acc 0.9836 p 0.9394 r 0.9394 f1 0.9394
step 60: train loss 0.1570 
cause_predict: train acc 0.9656 p 0.9062 r 0.8286 f1 0.8657
position_predict: train acc 0.9695 p 0.9000 r 0.8438 f1 0.8710
step 70: train loss 0.2109 
cause_predict: train acc 0.9638 p 0.8571 r 0.8571 f1 0.8571
position_predict: train acc 0.9493 p 0.7812 r 0.7812 f1 0.7812

epoch 13: test loss 0.7374 cost time: 11.1s

cause_predict: test acc 0.8762 p 0.5690 r 0.5205 f1 0.5437
max_acc 0.8919 max_p 0.6316 max_r 0.5678 max_f1 0.5980

position_predict: test acc 0.9178 p 0.6859 r 0.6620 f1 0.6738
max_acc 0.9267 max_p 0.7173 max_r 0.7073 max_f1 0.7123

Average max cause: max_acc 0.8883 max_p 0.6236 max_r 0.5331 max_f1 0.5748
Average max pos: max_acc 0.9187 max_p 0.6817 max_r 0.6864 max_f1 0.6840

step 10: train loss 0.0790 
cause_predict: train acc 0.9865 p 0.9474 r 0.9730 f1 0.9600
position_predict: train acc 0.9821 p 0.9394 r 0.9394 f1 0.9394
step 20: train loss 0.1200 
cause_predict: train acc 0.9724 p 0.9167 r 0.8684 f1 0.8919
position_predict: train acc 0.9759 p 0.8571 r 0.9375 f1 0.8955
step 30: train loss 0.1156 
cause_predict: train acc 0.9512 p 0.8824 r 0.8333 f1 0.8571
position_predict: train acc 0.9854 p 1.0000 r 0.9062 f1 0.9508
step 40: train loss 0.0665 
cause_predict: train acc 0.9860 p 0.9394 r 0.9688 f1 0.9538
position_predict: train acc 0.9814 p 0.9375 r 0.9375 f1 0.9375
step 50: train loss 0.1955 
cause_predict: train acc 0.9556 p 0.8500 r 0.8718 f1 0.8608
position_predict: train acc 0.9435 p 0.7812 r 0.7812 f1 0.7812
step 60: train loss 0.1741 
cause_predict: train acc 0.9585 p 0.9118 r 0.7949 f1 0.8493
position_predict: train acc 0.9774 p 0.9062 r 0.9062 f1 0.9062
step 70: train loss 0.1364 
cause_predict: train acc 0.9636 p 0.9355 r 0.8056 f1 0.8657
position_predict: train acc 0.9717 p 0.8788 r 0.9062 f1 0.8923

epoch 14: test loss 0.7205 cost time: 11.1s

cause_predict: test acc 0.8856 p 0.6134 r 0.5205 f1 0.5631
max_acc 0.8919 max_p 0.6316 max_r 0.5678 max_f1 0.5980

position_predict: test acc 0.9196 p 0.6904 r 0.6760 f1 0.6831
max_acc 0.9267 max_p 0.7173 max_r 0.7073 max_f1 0.7123

Average max cause: max_acc 0.8883 max_p 0.6236 max_r 0.5331 max_f1 0.5748
Average max pos: max_acc 0.9187 max_p 0.6817 max_r 0.6864 max_f1 0.6840

write pair_data/Ind_BiLSTM_1/fold_3_test.txt done
write pair_data/Ind_BiLSTM_1/fold_3_train.txt done
Optimization Finished!

############# fold 3 end ###############
############# fold 4 begin ###############
load data_file: data_combine_en/fold_4_train.txt
y_position.shape (2275, 75, 2)
y_cause.shape (2275, 75, 2)
x.shape (2275, 75, 30)
sen_len.shape (2275, 75)
doc_len.shape (2275,)
n_cut 107
load data done!

load data_file: data_combine_en/fold_4_test.txt
y_position.shape (284, 75, 2)
y_cause.shape (284, 75, 2)
x.shape (284, 75, 30)
sen_len.shape (284, 75)
doc_len.shape (284,)
n_cut 22
load data done!

train docs: 2275    test docs: 284
step 10: train loss 0.8875 
cause_predict: train acc 0.8303 p 0.0000 r 0.0000 f1 0.0000
position_predict: train acc 0.8532 p 0.0000 r 0.0000 f1 0.0000
step 20: train loss 0.7055 
cause_predict: train acc 0.8764 p 0.0000 r 0.0000 f1 0.0000
position_predict: train acc 0.8801 p 0.0000 r 0.0000 f1 0.0000
step 30: train loss 0.6920 
cause_predict: train acc 0.8523 p 0.0000 r 0.0000 f1 0.0000
position_predict: train acc 0.8650 p 0.0000 r 0.0000 f1 0.0000
step 40: train loss 0.6722 
cause_predict: train acc 0.8240 p 0.0000 r 0.0000 f1 0.0000
position_predict: train acc 0.8927 p 1.0000 r 0.2188 f1 0.3590
step 50: train loss 0.6305 
cause_predict: train acc 0.8490 p 0.0000 r 0.0000 f1 0.0000
position_predict: train acc 0.8694 p 0.5000 r 0.4375 f1 0.4667
step 60: train loss 0.5516 
cause_predict: train acc 0.8648 p 0.0000 r 0.0000 f1 0.0000
position_predict: train acc 0.8852 p 0.5500 r 0.6875 f1 0.6111
step 70: train loss 0.4480 
cause_predict: train acc 0.8929 p 0.0000 r 0.0000 f1 0.0000
position_predict: train acc 0.9286 p 0.8125 r 0.4062 f1 0.5417

epoch 0: test loss 0.5293 cost time: 10.8s

cause_predict: test acc 0.8664 p 1.0000 r 0.0568 f1 0.1075
max_acc 0.8664 max_p 1.0000 max_r 0.0568 max_f1 0.1075

position_predict: test acc 0.9218 p 0.7642 r 0.5645 f1 0.6493
max_acc 0.9218 max_p 0.7642 max_r 0.5645 max_f1 0.6493

Average max cause: max_acc 0.8664 max_p 1.0000 max_r 0.0568 max_f1 0.1075
Average max pos: max_acc 0.9218 max_p 0.7642 max_r 0.5645 max_f1 0.6493

step 10: train loss 0.5096 
cause_predict: train acc 0.8594 p 0.7500 r 0.0789 f1 0.1429
position_predict: train acc 0.9180 p 0.7000 r 0.6364 f1 0.6667
step 20: train loss 0.5125 
cause_predict: train acc 0.8945 p 1.0000 r 0.1562 f1 0.2703
position_predict: train acc 0.8984 p 0.6000 r 0.5625 f1 0.5806
step 30: train loss 0.4691 
cause_predict: train acc 0.8785 p 0.8182 r 0.2727 f1 0.4091
position_predict: train acc 0.9393 p 0.8065 r 0.7812 f1 0.7937
step 40: train loss 0.4101 
cause_predict: train acc 0.9019 p 0.8667 r 0.3514 f1 0.5000
position_predict: train acc 0.9434 p 0.7576 r 0.7812 f1 0.7692
step 50: train loss 0.5640 
cause_predict: train acc 0.8686 p 0.8000 r 0.3750 f1 0.5106
position_predict: train acc 0.9029 p 0.7586 r 0.6875 f1 0.7213
step 60: train loss 0.5405 
cause_predict: train acc 0.8673 p 0.6923 r 0.2727 f1 0.3913
position_predict: train acc 0.8910 p 0.6452 r 0.6250 f1 0.6349
step 70: train loss 0.4546 
cause_predict: train acc 0.8976 p 0.7143 r 0.1515 f1 0.2500
position_predict: train acc 0.9044 p 0.5714 r 0.5000 f1 0.5333

epoch 1: test loss 0.4793 cost time: 11.0s

cause_predict: test acc 0.8843 p 0.6883 r 0.3344 f1 0.4501
max_acc 0.8843 max_p 0.6883 max_r 0.3344 max_f1 0.4501

position_predict: test acc 0.9223 p 0.7148 r 0.6551 f1 0.6836
max_acc 0.9223 max_p 0.7148 max_r 0.6551 max_f1 0.6836

Average max cause: max_acc 0.8843 max_p 0.6883 max_r 0.3344 max_f1 0.4501
Average max pos: max_acc 0.9223 max_p 0.7148 max_r 0.6551 max_f1 0.6836

step 10: train loss 0.5187 
cause_predict: train acc 0.8785 p 0.9375 r 0.3409 f1 0.5000
position_predict: train acc 0.9190 p 0.7241 r 0.6364 f1 0.6774
step 20: train loss 0.4928 
cause_predict: train acc 0.8625 p 0.6667 r 0.2632 f1 0.3774
position_predict: train acc 0.9542 p 0.8387 r 0.8125 f1 0.8254
step 30: train loss 0.4377 
cause_predict: train acc 0.8916 p 0.7222 r 0.3333 f1 0.4561
position_predict: train acc 0.9301 p 0.6765 r 0.7188 f1 0.6970
step 40: train loss 0.5013 
cause_predict: train acc 0.8643 p 0.5455 r 0.1667 f1 0.2553
position_predict: train acc 0.9457 p 0.8462 r 0.6875 f1 0.7586
step 50: train loss 0.4873 
cause_predict: train acc 0.8429 p 0.5714 r 0.3333 f1 0.4211
position_predict: train acc 0.9429 p 0.9167 r 0.6875 f1 0.7857
step 60: train loss 0.4429 
cause_predict: train acc 0.8877 p 0.6842 r 0.3421 f1 0.4561
position_predict: train acc 0.9239 p 0.6897 r 0.6250 f1 0.6557
step 70: train loss 0.4775 
cause_predict: train acc 0.8945 p 0.6875 r 0.3333 f1 0.4490
position_predict: train acc 0.9180 p 0.7037 r 0.5938 f1 0.6441

epoch 2: test loss 0.4812 cost time: 10.8s

cause_predict: test acc 0.8861 p 0.7123 r 0.3281 f1 0.4492
max_acc 0.8843 max_p 0.6883 max_r 0.3344 max_f1 0.4501

position_predict: test acc 0.9200 p 0.7109 r 0.6341 f1 0.6703
max_acc 0.9223 max_p 0.7148 max_r 0.6551 max_f1 0.6836

Average max cause: max_acc 0.8843 max_p 0.6883 max_r 0.3344 max_f1 0.4501
Average max pos: max_acc 0.9223 max_p 0.7148 max_r 0.6551 max_f1 0.6836

step 10: train loss 0.3850 
cause_predict: train acc 0.9111 p 0.7083 r 0.5000 f1 0.5862
position_predict: train acc 0.9407 p 0.7857 r 0.6875 f1 0.7333
step 20: train loss 0.3223 
cause_predict: train acc 0.9127 p 0.7222 r 0.4062 f1 0.5200
position_predict: train acc 0.9455 p 0.7931 r 0.7188 f1 0.7541
step 30: train loss 0.3708 
cause_predict: train acc 0.8791 p 0.5556 r 0.2857 f1 0.3774
position_predict: train acc 0.9451 p 0.7931 r 0.7188 f1 0.7541
step 40: train loss 0.3829 
cause_predict: train acc 0.8885 p 0.6111 r 0.3143 f1 0.4151
position_predict: train acc 0.9568 p 0.8571 r 0.7500 f1 0.8000
step 50: train loss 0.4998 
cause_predict: train acc 0.8707 p 0.6667 r 0.4211 f1 0.5161
position_predict: train acc 0.9224 p 0.7333 r 0.6875 f1 0.7097
step 60: train loss 0.4411 
cause_predict: train acc 0.8960 p 0.9167 r 0.3056 f1 0.4583
position_predict: train acc 0.9200 p 0.7241 r 0.6364 f1 0.6774
step 70: train loss 0.4341 
cause_predict: train acc 0.8893 p 0.7917 r 0.4318 f1 0.5588
position_predict: train acc 0.9483 p 0.8000 r 0.7500 f1 0.7742

epoch 3: test loss 0.4644 cost time: 10.7s

cause_predict: test acc 0.8798 p 0.5968 r 0.4669 f1 0.5239
max_acc 0.8798 max_p 0.5968 max_r 0.4669 max_f1 0.5239

position_predict: test acc 0.9272 p 0.7422 r 0.6620 f1 0.6998
max_acc 0.9272 max_p 0.7422 max_r 0.6620 max_f1 0.6998

Average max cause: max_acc 0.8798 max_p 0.5968 max_r 0.4669 max_f1 0.5239
Average max pos: max_acc 0.9272 max_p 0.7422 max_r 0.6620 max_f1 0.6998

step 10: train loss 0.3920 
cause_predict: train acc 0.8852 p 0.6538 r 0.4722 f1 0.5484
position_predict: train acc 0.9467 p 0.8333 r 0.7576 f1 0.7937
step 20: train loss 0.4214 
cause_predict: train acc 0.8867 p 0.6842 r 0.3611 f1 0.4727
position_predict: train acc 0.9258 p 0.7600 r 0.5938 f1 0.6667
step 30: train loss 0.4203 
cause_predict: train acc 0.8962 p 0.6500 r 0.3939 f1 0.4906
position_predict: train acc 0.9423 p 0.7931 r 0.7188 f1 0.7541
step 40: train loss 0.2914 
cause_predict: train acc 0.9261 p 0.8947 r 0.5000 f1 0.6415
position_predict: train acc 0.9611 p 0.8438 r 0.8438 f1 0.8438
step 50: train loss 0.4421 
cause_predict: train acc 0.8879 p 0.8750 r 0.3889 f1 0.5385
position_predict: train acc 0.9393 p 0.8125 r 0.7879 f1 0.8000
step 60: train loss 0.3618 
cause_predict: train acc 0.9109 p 0.7667 r 0.6765 f1 0.7188
position_predict: train acc 0.9653 p 0.9310 r 0.8438 f1 0.8852
step 70: train loss 0.4124 
cause_predict: train acc 0.9057 p 0.7857 r 0.5641 f1 0.6567
position_predict: train acc 0.9467 p 0.7714 r 0.8438 f1 0.8060

epoch 4: test loss 0.4796 cost time: 10.6s

cause_predict: test acc 0.8870 p 0.6509 r 0.4353 f1 0.5217
max_acc 0.8798 max_p 0.5968 max_r 0.4669 max_f1 0.5239

position_predict: test acc 0.9240 p 0.6918 r 0.7352 f1 0.7128
max_acc 0.9240 max_p 0.6918 max_r 0.7352 max_f1 0.7128

Average max cause: max_acc 0.8870 max_p 0.6509 max_r 0.4353 max_f1 0.5217
Average max pos: max_acc 0.9240 max_p 0.6918 max_r 0.7352 max_f1 0.7128

step 10: train loss 0.3553 
cause_predict: train acc 0.9361 p 0.8889 r 0.6857 f1 0.7742
position_predict: train acc 0.9406 p 0.8276 r 0.7500 f1 0.7869
step 20: train loss 0.3245 
cause_predict: train acc 0.9195 p 0.7333 r 0.6286 f1 0.6769
position_predict: train acc 0.9617 p 0.8966 r 0.7879 f1 0.8387
step 30: train loss 0.2762 
cause_predict: train acc 0.9309 p 0.8261 r 0.5938 f1 0.6909
position_predict: train acc 0.9756 p 0.8824 r 0.9375 f1 0.9091
step 40: train loss 0.3389 
cause_predict: train acc 0.9182 p 0.8000 r 0.6061 f1 0.6897
position_predict: train acc 0.9500 p 0.8387 r 0.8125 f1 0.8254
step 50: train loss 0.2996 
cause_predict: train acc 0.9241 p 0.7812 r 0.6944 f1 0.7353
position_predict: train acc 0.9578 p 0.8438 r 0.8438 f1 0.8438
step 60: train loss 0.3008 
cause_predict: train acc 0.9331 p 0.7931 r 0.6216 f1 0.6970
position_predict: train acc 0.9398 p 0.7059 r 0.7500 f1 0.7273
step 70: train loss 0.4120 
cause_predict: train acc 0.8710 p 0.6538 r 0.4722 f1 0.5484
position_predict: train acc 0.9171 p 0.7333 r 0.6875 f1 0.7097

epoch 5: test loss 0.4699 cost time: 10.5s

cause_predict: test acc 0.8937 p 0.7257 r 0.4006 f1 0.5163
max_acc 0.8798 max_p 0.5968 max_r 0.4669 max_f1 0.5239

position_predict: test acc 0.9272 p 0.7279 r 0.6899 f1 0.7084
max_acc 0.9240 max_p 0.6918 max_r 0.7352 max_f1 0.7128

Average max cause: max_acc 0.8870 max_p 0.6509 max_r 0.4353 max_f1 0.5217
Average max pos: max_acc 0.9240 max_p 0.6918 max_r 0.7352 max_f1 0.7128

step 10: train loss 0.2536 
cause_predict: train acc 0.9346 p 0.8148 r 0.5789 f1 0.6769
position_predict: train acc 0.9626 p 0.8571 r 0.7500 f1 0.8000
step 20: train loss 0.3179 
cause_predict: train acc 0.9023 p 0.6471 r 0.6286 f1 0.6377
position_predict: train acc 0.9570 p 0.8182 r 0.8438 f1 0.8308
step 30: train loss 0.4560 
cause_predict: train acc 0.8889 p 0.6667 r 0.5714 f1 0.6154
position_predict: train acc 0.9370 p 0.7419 r 0.7188 f1 0.7302
step 40: train loss 0.3655 
cause_predict: train acc 0.9072 p 0.7931 r 0.6571 f1 0.7188
position_predict: train acc 0.9381 p 0.8387 r 0.7879 f1 0.8125
step 50: train loss 0.2144 
cause_predict: train acc 0.9565 p 0.9310 r 0.7714 f1 0.8438
position_predict: train acc 0.9696 p 0.8788 r 0.9062 f1 0.8923
step 60: train loss 0.3396 
cause_predict: train acc 0.9174 p 0.8519 r 0.5897 f1 0.6970
position_predict: train acc 0.9545 p 0.9200 r 0.7188 f1 0.8070
step 70: train loss 0.3126 
cause_predict: train acc 0.9341 p 0.7931 r 0.6765 f1 0.7302
position_predict: train acc 0.9419 p 0.7812 r 0.7576 f1 0.7692

epoch 6: test loss 0.5175 cost time: 10.9s

cause_predict: test acc 0.8749 p 0.5623 r 0.5268 f1 0.5440
max_acc 0.8749 max_p 0.5623 max_r 0.5268 max_f1 0.5440

position_predict: test acc 0.9267 p 0.7173 r 0.7073 f1 0.7123
max_acc 0.9240 max_p 0.6918 max_r 0.7352 max_f1 0.7128

Average max cause: max_acc 0.8749 max_p 0.5623 max_r 0.5268 max_f1 0.5440
Average max pos: max_acc 0.9267 max_p 0.7173 max_r 0.7073 max_f1 0.7123

step 10: train loss 0.2991 
cause_predict: train acc 0.9004 p 0.7353 r 0.6098 f1 0.6667
position_predict: train acc 0.9721 p 0.9032 r 0.8750 f1 0.8889
step 20: train loss 0.1951 
cause_predict: train acc 0.9500 p 0.9333 r 0.7368 f1 0.8235
position_predict: train acc 0.9792 p 0.9091 r 0.9375 f1 0.9231
step 30: train loss 0.2546 
cause_predict: train acc 0.9541 p 0.9615 r 0.7353 f1 0.8333
position_predict: train acc 0.9725 p 0.9062 r 0.9062 f1 0.9062
step 40: train loss 0.4102 
cause_predict: train acc 0.9130 p 0.7586 r 0.6667 f1 0.7097
position_predict: train acc 0.9565 p 0.8966 r 0.8125 f1 0.8525
step 50: train loss 0.3506 
cause_predict: train acc 0.9289 p 0.8108 r 0.8108 f1 0.8108
position_predict: train acc 0.9239 p 0.8750 r 0.6364 f1 0.7368
step 60: train loss 0.2604 
cause_predict: train acc 0.9644 p 0.8333 r 0.9091 f1 0.8696
position_predict: train acc 0.9447 p 0.7879 r 0.7879 f1 0.7879
step 70: train loss 0.2816 
cause_predict: train acc 0.9224 p 0.7429 r 0.7647 f1 0.7536
position_predict: train acc 0.9635 p 0.8571 r 0.9091 f1 0.8824

epoch 7: test loss 0.5327 cost time: 10.9s

cause_predict: test acc 0.8829 p 0.6141 r 0.4669 f1 0.5305
max_acc 0.8749 max_p 0.5623 max_r 0.5268 max_f1 0.5440

position_predict: test acc 0.9164 p 0.6645 r 0.7038 f1 0.6836
max_acc 0.9240 max_p 0.6918 max_r 0.7352 max_f1 0.7128

Average max cause: max_acc 0.8749 max_p 0.5623 max_r 0.5268 max_f1 0.5440
Average max pos: max_acc 0.9267 max_p 0.7173 max_r 0.7073 max_f1 0.7123

step 10: train loss 0.1854 
cause_predict: train acc 0.9444 p 0.7714 r 0.7941 f1 0.7826
position_predict: train acc 0.9630 p 0.8929 r 0.7812 f1 0.8333
step 20: train loss 0.2146 
cause_predict: train acc 0.9570 p 0.8684 r 0.8250 f1 0.8462
position_predict: train acc 0.9534 p 0.7778 r 0.8485 f1 0.8116
step 30: train loss 0.2351 
cause_predict: train acc 0.9415 p 0.8710 r 0.7714 f1 0.8182
position_predict: train acc 0.9659 p 0.8788 r 0.9062 f1 0.8923
step 40: train loss 0.1844 
cause_predict: train acc 0.9625 p 0.8438 r 0.8182 f1 0.8308
position_predict: train acc 0.9625 p 0.8182 r 0.8438 f1 0.8308
step 50: train loss 0.1939 
cause_predict: train acc 0.9653 p 0.8750 r 0.8750 f1 0.8750
position_predict: train acc 0.9757 p 0.8788 r 0.9062 f1 0.8923
step 60: train loss 0.2793 
cause_predict: train acc 0.9307 p 0.7333 r 0.8919 f1 0.8049
position_predict: train acc 0.9481 p 0.8182 r 0.8182 f1 0.8182
step 70: train loss 0.2240 
cause_predict: train acc 0.9444 p 0.8333 r 0.7353 f1 0.7812
position_predict: train acc 0.9762 p 0.9062 r 0.9062 f1 0.9062

epoch 8: test loss 0.5840 cost time: 10.9s

cause_predict: test acc 0.8803 p 0.5778 r 0.5741 f1 0.5759
max_acc 0.8803 max_p 0.5778 max_r 0.5741 max_f1 0.5759

position_predict: test acc 0.9209 p 0.6950 r 0.6829 f1 0.6889
max_acc 0.9240 max_p 0.6918 max_r 0.7352 max_f1 0.7128

Average max cause: max_acc 0.8803 max_p 0.5778 max_r 0.5741 max_f1 0.5759
Average max pos: max_acc 0.9209 max_p 0.6950 max_r 0.6829 max_f1 0.6889

step 10: train loss 0.1873 
cause_predict: train acc 0.9565 p 0.9062 r 0.8056 f1 0.8529
position_predict: train acc 0.9783 p 0.9355 r 0.9062 f1 0.9206
step 20: train loss 0.1666 
cause_predict: train acc 0.9482 p 0.9355 r 0.7250 f1 0.8169
position_predict: train acc 0.9920 p 0.9688 r 0.9688 f1 0.9688
step 30: train loss 0.2132 
cause_predict: train acc 0.9719 p 0.9375 r 0.9091 f1 0.9231
position_predict: train acc 0.9551 p 0.9000 r 0.8438 f1 0.8710
step 40: train loss 0.1879 
cause_predict: train acc 0.9509 p 0.7941 r 0.7500 f1 0.7714
position_predict: train acc 0.9693 p 0.8667 r 0.8125 f1 0.8387
step 50: train loss 0.1762 
cause_predict: train acc 0.9644 p 0.9091 r 0.8108 f1 0.8571
position_predict: train acc 0.9786 p 0.9655 r 0.8485 f1 0.9032
step 60: train loss 0.2320 
cause_predict: train acc 0.9585 p 0.8718 r 0.8500 f1 0.8608
position_predict: train acc 0.9585 p 0.8182 r 0.8438 f1 0.8308
step 70: train loss 0.2078 
cause_predict: train acc 0.9644 p 0.8824 r 0.8571 f1 0.8696
position_predict: train acc 0.9802 p 0.9355 r 0.9062 f1 0.9206

epoch 9: test loss 0.6002 cost time: 10.7s

cause_predict: test acc 0.8852 p 0.6128 r 0.5142 f1 0.5592
max_acc 0.8803 max_p 0.5778 max_r 0.5741 max_f1 0.5759

position_predict: test acc 0.9200 p 0.7045 r 0.6481 f1 0.6751
max_acc 0.9240 max_p 0.6918 max_r 0.7352 max_f1 0.7128

Average max cause: max_acc 0.8803 max_p 0.5778 max_r 0.5741 max_f1 0.5759
Average max pos: max_acc 0.9209 max_p 0.6950 max_r 0.6829 max_f1 0.6889

step 10: train loss 0.1675 
cause_predict: train acc 0.9588 p 0.9062 r 0.8056 f1 0.8529
position_predict: train acc 0.9794 p 0.9355 r 0.9062 f1 0.9206
step 20: train loss 0.2006 
cause_predict: train acc 0.9879 p 0.9730 r 0.9474 f1 0.9600
position_predict: train acc 0.9555 p 0.8182 r 0.8438 f1 0.8308
step 30: train loss 0.1434 
cause_predict: train acc 0.9438 p 0.8889 r 0.8421 f1 0.8649
position_predict: train acc 0.9888 p 1.0000 r 0.9375 f1 0.9677
step 40: train loss 0.2280 
cause_predict: train acc 0.9618 p 0.9000 r 0.7714 f1 0.8308
position_predict: train acc 0.9514 p 0.7812 r 0.7812 f1 0.7812
step 50: train loss 0.1643 
cause_predict: train acc 0.9628 p 0.9444 r 0.8718 f1 0.9067
position_predict: train acc 0.9734 p 0.9091 r 0.9375 f1 0.9231
step 60: train loss 0.2067 
cause_predict: train acc 0.9537 p 0.8333 r 0.8333 f1 0.8333
position_predict: train acc 0.9768 p 0.9333 r 0.8750 f1 0.9032
step 70: train loss 0.2166 
cause_predict: train acc 0.9461 p 0.8966 r 0.7647 f1 0.8254
position_predict: train acc 0.9755 p 0.9655 r 0.8750 f1 0.9180

epoch 10: test loss 0.6452 cost time: 10.8s

cause_predict: test acc 0.8865 p 0.6226 r 0.5047 f1 0.5575
max_acc 0.8803 max_p 0.5778 max_r 0.5741 max_f1 0.5759

position_predict: test acc 0.9182 p 0.6793 r 0.6864 f1 0.6828
max_acc 0.9240 max_p 0.6918 max_r 0.7352 max_f1 0.7128

Average max cause: max_acc 0.8803 max_p 0.5778 max_r 0.5741 max_f1 0.5759
Average max pos: max_acc 0.9209 max_p 0.6950 max_r 0.6829 max_f1 0.6889

step 10: train loss 0.1268 
cause_predict: train acc 0.9685 p 0.9118 r 0.8611 f1 0.8857
position_predict: train acc 0.9882 p 0.9677 r 0.9375 f1 0.9524
step 20: train loss 0.1766 
cause_predict: train acc 0.9474 p 0.8205 r 0.8649 f1 0.8421
position_predict: train acc 0.9825 p 0.9118 r 0.9688 f1 0.9394
step 30: train loss 0.1368 
cause_predict: train acc 0.9700 p 0.9211 r 0.9211 f1 0.9211
position_predict: train acc 0.9800 p 0.9394 r 0.9394 f1 0.9394
step 40: train loss 0.1616 
cause_predict: train acc 0.9556 p 0.8182 r 0.8182 f1 0.8182
position_predict: train acc 0.9778 p 0.9062 r 0.9062 f1 0.9062
step 50: train loss 0.0767 
cause_predict: train acc 0.9922 p 0.9737 r 0.9737 f1 0.9737
position_predict: train acc 0.9804 p 0.9091 r 0.9375 f1 0.9231
step 60: train loss 0.1891 
cause_predict: train acc 0.9570 p 0.8529 r 0.8286 f1 0.8406
position_predict: train acc 0.9688 p 0.8529 r 0.9062 f1 0.8788
step 70: train loss 0.1832 
cause_predict: train acc 0.9598 p 0.9118 r 0.8158 f1 0.8611
position_predict: train acc 0.9799 p 0.9355 r 0.9062 f1 0.9206

epoch 11: test loss 0.6473 cost time: 11.0s

cause_predict: test acc 0.8843 p 0.6098 r 0.5079 f1 0.5542
max_acc 0.8803 max_p 0.5778 max_r 0.5741 max_f1 0.5759

position_predict: test acc 0.9258 p 0.7373 r 0.6551 f1 0.6937
max_acc 0.9240 max_p 0.6918 max_r 0.7352 max_f1 0.7128

Average max cause: max_acc 0.8803 max_p 0.5778 max_r 0.5741 max_f1 0.5759
Average max pos: max_acc 0.9209 max_p 0.6950 max_r 0.6829 max_f1 0.6889

step 10: train loss 0.1033 
cause_predict: train acc 0.9807 p 0.9667 r 0.9062 f1 0.9355
position_predict: train acc 0.9758 p 0.9355 r 0.9062 f1 0.9206
step 20: train loss 0.1192 
cause_predict: train acc 0.9728 p 0.9189 r 0.8947 f1 0.9067
position_predict: train acc 0.9728 p 0.8788 r 0.9062 f1 0.8923
step 30: train loss 0.1230 
cause_predict: train acc 0.9707 p 0.8780 r 0.9474 f1 0.9114
position_predict: train acc 0.9791 p 0.9091 r 0.9375 f1 0.9231
step 40: train loss 0.0806 
cause_predict: train acc 0.9818 p 0.9091 r 0.9091 f1 0.9091
position_predict: train acc 0.9848 p 0.9355 r 0.9062 f1 0.9206
step 50: train loss 0.1716 
cause_predict: train acc 0.9620 p 0.8788 r 0.8529 f1 0.8657
position_predict: train acc 0.9578 p 0.8235 r 0.8750 f1 0.8485
step 60: train loss 0.1877 
cause_predict: train acc 0.9552 p 0.9062 r 0.8056 f1 0.8529
position_predict: train acc 0.9731 p 0.8889 r 0.9412 f1 0.9143
step 70: train loss 0.2604 
cause_predict: train acc 0.9485 p 0.8750 r 0.7778 f1 0.8235
position_predict: train acc 0.9528 p 0.8387 r 0.8125 f1 0.8254

epoch 12: test loss 0.7202 cost time: 11.0s

cause_predict: test acc 0.8713 p 0.5498 r 0.5047 f1 0.5263
max_acc 0.8803 max_p 0.5778 max_r 0.5741 max_f1 0.5759

position_predict: test acc 0.9200 p 0.7093 r 0.6376 f1 0.6716
max_acc 0.9240 max_p 0.6918 max_r 0.7352 max_f1 0.7128

Average max cause: max_acc 0.8803 max_p 0.5778 max_r 0.5741 max_f1 0.5759
Average max pos: max_acc 0.9209 max_p 0.6950 max_r 0.6829 max_f1 0.6889

step 10: train loss 0.1135 
cause_predict: train acc 0.9668 p 0.9118 r 0.8378 f1 0.8732
position_predict: train acc 0.9779 p 0.8611 r 0.9688 f1 0.9118
step 20: train loss 0.1632 
cause_predict: train acc 0.9679 p 0.9143 r 0.8649 f1 0.8889
position_predict: train acc 0.9839 p 0.9375 r 0.9375 f1 0.9375
step 30: train loss 0.1098 
cause_predict: train acc 0.9767 p 0.9730 r 0.8780 f1 0.9231
position_predict: train acc 0.9767 p 0.9355 r 0.8788 f1 0.9062
step 40: train loss 0.1366 
cause_predict: train acc 0.9664 p 0.8684 r 0.9167 f1 0.8919
position_predict: train acc 0.9790 p 0.9412 r 0.9143 f1 0.9275
step 50: train loss 0.1433 
cause_predict: train acc 0.9729 p 0.8788 r 0.8529 f1 0.8657
position_predict: train acc 0.9669 p 0.8182 r 0.8438 f1 0.8308
step 60: train loss 0.1617 
cause_predict: train acc 0.9690 p 0.8857 r 0.8611 f1 0.8732
position_predict: train acc 0.9586 p 0.8387 r 0.7879 f1 0.8125
step 70: train loss 0.1608 
cause_predict: train acc 0.9733 p 0.9697 r 0.8649 f1 0.9143
position_predict: train acc 0.9600 p 0.8750 r 0.8485 f1 0.8615

epoch 13: test loss 0.6793 cost time: 11.1s

2024-06-22 18:41:41.257754: W tensorflow/c/c_api.cc:304] Operation '{name:'softmax_b_pos/Adam_1/Assign' id:5023 op device:{requested: '', assigned: ''} def:{{{node softmax_b_pos/Adam_1/Assign}} = Assign[T=DT_FLOAT, _class=["loc:@softmax_b_pos"], _has_manual_control_dependencies=true, use_locking=true, validate_shape=true](softmax_b_pos/Adam_1, softmax_b_pos/Adam_1/Initializer/zeros)}}' was changed by setting attribute after it was run by a session. This mutation will have no effect, and will trigger an error in the future. Either don't modify nodes after running them or create a new session.
cause_predict: test acc 0.8803 p 0.5860 r 0.5268 f1 0.5548
max_acc 0.8803 max_p 0.5778 max_r 0.5741 max_f1 0.5759

position_predict: test acc 0.9187 p 0.6842 r 0.6794 f1 0.6818
max_acc 0.9240 max_p 0.6918 max_r 0.7352 max_f1 0.7128

Average max cause: max_acc 0.8803 max_p 0.5778 max_r 0.5741 max_f1 0.5759
Average max pos: max_acc 0.9209 max_p 0.6950 max_r 0.6829 max_f1 0.6889

step 10: train loss 0.1119 
cause_predict: train acc 0.9828 p 0.9444 r 0.9444 f1 0.9444
position_predict: train acc 0.9828 p 0.9667 r 0.9062 f1 0.9355
step 20: train loss 0.1842 
cause_predict: train acc 0.9680 p 0.8919 r 0.8919 f1 0.8919
position_predict: train acc 0.9640 p 0.8378 r 0.9118 f1 0.8732
step 30: train loss 0.0990 
cause_predict: train acc 0.9870 p 0.8974 r 0.9722 f1 0.9333
position_predict: train acc 0.9792 p 0.8788 r 0.8788 f1 0.8788
step 40: train loss 0.1234 
cause_predict: train acc 0.9810 p 1.0000 r 0.8889 f1 0.9412
position_predict: train acc 0.9762 p 0.9355 r 0.9062 f1 0.9206
step 50: train loss 0.1352 
cause_predict: train acc 0.9769 p 0.9189 r 0.9444 f1 0.9315
position_predict: train acc 0.9769 p 0.9091 r 0.9375 f1 0.9231
step 60: train loss 0.1078 
cause_predict: train acc 0.9877 p 0.9429 r 0.9706 f1 0.9565
position_predict: train acc 0.9794 p 0.9355 r 0.9062 f1 0.9206
step 70: train loss 0.1693 
cause_predict: train acc 0.9440 p 0.8438 r 0.7714 f1 0.8060
position_predict: train acc 0.9655 p 0.8750 r 0.8750 f1 0.8750

epoch 14: test loss 0.7515 cost time: 10.9s

cause_predict: test acc 0.8794 p 0.5813 r 0.5300 f1 0.5545
max_acc 0.8803 max_p 0.5778 max_r 0.5741 max_f1 0.5759

position_predict: test acc 0.9191 p 0.6920 r 0.6655 f1 0.6785
max_acc 0.9240 max_p 0.6918 max_r 0.7352 max_f1 0.7128

Average max cause: max_acc 0.8803 max_p 0.5778 max_r 0.5741 max_f1 0.5759
Average max pos: max_acc 0.9209 max_p 0.6950 max_r 0.6829 max_f1 0.6889

write pair_data/Ind_BiLSTM_1/fold_4_test.txt done
write pair_data/Ind_BiLSTM_1/fold_4_train.txt done
Optimization Finished!

############# fold 4 end ###############
############# fold 5 begin ###############
load data_file: data_combine_en/fold_5_train.txt
y_position.shape (2275, 75, 2)
y_cause.shape (2275, 75, 2)
x.shape (2275, 75, 30)
sen_len.shape (2275, 75)
doc_len.shape (2275,)
n_cut 107
load data done!

load data_file: data_combine_en/fold_5_test.txt
y_position.shape (284, 75, 2)
y_cause.shape (284, 75, 2)
x.shape (284, 75, 30)
sen_len.shape (284, 75)
doc_len.shape (284,)
n_cut 22
load data done!

train docs: 2275    test docs: 284
step 10: train loss 0.7540 
cause_predict: train acc 0.8735 p 0.0000 r 0.0000 f1 0.0000
position_predict: train acc 0.8735 p 0.0000 r 0.0000 f1 0.0000
step 20: train loss 0.7931 
cause_predict: train acc 0.8515 p 0.0000 r 0.0000 f1 0.0000
position_predict: train acc 0.8559 p 0.0000 r 0.0000 f1 0.0000
step 30: train loss 0.7975 
cause_predict: train acc 0.8214 p 0.0000 r 0.0000 f1 0.0000
position_predict: train acc 0.8316 p 0.0000 r 0.0000 f1 0.0000
step 40: train loss 0.6165 
cause_predict: train acc 0.8468 p 0.0000 r 0.0000 f1 0.0000
position_predict: train acc 0.8790 p 1.0000 r 0.0909 f1 0.1667
step 50: train loss 0.6452 
cause_predict: train acc 0.8390 p 0.0000 r 0.0000 f1 0.0000
position_predict: train acc 0.8585 p 0.5625 r 0.5455 f1 0.5538
step 60: train loss 0.4763 
cause_predict: train acc 0.9069 p 0.7500 r 0.1714 f1 0.2791
position_predict: train acc 0.9099 p 0.5263 r 0.6250 f1 0.5714
step 70: train loss 0.6278 
cause_predict: train acc 0.8734 p 1.0000 r 0.1429 f1 0.2500
position_predict: train acc 0.8650 p 0.5000 r 0.4688 f1 0.4839

epoch 0: test loss 0.5169 cost time: 10.9s

cause_predict: test acc 0.8794 p 0.7640 r 0.2145 f1 0.3350
max_acc 0.8794 max_p 0.7640 max_r 0.2145 max_f1 0.3350

position_predict: test acc 0.9182 p 0.7524 r 0.5401 f1 0.6288
max_acc 0.9182 max_p 0.7524 max_r 0.5401 max_f1 0.6288

Average max cause: max_acc 0.8794 max_p 0.7640 max_r 0.2145 max_f1 0.3350
Average max pos: max_acc 0.9182 max_p 0.7524 max_r 0.5401 max_f1 0.6288

step 10: train loss 0.4702 
cause_predict: train acc 0.8913 p 0.7200 r 0.5000 f1 0.5902
position_predict: train acc 0.9261 p 0.8571 r 0.5625 f1 0.6792
step 20: train loss 0.4640 
cause_predict: train acc 0.8964 p 1.0000 r 0.1714 f1 0.2927
position_predict: train acc 0.9429 p 0.7857 r 0.6875 f1 0.7333
step 30: train loss 0.5108 
cause_predict: train acc 0.8796 p 0.8333 r 0.2941 f1 0.4348
position_predict: train acc 0.9167 p 0.7333 r 0.6875 f1 0.7097
step 40: train loss 0.6438 
cause_predict: train acc 0.8616 p 0.5385 r 0.1707 f1 0.2593
position_predict: train acc 0.8997 p 0.5862 r 0.5000 f1 0.5397
step 50: train loss 0.5284 
cause_predict: train acc 0.8645 p 0.4667 r 0.2121 f1 0.2917
position_predict: train acc 0.9124 p 0.7200 r 0.5455 f1 0.6207
step 60: train loss 0.5899 
cause_predict: train acc 0.8547 p 0.6538 r 0.5000 f1 0.5667
position_predict: train acc 0.9162 p 0.8148 r 0.6875 f1 0.7458
step 70: train loss 0.5995 
cause_predict: train acc 0.8302 p 0.5000 r 0.1667 f1 0.2500
position_predict: train acc 0.9245 p 0.8148 r 0.6667 f1 0.7333

epoch 1: test loss 0.4652 cost time: 10.8s

cause_predict: test acc 0.8883 p 0.7445 r 0.3218 f1 0.4493
max_acc 0.8883 max_p 0.7445 max_r 0.3218 max_f1 0.4493

position_predict: test acc 0.9223 p 0.7287 r 0.6272 f1 0.6742
max_acc 0.9223 max_p 0.7287 max_r 0.6272 max_f1 0.6742

Average max cause: max_acc 0.8883 max_p 0.7445 max_r 0.3218 max_f1 0.4493
Average max pos: max_acc 0.9223 max_p 0.7287 max_r 0.6272 max_f1 0.6742

step 10: train loss 0.3617 
cause_predict: train acc 0.9160 p 0.7826 r 0.5294 f1 0.6316
position_predict: train acc 0.9320 p 0.7419 r 0.7188 f1 0.7302
step 20: train loss 0.5708 
cause_predict: train acc 0.8635 p 0.5000 r 0.2353 f1 0.3200
position_predict: train acc 0.9116 p 0.6923 r 0.5625 f1 0.6207
step 30: train loss 0.3993 
cause_predict: train acc 0.9108 p 0.9231 r 0.3077 f1 0.4615
position_predict: train acc 0.9554 p 0.8000 r 0.7500 f1 0.7742
step 40: train loss 0.5059 
cause_predict: train acc 0.8708 p 0.6250 r 0.2857 f1 0.3922
position_predict: train acc 0.9208 p 0.7188 r 0.6970 f1 0.7077
step 50: train loss 0.5050 
cause_predict: train acc 0.8646 p 0.7778 r 0.3889 f1 0.5185
position_predict: train acc 0.9323 p 0.8276 r 0.7500 f1 0.7869
step 60: train loss 0.3853 
cause_predict: train acc 0.9038 p 0.6250 r 0.2941 f1 0.4000
position_predict: train acc 0.9263 p 0.7895 r 0.4412 f1 0.5660
step 70: train loss 0.4502 
cause_predict: train acc 0.8970 p 0.6000 r 0.3429 f1 0.4364
position_predict: train acc 0.9535 p 0.8571 r 0.7059 f1 0.7742

epoch 2: test loss 0.4606 cost time: 10.8s

cause_predict: test acc 0.8910 p 0.7110 r 0.3880 f1 0.5020
max_acc 0.8910 max_p 0.7110 max_r 0.3880 max_f1 0.5020

position_predict: test acc 0.9303 p 0.7569 r 0.6725 f1 0.7122
max_acc 0.9303 max_p 0.7569 max_r 0.6725 max_f1 0.7122

Average max cause: max_acc 0.8910 max_p 0.7110 max_r 0.3880 max_f1 0.5020
Average max pos: max_acc 0.9303 max_p 0.7569 max_r 0.6725 max_f1 0.7122

step 10: train loss 0.4515 
cause_predict: train acc 0.8738 p 0.7391 r 0.4595 f1 0.5667
position_predict: train acc 0.9175 p 0.7778 r 0.6562 f1 0.7119
step 20: train loss 0.5947 
cause_predict: train acc 0.8490 p 0.6875 r 0.3143 f1 0.4314
position_predict: train acc 0.8906 p 0.7037 r 0.5938 f1 0.6441
step 30: train loss 0.5448 
cause_predict: train acc 0.8894 p 0.8824 r 0.4054 f1 0.5556
position_predict: train acc 0.8894 p 0.6250 r 0.6250 f1 0.6250
step 40: train loss 0.3087 
cause_predict: train acc 0.9237 p 0.9000 r 0.5143 f1 0.6545
position_predict: train acc 0.9518 p 0.8846 r 0.7188 f1 0.7931
step 50: train loss 0.3943 
cause_predict: train acc 0.8768 p 0.7143 r 0.4412 f1 0.5455
position_predict: train acc 0.9409 p 0.8571 r 0.7500 f1 0.8000
step 60: train loss 0.5034 
cause_predict: train acc 0.8838 p 0.6087 r 0.4242 f1 0.5000
position_predict: train acc 0.9212 p 0.7097 r 0.6875 f1 0.6984
step 70: train loss 0.5190 
cause_predict: train acc 0.8655 p 0.7500 r 0.3158 f1 0.4444
position_predict: train acc 0.9507 p 0.8889 r 0.7500 f1 0.8136

epoch 3: test loss 0.4710 cost time: 10.8s

cause_predict: test acc 0.8843 p 0.7014 r 0.3186 f1 0.4382
max_acc 0.8910 max_p 0.7110 max_r 0.3880 max_f1 0.5020

position_predict: test acc 0.9263 p 0.7652 r 0.6132 f1 0.6809
max_acc 0.9303 max_p 0.7569 max_r 0.6725 max_f1 0.7122

Average max cause: max_acc 0.8910 max_p 0.7110 max_r 0.3880 max_f1 0.5020
Average max pos: max_acc 0.9303 max_p 0.7569 max_r 0.6725 max_f1 0.7122

step 10: train loss 0.3192 
cause_predict: train acc 0.9218 p 0.7895 r 0.4412 f1 0.5660
position_predict: train acc 0.9388 p 0.7586 r 0.6667 f1 0.7097
step 20: train loss 0.4002 
cause_predict: train acc 0.8843 p 0.7333 r 0.3143 f1 0.4400
position_predict: train acc 0.9463 p 0.7879 r 0.8125 f1 0.8000
step 30: train loss 0.3859 
cause_predict: train acc 0.8979 p 0.6800 r 0.5152 f1 0.5862
position_predict: train acc 0.9660 p 0.8750 r 0.8750 f1 0.8750
step 40: train loss 0.3941 
cause_predict: train acc 0.9244 p 0.8387 r 0.6667 f1 0.7429
position_predict: train acc 0.9580 p 0.8438 r 0.8438 f1 0.8438
step 50: train loss 0.4108 
cause_predict: train acc 0.8925 p 0.7200 r 0.5294 f1 0.6102
position_predict: train acc 0.9299 p 0.7812 r 0.7576 f1 0.7692
step 60: train loss 0.3501 
cause_predict: train acc 0.9274 p 0.8696 r 0.5882 f1 0.7018
position_predict: train acc 0.9274 p 0.7742 r 0.7059 f1 0.7385
step 70: train loss 0.3671 
cause_predict: train acc 0.9079 p 0.8000 r 0.4706 f1 0.5926
position_predict: train acc 0.9456 p 0.8519 r 0.7188 f1 0.7797

epoch 4: test loss 0.4842 cost time: 10.2s

cause_predict: test acc 0.8892 p 0.7255 r 0.3502 f1 0.4723
max_acc 0.8910 max_p 0.7110 max_r 0.3880 max_f1 0.5020

position_predict: test acc 0.9223 p 0.7055 r 0.6760 f1 0.6904
max_acc 0.9303 max_p 0.7569 max_r 0.6725 max_f1 0.7122

Average max cause: max_acc 0.8910 max_p 0.7110 max_r 0.3880 max_f1 0.5020
Average max pos: max_acc 0.9303 max_p 0.7569 max_r 0.6725 max_f1 0.7122

step 10: train loss 0.3147 
cause_predict: train acc 0.9262 p 0.7692 r 0.6250 f1 0.6897
position_predict: train acc 0.9385 p 0.8400 r 0.6562 f1 0.7368
step 20: train loss 0.3797 
cause_predict: train acc 0.8950 p 0.7826 r 0.4737 f1 0.5902
position_predict: train acc 0.9496 p 0.8889 r 0.7273 f1 0.8000
step 30: train loss 0.3804 
cause_predict: train acc 0.8969 p 0.7308 r 0.4872 f1 0.5846
position_predict: train acc 0.9275 p 0.6970 r 0.7188 f1 0.7077
step 40: train loss 0.4230 
cause_predict: train acc 0.8485 p 0.7368 r 0.3590 f1 0.4828
position_predict: train acc 0.9697 p 0.9062 r 0.9062 f1 0.9062
step 50: train loss 0.4647 
cause_predict: train acc 0.9053 p 0.7143 r 0.5405 f1 0.6154
position_predict: train acc 0.9432 p 0.8214 r 0.6970 f1 0.7541
step 60: train loss 0.3815 
cause_predict: train acc 0.9010 p 0.6429 r 0.2571 f1 0.3673
position_predict: train acc 0.9393 p 0.7419 r 0.6765 f1 0.7077
step 70: train loss 0.3882 
cause_predict: train acc 0.9195 p 0.8077 r 0.5000 f1 0.6176
position_predict: train acc 0.9443 p 0.7500 r 0.6562 f1 0.7000

epoch 5: test loss 0.4835 cost time: 10.5s

cause_predict: test acc 0.8928 p 0.6726 r 0.4732 f1 0.5556
max_acc 0.8928 max_p 0.6726 max_r 0.4732 max_f1 0.5556

position_predict: test acc 0.9276 p 0.7341 r 0.6829 f1 0.7076
max_acc 0.9303 max_p 0.7569 max_r 0.6725 max_f1 0.7122

Average max cause: max_acc 0.8928 max_p 0.6726 max_r 0.4732 max_f1 0.5556
Average max pos: max_acc 0.9276 max_p 0.7341 max_r 0.6829 max_f1 0.7076

step 10: train loss 0.4276 
cause_predict: train acc 0.8987 p 0.7826 r 0.5000 f1 0.6102
position_predict: train acc 0.9295 p 0.8077 r 0.6562 f1 0.7241
step 20: train loss 0.2401 
cause_predict: train acc 0.9375 p 0.7429 r 0.8125 f1 0.7761
position_predict: train acc 0.9708 p 0.9310 r 0.8438 f1 0.8852
step 30: train loss 0.3062 
cause_predict: train acc 0.9208 p 0.7600 r 0.5588 f1 0.6441
position_predict: train acc 0.9623 p 0.8929 r 0.7812 f1 0.8333
step 40: train loss 0.4025 
cause_predict: train acc 0.8937 p 0.8519 r 0.5610 f1 0.6765
position_predict: train acc 0.9324 p 0.8276 r 0.7273 f1 0.7742
step 50: train loss 0.2742 
cause_predict: train acc 0.9280 p 0.8400 r 0.5833 f1 0.6885
position_predict: train acc 0.9659 p 0.8529 r 0.8788 f1 0.8657
step 60: train loss 0.3608 
cause_predict: train acc 0.9130 p 0.7241 r 0.6364 f1 0.6774
position_predict: train acc 0.9391 p 0.8214 r 0.7188 f1 0.7667
step 70: train loss 0.2838 
cause_predict: train acc 0.9390 p 0.9000 r 0.7297 f1 0.8060
position_predict: train acc 0.9296 p 0.7742 r 0.7500 f1 0.7619

epoch 6: test loss 0.5137 cost time: 10.5s

cause_predict: test acc 0.8865 p 0.6425 r 0.4479 f1 0.5279
max_acc 0.8928 max_p 0.6726 max_r 0.4732 max_f1 0.5556

position_predict: test acc 0.9231 p 0.7106 r 0.6760 f1 0.6929
max_acc 0.9303 max_p 0.7569 max_r 0.6725 max_f1 0.7122

Average max cause: max_acc 0.8928 max_p 0.6726 max_r 0.4732 max_f1 0.5556
Average max pos: max_acc 0.9276 max_p 0.7341 max_r 0.6829 max_f1 0.7076

step 10: train loss 0.1803 
cause_predict: train acc 0.9645 p 0.9091 r 0.8824 f1 0.8955
position_predict: train acc 0.9695 p 0.9333 r 0.8750 f1 0.9032
step 20: train loss 0.1867 
cause_predict: train acc 0.9524 p 0.9333 r 0.7179 f1 0.8116
position_predict: train acc 0.9707 p 0.8529 r 0.9062 f1 0.8788
step 30: train loss 0.2984 
cause_predict: train acc 0.9481 p 0.7647 r 0.7647 f1 0.7647
position_predict: train acc 0.9481 p 0.7500 r 0.7500 f1 0.7500
step 40: train loss 0.3111 
cause_predict: train acc 0.9067 p 0.8000 r 0.6154 f1 0.6957
position_predict: train acc 0.9600 p 0.8710 r 0.8438 f1 0.8571
step 50: train loss 0.2328 
cause_predict: train acc 0.9060 p 0.7027 r 0.7027 f1 0.7027
position_predict: train acc 0.9872 p 0.9394 r 0.9688 f1 0.9538
step 60: train loss 0.2442 
cause_predict: train acc 0.9457 p 0.8529 r 0.8056 f1 0.8286
position_predict: train acc 0.9502 p 0.8000 r 0.8750 f1 0.8358
step 70: train loss 0.3563 
cause_predict: train acc 0.9057 p 0.7407 r 0.5263 f1 0.6154
position_predict: train acc 0.9434 p 0.7714 r 0.7941 f1 0.7826

epoch 7: test loss 0.5554 cost time: 10.7s

cause_predict: test acc 0.8905 p 0.6714 r 0.4448 f1 0.5351
max_acc 0.8928 max_p 0.6726 max_r 0.4732 max_f1 0.5556

position_predict: test acc 0.9196 p 0.6801 r 0.7038 f1 0.6918
max_acc 0.9303 max_p 0.7569 max_r 0.6725 max_f1 0.7122

Average max cause: max_acc 0.8928 max_p 0.6726 max_r 0.4732 max_f1 0.5556
Average max pos: max_acc 0.9276 max_p 0.7341 max_r 0.6829 max_f1 0.7076

step 10: train loss 0.2451 
cause_predict: train acc 0.9476 p 0.8710 r 0.8182 f1 0.8438
position_predict: train acc 0.9529 p 0.8710 r 0.8438 f1 0.8571
step 20: train loss 0.2179 
cause_predict: train acc 0.9604 p 0.8205 r 0.9697 f1 0.8889
position_predict: train acc 0.9653 p 0.9032 r 0.8750 f1 0.8889
step 30: train loss 0.1564 
cause_predict: train acc 0.9808 p 0.9429 r 0.9167 f1 0.9296
position_predict: train acc 0.9731 p 0.8788 r 0.9062 f1 0.8923
step 40: train loss 0.1424 
cause_predict: train acc 0.9733 p 0.9459 r 0.8974 f1 0.9211
position_predict: train acc 0.9867 p 0.9677 r 0.9375 f1 0.9524
step 50: train loss 0.2815 
cause_predict: train acc 0.9281 p 0.7188 r 0.6571 f1 0.6866
position_predict: train acc 0.9486 p 0.7742 r 0.7500 f1 0.7619
step 60: train loss 0.2472 
cause_predict: train acc 0.9469 p 0.9286 r 0.7429 f1 0.8254
position_predict: train acc 0.9662 p 0.8788 r 0.9062 f1 0.8923
step 70: train loss 0.2987 
cause_predict: train acc 0.9295 p 0.8182 r 0.7105 f1 0.7606
position_predict: train acc 0.9544 p 0.8621 r 0.7812 f1 0.8197

epoch 8: test loss 0.5677 cost time: 10.7s

cause_predict: test acc 0.8789 p 0.5752 r 0.5552 f1 0.5650
max_acc 0.8789 max_p 0.5752 max_r 0.5552 max_f1 0.5650

position_predict: test acc 0.9223 p 0.7085 r 0.6690 f1 0.6882
max_acc 0.9303 max_p 0.7569 max_r 0.6725 max_f1 0.7122

Average max cause: max_acc 0.8928 max_p 0.6726 max_r 0.4732 max_f1 0.5556
Average max pos: max_acc 0.9276 max_p 0.7341 max_r 0.6829 max_f1 0.7076

step 10: train loss 0.1482 
cause_predict: train acc 0.9768 p 1.0000 r 0.8333 f1 0.9091
position_predict: train acc 0.9846 p 0.9375 r 0.9375 f1 0.9375
step 20: train loss 0.2219 
cause_predict: train acc 0.9519 p 0.9355 r 0.7838 f1 0.8529
position_predict: train acc 0.9615 p 0.8788 r 0.8788 f1 0.8788
step 30: train loss 0.1327 
cause_predict: train acc 0.9613 p 0.9412 r 0.8889 f1 0.9143
position_predict: train acc 0.9935 p 1.0000 r 0.9697 f1 0.9846
step 40: train loss 0.1336 
cause_predict: train acc 0.9793 p 0.9459 r 0.8974 f1 0.9211
position_predict: train acc 0.9690 p 0.8750 r 0.8485 f1 0.8615
step 50: train loss 0.2109 
cause_predict: train acc 0.9570 p 0.8929 r 0.7576 f1 0.8197
position_predict: train acc 0.9727 p 0.8788 r 0.9062 f1 0.8923
step 60: train loss 0.2278 
cause_predict: train acc 0.9410 p 0.8667 r 0.6842 f1 0.7647
position_predict: train acc 0.9779 p 0.9118 r 0.9118 f1 0.9118
step 70: train loss 0.2515 
cause_predict: train acc 0.9401 p 0.7812 r 0.7353 f1 0.7576
position_predict: train acc 0.9663 p 0.8750 r 0.8485 f1 0.8615

epoch 9: test loss 0.6031 cost time: 10.8s

cause_predict: test acc 0.8816 p 0.5878 r 0.5489 f1 0.5677
max_acc 0.8816 max_p 0.5878 max_r 0.5489 max_f1 0.5677

position_predict: test acc 0.9209 p 0.7083 r 0.6516 f1 0.6788
max_acc 0.9303 max_p 0.7569 max_r 0.6725 max_f1 0.7122

Average max cause: max_acc 0.8928 max_p 0.6726 max_r 0.4732 max_f1 0.5556
Average max pos: max_acc 0.9276 max_p 0.7341 max_r 0.6829 max_f1 0.7076

step 10: train loss 0.1922 
cause_predict: train acc 0.9680 p 0.9118 r 0.8611 f1 0.8857
position_predict: train acc 0.9600 p 0.8438 r 0.8438 f1 0.8438
step 20: train loss 0.2926 
cause_predict: train acc 0.9462 p 0.8611 r 0.8611 f1 0.8611
position_predict: train acc 0.9409 p 0.8056 r 0.8788 f1 0.8406
step 30: train loss 0.2020 
cause_predict: train acc 0.9412 p 0.8438 r 0.7500 f1 0.7941
position_predict: train acc 0.9622 p 0.8485 r 0.8750 f1 0.8615
step 40: train loss 0.0996 
cause_predict: train acc 0.9821 p 0.9697 r 0.9143 f1 0.9412
position_predict: train acc 0.9821 p 0.9118 r 0.9688 f1 0.9394
step 50: train loss 0.1009 
cause_predict: train acc 0.9805 p 0.9091 r 0.9375 f1 0.9231
position_predict: train acc 0.9766 p 0.9062 r 0.9062 f1 0.9062
step 60: train loss 0.2363 
cause_predict: train acc 0.9526 p 0.9231 r 0.8571 f1 0.8889
position_predict: train acc 0.9474 p 0.8056 r 0.9062 f1 0.8529
step 70: train loss 0.1764 
cause_predict: train acc 0.9772 p 0.9667 r 0.8788 f1 0.9206
position_predict: train acc 0.9589 p 0.8485 r 0.8750 f1 0.8615

epoch 10: test loss 0.6728 cost time: 11.1s

cause_predict: test acc 0.8838 p 0.6135 r 0.4858 f1 0.5423
max_acc 0.8816 max_p 0.5878 max_r 0.5489 max_f1 0.5677

position_predict: test acc 0.9191 p 0.6920 r 0.6655 f1 0.6785
max_acc 0.9303 max_p 0.7569 max_r 0.6725 max_f1 0.7122

Average max cause: max_acc 0.8928 max_p 0.6726 max_r 0.4732 max_f1 0.5556
Average max pos: max_acc 0.9276 max_p 0.7341 max_r 0.6829 max_f1 0.7076

step 10: train loss 0.2042 
cause_predict: train acc 0.9786 p 0.9211 r 0.9722 f1 0.9459
position_predict: train acc 0.9412 p 0.8387 r 0.8125 f1 0.8254
step 20: train loss 0.1644 
cause_predict: train acc 0.9747 p 0.8824 r 0.9375 f1 0.9091
position_predict: train acc 0.9789 p 0.9355 r 0.9062 f1 0.9206
step 30: train loss 0.1406 
cause_predict: train acc 0.9756 p 0.9032 r 0.8750 f1 0.8889
position_predict: train acc 0.9617 p 0.8000 r 0.8750 f1 0.8358
step 40: train loss 0.2375 
cause_predict: train acc 0.9431 p 0.8056 r 0.7632 f1 0.7838
position_predict: train acc 0.9537 p 0.7879 r 0.8125 f1 0.8000
step 50: train loss 0.1807 
cause_predict: train acc 0.9595 p 0.9697 r 0.8000 f1 0.8767
position_predict: train acc 0.9685 p 0.9032 r 0.8750 f1 0.8889
step 60: train loss 0.1378 
cause_predict: train acc 0.9742 p 0.8947 r 0.9189 f1 0.9067
position_predict: train acc 0.9815 p 0.8857 r 0.9688 f1 0.9254
step 70: train loss 0.1491 
cause_predict: train acc 0.9742 p 0.9167 r 0.9167 f1 0.9167
position_predict: train acc 0.9700 p 0.8788 r 0.9062 f1 0.8923

epoch 11: test loss 0.6630 cost time: 11.0s

cause_predict: test acc 0.8856 p 0.6117 r 0.5268 f1 0.5661
max_acc 0.8816 max_p 0.5878 max_r 0.5489 max_f1 0.5677

position_predict: test acc 0.9196 p 0.6877 r 0.6829 f1 0.6853
max_acc 0.9303 max_p 0.7569 max_r 0.6725 max_f1 0.7122

Average max cause: max_acc 0.8928 max_p 0.6726 max_r 0.4732 max_f1 0.5556
Average max pos: max_acc 0.9276 max_p 0.7341 max_r 0.6829 max_f1 0.7076

step 10: train loss 0.1158 
cause_predict: train acc 0.9804 p 0.9730 r 0.9000 f1 0.9351
position_predict: train acc 0.9804 p 0.9091 r 0.9375 f1 0.9231
step 20: train loss 0.1094 
cause_predict: train acc 0.9725 p 0.9231 r 0.8780 f1 0.9000
position_predict: train acc 0.9725 p 0.8750 r 0.8750 f1 0.8750
step 30: train loss 0.1545 
cause_predict: train acc 0.9667 p 0.9667 r 0.8529 f1 0.9062
position_predict: train acc 0.9722 p 0.9355 r 0.9062 f1 0.9206
step 40: train loss 0.1077 
cause_predict: train acc 0.9688 p 0.9412 r 0.8421 f1 0.8889
position_predict: train acc 0.9766 p 0.8824 r 0.9375 f1 0.9091
step 50: train loss 0.1645 
cause_predict: train acc 0.9841 p 0.9429 r 0.9429 f1 0.9429
position_predict: train acc 0.9641 p 0.8750 r 0.8485 f1 0.8615
step 60: train loss 0.1268 
cause_predict: train acc 0.9916 p 0.9722 r 0.9722 f1 0.9722
position_predict: train acc 0.9705 p 0.9032 r 0.8750 f1 0.8889
step 70: train loss 0.1546 
cause_predict: train acc 0.9617 p 0.9118 r 0.8611 f1 0.8857
position_predict: train acc 0.9904 p 1.0000 r 0.9394 f1 0.9688

epoch 12: test loss 0.6829 cost time: 10.9s

cause_predict: test acc 0.8807 p 0.5933 r 0.5016 f1 0.5436
max_acc 0.8816 max_p 0.5878 max_r 0.5489 max_f1 0.5677

position_predict: test acc 0.9129 p 0.6544 r 0.6794 f1 0.6667
max_acc 0.9303 max_p 0.7569 max_r 0.6725 max_f1 0.7122

Average max cause: max_acc 0.8928 max_p 0.6726 max_r 0.4732 max_f1 0.5556
Average max pos: max_acc 0.9276 max_p 0.7341 max_r 0.6829 max_f1 0.7076

step 10: train loss 0.1301 
cause_predict: train acc 0.9892 p 0.9474 r 0.9730 f1 0.9600
position_predict: train acc 0.9677 p 0.8485 r 0.8750 f1 0.8615
step 20: train loss 0.0827 
cause_predict: train acc 0.9827 p 0.9167 r 0.9429 f1 0.9296
position_predict: train acc 0.9862 p 0.9375 r 0.9375 f1 0.9375
step 30: train loss 0.1804 
cause_predict: train acc 0.9615 p 0.9062 r 0.8286 f1 0.8657
position_predict: train acc 0.9573 p 0.7895 r 0.9375 f1 0.8571
step 40: train loss 0.1909 
cause_predict: train acc 0.9597 p 0.8824 r 0.8333 f1 0.8571
position_predict: train acc 0.9637 p 0.9310 r 0.7941 f1 0.8571
step 50: train loss 0.2285 
cause_predict: train acc 0.9442 p 0.8108 r 0.8571 f1 0.8333
position_predict: train acc 0.9535 p 0.8108 r 0.9091 f1 0.8571
step 60: train loss 0.1188 
cause_predict: train acc 0.9685 p 0.8108 r 0.9375 f1 0.8696
position_predict: train acc 0.9790 p 0.9062 r 0.9062 f1 0.9062
step 70: train loss 0.2149 
cause_predict: train acc 0.9391 p 0.8182 r 0.8182 f1 0.8182
position_predict: train acc 0.9594 p 0.8529 r 0.9062 f1 0.8788

epoch 13: test loss 0.7604 cost time: 11.2s

cause_predict: test acc 0.8870 p 0.6168 r 0.5331 f1 0.5719
max_acc 0.8870 max_p 0.6168 max_r 0.5331 max_f1 0.5719

position_predict: test acc 0.9209 p 0.6923 r 0.6899 f1 0.6911
max_acc 0.9303 max_p 0.7569 max_r 0.6725 max_f1 0.7122

Average max cause: max_acc 0.8928 max_p 0.6726 max_r 0.4732 max_f1 0.5556
Average max pos: max_acc 0.9276 max_p 0.7341 max_r 0.6829 max_f1 0.7076

step 10: train loss 0.1162 
cause_predict: train acc 0.9734 p 0.9143 r 0.8889 f1 0.9014
position_predict: train acc 0.9696 p 0.8750 r 0.8750 f1 0.8750
step 20: train loss 0.1045 
cause_predict: train acc 0.9688 p 0.9091 r 0.8824 f1 0.8955
position_predict: train acc 0.9821 p 0.9375 r 0.9375 f1 0.9375
step 30: train loss 0.1238 
cause_predict: train acc 0.9802 p 0.9459 r 0.8974 f1 0.9211
position_predict: train acc 0.9670 p 0.8235 r 0.8750 f1 0.8485
step 40: train loss 0.2024 
cause_predict: train acc 0.9587 p 0.8810 r 0.8810 f1 0.8810
position_predict: train acc 0.9628 p 0.8710 r 0.8438 f1 0.8571
step 50: train loss 0.0769 
cause_predict: train acc 0.9877 p 0.9429 r 0.9706 f1 0.9565
position_predict: train acc 0.9795 p 0.9118 r 0.9394 f1 0.9254
step 60: train loss 0.1447 
cause_predict: train acc 0.9659 p 0.8947 r 0.8718 f1 0.8831
position_predict: train acc 0.9659 p 0.8710 r 0.8438 f1 0.8571
step 70: train loss 0.1722 
cause_predict: train acc 0.9624 p 0.8889 r 0.9143 f1 0.9014
position_predict: train acc 0.9516 p 0.8286 r 0.9062 f1 0.8657

epoch 14: test loss 0.7648 cost time: 11.3s

cause_predict: test acc 0.8843 p 0.5993 r 0.5521 f1 0.5747
max_acc 0.8843 max_p 0.5993 max_r 0.5521 max_f1 0.5747

2024-06-22 18:44:31.099858: W tensorflow/c/c_api.cc:304] Operation '{name:'softmax_b_pos/Adam_1/Assign' id:5023 op device:{requested: '', assigned: ''} def:{{{node softmax_b_pos/Adam_1/Assign}} = Assign[T=DT_FLOAT, _class=["loc:@softmax_b_pos"], _has_manual_control_dependencies=true, use_locking=true, validate_shape=true](softmax_b_pos/Adam_1, softmax_b_pos/Adam_1/Initializer/zeros)}}' was changed by setting attribute after it was run by a session. This mutation will have no effect, and will trigger an error in the future. Either don't modify nodes after running them or create a new session.
position_predict: test acc 0.9142 p 0.6655 r 0.6655 f1 0.6655
max_acc 0.9303 max_p 0.7569 max_r 0.6725 max_f1 0.7122

Average max cause: max_acc 0.8928 max_p 0.6726 max_r 0.4732 max_f1 0.5556
Average max pos: max_acc 0.9276 max_p 0.7341 max_r 0.6829 max_f1 0.7076

write pair_data/Ind_BiLSTM_1/fold_5_test.txt done
write pair_data/Ind_BiLSTM_1/fold_5_train.txt done
Optimization Finished!

############# fold 5 end ###############
############# fold 6 begin ###############
load data_file: data_combine_en/fold_6_train.txt
y_position.shape (2275, 75, 2)
y_cause.shape (2275, 75, 2)
x.shape (2275, 75, 30)
sen_len.shape (2275, 75)
doc_len.shape (2275,)
n_cut 107
load data done!

load data_file: data_combine_en/fold_6_test.txt
y_position.shape (284, 75, 2)
y_cause.shape (284, 75, 2)
x.shape (284, 75, 30)
sen_len.shape (284, 75)
doc_len.shape (284,)
n_cut 22
load data done!

train docs: 2275    test docs: 284
step 10: train loss 0.8413 
cause_predict: train acc 0.8419 p 0.0000 r 0.0000 f1 0.0000
position_predict: train acc 0.8465 p 0.0000 r 0.0000 f1 0.0000
step 20: train loss 0.6159 
cause_predict: train acc 0.8889 p 0.0000 r 0.0000 f1 0.0000
position_predict: train acc 0.8954 p 0.0000 r 0.0000 f1 0.0000
step 30: train loss 0.6315 
cause_predict: train acc 0.8687 p 0.0000 r 0.0000 f1 0.0000
position_predict: train acc 0.8764 p 0.0000 r 0.0000 f1 0.0000
step 40: train loss 0.7398 
cause_predict: train acc 0.8077 p 0.0000 r 0.0000 f1 0.0000
position_predict: train acc 0.8846 p 0.9000 r 0.2812 f1 0.4286
step 50: train loss 0.6004 
cause_predict: train acc 0.8583 p 0.0000 r 0.0000 f1 0.0000
position_predict: train acc 0.8740 p 0.5000 r 0.5312 f1 0.5152
step 60: train loss 0.5329 
cause_predict: train acc 0.8643 p 1.0000 r 0.0500 f1 0.0952
position_predict: train acc 0.9321 p 0.7600 r 0.5938 f1 0.6667
step 70: train loss 0.4574 
cause_predict: train acc 0.8964 p 0.7500 r 0.2812 f1 0.4091
position_predict: train acc 0.9323 p 0.7419 r 0.7188 f1 0.7302

epoch 0: test loss 0.5316 cost time: 11.0s

cause_predict: test acc 0.8700 p 0.9643 r 0.0852 f1 0.1565
max_acc 0.8700 max_p 0.9643 max_r 0.0852 max_f1 0.1565

position_predict: test acc 0.9138 p 0.6610 r 0.6725 f1 0.6667
max_acc 0.9138 max_p 0.6610 max_r 0.6725 max_f1 0.6667

Average max cause: max_acc 0.8700 max_p 0.9643 max_r 0.0852 max_f1 0.1565
Average max pos: max_acc 0.9138 max_p 0.6610 max_r 0.6725 max_f1 0.6667

step 10: train loss 0.5674 
cause_predict: train acc 0.8414 p 0.8333 r 0.1250 f1 0.2174
position_predict: train acc 0.9075 p 0.7200 r 0.5625 f1 0.6316
step 20: train loss 0.4946 
cause_predict: train acc 0.8809 p 0.6667 r 0.3030 f1 0.4167
position_predict: train acc 0.9021 p 0.7368 r 0.4375 f1 0.5490
step 30: train loss 0.4353 
cause_predict: train acc 0.9068 p 0.8667 r 0.3939 f1 0.5417
position_predict: train acc 0.9322 p 0.7931 r 0.6970 f1 0.7419
step 40: train loss 0.4967 
cause_predict: train acc 0.8845 p 1.0000 r 0.1944 f1 0.3256
position_predict: train acc 0.9163 p 0.7619 r 0.5000 f1 0.6038
step 50: train loss 0.5376 
cause_predict: train acc 0.8636 p 0.7500 r 0.2727 f1 0.4000
position_predict: train acc 0.9343 p 0.8065 r 0.7812 f1 0.7937
step 60: train loss 0.4936 
cause_predict: train acc 0.8767 p 0.7143 r 0.2941 f1 0.4167
position_predict: train acc 0.9383 p 0.8000 r 0.7500 f1 0.7742
step 70: train loss 0.5052 
cause_predict: train acc 0.8680 p 0.7333 r 0.3333 f1 0.4583
position_predict: train acc 0.9492 p 0.8438 r 0.8438 f1 0.8438

epoch 1: test loss 0.4850 cost time: 11.1s

cause_predict: test acc 0.8923 p 0.7603 r 0.3502 f1 0.4795
max_acc 0.8923 max_p 0.7603 max_r 0.3502 max_f1 0.4795

position_predict: test acc 0.9138 p 0.6715 r 0.6411 f1 0.6560
max_acc 0.9138 max_p 0.6610 max_r 0.6725 max_f1 0.6667

Average max cause: max_acc 0.8923 max_p 0.7603 max_r 0.3502 max_f1 0.4795
Average max pos: max_acc 0.9138 max_p 0.6715 max_r 0.6411 max_f1 0.6560

step 10: train loss 0.4633 
cause_predict: train acc 0.8761 p 0.6875 r 0.3143 f1 0.4314
position_predict: train acc 0.9359 p 0.7931 r 0.7188 f1 0.7541
step 20: train loss 0.4321 
cause_predict: train acc 0.9065 p 0.8889 r 0.4000 f1 0.5517
position_predict: train acc 0.9460 p 0.7742 r 0.7500 f1 0.7619
step 30: train loss 0.3727 
cause_predict: train acc 0.9297 p 1.0000 r 0.4545 f1 0.6250
position_predict: train acc 0.9219 p 0.7586 r 0.6286 f1 0.6875
step 40: train loss 0.4674 
cause_predict: train acc 0.8565 p 0.5000 r 0.2647 f1 0.3462
position_predict: train acc 0.9283 p 0.7778 r 0.6562 f1 0.7119
step 50: train loss 0.4832 
cause_predict: train acc 0.8626 p 0.6667 r 0.3889 f1 0.4912
position_predict: train acc 0.9336 p 0.8750 r 0.6562 f1 0.7500
step 60: train loss 0.4301 
cause_predict: train acc 0.8880 p 0.7059 r 0.3429 f1 0.4615
position_predict: train acc 0.9480 p 0.9524 r 0.6250 f1 0.7547
step 70: train loss 0.5043 
cause_predict: train acc 0.8783 p 0.8333 r 0.2778 f1 0.4167
position_predict: train acc 0.9261 p 0.8000 r 0.6250 f1 0.7018

epoch 2: test loss 0.4787 cost time: 11.1s

cause_predict: test acc 0.8878 p 0.7797 r 0.2902 f1 0.4230
max_acc 0.8923 max_p 0.7603 max_r 0.3502 max_f1 0.4795

position_predict: test acc 0.9240 p 0.7468 r 0.6167 f1 0.6756
max_acc 0.9240 max_p 0.7468 max_r 0.6167 max_f1 0.6756

Average max cause: max_acc 0.8923 max_p 0.7603 max_r 0.3502 max_f1 0.4795
Average max pos: max_acc 0.9138 max_p 0.6715 max_r 0.6411 max_f1 0.6560

step 10: train loss 0.3720 
cause_predict: train acc 0.8972 p 0.7368 r 0.4000 f1 0.5185
position_predict: train acc 0.9447 p 0.8462 r 0.6875 f1 0.7586
step 20: train loss 0.5167 
cause_predict: train acc 0.9021 p 0.6970 r 0.7188 f1 0.7077
position_predict: train acc 0.8763 p 0.6154 r 0.7273 f1 0.6667
step 30: train loss 0.4629 
cause_predict: train acc 0.8828 p 0.6471 r 0.5500 f1 0.5946
position_predict: train acc 0.9336 p 0.7667 r 0.6970 f1 0.7302
step 40: train loss 0.5168 
cause_predict: train acc 0.8912 p 0.7143 r 0.5263 f1 0.6061
position_predict: train acc 0.9079 p 0.6471 r 0.6875 f1 0.6667
step 50: train loss 0.3068 
cause_predict: train acc 0.8949 p 0.8235 r 0.3684 f1 0.5091
position_predict: train acc 0.9767 p 0.9643 r 0.8438 f1 0.9000
step 60: train loss 0.4190 
cause_predict: train acc 0.8930 p 0.7500 r 0.4737 f1 0.5806
position_predict: train acc 0.9506 p 0.8621 r 0.7576 f1 0.8065
step 70: train loss 0.4859 
cause_predict: train acc 0.8571 p 0.5000 r 0.3158 f1 0.3871
position_predict: train acc 0.9173 p 0.6562 r 0.6562 f1 0.6562

epoch 3: test loss 0.4680 cost time: 10.9s

cause_predict: test acc 0.8874 p 0.6383 r 0.4732 f1 0.5435
max_acc 0.8874 max_p 0.6383 max_r 0.4732 max_f1 0.5435

position_predict: test acc 0.9240 p 0.7067 r 0.6969 f1 0.7018
max_acc 0.9240 max_p 0.7067 max_r 0.6969 max_f1 0.7018

Average max cause: max_acc 0.8874 max_p 0.6383 max_r 0.4732 max_f1 0.5435
Average max pos: max_acc 0.9240 max_p 0.7067 max_r 0.6969 max_f1 0.7018

step 10: train loss 0.3847 
cause_predict: train acc 0.8893 p 0.8333 r 0.3750 f1 0.5172
position_predict: train acc 0.9526 p 0.8621 r 0.7576 f1 0.8065
step 20: train loss 0.3772 
cause_predict: train acc 0.8958 p 0.7917 r 0.5588 f1 0.6552
position_predict: train acc 0.9479 p 0.8438 r 0.8438 f1 0.8438
step 30: train loss 0.3905 
cause_predict: train acc 0.9095 p 0.8667 r 0.3939 f1 0.5417
position_predict: train acc 0.9506 p 0.8621 r 0.7576 f1 0.8065
step 40: train loss 0.2939 
cause_predict: train acc 0.9379 p 0.8182 r 0.5455 f1 0.6545
position_predict: train acc 0.9510 p 0.7931 r 0.7188 f1 0.7541
step 50: train loss 0.4335 
cause_predict: train acc 0.8920 p 0.6129 r 0.5588 f1 0.5846
position_predict: train acc 0.9240 p 0.7241 r 0.6562 f1 0.6885
step 60: train loss 0.2742 
cause_predict: train acc 0.9388 p 0.8214 r 0.6571 f1 0.7302
position_predict: train acc 0.9424 p 0.7931 r 0.6970 f1 0.7419
step 70: train loss 0.5977 
cause_predict: train acc 0.8485 p 0.6129 r 0.5135 f1 0.5588
position_predict: train acc 0.9141 p 0.7857 r 0.6667 f1 0.7213

epoch 4: test loss 0.4787 cost time: 11.3s

cause_predict: test acc 0.8932 p 0.6789 r 0.4669 f1 0.5533
max_acc 0.8932 max_p 0.6789 max_r 0.4669 max_f1 0.5533

position_predict: test acc 0.9227 p 0.7355 r 0.6202 f1 0.6730
max_acc 0.9240 max_p 0.7067 max_r 0.6969 max_f1 0.7018

Average max cause: max_acc 0.8874 max_p 0.6383 max_r 0.4732 max_f1 0.5435
Average max pos: max_acc 0.9240 max_p 0.7067 max_r 0.6969 max_f1 0.7018

step 10: train loss 0.3704 
cause_predict: train acc 0.9009 p 0.7917 r 0.5135 f1 0.6230
position_predict: train acc 0.9440 p 0.8846 r 0.6970 f1 0.7797
step 20: train loss 0.4136 
cause_predict: train acc 0.9020 p 0.7419 r 0.6571 f1 0.6970
position_predict: train acc 0.9461 p 0.8889 r 0.7500 f1 0.8136
step 30: train loss 0.2581 
cause_predict: train acc 0.9684 p 0.9375 r 0.8333 f1 0.8824
position_predict: train acc 0.9605 p 0.8438 r 0.8438 f1 0.8438
step 40: train loss 0.3034 
cause_predict: train acc 0.9220 p 0.9091 r 0.5882 f1 0.7143
position_predict: train acc 0.9707 p 0.9333 r 0.8750 f1 0.9032
step 50: train loss 0.4293 
cause_predict: train acc 0.8802 p 0.6400 r 0.4444 f1 0.5246
position_predict: train acc 0.9463 p 0.8276 r 0.7500 f1 0.7869
step 60: train loss 0.3496 
cause_predict: train acc 0.9073 p 0.7083 r 0.5000 f1 0.5862
position_predict: train acc 0.9498 p 0.7941 r 0.8182 f1 0.8060
step 70: train loss 0.4389 
cause_predict: train acc 0.9054 p 0.7826 r 0.5294 f1 0.6316
position_predict: train acc 0.9009 p 0.6562 r 0.6562 f1 0.6562

epoch 5: test loss 0.4867 cost time: 11.2s

cause_predict: test acc 0.8892 p 0.6683 r 0.4322 f1 0.5249
max_acc 0.8932 max_p 0.6789 max_r 0.4669 max_f1 0.5533

position_predict: test acc 0.9178 p 0.6758 r 0.6899 f1 0.6828
max_acc 0.9240 max_p 0.7067 max_r 0.6969 max_f1 0.7018

Average max cause: max_acc 0.8874 max_p 0.6383 max_r 0.4732 max_f1 0.5435
Average max pos: max_acc 0.9240 max_p 0.7067 max_r 0.6969 max_f1 0.7018

step 10: train loss 0.3539 
cause_predict: train acc 0.9261 p 0.8667 r 0.7027 f1 0.7761
position_predict: train acc 0.9360 p 0.8276 r 0.7500 f1 0.7869
step 20: train loss 0.3392 
cause_predict: train acc 0.9280 p 0.8000 r 0.7179 f1 0.7568
position_predict: train acc 0.9400 p 0.7568 r 0.8235 f1 0.7887
step 30: train loss 0.3577 
cause_predict: train acc 0.9048 p 0.7419 r 0.6216 f1 0.6765
position_predict: train acc 0.9481 p 0.7632 r 0.9062 f1 0.8286
step 40: train loss 0.3039 
cause_predict: train acc 0.9101 p 0.7931 r 0.6970 f1 0.7419
position_predict: train acc 0.9719 p 0.9355 r 0.9062 f1 0.9206
step 50: train loss 0.2656 
cause_predict: train acc 0.9509 p 0.8667 r 0.7222 f1 0.7879
position_predict: train acc 0.9509 p 0.8000 r 0.7500 f1 0.7742
step 60: train loss 0.2960 
cause_predict: train acc 0.9097 p 0.6667 r 0.5714 f1 0.6154
position_predict: train acc 0.9386 p 0.7143 r 0.7812 f1 0.7463
step 70: train loss 0.2652 
cause_predict: train acc 0.9208 p 0.8065 r 0.6579 f1 0.7246
position_predict: train acc 0.9792 p 0.9118 r 0.9394 f1 0.9254

epoch 6: test loss 0.5089 cost time: 11.1s

cause_predict: test acc 0.8914 p 0.6468 r 0.5142 f1 0.5729
max_acc 0.8914 max_p 0.6468 max_r 0.5142 max_f1 0.5729

position_predict: test acc 0.9205 p 0.6873 r 0.6969 f1 0.6920
max_acc 0.9240 max_p 0.7067 max_r 0.6969 max_f1 0.7018

Average max cause: max_acc 0.8914 max_p 0.6468 max_r 0.5142 max_f1 0.5729
Average max pos: max_acc 0.9205 max_p 0.6873 max_r 0.6969 max_f1 0.6920

step 10: train loss 0.2241 
cause_predict: train acc 0.9455 p 0.8667 r 0.7647 f1 0.8125
position_predict: train acc 0.9636 p 0.8750 r 0.8750 f1 0.8750
step 20: train loss 0.2130 
cause_predict: train acc 0.9420 p 0.8286 r 0.7436 f1 0.7838
position_predict: train acc 0.9855 p 0.9375 r 0.9375 f1 0.9375
step 30: train loss 0.2908 
cause_predict: train acc 0.9492 p 0.7778 r 0.8750 f1 0.8235
position_predict: train acc 0.9364 p 0.7647 r 0.7879 f1 0.7761
step 40: train loss 0.2517 
cause_predict: train acc 0.9244 p 0.7931 r 0.5897 f1 0.6765
position_predict: train acc 0.9553 p 0.7879 r 0.8125 f1 0.8000
step 50: train loss 0.2615 
cause_predict: train acc 0.9289 p 0.8333 r 0.7143 f1 0.7692
position_predict: train acc 0.9763 p 0.9355 r 0.9062 f1 0.9206
step 60: train loss 0.3261 
cause_predict: train acc 0.9375 p 0.8710 r 0.7500 f1 0.8060
position_predict: train acc 0.9375 p 0.8519 r 0.7188 f1 0.7797
step 70: train loss 0.2771 
cause_predict: train acc 0.9164 p 0.6667 r 0.6667 f1 0.6667
position_predict: train acc 0.9721 p 0.9000 r 0.8438 f1 0.8710

epoch 7: test loss 0.5769 cost time: 11.3s

cause_predict: test acc 0.8847 p 0.6081 r 0.5237 f1 0.5627
max_acc 0.8914 max_p 0.6468 max_r 0.5142 max_f1 0.5729

position_predict: test acc 0.9245 p 0.7305 r 0.6516 f1 0.6888
max_acc 0.9240 max_p 0.7067 max_r 0.6969 max_f1 0.7018

Average max cause: max_acc 0.8914 max_p 0.6468 max_r 0.5142 max_f1 0.5729
Average max pos: max_acc 0.9205 max_p 0.6873 max_r 0.6969 max_f1 0.6920

step 10: train loss 0.2845 
cause_predict: train acc 0.9358 p 0.8378 r 0.8378 f1 0.8378
position_predict: train acc 0.9626 p 0.9062 r 0.8788 f1 0.8923
step 20: train loss 0.1914 
cause_predict: train acc 0.9528 p 0.8710 r 0.8182 f1 0.8438
position_predict: train acc 0.9764 p 0.8919 r 0.9706 f1 0.9296
step 30: train loss 0.2131 
cause_predict: train acc 0.9464 p 0.8000 r 0.8889 f1 0.8421
position_predict: train acc 0.9554 p 0.8438 r 0.8438 f1 0.8438
step 40: train loss 0.2600 
cause_predict: train acc 0.9534 p 0.8235 r 0.8485 f1 0.8358
position_predict: train acc 0.9449 p 0.7879 r 0.8125 f1 0.8000
step 50: train loss 0.1997 
cause_predict: train acc 0.9550 p 0.8125 r 0.7879 f1 0.8000
position_predict: train acc 0.9550 p 0.8519 r 0.7188 f1 0.7797
step 60: train loss 0.2204 
cause_predict: train acc 0.9553 p 0.8286 r 0.8529 f1 0.8406
position_predict: train acc 0.9512 p 0.8387 r 0.7879 f1 0.8125
step 70: train loss 0.2351 
cause_predict: train acc 0.9492 p 0.8529 r 0.8529 f1 0.8529
position_predict: train acc 0.9594 p 0.9000 r 0.8438 f1 0.8710

epoch 8: test loss 0.5866 cost time: 11.1s

cause_predict: test acc 0.8883 p 0.6175 r 0.5552 f1 0.5847
max_acc 0.8883 max_p 0.6175 max_r 0.5552 max_f1 0.5847

position_predict: test acc 0.9223 p 0.7070 r 0.6725 f1 0.6893
max_acc 0.9240 max_p 0.7067 max_r 0.6969 max_f1 0.7018

Average max cause: max_acc 0.8883 max_p 0.6175 max_r 0.5552 max_f1 0.5847
Average max pos: max_acc 0.9223 max_p 0.7070 max_r 0.6725 max_f1 0.6893

step 10: train loss 0.1766 
cause_predict: train acc 0.9671 p 0.8684 r 0.9167 f1 0.8919
position_predict: train acc 0.9712 p 0.9310 r 0.8438 f1 0.8852
step 20: train loss 0.1219 
cause_predict: train acc 0.9750 p 0.9118 r 0.9118 f1 0.9118
position_predict: train acc 0.9792 p 0.9091 r 0.9375 f1 0.9231
step 30: train loss 0.1797 
cause_predict: train acc 0.9565 p 0.8750 r 0.7568 f1 0.8116
position_predict: train acc 0.9732 p 0.8750 r 0.8750 f1 0.8750
step 40: train loss 0.2794 
cause_predict: train acc 0.9238 p 0.8462 r 0.6471 f1 0.7333
position_predict: train acc 0.9667 p 0.9062 r 0.8788 f1 0.8923
step 50: train loss 0.2212 
cause_predict: train acc 0.9564 p 0.8485 r 0.7778 f1 0.8116
position_predict: train acc 0.9631 p 0.8438 r 0.8182 f1 0.8308
step 60: train loss 0.2773 
cause_predict: train acc 0.9484 p 0.8857 r 0.8158 f1 0.8493
position_predict: train acc 0.9437 p 0.8182 r 0.8182 f1 0.8182
step 70: train loss 0.2445 
cause_predict: train acc 0.9459 p 0.8750 r 0.8235 f1 0.8485
position_predict: train acc 0.9568 p 0.8788 r 0.8788 f1 0.8788

epoch 9: test loss 0.6410 cost time: 11.2s

cause_predict: test acc 0.8807 p 0.5933 r 0.5016 f1 0.5436
max_acc 0.8883 max_p 0.6175 max_r 0.5552 max_f1 0.5847

position_predict: test acc 0.9160 p 0.6787 r 0.6551 f1 0.6667
max_acc 0.9240 max_p 0.7067 max_r 0.6969 max_f1 0.7018

Average max cause: max_acc 0.8883 max_p 0.6175 max_r 0.5552 max_f1 0.5847
Average max pos: max_acc 0.9223 max_p 0.7070 max_r 0.6725 max_f1 0.6893

step 10: train loss 0.1301 
cause_predict: train acc 0.9800 p 0.9429 r 0.9167 f1 0.9296
position_predict: train acc 0.9720 p 0.9032 r 0.8750 f1 0.8889
step 20: train loss 0.1749 
cause_predict: train acc 0.9596 p 0.8378 r 0.9118 f1 0.8732
position_predict: train acc 0.9552 p 0.8235 r 0.8750 f1 0.8485
step 30: train loss 0.1244 
cause_predict: train acc 0.9772 p 0.9429 r 0.9167 f1 0.9296
position_predict: train acc 0.9772 p 0.9091 r 0.9375 f1 0.9231
step 40: train loss 0.1957 
cause_predict: train acc 0.9725 p 0.8857 r 0.9118 f1 0.8986
position_predict: train acc 0.9686 p 0.9000 r 0.8438 f1 0.8710
step 50: train loss 0.1687 
2024-06-22 18:47:27.086855: W tensorflow/c/c_api.cc:304] Operation '{name:'softmax_b_pos/Adam_1/Assign' id:5023 op device:{requested: '', assigned: ''} def:{{{node softmax_b_pos/Adam_1/Assign}} = Assign[T=DT_FLOAT, _class=["loc:@softmax_b_pos"], _has_manual_control_dependencies=true, use_locking=true, validate_shape=true](softmax_b_pos/Adam_1, softmax_b_pos/Adam_1/Initializer/zeros)}}' was changed by setting attribute after it was run by a session. This mutation will have no effect, and will trigger an error in the future. Either don't modify nodes after running them or create a new session.
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
cause_predict: train acc 0.9698 p 0.8919 r 0.9167 f1 0.9041
position_predict: train acc 0.9784 p 0.9091 r 0.9375 f1 0.9231
step 60: train loss 0.1824 
cause_predict: train acc 0.9530 p 0.7778 r 0.8000 f1 0.7887
position_predict: train acc 0.9687 p 0.8235 r 0.8750 f1 0.8485
step 70: train loss 0.1483 
cause_predict: train acc 0.9806 p 0.9459 r 0.9459 f1 0.9459
position_predict: train acc 0.9612 p 0.9062 r 0.8529 f1 0.8788

epoch 10: test loss 0.6401 cost time: 11.2s

cause_predict: test acc 0.8838 p 0.5973 r 0.5521 f1 0.5738
max_acc 0.8883 max_p 0.6175 max_r 0.5552 max_f1 0.5847

position_predict: test acc 0.9218 p 0.7000 r 0.6829 f1 0.6914
max_acc 0.9240 max_p 0.7067 max_r 0.6969 max_f1 0.7018

Average max cause: max_acc 0.8883 max_p 0.6175 max_r 0.5552 max_f1 0.5847
Average max pos: max_acc 0.9223 max_p 0.7070 max_r 0.6725 max_f1 0.6893

step 10: train loss 0.1259 
cause_predict: train acc 0.9738 p 0.9688 r 0.8611 f1 0.9118
position_predict: train acc 0.9694 p 0.9062 r 0.8788 f1 0.8923
step 20: train loss 0.0947 
cause_predict: train acc 0.9825 p 0.9286 r 0.9750 f1 0.9512
position_predict: train acc 0.9869 p 0.9688 r 0.9394 f1 0.9538
step 30: train loss 0.1853 
cause_predict: train acc 0.9463 p 0.8056 r 0.8286 f1 0.8169
position_predict: train acc 0.9793 p 0.9143 r 0.9412 f1 0.9275
step 40: train loss 0.2181 
cause_predict: train acc 0.9626 p 1.0000 r 0.7778 f1 0.8750
position_predict: train acc 0.9813 p 0.9118 r 0.9688 f1 0.9394
step 50: train loss 0.0892 
cause_predict: train acc 0.9955 p 1.0000 r 0.9722 f1 0.9859
position_predict: train acc 0.9821 p 0.9118 r 0.9688 f1 0.9394
step 60: train loss 0.1127 
cause_predict: train acc 0.9916 p 0.9730 r 0.9730 f1 0.9730
position_predict: train acc 0.9748 p 0.8611 r 0.9688 f1 0.9118
step 70: train loss 0.2853 
cause_predict: train acc 0.9383 p 0.8286 r 0.7838 f1 0.8056
position_predict: train acc 0.9559 p 0.8438 r 0.8438 f1 0.8438

epoch 11: test loss 0.6570 cost time: 10.8s

cause_predict: test acc 0.8820 p 0.5880 r 0.5584 f1 0.5728
max_acc 0.8883 max_p 0.6175 max_r 0.5552 max_f1 0.5847

position_predict: test acc 0.9147 p 0.6846 r 0.6202 f1 0.6508
max_acc 0.9240 max_p 0.7067 max_r 0.6969 max_f1 0.7018

Average max cause: max_acc 0.8883 max_p 0.6175 max_r 0.5552 max_f1 0.5847
Average max pos: max_acc 0.9223 max_p 0.7070 max_r 0.6725 max_f1 0.6893

step 10: train loss 0.1746 
cause_predict: train acc 0.9799 p 0.9474 r 0.9231 f1 0.9351
position_predict: train acc 0.9518 p 0.7941 r 0.8438 f1 0.8182
step 20: train loss 0.1252 
cause_predict: train acc 0.9744 p 0.8824 r 0.9091 f1 0.8955
position_predict: train acc 0.9707 p 0.8529 r 0.9062 f1 0.8788
step 30: train loss 0.1051 
cause_predict: train acc 0.9957 p 0.9730 r 1.0000 f1 0.9863
position_predict: train acc 0.9740 p 0.9333 r 0.8750 f1 0.9032
step 40: train loss 0.0906 
cause_predict: train acc 0.9904 p 0.9697 r 0.9697 f1 0.9697
position_predict: train acc 0.9809 p 0.9375 r 0.9375 f1 0.9375
step 50: train loss 0.1528 
cause_predict: train acc 0.9624 p 0.8205 r 0.8649 f1 0.8421
position_predict: train acc 0.9749 p 0.8529 r 0.9062 f1 0.8788
step 60: train loss 0.1675 
cause_predict: train acc 0.9743 p 0.9444 r 0.8718 f1 0.9067
position_predict: train acc 0.9632 p 0.8710 r 0.8182 f1 0.8438
step 70: train loss 0.1343 
cause_predict: train acc 0.9775 p 0.9167 r 0.9167 f1 0.9167
position_predict: train acc 0.9775 p 0.9091 r 0.9091 f1 0.9091

epoch 12: test loss 0.7054 cost time: 11.3s

cause_predict: test acc 0.8905 p 0.6364 r 0.5300 f1 0.5783
max_acc 0.8883 max_p 0.6175 max_r 0.5552 max_f1 0.5847

position_predict: test acc 0.9093 p 0.6469 r 0.6446 f1 0.6457
max_acc 0.9240 max_p 0.7067 max_r 0.6969 max_f1 0.7018

Average max cause: max_acc 0.8883 max_p 0.6175 max_r 0.5552 max_f1 0.5847
Average max pos: max_acc 0.9223 max_p 0.7070 max_r 0.6725 max_f1 0.6893

step 10: train loss 0.0845 
cause_predict: train acc 0.9885 p 0.9722 r 0.9722 f1 0.9722
position_predict: train acc 0.9885 p 0.9697 r 0.9697 f1 0.9697
step 20: train loss 0.0794 
cause_predict: train acc 0.9871 p 0.9429 r 0.9706 f1 0.9565
position_predict: train acc 0.9914 p 0.9697 r 0.9697 f1 0.9697
step 30: train loss 0.0861 
cause_predict: train acc 0.9872 p 0.9429 r 0.9706 f1 0.9565
position_predict: train acc 0.9872 p 0.9394 r 0.9688 f1 0.9538
step 40: train loss 0.1158 
cause_predict: train acc 0.9725 p 0.9394 r 0.8611 f1 0.8986
position_predict: train acc 0.9804 p 0.9355 r 0.9062 f1 0.9206
step 50: train loss 0.1298 
cause_predict: train acc 0.9827 p 0.9737 r 0.9024 f1 0.9367
position_predict: train acc 0.9792 p 0.9062 r 0.9062 f1 0.9062
step 60: train loss 0.1222 
cause_predict: train acc 0.9783 p 0.9394 r 0.9118 f1 0.9254
position_predict: train acc 0.9609 p 0.8966 r 0.8125 f1 0.8525
step 70: train loss 0.1331 
cause_predict: train acc 0.9926 p 0.9474 r 1.0000 f1 0.9730
position_predict: train acc 0.9480 p 0.7879 r 0.7879 f1 0.7879

epoch 13: test loss 0.7407 cost time: 11.2s

cause_predict: test acc 0.8820 p 0.5950 r 0.5237 f1 0.5570
max_acc 0.8883 max_p 0.6175 max_r 0.5552 max_f1 0.5847

position_predict: test acc 0.9142 p 0.6753 r 0.6376 f1 0.6559
max_acc 0.9240 max_p 0.7067 max_r 0.6969 max_f1 0.7018

Average max cause: max_acc 0.8883 max_p 0.6175 max_r 0.5552 max_f1 0.5847
Average max pos: max_acc 0.9223 max_p 0.7070 max_r 0.6725 max_f1 0.6893

step 10: train loss 0.1400 
cause_predict: train acc 0.9719 p 0.9118 r 0.8611 f1 0.8857
position_predict: train acc 0.9509 p 0.8214 r 0.7188 f1 0.7667
step 20: train loss 0.1049 
cause_predict: train acc 0.9844 p 0.9474 r 0.9474 f1 0.9474
position_predict: train acc 0.9688 p 0.9032 r 0.8485 f1 0.8750
step 30: train loss 0.0631 
cause_predict: train acc 1.0000 p 1.0000 r 1.0000 f1 1.0000
position_predict: train acc 0.9789 p 0.9062 r 0.9062 f1 0.9062
step 40: train loss 0.0948 
cause_predict: train acc 0.9883 p 0.9714 r 0.9714 f1 0.9714
position_predict: train acc 0.9766 p 0.9394 r 0.9394 f1 0.9394
step 50: train loss 0.0693 
cause_predict: train acc 0.9855 p 0.9211 r 1.0000 f1 0.9589
position_predict: train acc 0.9903 p 0.9697 r 0.9697 f1 0.9697
step 60: train loss 0.1022 
cause_predict: train acc 0.9844 p 0.9737 r 0.9487 f1 0.9610
position_predict: train acc 0.9792 p 0.9118 r 0.9688 f1 0.9394
step 70: train loss 0.2516 
cause_predict: train acc 0.9742 p 0.9189 r 0.8947 f1 0.9067
position_predict: train acc 0.9631 p 0.8235 r 0.8750 f1 0.8485

epoch 14: test loss 0.7853 cost time: 10.8s

cause_predict: test acc 0.8914 p 0.6445 r 0.5205 f1 0.5759
max_acc 0.8883 max_p 0.6175 max_r 0.5552 max_f1 0.5847

position_predict: test acc 0.9182 p 0.6912 r 0.6551 f1 0.6726
max_acc 0.9240 max_p 0.7067 max_r 0.6969 max_f1 0.7018

Average max cause: max_acc 0.8883 max_p 0.6175 max_r 0.5552 max_f1 0.5847
Average max pos: max_acc 0.9223 max_p 0.7070 max_r 0.6725 max_f1 0.6893

write pair_data/Ind_BiLSTM_1/fold_6_test.txt done
write pair_data/Ind_BiLSTM_1/fold_6_train.txt done
Optimization Finished!

############# fold 6 end ###############
############# fold 7 begin ###############
load data_file: data_combine_en/fold_7_train.txt
y_position.shape (2275, 75, 2)
y_cause.shape (2275, 75, 2)
x.shape (2275, 75, 30)
sen_len.shape (2275, 75)
doc_len.shape (2275,)
n_cut 107
load data done!

load data_file: data_combine_en/fold_7_test.txt
y_position.shape (284, 75, 2)
y_cause.shape (284, 75, 2)
x.shape (284, 75, 30)
sen_len.shape (284, 75)
doc_len.shape (284,)
n_cut 22
load data done!

train docs: 2275    test docs: 284
step 10: train loss 0.7796 
cause_predict: train acc 0.8605 p 0.0000 r 0.0000 f1 0.0000
position_predict: train acc 0.8721 p 0.0000 r 0.0000 f1 0.0000
step 20: train loss 0.7146 
cause_predict: train acc 0.8512 p 0.0000 r 0.0000 f1 0.0000
position_predict: train acc 0.8678 p 0.0000 r 0.0000 f1 0.0000
step 30: train loss 0.6592 
cause_predict: train acc 0.8491 p 0.0000 r 0.0000 f1 0.0000
position_predict: train acc 0.8578 p 1.0000 r 0.0294 f1 0.0571
step 40: train loss 0.6272 
cause_predict: train acc 0.8577 p 0.0000 r 0.0000 f1 0.0000
position_predict: train acc 0.8893 p 0.6087 r 0.4242 f1 0.5000
step 50: train loss 0.5750 
cause_predict: train acc 0.8672 p 1.0000 r 0.0857 f1 0.1579
position_predict: train acc 0.8838 p 0.5769 r 0.4688 f1 0.5172
step 60: train loss 0.6633 
cause_predict: train acc 0.8300 p 0.7778 r 0.1795 f1 0.2917
position_predict: train acc 0.9300 p 0.9500 r 0.5938 f1 0.7308
step 70: train loss 0.4597 
cause_predict: train acc 0.8761 p 0.3846 r 0.1316 f1 0.1961
position_predict: train acc 0.9547 p 0.8148 r 0.6875 f1 0.7458

epoch 0: test loss 0.5180 cost time: 11.0s

cause_predict: test acc 0.8744 p 0.7250 r 0.1830 f1 0.2922
max_acc 0.8744 max_p 0.7250 max_r 0.1830 max_f1 0.2922

position_predict: test acc 0.9138 p 0.6506 r 0.7073 f1 0.6778
max_acc 0.9138 max_p 0.6506 max_r 0.7073 max_f1 0.6778

Average max cause: max_acc 0.8744 max_p 0.7250 max_r 0.1830 max_f1 0.2922
Average max pos: max_acc 0.9138 max_p 0.6506 max_r 0.7073 max_f1 0.6778

step 10: train loss 0.5595 
cause_predict: train acc 0.9116 p 0.8947 r 0.5000 f1 0.6415
position_predict: train acc 0.8930 p 0.6800 r 0.5312 f1 0.5965
step 20: train loss 0.5681 
cause_predict: train acc 0.8519 p 0.7000 r 0.1944 f1 0.3043
position_predict: train acc 0.9259 p 0.8400 r 0.6364 f1 0.7241
step 30: train loss 0.4487 
cause_predict: train acc 0.8943 p 0.6875 r 0.3235 f1 0.4400
position_predict: train acc 0.9283 p 0.7241 r 0.6562 f1 0.6885
step 40: train loss 0.4815 
cause_predict: train acc 0.8764 p 0.8182 r 0.2308 f1 0.3600
position_predict: train acc 0.9382 p 0.9474 r 0.5455 f1 0.6923
step 50: train loss 0.4894 
cause_predict: train acc 0.8750 p 0.7692 r 0.2500 f1 0.3774
position_predict: train acc 0.9432 p 0.7576 r 0.7812 f1 0.7692
step 60: train loss 0.4959 
cause_predict: train acc 0.8809 p 0.4211 r 0.2286 f1 0.2963
position_predict: train acc 0.9060 p 0.5714 r 0.3636 f1 0.4444
step 70: train loss 0.6114 
cause_predict: train acc 0.8468 p 0.5217 r 0.3429 f1 0.4138
position_predict: train acc 0.9054 p 0.8333 r 0.4545 f1 0.5882

epoch 1: test loss 0.4767 cost time: 11.1s

cause_predict: test acc 0.8919 p 0.7517 r 0.3533 f1 0.4807
max_acc 0.8919 max_p 0.7517 max_r 0.3533 max_f1 0.4807

position_predict: test acc 0.9223 p 0.7165 r 0.6516 f1 0.6825
max_acc 0.9223 max_p 0.7165 max_r 0.6516 max_f1 0.6825

Average max cause: max_acc 0.8919 max_p 0.7517 max_r 0.3533 max_f1 0.4807
Average max pos: max_acc 0.9223 max_p 0.7165 max_r 0.6516 max_f1 0.6825

step 10: train loss 0.4753 
cause_predict: train acc 0.8915 p 0.6087 r 0.3784 f1 0.4667
position_predict: train acc 0.9153 p 0.6333 r 0.5758 f1 0.6032
step 20: train loss 0.5378 
cause_predict: train acc 0.8926 p 0.9286 r 0.3421 f1 0.5000
position_predict: train acc 0.9298 p 0.8077 r 0.6364 f1 0.7119
step 30: train loss 0.5438 
cause_predict: train acc 0.8579 p 0.7308 r 0.5000 f1 0.5937
position_predict: train acc 0.9290 p 0.8276 r 0.7500 f1 0.7869
step 40: train loss 0.4347 
cause_predict: train acc 0.8959 p 0.6250 r 0.4412 f1 0.5172
position_predict: train acc 0.9182 p 0.7200 r 0.5455 f1 0.6207
step 50: train loss 0.3575 
cause_predict: train acc 0.9073 p 0.8462 r 0.3333 f1 0.4783
position_predict: train acc 0.9498 p 0.8276 r 0.7500 f1 0.7869
step 60: train loss 0.5320 
cause_predict: train acc 0.8540 p 0.7500 r 0.2308 f1 0.3529
position_predict: train acc 0.9425 p 0.8065 r 0.7812 f1 0.7937
step 70: train loss 0.5160 
cause_predict: train acc 0.8610 p 0.6087 r 0.3889 f1 0.4746
position_predict: train acc 0.9372 p 0.8000 r 0.7500 f1 0.7742

epoch 2: test loss 0.4710 cost time: 11.1s

cause_predict: test acc 0.8870 p 0.7162 r 0.3344 f1 0.4559
max_acc 0.8919 max_p 0.7517 max_r 0.3533 max_f1 0.4807

position_predict: test acc 0.9267 p 0.7450 r 0.6516 f1 0.6952
max_acc 0.9267 max_p 0.7450 max_r 0.6516 max_f1 0.6952

Average max cause: max_acc 0.8919 max_p 0.7517 max_r 0.3533 max_f1 0.4807
Average max pos: max_acc 0.9223 max_p 0.7165 max_r 0.6516 max_f1 0.6825

step 10: train loss 0.3041 
cause_predict: train acc 0.9038 p 0.6667 r 0.4444 f1 0.5333
position_predict: train acc 0.9588 p 0.8387 r 0.7879 f1 0.8125
step 20: train loss 0.4809 
cause_predict: train acc 0.8808 p 0.5862 r 0.4722 f1 0.5231
position_predict: train acc 0.9077 p 0.6452 r 0.6061 f1 0.6250
step 30: train loss 0.5191 
cause_predict: train acc 0.8591 p 0.6000 r 0.4167 f1 0.4918
position_predict: train acc 0.9136 p 0.7241 r 0.6562 f1 0.6885
step 40: train loss 0.5206 
cause_predict: train acc 0.8861 p 0.7647 r 0.3611 f1 0.4906
position_predict: train acc 0.9114 p 0.7308 r 0.5758 f1 0.6441
step 50: train loss 0.3983 
cause_predict: train acc 0.9091 p 0.7143 r 0.4688 f1 0.5660
position_predict: train acc 0.9328 p 0.8261 r 0.5938 f1 0.6909
step 60: train loss 0.4213 
cause_predict: train acc 0.9308 p 1.0000 r 0.6562 f1 0.7925
position_predict: train acc 0.8805 p 0.7333 r 0.6667 f1 0.6984
step 70: train loss 0.4529 
cause_predict: train acc 0.9071 p 0.7600 r 0.5588 f1 0.6441
position_predict: train acc 0.9071 p 0.7391 r 0.5312 f1 0.6182

epoch 3: test loss 0.4793 cost time: 11.1s

cause_predict: test acc 0.8905 p 0.7368 r 0.3533 f1 0.4776
max_acc 0.8919 max_p 0.7517 max_r 0.3533 max_f1 0.4807

position_predict: test acc 0.9303 p 0.7417 r 0.7003 f1 0.7204
max_acc 0.9303 max_p 0.7417 max_r 0.7003 max_f1 0.7204

Average max cause: max_acc 0.8905 max_p 0.7368 max_r 0.3533 max_f1 0.4776
Average max pos: max_acc 0.9303 max_p 0.7417 max_r 0.7003 max_f1 0.7204

step 10: train loss 0.3404 
cause_predict: train acc 0.8972 p 0.9130 r 0.5122 f1 0.6562
position_predict: train acc 0.9626 p 0.8529 r 0.9062 f1 0.8788
step 20: train loss 0.2988 
cause_predict: train acc 0.9329 p 0.8333 r 0.5714 f1 0.6780
position_predict: train acc 0.9647 p 0.8667 r 0.8125 f1 0.8387
step 30: train loss 0.3721 
cause_predict: train acc 0.8984 p 0.6667 r 0.5714 f1 0.6154
position_predict: train acc 0.9512 p 0.9565 r 0.6667 f1 0.7857
step 40: train loss 0.2739 
cause_predict: train acc 0.9145 p 0.7083 r 0.5152 f1 0.5965
position_predict: train acc 0.9703 p 0.8750 r 0.8750 f1 0.8750
step 50: train loss 0.3542 
cause_predict: train acc 0.9062 p 0.6000 r 0.5455 f1 0.5714
position_predict: train acc 0.9410 p 0.7273 r 0.7500 f1 0.7385
step 60: train loss 0.3541 
cause_predict: train acc 0.9247 p 0.7619 r 0.4848 f1 0.5926
position_predict: train acc 0.9418 p 0.7143 r 0.7812 f1 0.7463
step 70: train loss 0.3920 
cause_predict: train acc 0.8951 p 0.8667 r 0.3171 f1 0.4643
position_predict: train acc 0.9441 p 0.7857 r 0.6875 f1 0.7333

epoch 4: test loss 0.4788 cost time: 11.1s

cause_predict: test acc 0.8914 p 0.6850 r 0.4322 f1 0.5300
max_acc 0.8914 max_p 0.6850 max_r 0.4322 max_f1 0.5300

position_predict: test acc 0.9200 p 0.6753 r 0.7247 f1 0.6992
max_acc 0.9303 max_p 0.7417 max_r 0.7003 max_f1 0.7204

Average max cause: max_acc 0.8914 max_p 0.6850 max_r 0.4322 max_f1 0.5300
Average max pos: max_acc 0.9200 max_p 0.6753 max_r 0.7247 max_f1 0.6992

step 10: train loss 0.2104 
cause_predict: train acc 0.9425 p 0.8846 r 0.6571 f1 0.7541
position_predict: train acc 0.9732 p 0.9310 r 0.8438 f1 0.8852
step 20: train loss 0.2368 
cause_predict: train acc 0.9375 p 0.8214 r 0.6389 f1 0.7187
position_predict: train acc 0.9722 p 0.8750 r 0.8750 f1 0.8750
step 30: train loss 0.4105 
cause_predict: train acc 0.9234 p 0.7333 r 0.6286 f1 0.6769
position_predict: train acc 0.9197 p 0.6786 r 0.5938 f1 0.6333
step 40: train loss 0.4121 
cause_predict: train acc 0.8784 p 0.7143 r 0.5128 f1 0.5970
position_predict: train acc 0.9640 p 0.9286 r 0.8125 f1 0.8667
step 50: train loss 0.3316 
cause_predict: train acc 0.9275 p 0.9167 r 0.6471 f1 0.7586
position_predict: train acc 0.9430 p 0.8387 r 0.8125 f1 0.8254
step 60: train loss 0.3466 
cause_predict: train acc 0.9136 p 0.8077 r 0.6000 f1 0.6885
position_predict: train acc 0.9318 p 0.7931 r 0.7188 f1 0.7541
step 70: train loss 0.5906 
cause_predict: train acc 0.8578 p 0.6129 r 0.5135 f1 0.5588
position_predict: train acc 0.8863 p 0.6429 r 0.5625 f1 0.6000

epoch 5: test loss 0.4981 cost time: 11.1s

cause_predict: test acc 0.8856 p 0.6533 r 0.4101 f1 0.5039
max_acc 0.8914 max_p 0.6850 max_r 0.4322 max_f1 0.5300

position_predict: test acc 0.9281 p 0.7500 r 0.6585 f1 0.7013
max_acc 0.9303 max_p 0.7417 max_r 0.7003 max_f1 0.7204

Average max cause: max_acc 0.8914 max_p 0.6850 max_r 0.4322 max_f1 0.5300
Average max pos: max_acc 0.9200 max_p 0.6753 max_r 0.7247 max_f1 0.6992

step 10: train loss 0.2140 
cause_predict: train acc 0.9514 p 0.7838 r 0.8286 f1 0.8056
position_predict: train acc 0.9583 p 0.8125 r 0.8125 f1 0.8125
step 20: train loss 0.2964 
cause_predict: train acc 0.9472 p 0.8182 r 0.7714 f1 0.7941
position_predict: train acc 0.9321 p 0.7273 r 0.7273 f1 0.7273
step 30: train loss 0.2687 
cause_predict: train acc 0.9438 p 0.8667 r 0.7027 f1 0.7761
position_predict: train acc 0.9551 p 0.8571 r 0.7500 f1 0.8000
step 40: train loss 0.3263 
cause_predict: train acc 0.9034 p 0.8421 r 0.4444 f1 0.5818
position_predict: train acc 0.9496 p 0.8333 r 0.7812 f1 0.8065
step 50: train loss 0.4216 
cause_predict: train acc 0.9170 p 0.7647 r 0.6842 f1 0.7222
position_predict: train acc 0.9378 p 0.7647 r 0.7879 f1 0.7761
step 60: train loss 0.2491 
cause_predict: train acc 0.9409 p 0.8621 r 0.6944 f1 0.7692
position_predict: train acc 0.9685 p 0.9000 r 0.8438 f1 0.8710
step 70: train loss 0.3772 
cause_predict: train acc 0.9238 p 0.7647 r 0.7429 f1 0.7536
position_predict: train acc 0.9327 p 0.7576 r 0.7812 f1 0.7692

epoch 6: test loss 0.5278 cost time: 11.2s

cause_predict: test acc 0.8870 p 0.6270 r 0.4984 f1 0.5554
max_acc 0.8870 max_p 0.6270 max_r 0.4984 max_f1 0.5554

position_predict: test acc 0.9191 p 0.6853 r 0.6829 f1 0.6841
max_acc 0.9303 max_p 0.7417 max_r 0.7003 max_f1 0.7204

Average max cause: max_acc 0.8870 max_p 0.6270 max_r 0.4984 max_f1 0.5554
Average max pos: max_acc 0.9191 max_p 0.6853 max_r 0.6829 max_f1 0.6841

step 10: train loss 0.2907 
cause_predict: train acc 0.9339 p 0.7353 r 0.7812 f1 0.7576
position_predict: train acc 0.9463 p 0.8065 r 0.7812 f1 0.7937
step 20: train loss 0.2229 
cause_predict: train acc 0.9628 p 0.9310 r 0.8182 f1 0.8710
position_predict: train acc 0.9535 p 0.8438 r 0.8438 f1 0.8438
step 30: train loss 0.3493 
cause_predict: train acc 0.9137 p 0.7857 r 0.5789 f1 0.6667
position_predict: train acc 0.9490 p 0.8333 r 0.7576 f1 0.7937
step 40: train loss 0.2801 
cause_predict: train acc 0.9350 p 0.8182 r 0.7941 f1 0.8060
position_predict: train acc 0.9500 p 0.8529 r 0.8529 f1 0.8529
step 50: train loss 0.3297 
cause_predict: train acc 0.9313 p 0.7647 r 0.7647 f1 0.7647
position_predict: train acc 0.9356 p 0.7576 r 0.7812 f1 0.7692
step 60: train loss 0.2075 
cause_predict: train acc 0.9514 p 0.8065 r 0.7576 f1 0.7812
position_predict: train acc 0.9792 p 0.9333 r 0.8750 f1 0.9032
step 70: train loss 0.3122 
cause_predict: train acc 0.9231 p 0.8065 r 0.6579 f1 0.7246
position_predict: train acc 0.9555 p 0.8667 r 0.7879 f1 0.8254

epoch 7: test loss 0.5528 cost time: 11.2s

cause_predict: test acc 0.8874 p 0.6182 r 0.5363 f1 0.5743
max_acc 0.8874 max_p 0.6182 max_r 0.5363 max_f1 0.5743

position_predict: test acc 0.9223 p 0.6982 r 0.6934 f1 0.6958
max_acc 0.9303 max_p 0.7417 max_r 0.7003 max_f1 0.7204

Average max cause: max_acc 0.8874 max_p 0.6182 max_r 0.5363 max_f1 0.5743
Average max pos: max_acc 0.9223 max_p 0.6982 max_r 0.6934 max_f1 0.6958

step 10: train loss 0.1172 
cause_predict: train acc 0.9705 p 0.9688 r 0.8378 f1 0.8986
position_predict: train acc 0.9831 p 0.9375 r 0.9375 f1 0.9375
step 20: train loss 0.2488 
cause_predict: train acc 0.9292 p 0.7778 r 0.7778 f1 0.7778
position_predict: train acc 0.9735 p 0.9062 r 0.9062 f1 0.9062
step 30: train loss 0.3169 
cause_predict: train acc 0.9441 p 0.8710 r 0.8438 f1 0.8571
position_predict: train acc 0.9317 p 0.8000 r 0.8750 f1 0.8358
step 40: train loss 0.3001 
cause_predict: train acc 0.9126 p 0.7812 r 0.7353 f1 0.7576
position_predict: train acc 0.9563 p 0.8750 r 0.8750 f1 0.8750
step 50: train loss 0.2504 
cause_predict: train acc 0.9748 p 0.9355 r 0.8788 f1 0.9062
position_predict: train acc 0.9160 p 0.7241 r 0.6364 f1 0.6774
step 60: train loss 0.2557 
cause_predict: train acc 0.9447 p 0.7838 r 0.8529 f1 0.8169
position_predict: train acc 0.9617 p 0.8485 r 0.8750 f1 0.8615
step 70: train loss 0.2216 
cause_predict: train acc 0.9536 p 0.8378 r 0.8611 f1 0.8493
position_predict: train acc 0.9494 p 0.8125 r 0.8125 f1 0.8125

epoch 8: test loss 0.5699 cost time: 10.6s

cause_predict: test acc 0.8905 p 0.6364 r 0.5300 f1 0.5783
max_acc 0.8905 max_p 0.6364 max_r 0.5300 max_f1 0.5783

position_predict: test acc 0.9155 p 0.6713 r 0.6690 f1 0.6702
max_acc 0.9303 max_p 0.7417 max_r 0.7003 max_f1 0.7204

Average max cause: max_acc 0.8874 max_p 0.6182 max_r 0.5363 max_f1 0.5743
Average max pos: max_acc 0.9223 max_p 0.6982 max_r 0.6934 max_f1 0.6958

step 10: train loss 0.1262 
cause_predict: train acc 0.9839 p 0.9412 r 0.9412 f1 0.9412
position_predict: train acc 0.9880 p 0.9688 r 0.9394 f1 0.9538
step 20: train loss 0.2507 
cause_predict: train acc 0.9673 p 0.9412 r 0.8649 f1 0.9014
position_predict: train acc 0.9393 p 0.7879 r 0.8125 f1 0.8000
step 30: train loss 0.2110 
cause_predict: train acc 0.9498 p 0.8750 r 0.7778 f1 0.8235
position_predict: train acc 0.9540 p 0.8485 r 0.8235 f1 0.8358
step 40: train loss 0.1947 
cause_predict: train acc 0.9508 p 0.8438 r 0.7941 f1 0.8182
position_predict: train acc 0.9713 p 0.9333 r 0.8485 f1 0.8889
step 50: train loss 0.1656 
cause_predict: train acc 0.9736 p 0.8378 r 0.9394 f1 0.8857
position_predict: train acc 0.9571 p 0.8065 r 0.7812 f1 0.7937
step 60: train loss 0.2343 
cause_predict: train acc 0.9406 p 0.8500 r 0.8500 f1 0.8500
position_predict: train acc 0.9752 p 0.8857 r 0.9688 f1 0.9254
step 70: train loss 0.2633 
cause_predict: train acc 0.9451 p 0.8788 r 0.7632 f1 0.8169
position_predict: train acc 0.9325 p 0.7353 r 0.7812 f1 0.7576

epoch 9: test loss 0.6180 cost time: 11.2s

cause_predict: test acc 0.8874 p 0.6045 r 0.5931 f1 0.5987
max_acc 0.8874 max_p 0.6045 max_r 0.5931 max_f1 0.5987

position_predict: test acc 0.9196 p 0.6974 r 0.6585 f1 0.6774
max_acc 0.9303 max_p 0.7417 max_r 0.7003 max_f1 0.7204

Average max cause: max_acc 0.8874 max_p 0.6045 max_r 0.5931 max_f1 0.5987
Average max pos: max_acc 0.9196 max_p 0.6974 max_r 0.6585 max_f1 0.6774

step 10: train loss 0.1510 
cause_predict: train acc 0.9855 p 0.9688 r 0.9394 f1 0.9538
position_predict: train acc 0.9662 p 0.8824 r 0.9091 f1 0.8955
step 20: train loss 0.1719 
cause_predict: train acc 0.9627 p 0.9355 r 0.8056 f1 0.8657
position_predict: train acc 0.9585 p 0.8235 r 0.8750 f1 0.8485
step 30: train loss 0.1192 
cause_predict: train acc 0.9732 p 0.9000 r 0.9000 f1 0.9000
position_predict: train acc 0.9900 p 0.9394 r 0.9688 f1 0.9538
step 40: train loss 0.1021 
cause_predict: train acc 0.9628 p 0.9143 r 0.8421 f1 0.8767
position_predict: train acc 0.9959 p 1.0000 r 0.9688 f1 0.9841
step 50: train loss 0.1056 
cause_predict: train acc 0.9778 p 0.9143 r 0.9143 f1 0.9143
position_predict: train acc 0.9852 p 0.9667 r 0.9062 f1 0.9355
step 60: train loss 0.2293 
cause_predict: train acc 0.9478 p 0.8158 r 0.8611 f1 0.8378
position_predict: train acc 0.9522 p 0.8000 r 0.8750 f1 0.8358
step 70: train loss 0.2016 
cause_predict: train acc 0.9530 p 0.9032 r 0.7778 f1 0.8358
position_predict: train acc 0.9573 p 0.8710 r 0.8182 f1 0.8438

epoch 10: test loss 0.6569 cost time: 11.1s

cause_predict: test acc 0.8807 p 0.5850 r 0.5426 f1 0.5630
max_acc 0.8874 max_p 0.6045 max_r 0.5931 max_f1 0.5987

position_predict: test acc 0.9129 p 0.6513 r 0.6899 f1 0.6701
max_acc 0.9303 max_p 0.7417 max_r 0.7003 max_f1 0.7204

Average max cause: max_acc 0.8874 max_p 0.6045 max_r 0.5931 max_f1 0.5987
Average max pos: max_acc 0.9196 max_p 0.6974 max_r 0.6585 max_f1 0.6774

step 10: train loss 0.0946 
cause_predict: train acc 0.9751 p 0.9429 r 0.8684 f1 0.9041
position_predict: train acc 0.9893 p 0.9677 r 0.9375 f1 0.9524
step 20: train loss 0.0818 
cause_predict: train acc 0.9841 p 0.8947 r 1.0000 f1 0.9444
position_predict: train acc 0.9801 p 0.9091 r 0.9375 f1 0.9231
step 30: train loss 0.1517 
cause_predict: train acc 0.9765 p 0.9062 r 0.9062 f1 0.9062
position_predict: train acc 0.9647 p 0.9000 r 0.8182 f1 0.8571
step 40: train loss 0.1956 
cause_predict: train acc 0.9505 p 0.8857 r 0.8378 f1 0.8611
position_predict: train acc 0.9653 p 0.8788 r 0.9062 f1 0.8923
step 50: train loss 0.1478 
cause_predict: train acc 0.9549 p 0.7619 r 0.9143 f1 0.8312
position_predict: train acc 0.9757 p 0.8824 r 0.9091 f1 0.8955
step 60: train loss 0.2044 
2024-06-22 18:50:25.957954: W tensorflow/c/c_api.cc:304] Operation '{name:'softmax_b_pos/Adam_1/Assign' id:5023 op device:{requested: '', assigned: ''} def:{{{node softmax_b_pos/Adam_1/Assign}} = Assign[T=DT_FLOAT, _class=["loc:@softmax_b_pos"], _has_manual_control_dependencies=true, use_locking=true, validate_shape=true](softmax_b_pos/Adam_1, softmax_b_pos/Adam_1/Initializer/zeros)}}' was changed by setting attribute after it was run by a session. This mutation will have no effect, and will trigger an error in the future. Either don't modify nodes after running them or create a new session.
cause_predict: train acc 0.9555 p 0.8529 r 0.8286 f1 0.8406
position_predict: train acc 0.9555 p 0.8387 r 0.8125 f1 0.8254
step 70: train loss 0.2041 
cause_predict: train acc 0.9777 p 0.9394 r 0.8857 f1 0.9118
position_predict: train acc 0.9628 p 0.8235 r 0.8750 f1 0.8485

epoch 11: test loss 0.6859 cost time: 11.1s

cause_predict: test acc 0.8771 p 0.5724 r 0.5237 f1 0.5470
max_acc 0.8874 max_p 0.6045 max_r 0.5931 max_f1 0.5987

position_predict: test acc 0.9088 p 0.6416 r 0.6551 f1 0.6483
max_acc 0.9303 max_p 0.7417 max_r 0.7003 max_f1 0.7204

Average max cause: max_acc 0.8874 max_p 0.6045 max_r 0.5931 max_f1 0.5987
Average max pos: max_acc 0.9196 max_p 0.6974 max_r 0.6585 max_f1 0.6774

step 10: train loss 0.1065 
cause_predict: train acc 0.9853 p 0.9167 r 0.9706 f1 0.9429
position_predict: train acc 0.9744 p 0.8824 r 0.9091 f1 0.8955
step 20: train loss 0.1125 
cause_predict: train acc 0.9630 p 0.9231 r 0.9000 f1 0.9114
position_predict: train acc 0.9947 p 1.0000 r 0.9688 f1 0.9841
step 30: train loss 0.1498 
cause_predict: train acc 0.9683 p 0.8919 r 0.8462 f1 0.8684
position_predict: train acc 0.9810 p 0.9355 r 0.8788 f1 0.9062
step 40: train loss 0.1447 
cause_predict: train acc 0.9544 p 0.8824 r 0.8108 f1 0.8451
position_predict: train acc 0.9834 p 0.9143 r 0.9697 f1 0.9412
step 50: train loss 0.1225 
cause_predict: train acc 0.9763 p 0.9231 r 0.9231 f1 0.9231
position_predict: train acc 0.9802 p 0.9355 r 0.9062 f1 0.9206
step 60: train loss 0.1742 
cause_predict: train acc 0.9654 p 0.9143 r 0.8649 f1 0.8889
position_predict: train acc 0.9697 p 0.9032 r 0.8750 f1 0.8889
step 70: train loss 0.1060 
cause_predict: train acc 0.9852 p 0.9688 r 0.9118 f1 0.9394
position_predict: train acc 0.9778 p 0.9333 r 0.8750 f1 0.9032

epoch 12: test loss 0.6879 cost time: 11.0s

cause_predict: test acc 0.8919 p 0.6471 r 0.5205 f1 0.5769
max_acc 0.8874 max_p 0.6045 max_r 0.5931 max_f1 0.5987

position_predict: test acc 0.9164 p 0.6799 r 0.6585 f1 0.6690
max_acc 0.9303 max_p 0.7417 max_r 0.7003 max_f1 0.7204

Average max cause: max_acc 0.8874 max_p 0.6045 max_r 0.5931 max_f1 0.5987
Average max pos: max_acc 0.9196 max_p 0.6974 max_r 0.6585 max_f1 0.6774

step 10: train loss 0.0614 
cause_predict: train acc 0.9949 p 1.0000 r 0.9714 f1 0.9855
position_predict: train acc 0.9949 p 1.0000 r 0.9688 f1 0.9841
step 20: train loss 0.1507 
cause_predict: train acc 0.9644 p 0.9143 r 0.8421 f1 0.8767
position_predict: train acc 0.9723 p 0.8824 r 0.9091 f1 0.8955
step 30: train loss 0.1264 
cause_predict: train acc 0.9702 p 0.8889 r 0.8649 f1 0.8767
position_predict: train acc 0.9801 p 0.9062 r 0.9062 f1 0.9062
step 40: train loss 0.1155 
cause_predict: train acc 0.9801 p 0.9394 r 0.8857 f1 0.9118
position_predict: train acc 0.9734 p 0.8750 r 0.8750 f1 0.8750
step 50: train loss 0.1840 
cause_predict: train acc 0.9784 p 0.9143 r 0.9412 f1 0.9275
position_predict: train acc 0.9612 p 0.8710 r 0.8438 f1 0.8571
step 60: train loss 0.1154 
cause_predict: train acc 0.9886 p 0.9722 r 0.9459 f1 0.9589
position_predict: train acc 0.9811 p 0.9375 r 0.9091 f1 0.9231
step 70: train loss 0.2384 
cause_predict: train acc 0.9550 p 0.8857 r 0.8378 f1 0.8611
position_predict: train acc 0.9505 p 0.8000 r 0.8750 f1 0.8358

epoch 13: test loss 0.6811 cost time: 11.1s

cause_predict: test acc 0.8816 p 0.5833 r 0.5741 f1 0.5787
max_acc 0.8874 max_p 0.6045 max_r 0.5931 max_f1 0.5987

position_predict: test acc 0.9151 p 0.6702 r 0.6655 f1 0.6678
max_acc 0.9303 max_p 0.7417 max_r 0.7003 max_f1 0.7204

Average max cause: max_acc 0.8874 max_p 0.6045 max_r 0.5931 max_f1 0.5987
Average max pos: max_acc 0.9196 max_p 0.6974 max_r 0.6585 max_f1 0.6774

step 10: train loss 0.0867 
cause_predict: train acc 0.9835 p 0.9459 r 0.9722 f1 0.9589
position_predict: train acc 0.9835 p 0.9394 r 0.9688 f1 0.9538
step 20: train loss 0.0784 
cause_predict: train acc 0.9785 p 1.0000 r 0.8571 f1 0.9231
position_predict: train acc 0.9914 p 0.9688 r 0.9688 f1 0.9688
step 30: train loss 0.0838 
cause_predict: train acc 0.9753 p 0.9118 r 0.9118 f1 0.9118
position_predict: train acc 0.9877 p 1.0000 r 0.9091 f1 0.9524
step 40: train loss 0.0869 
cause_predict: train acc 0.9920 p 0.9714 r 0.9714 f1 0.9714
position_predict: train acc 0.9800 p 0.9655 r 0.8750 f1 0.9180
step 50: train loss 0.1288 
cause_predict: train acc 0.9708 p 0.8857 r 0.9118 f1 0.8986
position_predict: train acc 0.9667 p 0.9000 r 0.8438 f1 0.8710
step 60: train loss 0.1512 
cause_predict: train acc 0.9663 p 0.8857 r 0.9118 f1 0.8986
position_predict: train acc 0.9808 p 0.9375 r 0.9375 f1 0.9375
step 70: train loss 0.1654 
cause_predict: train acc 0.9675 p 0.8750 r 0.8485 f1 0.8615
position_predict: train acc 0.9675 p 0.8710 r 0.8438 f1 0.8571

epoch 14: test loss 0.7819 cost time: 11.0s

cause_predict: test acc 0.8829 p 0.5993 r 0.5237 f1 0.5589
max_acc 0.8874 max_p 0.6045 max_r 0.5931 max_f1 0.5987

position_predict: test acc 0.9191 p 0.6893 r 0.6725 f1 0.6808
max_acc 0.9303 max_p 0.7417 max_r 0.7003 max_f1 0.7204

Average max cause: max_acc 0.8874 max_p 0.6045 max_r 0.5931 max_f1 0.5987
Average max pos: max_acc 0.9196 max_p 0.6974 max_r 0.6585 max_f1 0.6774

write pair_data/Ind_BiLSTM_1/fold_7_test.txt done
write pair_data/Ind_BiLSTM_1/fold_7_train.txt done
Optimization Finished!

############# fold 7 end ###############
############# fold 8 begin ###############
load data_file: data_combine_en/fold_8_train.txt
y_position.shape (2275, 75, 2)
y_cause.shape (2275, 75, 2)
x.shape (2275, 75, 30)
sen_len.shape (2275, 75)
doc_len.shape (2275,)
n_cut 107
load data done!

load data_file: data_combine_en/fold_8_test.txt
y_position.shape (284, 75, 2)
y_cause.shape (284, 75, 2)
x.shape (284, 75, 30)
sen_len.shape (284, 75)
doc_len.shape (284,)
n_cut 22
load data done!

train docs: 2275    test docs: 284
step 10: train loss 0.8509 
cause_predict: train acc 0.8333 p 0.0000 r 0.0000 f1 0.0000
position_predict: train acc 0.8431 p 0.0000 r 0.0000 f1 0.0000
step 20: train loss 0.7645 
cause_predict: train acc 0.8406 p 0.0000 r 0.0000 f1 0.0000
position_predict: train acc 0.8454 p 0.0000 r 0.0000 f1 0.0000
step 30: train loss 0.7552 
cause_predict: train acc 0.8203 p 0.0000 r 0.0000 f1 0.0000
position_predict: train acc 0.8525 p 0.0000 r 0.0000 f1 0.0000
step 40: train loss 0.7034 
cause_predict: train acc 0.8203 p 1.0000 r 0.0250 f1 0.0488
position_predict: train acc 0.8894 p 0.7500 r 0.3750 f1 0.5000
step 50: train loss 0.5748 
cause_predict: train acc 0.8950 p 1.0000 r 0.2424 f1 0.3902
position_predict: train acc 0.9034 p 0.7037 r 0.5588 f1 0.6230
step 60: train loss 0.6326 
cause_predict: train acc 0.8253 p 0.6000 r 0.0732 f1 0.1304
position_predict: train acc 0.9170 p 0.7600 r 0.5938 f1 0.6667
step 70: train loss 0.5442 
cause_predict: train acc 0.8494 p 0.6000 r 0.0811 f1 0.1429
position_predict: train acc 0.9121 p 0.7200 r 0.5625 f1 0.6316

epoch 0: test loss 0.5048 cost time: 11.0s

cause_predict: test acc 0.8861 p 0.6867 r 0.3596 f1 0.4720
max_acc 0.8861 max_p 0.6867 max_r 0.3596 max_f1 0.4720

position_predict: test acc 0.9205 p 0.7946 r 0.5122 f1 0.6229
max_acc 0.9205 max_p 0.7946 max_r 0.5122 max_f1 0.6229

Average max cause: max_acc 0.8861 max_p 0.6867 max_r 0.3596 max_f1 0.4720
Average max pos: max_acc 0.9205 max_p 0.7946 max_r 0.5122 max_f1 0.6229

step 10: train loss 0.6709 
cause_predict: train acc 0.8545 p 0.6923 r 0.2500 f1 0.3673
position_predict: train acc 0.8873 p 0.6429 r 0.5625 f1 0.6000
step 20: train loss 0.4723 
cause_predict: train acc 0.8867 p 0.7273 r 0.2353 f1 0.3556
position_predict: train acc 0.9219 p 0.7143 r 0.6250 f1 0.6667
step 30: train loss 0.4125 
cause_predict: train acc 0.9018 p 0.6667 r 0.3125 f1 0.4255
position_predict: train acc 0.9200 p 0.6667 r 0.6250 f1 0.6452
step 40: train loss 0.5328 
cause_predict: train acc 0.8828 p 0.6429 r 0.2368 f1 0.3462
position_predict: train acc 0.9069 p 0.6071 r 0.5152 f1 0.5574
step 50: train loss 0.4787 
cause_predict: train acc 0.8635 p 0.5000 r 0.1250 f1 0.2000
position_predict: train acc 0.9352 p 0.7333 r 0.6667 f1 0.6984
step 60: train loss 0.4325 
cause_predict: train acc 0.8923 p 0.6552 r 0.4634 f1 0.5429
position_predict: train acc 0.9428 p 0.7143 r 0.7812 f1 0.7463
step 70: train loss 0.6043 
cause_predict: train acc 0.8485 p 0.6364 r 0.1842 f1 0.2857
position_predict: train acc 0.9177 p 0.8421 r 0.5000 f1 0.6275

epoch 1: test loss 0.4796 cost time: 11.1s

cause_predict: test acc 0.8910 p 0.7450 r 0.3502 f1 0.4764
max_acc 0.8910 max_p 0.7450 max_r 0.3502 max_f1 0.4764

position_predict: test acc 0.9205 p 0.7189 r 0.6237 f1 0.6679
max_acc 0.9205 max_p 0.7189 max_r 0.6237 max_f1 0.6679

Average max cause: max_acc 0.8910 max_p 0.7450 max_r 0.3502 max_f1 0.4764
Average max pos: max_acc 0.9205 max_p 0.7189 max_r 0.6237 max_f1 0.6679

step 10: train loss 0.5180 
cause_predict: train acc 0.8333 p 0.5000 r 0.2941 f1 0.3704
position_predict: train acc 0.9216 p 0.7353 r 0.7812 f1 0.7576
step 20: train loss 0.5128 
cause_predict: train acc 0.8745 p 0.7826 r 0.4186 f1 0.5455
position_predict: train acc 0.9289 p 0.7667 r 0.6970 f1 0.7302
step 30: train loss 0.4924 
cause_predict: train acc 0.8744 p 0.6552 r 0.5278 f1 0.5846
position_predict: train acc 0.9116 p 0.6857 r 0.7500 f1 0.7164
step 40: train loss 0.4783 
cause_predict: train acc 0.8836 p 0.6875 r 0.3333 f1 0.4490
position_predict: train acc 0.9310 p 0.7667 r 0.7188 f1 0.7419
step 50: train loss 0.4958 
cause_predict: train acc 0.8777 p 0.8125 r 0.3421 f1 0.4815
position_predict: train acc 0.9083 p 0.7143 r 0.6061 f1 0.6557
step 60: train loss 0.5098 
cause_predict: train acc 0.8872 p 0.7143 r 0.2857 f1 0.4082
position_predict: train acc 0.8755 p 0.5217 r 0.3636 f1 0.4286
step 70: train loss 0.5025 
cause_predict: train acc 0.8723 p 0.6111 r 0.2821 f1 0.3860
position_predict: train acc 0.9307 p 0.7600 r 0.5938 f1 0.6667

epoch 2: test loss 0.4742 cost time: 11.1s

cause_predict: test acc 0.8829 p 0.6291 r 0.4227 f1 0.5057
max_acc 0.8829 max_p 0.6291 max_r 0.4227 max_f1 0.5057

position_predict: test acc 0.9236 p 0.7302 r 0.6411 f1 0.6827
max_acc 0.9236 max_p 0.7302 max_r 0.6411 max_f1 0.6827

Average max cause: max_acc 0.8829 max_p 0.6291 max_r 0.4227 max_f1 0.5057
Average max pos: max_acc 0.9236 max_p 0.7302 max_r 0.6411 max_f1 0.6827

step 10: train loss 0.3515 
cause_predict: train acc 0.9195 p 0.8421 r 0.4706 f1 0.6038
position_predict: train acc 0.9502 p 0.8125 r 0.7879 f1 0.8000
step 20: train loss 0.4806 
cause_predict: train acc 0.8929 p 0.7222 r 0.3421 f1 0.4643
position_predict: train acc 0.9429 p 0.7500 r 0.7500 f1 0.7500
step 30: train loss 0.3458 
cause_predict: train acc 0.9132 p 0.8182 r 0.5143 f1 0.6316
position_predict: train acc 0.9256 p 0.7586 r 0.6667 f1 0.7097
step 40: train loss 0.4565 
cause_predict: train acc 0.8889 p 0.6842 r 0.3714 f1 0.4815
position_predict: train acc 0.8968 p 0.6000 r 0.5625 f1 0.5806
step 50: train loss 0.4456 
cause_predict: train acc 0.8954 p 0.7619 r 0.4444 f1 0.5614
position_predict: train acc 0.9121 p 0.7308 r 0.5758 f1 0.6441
step 60: train loss 0.4297 
cause_predict: train acc 0.8866 p 0.7222 r 0.3714 f1 0.4906
position_predict: train acc 0.9328 p 0.7742 r 0.7273 f1 0.7500
step 70: train loss 0.5550 
cause_predict: train acc 0.8702 p 0.6429 r 0.5143 f1 0.5714
position_predict: train acc 0.8990 p 0.6667 r 0.6875 f1 0.6769

epoch 3: test loss 0.4779 cost time: 10.7s

cause_predict: test acc 0.8905 p 0.6565 r 0.4763 f1 0.5521
max_acc 0.8905 max_p 0.6565 max_r 0.4763 max_f1 0.5521

position_predict: test acc 0.9209 p 0.7007 r 0.6690 f1 0.6845
max_acc 0.9209 max_p 0.7007 max_r 0.6690 max_f1 0.6845

Average max cause: max_acc 0.8905 max_p 0.6565 max_r 0.4763 max_f1 0.5521
Average max pos: max_acc 0.9209 max_p 0.7007 max_r 0.6690 max_f1 0.6845

step 10: train loss 0.4416 
cause_predict: train acc 0.8680 p 0.7241 r 0.5385 f1 0.6176
position_predict: train acc 0.9289 p 0.8000 r 0.7500 f1 0.7742
step 20: train loss 0.3437 
cause_predict: train acc 0.9020 p 0.6667 r 0.6486 f1 0.6575
position_predict: train acc 0.9373 p 0.8077 r 0.6562 f1 0.7241
step 30: train loss 0.4042 
cause_predict: train acc 0.9083 p 0.7667 r 0.6389 f1 0.6970
position_predict: train acc 0.9312 p 0.7742 r 0.7500 f1 0.7619
step 40: train loss 0.4391 
cause_predict: train acc 0.9032 p 0.6923 r 0.5294 f1 0.6000
position_predict: train acc 0.9113 p 0.6923 r 0.5625 f1 0.6207
step 50: train loss 0.4064 
cause_predict: train acc 0.9044 p 0.6429 r 0.5000 f1 0.5625
position_predict: train acc 0.9454 p 0.7500 r 0.7500 f1 0.7500
step 60: train loss 0.4738 
cause_predict: train acc 0.9082 p 0.7857 r 0.6471 f1 0.7097
position_predict: train acc 0.9235 p 0.7429 r 0.8125 f1 0.7761
step 70: train loss 0.2919 
cause_predict: train acc 0.9236 p 0.7727 r 0.4722 f1 0.5862
position_predict: train acc 0.9618 p 0.8621 r 0.7576 f1 0.8065

epoch 4: test loss 0.4634 cost time: 10.3s

cause_predict: test acc 0.8937 p 0.6985 r 0.4385 f1 0.5388
max_acc 0.8905 max_p 0.6565 max_r 0.4763 max_f1 0.5521

position_predict: test acc 0.9254 p 0.7041 r 0.7213 f1 0.7126
max_acc 0.9254 max_p 0.7041 max_r 0.7213 max_f1 0.7126

Average max cause: max_acc 0.8937 max_p 0.6985 max_r 0.4385 max_f1 0.5388
Average max pos: max_acc 0.9254 max_p 0.7041 max_r 0.7213 max_f1 0.7126

step 10: train loss 0.4715 
cause_predict: train acc 0.8670 p 0.6786 r 0.4872 f1 0.5672
position_predict: train acc 0.9128 p 0.6757 r 0.7812 f1 0.7246
step 20: train loss 0.2763 
cause_predict: train acc 0.9577 p 0.8485 r 0.8235 f1 0.8358
position_predict: train acc 0.9654 p 0.8710 r 0.8438 f1 0.8571
step 30: train loss 0.4071 
cause_predict: train acc 0.8968 p 0.6667 r 0.5143 f1 0.5806
position_predict: train acc 0.9444 p 0.8214 r 0.7188 f1 0.7667
step 40: train loss 0.3332 
cause_predict: train acc 0.9106 p 0.7500 r 0.6000 f1 0.6667
position_predict: train acc 0.9617 p 0.9259 r 0.7812 f1 0.8475
step 50: train loss 0.2984 
cause_predict: train acc 0.9094 p 0.7097 r 0.5641 f1 0.6286
position_predict: train acc 0.9721 p 0.9000 r 0.8438 f1 0.8710
step 60: train loss 0.3235 
cause_predict: train acc 0.9251 p 0.7742 r 0.7059 f1 0.7385
position_predict: train acc 0.9383 p 0.8000 r 0.7500 f1 0.7742
step 70: train loss 0.4044 
cause_predict: train acc 0.8894 p 0.7241 r 0.5526 f1 0.6269
position_predict: train acc 0.9381 p 0.7812 r 0.7812 f1 0.7812

epoch 5: test loss 0.4950 cost time: 10.4s

cause_predict: test acc 0.8870 p 0.6684 r 0.4006 f1 0.5010
max_acc 0.8905 max_p 0.6565 max_r 0.4763 max_f1 0.5521

position_predict: test acc 0.9187 p 0.6937 r 0.6551 f1 0.6738
max_acc 0.9254 max_p 0.7041 max_r 0.7213 max_f1 0.7126

Average max cause: max_acc 0.8937 max_p 0.6985 max_r 0.4385 max_f1 0.5388
Average max pos: max_acc 0.9254 max_p 0.7041 max_r 0.7213 max_f1 0.7126

step 10: train loss 0.4172 
cause_predict: train acc 0.8966 p 0.7059 r 0.5854 f1 0.6400
position_predict: train acc 0.9464 p 0.7647 r 0.8125 f1 0.7879
step 20: train loss 0.3326 
cause_predict: train acc 0.9194 p 0.7407 r 0.5714 f1 0.6452
position_predict: train acc 0.9451 p 0.7812 r 0.7576 f1 0.7692
step 30: train loss 0.2736 
cause_predict: train acc 0.9178 p 0.7407 r 0.5405 f1 0.6250
position_predict: train acc 0.9623 p 0.8710 r 0.7941 f1 0.8308
step 40: train loss 0.3252 
cause_predict: train acc 0.9409 p 0.7500 r 0.8182 f1 0.7826
position_predict: train acc 0.9331 p 0.7857 r 0.6667 f1 0.7213
step 50: train loss 0.2950 
cause_predict: train acc 0.9396 p 0.7742 r 0.6857 f1 0.7273
position_predict: train acc 0.9631 p 0.8667 r 0.7879 f1 0.8254
step 60: train loss 0.3765 
cause_predict: train acc 0.9170 p 0.7812 r 0.6757 f1 0.7246
position_predict: train acc 0.9389 p 0.7812 r 0.7812 f1 0.7812
step 70: train loss 0.2732 
cause_predict: train acc 0.9187 p 0.6970 r 0.6970 f1 0.6970
position_predict: train acc 0.9634 p 0.8710 r 0.8438 f1 0.8571

epoch 6: test loss 0.5173 cost time: 10.5s

cause_predict: test acc 0.8928 p 0.6559 r 0.5110 f1 0.5745
max_acc 0.8928 max_p 0.6559 max_r 0.5110 max_f1 0.5745

position_predict: test acc 0.9231 p 0.6923 r 0.7213 f1 0.7065
max_acc 0.9254 max_p 0.7041 max_r 0.7213 max_f1 0.7126

Average max cause: max_acc 0.8928 max_p 0.6559 max_r 0.5110 max_f1 0.5745
Average max pos: max_acc 0.9231 max_p 0.6923 max_r 0.7213 max_f1 0.7065

step 10: train loss 0.3294 
cause_predict: train acc 0.9224 p 0.8077 r 0.6364 f1 0.7119
position_predict: train acc 0.9361 p 0.7812 r 0.7812 f1 0.7812
step 20: train loss 0.3292 
cause_predict: train acc 0.9273 p 0.8846 r 0.6389 f1 0.7419
position_predict: train acc 0.9591 p 0.8966 r 0.8125 f1 0.8525
step 30: train loss 0.3992 
cause_predict: train acc 0.9265 p 0.8000 r 0.7273 f1 0.7619
position_predict: train acc 0.9069 p 0.6970 r 0.7188 f1 0.7077
step 40: train loss 0.1816 
cause_predict: train acc 0.9522 p 0.8056 r 0.8056 f1 0.8056
position_predict: train acc 0.9659 p 0.9000 r 0.7941 f1 0.8438
step 50: train loss 0.2699 
cause_predict: train acc 0.9367 p 0.7714 r 0.8182 f1 0.7941
position_predict: train acc 0.9457 p 0.8182 r 0.8182 f1 0.8182
step 60: train loss 0.2637 
cause_predict: train acc 0.9362 p 0.7714 r 0.7941 f1 0.7826
position_predict: train acc 0.9489 p 0.8621 r 0.7576 f1 0.8065
step 70: train loss 0.2349 
cause_predict: train acc 0.9351 p 0.8276 r 0.7059 f1 0.7619
position_predict: train acc 0.9740 p 0.9355 r 0.8788 f1 0.9062

epoch 7: test loss 0.5591 cost time: 10.5s

cause_predict: test acc 0.8856 p 0.6093 r 0.5363 f1 0.5705
max_acc 0.8928 max_p 0.6559 max_r 0.5110 max_f1 0.5745

position_predict: test acc 0.9187 p 0.6768 r 0.7003 f1 0.6884
max_acc 0.9254 max_p 0.7041 max_r 0.7213 max_f1 0.7126

Average max cause: max_acc 0.8928 max_p 0.6559 max_r 0.5110 max_f1 0.5745
Average max pos: max_acc 0.9231 max_p 0.6923 max_r 0.7213 max_f1 0.7065

step 10: train loss 0.1976 
cause_predict: train acc 0.9671 p 0.9655 r 0.8235 f1 0.8889
position_predict: train acc 0.9671 p 0.9032 r 0.8750 f1 0.8889
step 20: train loss 0.2052 
cause_predict: train acc 0.9447 p 0.9062 r 0.7838 f1 0.8406
position_predict: train acc 0.9648 p 0.9032 r 0.8750 f1 0.8889
step 30: train loss 0.1177 
cause_predict: train acc 0.9762 p 0.9211 r 0.9211 f1 0.9211
position_predict: train acc 0.9841 p 0.9677 r 0.9091 f1 0.9375
step 40: train loss 0.1464 
cause_predict: train acc 0.9693 p 0.9375 r 0.8333 f1 0.8824
position_predict: train acc 0.9808 p 0.8857 r 0.9688 f1 0.9254
step 50: train loss 0.3698 
cause_predict: train acc 0.9259 p 0.7500 r 0.7941 f1 0.7714
position_predict: train acc 0.9398 p 0.7714 r 0.8438 f1 0.8060
step 60: train loss 0.2445 
cause_predict: train acc 0.9388 p 0.7879 r 0.7222 f1 0.7536
position_predict: train acc 0.9496 p 0.7812 r 0.7812 f1 0.7812
step 70: train loss 0.1765 
cause_predict: train acc 0.9697 p 0.9394 r 0.8857 f1 0.9118
position_predict: train acc 0.9444 p 0.8182 r 0.8438 f1 0.8308

epoch 8: test loss 0.5413 cost time: 10.6s

cause_predict: test acc 0.8923 p 0.6367 r 0.5584 f1 0.5950
max_acc 0.8923 max_p 0.6367 max_r 0.5584 max_f1 0.5950

position_predict: test acc 0.9218 p 0.7014 r 0.6794 f1 0.6903
max_acc 0.9254 max_p 0.7041 max_r 0.7213 max_f1 0.7126

Average max cause: max_acc 0.8923 max_p 0.6367 max_r 0.5584 max_f1 0.5950
Average max pos: max_acc 0.9218 max_p 0.7014 max_r 0.6794 max_f1 0.6903

step 10: train loss 0.1123 
cause_predict: train acc 0.9718 p 0.9677 r 0.8571 f1 0.9091
position_predict: train acc 0.9859 p 0.9394 r 0.9688 f1 0.9538
step 20: train loss 0.2429 
cause_predict: train acc 0.9388 p 0.8788 r 0.7838 f1 0.8286
position_predict: train acc 0.9643 p 0.8824 r 0.9091 f1 0.8955
step 30: train loss 0.1839 
cause_predict: train acc 0.9644 p 0.8750 r 0.8235 f1 0.8485
position_predict: train acc 0.9609 p 0.8235 r 0.8485 f1 0.8358
step 40: train loss 0.1526 
cause_predict: train acc 0.9598 p 0.8857 r 0.8378 f1 0.8611
position_predict: train acc 0.9759 p 0.9355 r 0.8788 f1 0.9062
step 50: train loss 0.1145 
cause_predict: train acc 0.9829 p 0.9688 r 0.8857 f1 0.9254
position_predict: train acc 0.9727 p 0.9000 r 0.8438 f1 0.8710
step 60: train loss 0.1915 
cause_predict: train acc 0.9677 p 0.9167 r 0.8684 f1 0.8919
position_predict: train acc 0.9556 p 0.8621 r 0.7812 f1 0.8197
step 70: train loss 0.1992 
cause_predict: train acc 0.9495 p 0.8235 r 0.7778 f1 0.8000
position_predict: train acc 0.9711 p 0.8750 r 0.8750 f1 0.8750

epoch 9: test loss 0.6093 cost time: 10.6s

cause_predict: test acc 0.8776 p 0.5765 r 0.5110 f1 0.5418
max_acc 0.8923 max_p 0.6367 max_r 0.5584 max_f1 0.5950

position_predict: test acc 0.9187 p 0.6868 r 0.6725 f1 0.6796
max_acc 0.9254 max_p 0.7041 max_r 0.7213 max_f1 0.7126

Average max cause: max_acc 0.8923 max_p 0.6367 max_r 0.5584 max_f1 0.5950
Average max pos: max_acc 0.9218 max_p 0.7014 max_r 0.6794 max_f1 0.6903

step 10: train loss 0.2827 
cause_predict: train acc 0.9331 p 0.9091 r 0.6977 f1 0.7895
position_predict: train acc 0.9582 p 0.8667 r 0.8125 f1 0.8387
step 20: train loss 0.1327 
cause_predict: train acc 0.9609 p 1.0000 r 0.7353 f1 0.8475
position_predict: train acc 0.9826 p 0.9375 r 0.9375 f1 0.9375
step 30: train loss 0.3467 
cause_predict: train acc 0.9257 p 0.7568 r 0.8235 f1 0.7887
position_predict: train acc 0.9604 p 0.8750 r 0.8750 f1 0.8750
step 40: train loss 0.1935 
cause_predict: train acc 0.9615 p 0.8049 r 0.9167 f1 0.8571
position_predict: train acc 0.9755 p 0.9032 r 0.8750 f1 0.8889
step 50: train loss 0.3356 
cause_predict: train acc 0.9320 p 0.8065 r 0.6944 f1 0.7463
position_predict: train acc 0.9440 p 0.7647 r 0.8125 f1 0.7879
step 60: train loss 0.1711 
cause_predict: train acc 0.9710 p 0.9091 r 0.8824 f1 0.8955
position_predict: train acc 0.9710 p 0.9032 r 0.8750 f1 0.8889
step 70: train loss 0.2939 
cause_predict: train acc 0.9070 p 0.7500 r 0.8333 f1 0.7895
position_predict: train acc 0.9651 p 0.8824 r 0.9375 f1 0.9091

epoch 10: test loss 0.6213 cost time: 10.4s

cause_predict: test acc 0.8731 p 0.5487 r 0.5868 f1 0.5671
max_acc 0.8923 max_p 0.6367 max_r 0.5584 max_f1 0.5950

position_predict: test acc 0.9209 p 0.6978 r 0.6760 f1 0.6867
max_acc 0.9254 max_p 0.7041 max_r 0.7213 max_f1 0.7126

Average max cause: max_acc 0.8923 max_p 0.6367 max_r 0.5584 max_f1 0.5950
Average max pos: max_acc 0.9218 max_p 0.7014 max_r 0.6794 max_f1 0.6903

step 10: train loss 0.0750 
cause_predict: train acc 0.9883 p 0.9697 r 0.9143 f1 0.9412
position_predict: train acc 0.9824 p 0.9643 r 0.8438 f1 0.9000
step 20: train loss 0.1708 
cause_predict: train acc 0.9682 p 0.9091 r 0.8824 f1 0.8955
position_predict: train acc 0.9591 p 0.8485 r 0.8750 f1 0.8615
step 30: train loss 0.0724 
cause_predict: train acc 0.9831 p 0.9189 r 0.9714 f1 0.9444
position_predict: train acc 0.9831 p 0.9118 r 0.9688 f1 0.9394
step 40: train loss 0.1310 
cause_predict: train acc 0.9780 p 0.9697 r 0.8649 f1 0.9143
position_predict: train acc 0.9890 p 1.0000 r 0.9062 f1 0.9508
step 50: train loss 0.2456 
cause_predict: train acc 0.9661 p 0.8857 r 0.9394 f1 0.9118
position_predict: train acc 0.9492 p 0.8710 r 0.8438 f1 0.8571
step 60: train loss 0.1795 
cause_predict: train acc 0.9528 p 0.8378 r 0.8857 f1 0.8611
position_predict: train acc 0.9623 p 0.9000 r 0.8438 f1 0.8710
step 70: train loss 0.1776 
cause_predict: train acc 0.9618 p 0.9000 r 0.8372 f1 0.8675
position_predict: train acc 0.9583 p 0.8125 r 0.8125 f1 0.8125

epoch 11: test loss 0.6164 cost time: 10.4s

cause_predict: test acc 0.8901 p 0.6310 r 0.5394 f1 0.5816
max_acc 0.8923 max_p 0.6367 max_r 0.5584 max_f1 0.5950

position_predict: test acc 0.9231 p 0.7170 r 0.6620 f1 0.6884
max_acc 0.9254 max_p 0.7041 max_r 0.7213 max_f1 0.7126

Average max cause: max_acc 0.8923 max_p 0.6367 max_r 0.5584 max_f1 0.5950
Average max pos: max_acc 0.9218 max_p 0.7014 max_r 0.6794 max_f1 0.6903

step 10: train loss 0.1611 
cause_predict: train acc 0.9639 p 0.9189 r 0.8293 f1 0.8718
position_predict: train acc 0.9711 p 0.9000 r 0.8438 f1 0.8710
step 20: train loss 0.1521 
cause_predict: train acc 0.9767 p 0.9412 r 0.9143 f1 0.9275
position_predict: train acc 0.9581 p 0.8710 r 0.8438 f1 0.8571
step 30: train loss 0.1221 
cause_predict: train acc 0.9770 p 0.9394 r 0.9118 f1 0.9254
position_predict: train acc 0.9816 p 0.9118 r 0.9688 f1 0.9394
step 40: train loss 0.0933 
cause_predict: train acc 0.9634 p 0.9091 r 0.8824 f1 0.8955
position_predict: train acc 0.9791 p 0.9118 r 0.9688 f1 0.9394
step 50: train loss 0.2083 
cause_predict: train acc 0.9576 p 0.8788 r 0.8286 f1 0.8529
position_predict: train acc 0.9619 p 0.8750 r 0.8485 f1 0.8615
step 60: train loss 0.0686 
cause_predict: train acc 0.9899 p 1.0000 r 0.9459 f1 0.9722
position_predict: train acc 0.9950 p 0.9714 r 1.0000 f1 0.9855
step 70: train loss 0.1418 
2024-06-22 18:53:16.927770: W tensorflow/c/c_api.cc:304] Operation '{name:'softmax_b_pos/Adam_1/Assign' id:5023 op device:{requested: '', assigned: ''} def:{{{node softmax_b_pos/Adam_1/Assign}} = Assign[T=DT_FLOAT, _class=["loc:@softmax_b_pos"], _has_manual_control_dependencies=true, use_locking=true, validate_shape=true](softmax_b_pos/Adam_1, softmax_b_pos/Adam_1/Initializer/zeros)}}' was changed by setting attribute after it was run by a session. This mutation will have no effect, and will trigger an error in the future. Either don't modify nodes after running them or create a new session.
cause_predict: train acc 0.9826 p 0.9189 r 0.9714 f1 0.9444
position_predict: train acc 0.9696 p 0.9032 r 0.8750 f1 0.8889

epoch 12: test loss 0.7041 cost time: 10.5s

cause_predict: test acc 0.8856 p 0.6041 r 0.5584 f1 0.5803
max_acc 0.8923 max_p 0.6367 max_r 0.5584 max_f1 0.5950

position_predict: test acc 0.9142 p 0.6740 r 0.6411 f1 0.6571
max_acc 0.9254 max_p 0.7041 max_r 0.7213 max_f1 0.7126

Average max cause: max_acc 0.8923 max_p 0.6367 max_r 0.5584 max_f1 0.5950
Average max pos: max_acc 0.9218 max_p 0.7014 max_r 0.6794 max_f1 0.6903

step 10: train loss 0.1374 
cause_predict: train acc 0.9771 p 1.0000 r 0.8529 f1 0.9206
position_predict: train acc 0.9725 p 0.9355 r 0.8788 f1 0.9062
step 20: train loss 0.1712 
cause_predict: train acc 0.9544 p 0.9091 r 0.7895 f1 0.8451
position_predict: train acc 0.9751 p 0.9091 r 0.9091 f1 0.9091
step 30: train loss 0.1605 
cause_predict: train acc 0.9649 p 0.8537 r 0.9459 f1 0.8974
position_predict: train acc 0.9649 p 0.8750 r 0.8750 f1 0.8750
step 40: train loss 0.1700 
cause_predict: train acc 0.9741 p 0.9429 r 0.8919 f1 0.9167
position_predict: train acc 0.9526 p 0.8182 r 0.8438 f1 0.8308
step 50: train loss 0.1339 
cause_predict: train acc 0.9804 p 0.9487 r 0.9487 f1 0.9487
position_predict: train acc 0.9853 p 0.9688 r 0.9394 f1 0.9538
step 60: train loss 0.1434 
cause_predict: train acc 0.9689 p 0.9429 r 0.8462 f1 0.8919
position_predict: train acc 0.9728 p 0.8788 r 0.9062 f1 0.8923
step 70: train loss 0.2147 
cause_predict: train acc 0.9537 p 0.8919 r 0.8462 f1 0.8684
position_predict: train acc 0.9722 p 0.9062 r 0.9062 f1 0.9062

epoch 13: test loss 0.6849 cost time: 10.5s

cause_predict: test acc 0.8901 p 0.6320 r 0.5363 f1 0.5802
max_acc 0.8923 max_p 0.6367 max_r 0.5584 max_f1 0.5950

position_predict: test acc 0.9196 p 0.6945 r 0.6655 f1 0.6797
max_acc 0.9254 max_p 0.7041 max_r 0.7213 max_f1 0.7126

Average max cause: max_acc 0.8923 max_p 0.6367 max_r 0.5584 max_f1 0.5950
Average max pos: max_acc 0.9218 max_p 0.7014 max_r 0.6794 max_f1 0.6903

step 10: train loss 0.0899 
cause_predict: train acc 0.9815 p 0.9211 r 0.9459 f1 0.9333
position_predict: train acc 0.9779 p 0.9091 r 0.9091 f1 0.9091
step 20: train loss 0.0994 
cause_predict: train acc 0.9872 p 0.9714 r 0.9444 f1 0.9577
position_predict: train acc 0.9745 p 0.9062 r 0.9062 f1 0.9062
step 30: train loss 0.0613 
cause_predict: train acc 0.9841 p 0.9697 r 0.9143 f1 0.9412
position_predict: train acc 0.9881 p 0.9394 r 0.9688 f1 0.9538
step 40: train loss 0.1066 
cause_predict: train acc 0.9811 p 0.9231 r 0.9231 f1 0.9231
position_predict: train acc 0.9685 p 0.8438 r 0.8438 f1 0.8438
step 50: train loss 0.1292 
cause_predict: train acc 0.9656 p 0.8788 r 0.8529 f1 0.8657
position_predict: train acc 0.9771 p 0.9091 r 0.9091 f1 0.9091
step 60: train loss 0.0688 
cause_predict: train acc 0.9922 p 1.0000 r 0.9429 f1 0.9706
position_predict: train acc 0.9843 p 0.9667 r 0.9062 f1 0.9355
step 70: train loss 0.1595 
cause_predict: train acc 0.9638 p 0.9118 r 0.8611 f1 0.8857
position_predict: train acc 0.9729 p 0.8824 r 0.9375 f1 0.9091

epoch 14: test loss 0.6970 cost time: 10.3s

cause_predict: test acc 0.8820 p 0.5985 r 0.5079 f1 0.5495
max_acc 0.8923 max_p 0.6367 max_r 0.5584 max_f1 0.5950

position_predict: test acc 0.9160 p 0.6774 r 0.6585 f1 0.6678
max_acc 0.9254 max_p 0.7041 max_r 0.7213 max_f1 0.7126

Average max cause: max_acc 0.8923 max_p 0.6367 max_r 0.5584 max_f1 0.5950
Average max pos: max_acc 0.9218 max_p 0.7014 max_r 0.6794 max_f1 0.6903

write pair_data/Ind_BiLSTM_1/fold_8_test.txt done
write pair_data/Ind_BiLSTM_1/fold_8_train.txt done
Optimization Finished!

############# fold 8 end ###############
############# fold 9 begin ###############
load data_file: data_combine_en/fold_9_train.txt
y_position.shape (2275, 75, 2)
y_cause.shape (2275, 75, 2)
x.shape (2275, 75, 30)
sen_len.shape (2275, 75)
doc_len.shape (2275,)
n_cut 107
load data done!

load data_file: data_combine_en/fold_9_test.txt
y_position.shape (284, 75, 2)
y_cause.shape (284, 75, 2)
x.shape (284, 75, 30)
sen_len.shape (284, 75)
doc_len.shape (284,)
n_cut 22
load data done!

train docs: 2275    test docs: 284
step 10: train loss 0.8802 
cause_predict: train acc 0.8122 p 0.0000 r 0.0000 f1 0.0000
position_predict: train acc 0.8498 p 0.0000 r 0.0000 f1 0.0000
step 20: train loss 0.6585 
cause_predict: train acc 0.8734 p 0.0000 r 0.0000 f1 0.0000
position_predict: train acc 0.8961 p 0.0000 r 0.0000 f1 0.0000
step 30: train loss 0.6173 
cause_predict: train acc 0.8828 p 0.0000 r 0.0000 f1 0.0000
position_predict: train acc 0.8828 p 0.0000 r 0.0000 f1 0.0000
step 40: train loss 0.5229 
cause_predict: train acc 0.8785 p 0.0000 r 0.0000 f1 0.0000
position_predict: train acc 0.8924 p 0.5833 r 0.2121 f1 0.3111
step 50: train loss 0.6083 
cause_predict: train acc 0.8696 p 0.0000 r 0.0000 f1 0.0000
position_predict: train acc 0.9012 p 0.7333 r 0.3438 f1 0.4681
step 60: train loss 0.5832 
cause_predict: train acc 0.8476 p 0.0000 r 0.0000 f1 0.0000
position_predict: train acc 0.8952 p 0.9167 r 0.3438 f1 0.5000
step 70: train loss 0.5845 
cause_predict: train acc 0.8424 p 1.0000 r 0.0588 f1 0.1111
position_predict: train acc 0.9015 p 0.7826 r 0.5455 f1 0.6429

epoch 0: test loss 0.5408 cost time: 10.6s

cause_predict: test acc 0.8601 p 1.0000 r 0.0126 f1 0.0249
max_acc 0.8601 max_p 1.0000 max_r 0.0126 max_f1 0.0249

position_predict: test acc 0.9164 p 0.7232 r 0.5645 f1 0.6341
max_acc 0.9164 max_p 0.7232 max_r 0.5645 max_f1 0.6341

Average max cause: max_acc 0.8601 max_p 1.0000 max_r 0.0126 max_f1 0.0249
Average max pos: max_acc 0.9164 max_p 0.7232 max_r 0.5645 max_f1 0.6341

step 10: train loss 0.4363 
cause_predict: train acc 0.8699 p 1.0000 r 0.0541 f1 0.1026
position_predict: train acc 0.9517 p 0.7714 r 0.8438 f1 0.8060
step 20: train loss 0.4947 
cause_predict: train acc 0.8554 p 0.5000 r 0.1143 f1 0.1860
position_predict: train acc 0.9050 p 0.6800 r 0.5312 f1 0.5965
step 30: train loss 0.5634 
cause_predict: train acc 0.8644 p 0.8000 r 0.1143 f1 0.2000
position_predict: train acc 0.8898 p 0.6552 r 0.5429 f1 0.5937
step 40: train loss 0.5462 
cause_predict: train acc 0.8735 p 0.6000 r 0.2647 f1 0.3673
position_predict: train acc 0.9020 p 0.6667 r 0.5000 f1 0.5714
step 50: train loss 0.5089 
cause_predict: train acc 0.8621 p 0.6667 r 0.3590 f1 0.4667
position_predict: train acc 0.9440 p 0.8276 r 0.7500 f1 0.7869
step 60: train loss 0.5209 
cause_predict: train acc 0.8826 p 0.6154 r 0.2222 f1 0.3265
position_predict: train acc 0.9253 p 0.7037 r 0.5938 f1 0.6441
step 70: train loss 0.4657 
cause_predict: train acc 0.8874 p 0.6000 r 0.2500 f1 0.3529
position_predict: train acc 0.9215 p 0.6800 r 0.5312 f1 0.5965

epoch 1: test loss 0.4859 cost time: 10.6s

cause_predict: test acc 0.8954 p 0.7677 r 0.3754 f1 0.5042
max_acc 0.8954 max_p 0.7677 max_r 0.3754 max_f1 0.5042

position_predict: test acc 0.9187 p 0.7108 r 0.6167 f1 0.6604
max_acc 0.9187 max_p 0.7108 max_r 0.6167 max_f1 0.6604

Average max cause: max_acc 0.8954 max_p 0.7677 max_r 0.3754 max_f1 0.5042
Average max pos: max_acc 0.9187 max_p 0.7108 max_r 0.6167 max_f1 0.6604

step 10: train loss 0.5129 
cause_predict: train acc 0.8382 p 0.4400 r 0.3056 f1 0.3607
position_predict: train acc 0.9046 p 0.6364 r 0.6562 f1 0.6462
step 20: train loss 0.5319 
cause_predict: train acc 0.8664 p 0.7333 r 0.3056 f1 0.4314
position_predict: train acc 0.9217 p 0.7586 r 0.6875 f1 0.7213
step 30: train loss 0.4090 
cause_predict: train acc 0.9134 p 0.6800 r 0.5152 f1 0.5862
position_predict: train acc 0.9567 p 0.8333 r 0.7812 f1 0.8065
step 40: train loss 0.3758 
cause_predict: train acc 0.9105 p 0.8235 r 0.3590 f1 0.5000
position_predict: train acc 0.9393 p 0.7692 r 0.6061 f1 0.6780
step 50: train loss 0.4680 
cause_predict: train acc 0.8805 p 0.8333 r 0.3846 f1 0.5263
position_predict: train acc 0.9469 p 0.8621 r 0.7576 f1 0.8065
step 60: train loss 0.5326 
cause_predict: train acc 0.8919 p 0.6667 r 0.4444 f1 0.5333
position_predict: train acc 0.8996 p 0.6296 r 0.5152 f1 0.5667
step 70: train loss 0.4881 
cause_predict: train acc 0.8723 p 0.5600 r 0.4242 f1 0.4828
position_predict: train acc 0.9106 p 0.7037 r 0.5938 f1 0.6441

epoch 2: test loss 0.4709 cost time: 10.3s

cause_predict: test acc 0.8878 p 0.6602 r 0.4290 f1 0.5201
max_acc 0.8878 max_p 0.6602 max_r 0.4290 max_f1 0.5201

position_predict: test acc 0.9240 p 0.7577 r 0.5993 f1 0.6693
max_acc 0.9240 max_p 0.7577 max_r 0.5993 max_f1 0.6693

Average max cause: max_acc 0.8878 max_p 0.6602 max_r 0.4290 max_f1 0.5201
Average max pos: max_acc 0.9240 max_p 0.7577 max_r 0.5993 max_f1 0.6693

step 10: train loss 0.4155 
cause_predict: train acc 0.9008 p 0.7200 r 0.5143 f1 0.6000
position_predict: train acc 0.9298 p 0.7778 r 0.6562 f1 0.7119
step 20: train loss 0.4075 
cause_predict: train acc 0.8967 p 0.6562 r 0.6000 f1 0.6269
position_predict: train acc 0.9421 p 0.8000 r 0.7500 f1 0.7742
step 30: train loss 0.4940 
cause_predict: train acc 0.8883 p 0.7500 r 0.6176 f1 0.6774
position_predict: train acc 0.8994 p 0.7692 r 0.6250 f1 0.6897
step 40: train loss 0.4336 
cause_predict: train acc 0.8673 p 0.7391 r 0.4359 f1 0.5484
position_predict: train acc 0.9336 p 0.8276 r 0.7273 f1 0.7742
step 50: train loss 0.4260 
cause_predict: train acc 0.8885 p 0.6129 r 0.5278 f1 0.5672
position_predict: train acc 0.9346 p 0.7419 r 0.7188 f1 0.7302
step 60: train loss 0.4796 
cause_predict: train acc 0.8739 p 0.6364 r 0.4000 f1 0.4912
position_predict: train acc 0.9261 p 0.8000 r 0.6250 f1 0.7018
step 70: train loss 0.3637 
cause_predict: train acc 0.9289 p 0.8148 r 0.6471 f1 0.7213
position_predict: train acc 0.9372 p 0.7931 r 0.7188 f1 0.7541

epoch 3: test loss 0.4736 cost time: 10.6s

cause_predict: test acc 0.8878 p 0.6514 r 0.4479 f1 0.5308
max_acc 0.8878 max_p 0.6514 max_r 0.4479 max_f1 0.5308

position_predict: test acc 0.9218 p 0.7137 r 0.6516 f1 0.6812
max_acc 0.9218 max_p 0.7137 max_r 0.6516 max_f1 0.6812

Average max cause: max_acc 0.8878 max_p 0.6514 max_r 0.4479 max_f1 0.5308
Average max pos: max_acc 0.9218 max_p 0.7137 max_r 0.6516 max_f1 0.6812

step 10: train loss 0.4146 
cause_predict: train acc 0.8915 p 0.7000 r 0.3889 f1 0.5000
position_predict: train acc 0.9457 p 0.8214 r 0.7188 f1 0.7667
step 20: train loss 0.2734 
cause_predict: train acc 0.9582 p 0.8750 r 0.8235 f1 0.8485
position_predict: train acc 0.9372 p 0.7576 r 0.7812 f1 0.7692
step 30: train loss 0.4080 
cause_predict: train acc 0.8839 p 0.6923 r 0.5000 f1 0.5806
position_predict: train acc 0.9464 p 0.8333 r 0.7812 f1 0.8065
step 40: train loss 0.3675 
cause_predict: train acc 0.9087 p 0.7308 r 0.5278 f1 0.6129
position_predict: train acc 0.9392 p 0.7667 r 0.7188 f1 0.7419
step 50: train loss 0.4843 
cause_predict: train acc 0.8874 p 0.7143 r 0.4412 f1 0.5455
position_predict: train acc 0.9054 p 0.7037 r 0.5938 f1 0.6441
step 60: train loss 0.3655 
cause_predict: train acc 0.9048 p 0.6765 r 0.6765 f1 0.6765
position_predict: train acc 0.9221 p 0.7500 r 0.6562 f1 0.7000
step 70: train loss 0.3624 
cause_predict: train acc 0.9121 p 0.7857 r 0.5946 f1 0.6769
position_predict: train acc 0.9582 p 0.8929 r 0.7812 f1 0.8333

epoch 4: test loss 0.4822 cost time: 10.8s

cause_predict: test acc 0.8919 p 0.6866 r 0.4353 f1 0.5328
max_acc 0.8919 max_p 0.6866 max_r 0.4353 max_f1 0.5328

position_predict: test acc 0.9218 p 0.6918 r 0.7038 f1 0.6978
max_acc 0.9218 max_p 0.6918 max_r 0.7038 max_f1 0.6978

Average max cause: max_acc 0.8919 max_p 0.6866 max_r 0.4353 max_f1 0.5328
Average max pos: max_acc 0.9218 max_p 0.6918 max_r 0.7038 max_f1 0.6978

step 10: train loss 0.3440 
cause_predict: train acc 0.8943 p 0.7436 r 0.6744 f1 0.7073
position_predict: train acc 0.9604 p 0.8710 r 0.8438 f1 0.8571
step 20: train loss 0.3080 
cause_predict: train acc 0.9058 p 0.7407 r 0.5882 f1 0.6557
position_predict: train acc 0.9507 p 0.8889 r 0.7500 f1 0.8136
step 30: train loss 0.3560 
cause_predict: train acc 0.9196 p 0.7419 r 0.6970 f1 0.7188
position_predict: train acc 0.9330 p 0.7576 r 0.7812 f1 0.7692
step 40: train loss 0.2828 
cause_predict: train acc 0.9375 p 0.9048 r 0.5429 f1 0.6786
position_predict: train acc 0.9583 p 0.8387 r 0.7879 f1 0.8125
step 50: train loss 0.3465 
cause_predict: train acc 0.8984 p 0.6667 r 0.5946 f1 0.6286
position_predict: train acc 0.9531 p 0.8125 r 0.8125 f1 0.8125
step 60: train loss 0.3331 
cause_predict: train acc 0.9231 p 0.7500 r 0.5833 f1 0.6562
position_predict: train acc 0.9650 p 0.8438 r 0.8438 f1 0.8438
step 70: train loss 0.4335 
cause_predict: train acc 0.8971 p 0.7188 r 0.6571 f1 0.6866
position_predict: train acc 0.9461 p 0.8235 r 0.8485 f1 0.8358

epoch 5: test loss 0.4978 cost time: 10.6s

cause_predict: test acc 0.8834 p 0.5959 r 0.5489 f1 0.5714
max_acc 0.8834 max_p 0.5959 max_r 0.5489 max_f1 0.5714

position_predict: test acc 0.9196 p 0.6838 r 0.6934 f1 0.6886
max_acc 0.9218 max_p 0.6918 max_r 0.7038 max_f1 0.6978

Average max cause: max_acc 0.8834 max_p 0.5959 max_r 0.5489 max_f1 0.5714
Average max pos: max_acc 0.9196 max_p 0.6838 max_r 0.6934 max_f1 0.6886

step 10: train loss 0.2746 
cause_predict: train acc 0.9307 p 0.8462 r 0.6471 f1 0.7333
position_predict: train acc 0.9567 p 0.8667 r 0.8125 f1 0.8387
step 20: train loss 0.2855 
cause_predict: train acc 0.9267 p 0.7812 r 0.7812 f1 0.7812
position_predict: train acc 0.9476 p 0.8438 r 0.8438 f1 0.8438
step 30: train loss 0.2577 
cause_predict: train acc 0.9219 p 0.7143 r 0.7143 f1 0.7143
position_predict: train acc 0.9648 p 0.8485 r 0.8750 f1 0.8615
step 40: train loss 0.3252 
cause_predict: train acc 0.9481 p 0.8387 r 0.7429 f1 0.7879
position_predict: train acc 0.9407 p 0.7857 r 0.6875 f1 0.7333
step 50: train loss 0.4390 
cause_predict: train acc 0.8872 p 0.7879 r 0.6341 f1 0.7027
position_predict: train acc 0.9179 p 0.7500 r 0.7500 f1 0.7500
step 60: train loss 0.2565 
cause_predict: train acc 0.9375 p 0.7931 r 0.6571 f1 0.7188
position_predict: train acc 0.9583 p 0.7941 r 0.8438 f1 0.8182
step 70: train loss 0.3366 
cause_predict: train acc 0.9360 p 0.8333 r 0.6410 f1 0.7246
position_predict: train acc 0.9394 p 0.7500 r 0.6562 f1 0.7000

epoch 6: test loss 0.5322 cost time: 10.5s

cause_predict: test acc 0.8794 p 0.5900 r 0.4858 f1 0.5329
max_acc 0.8834 max_p 0.5959 max_r 0.5489 max_f1 0.5714

position_predict: test acc 0.9191 p 0.6920 r 0.6655 f1 0.6785
max_acc 0.9218 max_p 0.6918 max_r 0.7038 max_f1 0.6978

Average max cause: max_acc 0.8834 max_p 0.5959 max_r 0.5489 max_f1 0.5714
Average max pos: max_acc 0.9196 max_p 0.6838 max_r 0.6934 max_f1 0.6886

step 10: train loss 0.2035 
cause_predict: train acc 0.9539 p 0.9062 r 0.8056 f1 0.8529
position_predict: train acc 0.9724 p 0.9062 r 0.9062 f1 0.9062
step 20: train loss 0.2335 
cause_predict: train acc 0.9255 p 0.7742 r 0.6667 f1 0.7164
position_predict: train acc 0.9765 p 0.9643 r 0.8438 f1 0.9000
step 30: train loss 0.1873 
cause_predict: train acc 0.9550 p 0.9091 r 0.8108 f1 0.8571
position_predict: train acc 0.9730 p 0.9062 r 0.9062 f1 0.9062
step 40: train loss 0.1968 
cause_predict: train acc 0.9568 p 0.8889 r 0.7273 f1 0.8000
position_predict: train acc 0.9748 p 0.9032 r 0.8750 f1 0.8889
step 50: train loss 0.2259 
cause_predict: train acc 0.9248 p 0.7143 r 0.7143 f1 0.7143
position_predict: train acc 0.9624 p 0.8125 r 0.8125 f1 0.8125
step 60: train loss 0.1699 
cause_predict: train acc 0.9565 p 0.8710 r 0.7941 f1 0.8308
position_predict: train acc 0.9763 p 0.8857 r 0.9394 f1 0.9118
step 70: train loss 0.2812 
cause_predict: train acc 0.9264 p 0.7778 r 0.7568 f1 0.7671
position_predict: train acc 0.9567 p 0.8438 r 0.8438 f1 0.8438

epoch 7: test loss 0.5740 cost time: 10.3s

cause_predict: test acc 0.8798 p 0.5795 r 0.5521 f1 0.5654
max_acc 0.8834 max_p 0.5959 max_r 0.5489 max_f1 0.5714

position_predict: test acc 0.9124 p 0.6409 r 0.7213 f1 0.6787
max_acc 0.9218 max_p 0.6918 max_r 0.7038 max_f1 0.6978

Average max cause: max_acc 0.8834 max_p 0.5959 max_r 0.5489 max_f1 0.5714
Average max pos: max_acc 0.9196 max_p 0.6838 max_r 0.6934 max_f1 0.6886

step 10: train loss 0.2036 
cause_predict: train acc 0.9474 p 0.8824 r 0.8571 f1 0.8696
position_predict: train acc 0.9708 p 0.9355 r 0.9062 f1 0.9206
step 20: train loss 0.2199 
cause_predict: train acc 0.9650 p 0.9062 r 0.8788 f1 0.8923
position_predict: train acc 0.9650 p 0.9032 r 0.8750 f1 0.8889
step 30: train loss 0.1588 
cause_predict: train acc 0.9613 p 0.8788 r 0.8056 f1 0.8406
position_predict: train acc 0.9718 p 0.8824 r 0.8824 f1 0.8824
step 40: train loss 0.2354 
cause_predict: train acc 0.9567 p 0.8718 r 0.8718 f1 0.8718
position_predict: train acc 0.9654 p 0.8750 r 0.8750 f1 0.8750
step 50: train loss 0.2220 
cause_predict: train acc 0.9486 p 0.8108 r 0.8333 f1 0.8219
position_predict: train acc 0.9565 p 0.8387 r 0.8125 f1 0.8254
step 60: train loss 0.3132 
cause_predict: train acc 0.9440 p 0.8065 r 0.7812 f1 0.7937
position_predict: train acc 0.9138 p 0.6875 r 0.6875 f1 0.6875
step 70: train loss 0.2691 
cause_predict: train acc 0.9206 p 0.7143 r 0.7143 f1 0.7143
position_predict: train acc 0.9683 p 0.9032 r 0.8485 f1 0.8750

epoch 8: test loss 0.5791 cost time: 10.2s

cause_predict: test acc 0.8843 p 0.6169 r 0.4826 f1 0.5416
max_acc 0.8834 max_p 0.5959 max_r 0.5489 max_f1 0.5714

position_predict: test acc 0.9160 p 0.6713 r 0.6760 f1 0.6736
max_acc 0.9218 max_p 0.6918 max_r 0.7038 max_f1 0.6978

Average max cause: max_acc 0.8834 max_p 0.5959 max_r 0.5489 max_f1 0.5714
Average max pos: max_acc 0.9196 max_p 0.6838 max_r 0.6934 max_f1 0.6886

step 10: train loss 0.1740 
cause_predict: train acc 0.9592 p 0.8750 r 0.8235 f1 0.8485
position_predict: train acc 0.9837 p 0.9667 r 0.9062 f1 0.9355
step 20: train loss 0.1561 
cause_predict: train acc 0.9602 p 0.9667 r 0.7838 f1 0.8657
position_predict: train acc 0.9690 p 0.9333 r 0.8485 f1 0.8889
step 30: train loss 0.1158 
cause_predict: train acc 0.9851 p 0.9677 r 0.9091 f1 0.9375
position_predict: train acc 0.9777 p 0.9333 r 0.8750 f1 0.9032
step 40: train loss 0.3020 
cause_predict: train acc 0.9293 p 0.8000 r 0.8000 f1 0.8000
position_predict: train acc 0.9545 p 0.8710 r 0.8438 f1 0.8571
step 50: train loss 0.2526 
cause_predict: train acc 0.9614 p 0.9375 r 0.8108 f1 0.8696
position_predict: train acc 0.9571 p 0.8667 r 0.8125 f1 0.8387
step 60: train loss 0.2363 
cause_predict: train acc 0.9487 p 0.9259 r 0.7576 f1 0.8333
position_predict: train acc 0.9590 p 0.9310 r 0.8182 f1 0.8710
step 70: train loss 0.2753 
cause_predict: train acc 0.9325 p 0.7619 r 0.8205 f1 0.7901
position_predict: train acc 0.9405 p 0.7812 r 0.7576 f1 0.7692

epoch 9: test loss 0.6224 cost time: 10.4s

cause_predict: test acc 0.8843 p 0.6074 r 0.5174 f1 0.5588
max_acc 0.8834 max_p 0.5959 max_r 0.5489 max_f1 0.5714

position_predict: test acc 0.9151 p 0.6702 r 0.6655 f1 0.6678
max_acc 0.9218 max_p 0.6918 max_r 0.7038 max_f1 0.6978

Average max cause: max_acc 0.8834 max_p 0.5959 max_r 0.5489 max_f1 0.5714
Average max pos: max_acc 0.9196 max_p 0.6838 max_r 0.6934 max_f1 0.6886

step 10: train loss 0.1009 
cause_predict: train acc 0.9711 p 0.9118 r 0.8611 f1 0.8857
position_predict: train acc 0.9856 p 0.9143 r 0.9697 f1 0.9412
step 20: train loss 0.1683 
cause_predict: train acc 0.9565 p 0.8438 r 0.8182 f1 0.8308
position_predict: train acc 0.9526 p 0.8125 r 0.8125 f1 0.8125
step 30: train loss 0.1231 
cause_predict: train acc 0.9723 p 0.9118 r 0.8857 f1 0.8986
position_predict: train acc 0.9881 p 0.9394 r 0.9688 f1 0.9538
step 40: train loss 0.1169 
cause_predict: train acc 0.9888 p 0.9697 r 0.9412 f1 0.9552
position_predict: train acc 0.9740 p 0.9310 r 0.8438 f1 0.8852
step 50: train loss 0.1436 
cause_predict: train acc 0.9782 p 0.9394 r 0.9118 f1 0.9254
position_predict: train acc 0.9651 p 0.8750 r 0.8750 f1 0.8750
step 60: train loss 0.2384 
cause_predict: train acc 0.9535 p 0.8387 r 0.7879 f1 0.8125
position_predict: train acc 0.9535 p 0.8333 r 0.7812 f1 0.8065
step 70: train loss 0.2825 
cause_predict: train acc 0.9375 p 0.8571 r 0.6667 f1 0.7500
position_predict: train acc 0.9414 p 0.7931 r 0.7188 f1 0.7541

epoch 10: test loss 0.6076 cost time: 10.8s

cause_predict: test acc 0.8937 p 0.6367 r 0.5804 f1 0.6073
max_acc 0.8937 max_p 0.6367 max_r 0.5804 max_f1 0.6073

position_predict: test acc 0.9200 p 0.6985 r 0.6620 f1 0.6798
max_acc 0.9218 max_p 0.6918 max_r 0.7038 max_f1 0.6978

Average max cause: max_acc 0.8937 max_p 0.6367 max_r 0.5804 max_f1 0.6073
Average max pos: max_acc 0.9200 max_p 0.6985 max_r 0.6620 max_f1 0.6798

step 10: train loss 0.1441 
cause_predict: train acc 0.9828 p 0.9706 r 0.9167 f1 0.9429
position_predict: train acc 0.9657 p 0.8750 r 0.8750 f1 0.8750
step 20: train loss 0.1033 
cause_predict: train acc 0.9791 p 0.9706 r 0.8919 f1 0.9296
position_predict: train acc 0.9791 p 0.9355 r 0.9062 f1 0.9206
step 30: train loss 0.1439 
cause_predict: train acc 0.9552 p 0.8571 r 0.8824 f1 0.8696
position_predict: train acc 0.9751 p 0.9118 r 0.9394 f1 0.9254
step 40: train loss 0.1370 
cause_predict: train acc 0.9763 p 0.9143 r 0.9143 f1 0.9143
position_predict: train acc 0.9763 p 0.9333 r 0.8750 f1 0.9032
step 50: train loss 0.1246 
cause_predict: train acc 0.9669 p 0.8571 r 0.8824 f1 0.8696
position_predict: train acc 0.9926 p 0.9412 r 1.0000 f1 0.9697
step 60: train loss 0.1852 
cause_predict: train acc 0.9727 p 0.8684 r 0.9167 f1 0.8919
position_predict: train acc 0.9590 p 0.8333 r 0.7812 f1 0.8065
step 70: train loss 0.2629 
cause_predict: train acc 0.9509 p 0.7838 r 0.9062 f1 0.8406
position_predict: train acc 0.9375 p 0.8000 r 0.7500 f1 0.7742

epoch 11: test loss 0.6754 cost time: 10.7s

cause_predict: test acc 0.8852 p 0.5987 r 0.5741 f1 0.5862
max_acc 0.8937 max_p 0.6367 max_r 0.5804 max_f1 0.6073

position_predict: test acc 0.9182 p 0.7000 r 0.6341 f1 0.6654
max_acc 0.9218 max_p 0.6918 max_r 0.7038 max_f1 0.6978

Average max cause: max_acc 0.8937 max_p 0.6367 max_r 0.5804 max_f1 0.6073
Average max pos: max_acc 0.9200 max_p 0.6985 max_r 0.6620 max_f1 0.6798

step 10: train loss 0.1053 
cause_predict: train acc 0.9791 p 0.9143 r 0.9412 f1 0.9275
position_predict: train acc 0.9874 p 0.9394 r 0.9688 f1 0.9538
step 20: train loss 0.1862 
cause_predict: train acc 0.9727 p 0.8857 r 0.9118 f1 0.8986
position_predict: train acc 0.9648 p 0.8485 r 0.8750 f1 0.8615
step 30: train loss 0.0743 
cause_predict: train acc 0.9896 p 1.0000 r 0.9167 f1 0.9565
position_predict: train acc 0.9862 p 0.9118 r 0.9688 f1 0.9394
step 40: train loss 0.2332 
cause_predict: train acc 0.9590 p 0.8919 r 0.8919 f1 0.8919
position_predict: train acc 0.9590 p 0.8750 r 0.8750 f1 0.8750
step 50: train loss 0.2022 
cause_predict: train acc 0.9437 p 0.9000 r 0.7500 f1 0.8182
position_predict: train acc 0.9718 p 0.9333 r 0.8750 f1 0.9032
step 60: train loss 0.1005 
cause_predict: train acc 0.9797 p 0.9118 r 0.9394 f1 0.9254
position_predict: train acc 0.9878 p 0.9677 r 0.9375 f1 0.9524
step 70: train loss 0.1188 
cause_predict: train acc 0.9775 p 0.9189 r 0.8947 f1 0.9067
position_predict: train acc 0.9775 p 0.8788 r 0.9062 f1 0.8923

epoch 12: test loss 0.6577 cost time: 10.4s

cause_predict: test acc 0.8789 p 0.5706 r 0.5868 f1 0.5785
max_acc 0.8937 max_p 0.6367 max_r 0.5804 max_f1 0.6073

position_predict: test acc 0.9142 p 0.6557 r 0.6969 f1 0.6757
max_acc 0.9218 max_p 0.6918 max_r 0.7038 max_f1 0.6978

Average max cause: max_acc 0.8937 max_p 0.6367 max_r 0.5804 max_f1 0.6073
Average max pos: max_acc 0.9200 max_p 0.6985 max_r 0.6620 max_f1 0.6798

step 10: train loss 0.0923 
cause_predict: train acc 0.9795 p 0.9394 r 0.9118 f1 0.9254
position_predict: train acc 0.9836 p 0.9375 r 0.9375 f1 0.9375
step 20: train loss 0.1162 
cause_predict: train acc 0.9809 p 0.9722 r 0.8974 f1 0.9333
position_predict: train acc 0.9809 p 0.9118 r 0.9394 f1 0.9254
step 30: train loss 0.1236 
cause_predict: train acc 0.9764 p 0.8857 r 0.9118 f1 0.8986
position_predict: train acc 0.9798 p 0.9091 r 0.9091 f1 0.9091
step 40: train loss 0.0289 
cause_predict: train acc 1.0000 p 1.0000 r 1.0000 f1 1.0000
position_predict: train acc 0.9946 p 0.9706 r 1.0000 f1 0.9851
step 50: train loss 0.1539 
cause_predict: train acc 0.9746 p 0.8919 r 0.9706 f1 0.9296
position_predict: train acc 0.9594 p 0.8750 r 0.8750 f1 0.8750
step 60: train loss 0.1057 
cause_predict: train acc 0.9865 p 0.9375 r 0.9375 f1 0.9375
position_predict: train acc 0.9764 p 0.9032 r 0.8750 f1 0.8889
step 70: train loss 0.1847 
cause_predict: train acc 0.9640 p 0.9062 r 0.8286 f1 0.8657
position_predict: train acc 0.9600 p 0.8286 r 0.8788 f1 0.8529

epoch 13: test loss 0.7392 cost time: 10.2s

2024-06-22 18:56:06.239213: W tensorflow/c/c_api.cc:304] Operation '{name:'softmax_b_pos/Adam_1/Assign' id:5023 op device:{requested: '', assigned: ''} def:{{{node softmax_b_pos/Adam_1/Assign}} = Assign[T=DT_FLOAT, _class=["loc:@softmax_b_pos"], _has_manual_control_dependencies=true, use_locking=true, validate_shape=true](softmax_b_pos/Adam_1, softmax_b_pos/Adam_1/Initializer/zeros)}}' was changed by setting attribute after it was run by a session. This mutation will have no effect, and will trigger an error in the future. Either don't modify nodes after running them or create a new session.
cause_predict: test acc 0.8749 p 0.5654 r 0.5047 f1 0.5333
max_acc 0.8937 max_p 0.6367 max_r 0.5804 max_f1 0.6073

position_predict: test acc 0.9115 p 0.6572 r 0.6481 f1 0.6526
max_acc 0.9218 max_p 0.6918 max_r 0.7038 max_f1 0.6978

Average max cause: max_acc 0.8937 max_p 0.6367 max_r 0.5804 max_f1 0.6073
Average max pos: max_acc 0.9200 max_p 0.6985 max_r 0.6620 max_f1 0.6798

step 10: train loss 0.0875 
cause_predict: train acc 0.9801 p 0.9143 r 0.9143 f1 0.9143
position_predict: train acc 0.9867 p 0.9375 r 0.9375 f1 0.9375
step 20: train loss 0.0812 
cause_predict: train acc 0.9858 p 0.9500 r 0.9744 f1 0.9620
position_predict: train acc 0.9810 p 0.9667 r 0.9062 f1 0.9355
step 30: train loss 0.0837 
cause_predict: train acc 0.9798 p 0.9714 r 0.9189 f1 0.9444
position_predict: train acc 0.9949 p 1.0000 r 0.9688 f1 0.9841
step 40: train loss 0.0663 
cause_predict: train acc 0.9877 p 0.9444 r 0.9714 f1 0.9577
position_predict: train acc 0.9918 p 0.9697 r 0.9697 f1 0.9697
step 50: train loss 0.0941 
cause_predict: train acc 0.9924 p 0.9744 r 0.9744 f1 0.9744
position_predict: train acc 0.9696 p 0.8529 r 0.9062 f1 0.8788
step 60: train loss 0.1450 
cause_predict: train acc 0.9808 p 0.9429 r 0.9429 f1 0.9429
position_predict: train acc 0.9615 p 0.8824 r 0.8824 f1 0.8824
step 70: train loss 0.1672 
cause_predict: train acc 0.9864 p 0.9697 r 0.9412 f1 0.9552
position_predict: train acc 0.9548 p 0.8710 r 0.8182 f1 0.8438

epoch 14: test loss 0.7738 cost time: 10.5s

cause_predict: test acc 0.8838 p 0.6084 r 0.5047 f1 0.5517
max_acc 0.8937 max_p 0.6367 max_r 0.5804 max_f1 0.6073

position_predict: test acc 0.9142 p 0.6753 r 0.6376 f1 0.6559
max_acc 0.9218 max_p 0.6918 max_r 0.7038 max_f1 0.6978

Average max cause: max_acc 0.8937 max_p 0.6367 max_r 0.5804 max_f1 0.6073
Average max pos: max_acc 0.9200 max_p 0.6985 max_r 0.6620 max_f1 0.6798

write pair_data/Ind_BiLSTM_1/fold_9_test.txt done
write pair_data/Ind_BiLSTM_1/fold_9_train.txt done
Optimization Finished!

############# fold 9 end ###############
############# fold 10 begin ###############
load data_file: data_combine_en/fold_10_train.txt
y_position.shape (2275, 75, 2)
y_cause.shape (2275, 75, 2)
x.shape (2275, 75, 30)
sen_len.shape (2275, 75)
doc_len.shape (2275,)
n_cut 107
load data done!

load data_file: data_combine_en/fold_10_test.txt
y_position.shape (284, 75, 2)
y_cause.shape (284, 75, 2)
x.shape (284, 75, 30)
sen_len.shape (284, 75)
doc_len.shape (284,)
n_cut 22
load data done!

train docs: 2275    test docs: 284
step 10: train loss 0.7825 
cause_predict: train acc 0.8521 p 0.0000 r 0.0000 f1 0.0000
position_predict: train acc 0.8716 p 0.0000 r 0.0000 f1 0.0000
step 20: train loss 0.7774 
cause_predict: train acc 0.8478 p 0.0000 r 0.0000 f1 0.0000
position_predict: train acc 0.8609 p 0.0000 r 0.0000 f1 0.0000
step 30: train loss 0.6483 
cause_predict: train acc 0.8694 p 0.0000 r 0.0000 f1 0.0000
position_predict: train acc 0.8806 p 0.0000 r 0.0000 f1 0.0000
step 40: train loss 0.5378 
cause_predict: train acc 0.8630 p 0.5000 r 0.0811 f1 0.1395
position_predict: train acc 0.9185 p 0.6923 r 0.5625 f1 0.6207
step 50: train loss 0.6985 
cause_predict: train acc 0.8235 p 1.0000 r 0.0270 f1 0.0526
position_predict: train acc 0.8873 p 0.7368 r 0.4375 f1 0.5490
step 60: train loss 0.5685 
cause_predict: train acc 0.8659 p 1.0000 r 0.0833 f1 0.1538
position_predict: train acc 0.9187 p 0.6875 r 0.6875 f1 0.6875
step 70: train loss 0.4778 
cause_predict: train acc 0.8980 p 0.9167 r 0.3143 f1 0.4681
position_predict: train acc 0.9265 p 0.7692 r 0.6250 f1 0.6897

epoch 0: test loss 0.5137 cost time: 10.7s

cause_predict: test acc 0.8776 p 0.6870 r 0.2492 f1 0.3657
max_acc 0.8776 max_p 0.6870 max_r 0.2492 max_f1 0.3657

position_predict: test acc 0.9214 p 0.7606 r 0.5645 f1 0.6480
max_acc 0.9214 max_p 0.7606 max_r 0.5645 max_f1 0.6480

Average max cause: max_acc 0.8776 max_p 0.6870 max_r 0.2492 max_f1 0.3657
Average max pos: max_acc 0.9214 max_p 0.7606 max_r 0.5645 max_f1 0.6480

step 10: train loss 0.4771 
cause_predict: train acc 0.8498 p 0.6071 r 0.4474 f1 0.5152
position_predict: train acc 0.9296 p 0.8696 r 0.6250 f1 0.7273
step 20: train loss 0.6507 
cause_predict: train acc 0.8309 p 0.5714 r 0.3158 f1 0.4068
position_predict: train acc 0.9082 p 0.7241 r 0.6562 f1 0.6885
step 30: train loss 0.5583 
cause_predict: train acc 0.8686 p 0.6000 r 0.4167 f1 0.4918
position_predict: train acc 0.9110 p 0.7200 r 0.5625 f1 0.6316
step 40: train loss 0.5760 
cause_predict: train acc 0.8318 p 0.6923 r 0.2195 f1 0.3333
position_predict: train acc 0.9252 p 0.9048 r 0.5758 f1 0.7037
step 50: train loss 0.5567 
cause_predict: train acc 0.8514 p 0.6000 r 0.2250 f1 0.3273
position_predict: train acc 0.9317 p 0.8261 r 0.5938 f1 0.6909
step 60: train loss 0.5931 
cause_predict: train acc 0.8491 p 0.6000 r 0.2368 f1 0.3396
position_predict: train acc 0.9440 p 0.8846 r 0.6970 f1 0.7797
step 70: train loss 0.5118 
cause_predict: train acc 0.8837 p 0.6190 r 0.3714 f1 0.4643
position_predict: train acc 0.9341 p 0.7857 r 0.6667 f1 0.7213

epoch 1: test loss 0.4798 cost time: 10.9s

cause_predict: test acc 0.8878 p 0.7063 r 0.3565 f1 0.4738
max_acc 0.8878 max_p 0.7063 max_r 0.3565 max_f1 0.4738

position_predict: test acc 0.9258 p 0.7354 r 0.6585 f1 0.6949
max_acc 0.9258 max_p 0.7354 max_r 0.6585 max_f1 0.6949

Average max cause: max_acc 0.8878 max_p 0.7063 max_r 0.3565 max_f1 0.4738
Average max pos: max_acc 0.9258 max_p 0.7354 max_r 0.6585 max_f1 0.6949

step 10: train loss 0.4510 
cause_predict: train acc 0.8722 p 0.6522 r 0.4167 f1 0.5085
position_predict: train acc 0.9427 p 0.7879 r 0.8125 f1 0.8000
step 20: train loss 0.3755 
cause_predict: train acc 0.8894 p 0.9167 r 0.3056 f1 0.4583
position_predict: train acc 0.9532 p 0.8621 r 0.7812 f1 0.8197
step 30: train loss 0.5509 
cause_predict: train acc 0.8483 p 0.6000 r 0.4054 f1 0.4839
position_predict: train acc 0.9336 p 0.8000 r 0.7500 f1 0.7742
step 40: train loss 0.4424 
cause_predict: train acc 0.8973 p 1.0000 r 0.2500 f1 0.4000
position_predict: train acc 0.9354 p 0.8000 r 0.6250 f1 0.7018
step 50: train loss 0.4773 
cause_predict: train acc 0.8606 p 0.5556 r 0.4688 f1 0.5085
position_predict: train acc 0.8894 p 0.6364 r 0.6562 f1 0.6462
step 60: train loss 0.4439 
cause_predict: train acc 0.8845 p 0.6190 r 0.3514 f1 0.4483
position_predict: train acc 0.9386 p 0.7273 r 0.7500 f1 0.7385
step 70: train loss 0.5084 
cause_predict: train acc 0.8627 p 0.6875 r 0.3235 f1 0.4400
position_predict: train acc 0.9118 p 0.7419 r 0.6970 f1 0.7188

epoch 2: test loss 0.4722 cost time: 11.0s

cause_predict: test acc 0.8901 p 0.7233 r 0.3628 f1 0.4832
max_acc 0.8901 max_p 0.7233 max_r 0.3628 max_f1 0.4832

position_predict: test acc 0.9303 p 0.7472 r 0.6899 f1 0.7174
max_acc 0.9303 max_p 0.7472 max_r 0.6899 max_f1 0.7174

Average max cause: max_acc 0.8901 max_p 0.7233 max_r 0.3628 max_f1 0.4832
Average max pos: max_acc 0.9303 max_p 0.7472 max_r 0.6899 max_f1 0.7174

step 10: train loss 0.4262 
cause_predict: train acc 0.8911 p 0.7200 r 0.5455 f1 0.6207
position_predict: train acc 0.9158 p 0.8077 r 0.6364 f1 0.7119
step 20: train loss 0.3111 
cause_predict: train acc 0.9091 p 0.5000 r 0.2000 f1 0.2857
position_predict: train acc 0.9377 p 0.6250 r 0.6250 f1 0.6250
step 30: train loss 0.3742 
cause_predict: train acc 0.9142 p 0.8421 r 0.4444 f1 0.5818
position_predict: train acc 0.9478 p 0.8000 r 0.7500 f1 0.7742
step 40: train loss 0.3329 
cause_predict: train acc 0.9344 p 0.8182 r 0.5143 f1 0.6316
position_predict: train acc 0.9344 p 0.6765 r 0.6970 f1 0.6866
step 50: train loss 0.4105 
cause_predict: train acc 0.8889 p 0.8636 r 0.5135 f1 0.6441
position_predict: train acc 0.9471 p 0.8667 r 0.8125 f1 0.8387
step 60: train loss 0.4857 
cause_predict: train acc 0.8979 p 0.7647 r 0.3939 f1 0.5200
position_predict: train acc 0.9149 p 0.7097 r 0.6667 f1 0.6875
step 70: train loss 0.5368 
cause_predict: train acc 0.8596 p 0.5556 r 0.2857 f1 0.3774
position_predict: train acc 0.9021 p 0.6800 r 0.5312 f1 0.5965

epoch 3: test loss 0.4809 cost time: 10.9s

cause_predict: test acc 0.8919 p 0.7778 r 0.3312 f1 0.4646
max_acc 0.8901 max_p 0.7233 max_r 0.3628 max_f1 0.4832

position_predict: test acc 0.9272 p 0.7366 r 0.6725 f1 0.7031
max_acc 0.9303 max_p 0.7472 max_r 0.6899 max_f1 0.7174

Average max cause: max_acc 0.8901 max_p 0.7233 max_r 0.3628 max_f1 0.4832
Average max pos: max_acc 0.9303 max_p 0.7472 max_r 0.6899 max_f1 0.7174

step 10: train loss 0.4390 
cause_predict: train acc 0.8835 p 0.6364 r 0.4000 f1 0.4912
position_predict: train acc 0.9237 p 0.7692 r 0.6061 f1 0.6780
step 20: train loss 0.2833 
cause_predict: train acc 0.9200 p 0.7857 r 0.6471 f1 0.7097
position_predict: train acc 0.9600 p 0.8529 r 0.8788 f1 0.8657
step 30: train loss 0.3772 
cause_predict: train acc 0.9024 p 0.7419 r 0.6571 f1 0.6970
position_predict: train acc 0.9268 p 0.7429 r 0.8125 f1 0.7761
step 40: train loss 0.4667 
cause_predict: train acc 0.8996 p 0.7500 r 0.3333 f1 0.4615
position_predict: train acc 0.9283 p 0.7308 r 0.5938 f1 0.6552
step 50: train loss 0.3564 
cause_predict: train acc 0.9114 p 0.7200 r 0.5143 f1 0.6000
position_predict: train acc 0.9336 p 0.7188 r 0.7188 f1 0.7188
step 60: train loss 0.3370 
cause_predict: train acc 0.9343 p 0.8400 r 0.6000 f1 0.7000
position_predict: train acc 0.9489 p 0.8276 r 0.7273 f1 0.7742
step 70: train loss 0.4480 
cause_predict: train acc 0.8770 p 0.7500 r 0.5143 f1 0.6102
position_predict: train acc 0.9465 p 0.8667 r 0.8125 f1 0.8387

epoch 4: test loss 0.4812 cost time: 11.2s

cause_predict: test acc 0.8905 p 0.6837 r 0.4227 f1 0.5224
max_acc 0.8905 max_p 0.6837 max_r 0.4227 max_f1 0.5224

position_predict: test acc 0.9223 p 0.7025 r 0.6829 f1 0.6926
max_acc 0.9303 max_p 0.7472 max_r 0.6899 max_f1 0.7174

Average max cause: max_acc 0.8905 max_p 0.6837 max_r 0.4227 max_f1 0.5224
Average max pos: max_acc 0.9223 max_p 0.7025 max_r 0.6829 max_f1 0.6926

step 10: train loss 0.3256 
cause_predict: train acc 0.9154 p 0.6667 r 0.6061 f1 0.6349
position_predict: train acc 0.9412 p 0.8214 r 0.6765 f1 0.7419
step 20: train loss 0.2299 
cause_predict: train acc 0.9318 p 0.8800 r 0.6471 f1 0.7458
position_predict: train acc 0.9591 p 0.8750 r 0.8485 f1 0.8615
step 30: train loss 0.2980 
cause_predict: train acc 0.9133 p 0.8276 r 0.7059 f1 0.7619
position_predict: train acc 0.9595 p 0.9032 r 0.8750 f1 0.8889
step 40: train loss 0.3054 
cause_predict: train acc 0.9245 p 0.7586 r 0.6286 f1 0.6875
position_predict: train acc 0.9547 p 0.7941 r 0.8438 f1 0.8182
step 50: train loss 0.3310 
cause_predict: train acc 0.9030 p 0.8077 r 0.5385 f1 0.6462
position_predict: train acc 0.9536 p 0.8387 r 0.8125 f1 0.8254
step 60: train loss 0.3379 
cause_predict: train acc 0.9004 p 0.7895 r 0.4286 f1 0.5556
position_predict: train acc 0.9461 p 0.7879 r 0.8125 f1 0.8000
step 70: train loss 0.4895 
cause_predict: train acc 0.8739 p 0.6800 r 0.4474 f1 0.5397
position_predict: train acc 0.9261 p 0.7419 r 0.7188 f1 0.7302

epoch 5: test loss 0.4715 cost time: 11.2s

cause_predict: test acc 0.8914 p 0.6595 r 0.4826 f1 0.5574
max_acc 0.8914 max_p 0.6595 max_r 0.4826 max_f1 0.5574

position_predict: test acc 0.9267 p 0.7158 r 0.7108 f1 0.7133
max_acc 0.9303 max_p 0.7472 max_r 0.6899 max_f1 0.7174

Average max cause: max_acc 0.8914 max_p 0.6595 max_r 0.4826 max_f1 0.5574
Average max pos: max_acc 0.9267 max_p 0.7158 max_r 0.7108 max_f1 0.7133

step 10: train loss 0.3588 
cause_predict: train acc 0.9105 p 0.8000 r 0.6857 f1 0.7385
position_predict: train acc 0.9579 p 0.8788 r 0.8788 f1 0.8788
step 20: train loss 0.3405 
cause_predict: train acc 0.9050 p 0.7500 r 0.7297 f1 0.7397
position_predict: train acc 0.9600 p 0.9286 r 0.8125 f1 0.8667
step 30: train loss 0.3012 
cause_predict: train acc 0.9087 p 0.7241 r 0.5833 f1 0.6462
position_predict: train acc 0.9444 p 0.8214 r 0.7188 f1 0.7667
step 40: train loss 0.2646 
cause_predict: train acc 0.9339 p 0.8065 r 0.7353 f1 0.7692
position_predict: train acc 0.9692 p 0.9032 r 0.8750 f1 0.8889
step 50: train loss 0.2340 
cause_predict: train acc 0.9182 p 0.7576 r 0.7143 f1 0.7353
position_predict: train acc 0.9864 p 0.9394 r 0.9688 f1 0.9538
step 60: train loss 0.2911 
cause_predict: train acc 0.9324 p 0.8065 r 0.7353 f1 0.7692
position_predict: train acc 0.9550 p 0.8667 r 0.8125 f1 0.8387
step 70: train loss 0.4063 
cause_predict: train acc 0.8849 p 0.6667 r 0.4737 f1 0.5538
position_predict: train acc 0.9603 p 0.9286 r 0.7647 f1 0.8387

epoch 6: test loss 0.5367 cost time: 11.1s

cause_predict: test acc 0.8861 p 0.6325 r 0.4669 f1 0.5372
max_acc 0.8914 max_p 0.6595 max_r 0.4826 max_f1 0.5574

position_predict: test acc 0.9147 p 0.6727 r 0.6516 f1 0.6619
max_acc 0.9303 max_p 0.7472 max_r 0.6899 max_f1 0.7174

Average max cause: max_acc 0.8914 max_p 0.6595 max_r 0.4826 max_f1 0.5574
Average max pos: max_acc 0.9267 max_p 0.7158 max_r 0.7108 max_f1 0.7133

step 10: train loss 0.2557 
cause_predict: train acc 0.9386 p 0.8857 r 0.7561 f1 0.8158
position_predict: train acc 0.9737 p 0.9091 r 0.9091 f1 0.9091
step 20: train loss 0.2215 
cause_predict: train acc 0.9545 p 0.8378 r 0.8611 f1 0.8493
position_predict: train acc 0.9463 p 0.7879 r 0.8125 f1 0.8000
step 30: train loss 0.2002 
cause_predict: train acc 0.9582 p 0.8438 r 0.7714 f1 0.8060
position_predict: train acc 0.9711 p 0.8710 r 0.8438 f1 0.8571
step 40: train loss 0.2288 
cause_predict: train acc 0.9244 p 0.9333 r 0.7179 f1 0.8116
position_predict: train acc 0.9709 p 0.9355 r 0.9062 f1 0.9206
step 50: train loss 0.1937 
cause_predict: train acc 0.9583 p 0.9677 r 0.7143 f1 0.8219
position_predict: train acc 0.9712 p 0.8529 r 0.8788 f1 0.8657
step 60: train loss 0.3855 
cause_predict: train acc 0.9186 p 0.7576 r 0.6579 f1 0.7042
position_predict: train acc 0.9302 p 0.7586 r 0.6667 f1 0.7097
step 70: train loss 0.1952 
cause_predict: train acc 0.9576 p 0.9310 r 0.7297 f1 0.8182
position_predict: train acc 0.9823 p 0.9355 r 0.9062 f1 0.9206

epoch 7: test loss 0.5590 cost time: 11.0s

cause_predict: test acc 0.8829 p 0.6291 r 0.4227 f1 0.5057
max_acc 0.8914 max_p 0.6595 max_r 0.4826 max_f1 0.5574

position_predict: test acc 0.9200 p 0.7000 r 0.6585 f1 0.6786
max_acc 0.9303 max_p 0.7472 max_r 0.6899 max_f1 0.7174

Average max cause: max_acc 0.8914 max_p 0.6595 max_r 0.4826 max_f1 0.5574
Average max pos: max_acc 0.9267 max_p 0.7158 max_r 0.7108 max_f1 0.7133

step 10: train loss 0.1840 
cause_predict: train acc 0.9649 p 0.8824 r 0.8333 f1 0.8571
position_predict: train acc 0.9649 p 0.8235 r 0.8750 f1 0.8485
step 20: train loss 0.3143 
cause_predict: train acc 0.9330 p 0.7500 r 0.8182 f1 0.7826
position_predict: train acc 0.9420 p 0.8125 r 0.7879 f1 0.8000
step 30: train loss 0.3107 
cause_predict: train acc 0.9244 p 0.8387 r 0.6842 f1 0.7536
position_predict: train acc 0.9600 p 0.8485 r 0.8750 f1 0.8615
step 40: train loss 0.2589 
cause_predict: train acc 0.9606 p 0.8824 r 0.8333 f1 0.8571
position_predict: train acc 0.9449 p 0.7812 r 0.7812 f1 0.7812
step 50: train loss 0.2641 
cause_predict: train acc 0.9385 p 0.9091 r 0.5882 f1 0.7143
position_predict: train acc 0.9577 p 0.8621 r 0.7812 f1 0.8197
step 60: train loss 0.2513 
cause_predict: train acc 0.9482 p 0.8056 r 0.7073 f1 0.7532
position_predict: train acc 0.9564 p 0.7812 r 0.7353 f1 0.7576
step 70: train loss 0.2747 
cause_predict: train acc 0.9458 p 0.7778 r 0.8000 f1 0.7887
position_predict: train acc 0.9422 p 0.7857 r 0.6875 f1 0.7333

epoch 8: test loss 0.6171 cost time: 11.0s

cause_predict: test acc 0.8776 p 0.5765 r 0.5110 f1 0.5418
max_acc 0.8914 max_p 0.6595 max_r 0.4826 max_f1 0.5574

position_predict: test acc 0.9178 p 0.6873 r 0.6585 f1 0.6726
max_acc 0.9303 max_p 0.7472 max_r 0.6899 max_f1 0.7174

Average max cause: max_acc 0.8914 max_p 0.6595 max_r 0.4826 max_f1 0.5574
Average max pos: max_acc 0.9267 max_p 0.7158 max_r 0.7108 max_f1 0.7133

step 10: train loss 0.2181 
cause_predict: train acc 0.9747 p 0.9459 r 0.8974 f1 0.9211
position_predict: train acc 0.9283 p 0.7742 r 0.7059 f1 0.7385
step 20: train loss 0.1853 
cause_predict: train acc 0.9638 p 0.9688 r 0.8158 f1 0.8857
position_predict: train acc 0.9683 p 0.9062 r 0.8788 f1 0.8923
step 30: train loss 0.2032 
cause_predict: train acc 0.9437 p 0.8710 r 0.7714 f1 0.8182
position_predict: train acc 0.9624 p 0.8529 r 0.9062 f1 0.8788
step 40: train loss 0.2112 
cause_predict: train acc 0.9572 p 0.8857 r 0.7750 f1 0.8267
position_predict: train acc 0.9671 p 0.8235 r 0.8750 f1 0.8485
step 50: train loss 0.1977 
cause_predict: train acc 0.9705 p 0.8857 r 0.9118 f1 0.8986
position_predict: train acc 0.9620 p 0.8710 r 0.8438 f1 0.8571
step 60: train loss 0.1600 
cause_predict: train acc 0.9594 p 0.8571 r 0.8333 f1 0.8451
position_predict: train acc 0.9852 p 0.9375 r 0.9375 f1 0.9375
step 70: train loss 0.2114 
cause_predict: train acc 0.9624 p 0.8611 r 0.9118 f1 0.8857
position_predict: train acc 0.9531 p 0.8438 r 0.8438 f1 0.8438

epoch 9: test loss 0.6454 cost time: 10.9s

cause_predict: test acc 0.8633 p 0.5167 r 0.5363 f1 0.5263
max_acc 0.8914 max_p 0.6595 max_r 0.4826 max_f1 0.5574

position_predict: test acc 0.9178 p 0.6859 r 0.6620 f1 0.6738
max_acc 0.9303 max_p 0.7472 max_r 0.6899 max_f1 0.7174

Average max cause: max_acc 0.8914 max_p 0.6595 max_r 0.4826 max_f1 0.5574
Average max pos: max_acc 0.9267 max_p 0.7158 max_r 0.7108 max_f1 0.7133

step 10: train loss 0.1486 
cause_predict: train acc 0.9715 p 0.8750 r 0.8485 f1 0.8615
position_predict: train acc 0.9620 p 0.8125 r 0.8125 f1 0.8125
step 20: train loss 0.1343 
cause_predict: train acc 0.9683 p 0.9032 r 0.8750 f1 0.8889
position_predict: train acc 0.9819 p 0.9375 r 0.9375 f1 0.9375
step 30: train loss 0.1657 
cause_predict: train acc 0.9674 p 0.8649 r 0.9412 f1 0.9014
position_predict: train acc 0.9674 p 0.9062 r 0.8788 f1 0.8923
step 40: train loss 0.1360 
cause_predict: train acc 0.9809 p 0.9706 r 0.8919 f1 0.9296
position_predict: train acc 0.9847 p 0.9375 r 0.9375 f1 0.9375
step 50: train loss 0.1580 
cause_predict: train acc 0.9535 p 0.8621 r 0.7576 f1 0.8065
position_predict: train acc 0.9806 p 0.9091 r 0.9375 f1 0.9231
step 60: train loss 0.2248 
cause_predict: train acc 0.9309 p 0.8205 r 0.8000 f1 0.8101
position_predict: train acc 0.9770 p 0.9355 r 0.9062 f1 0.9206
step 70: train loss 0.2462 
cause_predict: train acc 0.9190 p 0.9118 r 0.6889 f1 0.7848
position_predict: train acc 0.9524 p 0.8710 r 0.8182 f1 0.8438

epoch 10: test loss 0.6694 cost time: 10.9s

cause_predict: test acc 0.8829 p 0.6007 r 0.5174 f1 0.5559
max_acc 0.8914 max_p 0.6595 max_r 0.4826 max_f1 0.5574

position_predict: test acc 0.9223 p 0.7025 r 0.6829 f1 0.6926
max_acc 0.9303 max_p 0.7472 max_r 0.6899 max_f1 0.7174

Average max cause: max_acc 0.8914 max_p 0.6595 max_r 0.4826 max_f1 0.5574
Average max pos: max_acc 0.9267 max_p 0.7158 max_r 0.7108 max_f1 0.7133

step 10: train loss 0.0905 
cause_predict: train acc 0.9829 p 0.9167 r 0.9429 f1 0.9296
position_predict: train acc 0.9932 p 1.0000 r 0.9375 f1 0.9677
step 20: train loss 0.1853 
cause_predict: train acc 0.9662 p 0.9048 r 0.8837 f1 0.8941
position_predict: train acc 0.9662 p 0.8750 r 0.8485 f1 0.8615
step 30: train loss 0.2063 
cause_predict: train acc 0.9526 p 0.8750 r 0.8235 f1 0.8485
position_predict: train acc 0.9573 p 0.9000 r 0.8182 f1 0.8571
step 40: train loss 0.1453 
cause_predict: train acc 0.9746 p 0.9231 r 0.8780 f1 0.9000
position_predict: train acc 0.9651 p 0.8182 r 0.8438 f1 0.8308
step 50: train loss 0.1468 
cause_predict: train acc 0.9683 p 0.9677 r 0.8333 f1 0.8955
position_predict: train acc 0.9683 p 0.8788 r 0.9062 f1 0.8923
step 60: train loss 0.2872 
cause_predict: train acc 0.9400 p 0.8182 r 0.8182 f1 0.8182
position_predict: train acc 0.9500 p 0.8235 r 0.8750 f1 0.8485
step 70: train loss 0.1645 
cause_predict: train acc 0.9675 p 0.8889 r 0.8889 f1 0.8889
position_predict: train acc 0.9675 p 0.9032 r 0.8485 f1 0.8750

epoch 11: test loss 0.6846 cost time: 11.1s

cause_predict: test acc 0.8820 p 0.6008 r 0.4984 f1 0.5448
max_acc 0.8914 max_p 0.6595 max_r 0.4826 max_f1 0.5574

position_predict: test acc 0.9133 p 0.6643 r 0.6551 f1 0.6596
max_acc 0.9303 max_p 0.7472 max_r 0.6899 max_f1 0.7174

Average max cause: max_acc 0.8914 max_p 0.6595 max_r 0.4826 max_f1 0.5574
Average max pos: max_acc 0.9267 max_p 0.7158 max_r 0.7108 max_f1 0.7133

step 10: train loss 0.1386 
cause_predict: train acc 0.9856 p 0.9459 r 0.9459 f1 0.9459
position_predict: train acc 0.9675 p 0.8750 r 0.8485 f1 0.8615
step 20: train loss 0.1697 
cause_predict: train acc 0.9540 p 0.7949 r 0.9118 f1 0.8493
position_predict: train acc 0.9791 p 0.9118 r 0.9394 f1 0.9254
step 30: train loss 0.1095 
cause_predict: train acc 0.9673 p 0.8649 r 0.9143 f1 0.8889
position_predict: train acc 0.9796 p 0.9091 r 0.9375 f1 0.9231
step 40: train loss 0.1364 
cause_predict: train acc 0.9779 p 0.9730 r 0.9000 f1 0.9351
position_predict: train acc 0.9779 p 0.9091 r 0.9375 f1 0.9231
step 50: train loss 0.0940 
cause_predict: train acc 0.9781 p 0.9412 r 0.9412 f1 0.9412
position_predict: train acc 0.9836 p 0.9394 r 0.9688 f1 0.9538
step 60: train loss 0.1628 
cause_predict: train acc 0.9748 p 0.9091 r 0.9091 f1 0.9091
position_predict: train acc 0.9622 p 0.8485 r 0.8750 f1 0.8615
step 70: train loss 0.1611 
cause_predict: train acc 0.9676 p 0.8718 r 0.9444 f1 0.9067
position_predict: train acc 0.9583 p 0.8710 r 0.8438 f1 0.8571

epoch 12: test loss 0.7350 cost time: 10.8s

cause_predict: test acc 0.8767 p 0.5668 r 0.5489 f1 0.5577
max_acc 0.8767 max_p 0.5668 max_r 0.5489 max_f1 0.5577

position_predict: test acc 0.9124 p 0.6553 r 0.6690 f1 0.6621
max_acc 0.9303 max_p 0.7472 max_r 0.6899 max_f1 0.7174

Average max cause: max_acc 0.8914 max_p 0.6595 max_r 0.4826 max_f1 0.5574
Average max pos: max_acc 0.9267 max_p 0.7158 max_r 0.7108 max_f1 0.7133

step 10: train loss 0.1001 
cause_predict: train acc 0.9925 p 1.0000 r 0.9459 f1 0.9722
position_predict: train acc 0.9624 p 0.8438 r 0.8438 f1 0.8438
step 20: train loss 0.1591 
cause_predict: train acc 0.9548 p 0.8919 r 0.8462 f1 0.8684
position_predict: train acc 0.9774 p 0.9355 r 0.9062 f1 0.9206
step 30: train loss 0.1458 
cause_predict: train acc 0.9791 p 0.9394 r 0.8857 f1 0.9118
position_predict: train acc 0.9617 p 0.8387 r 0.8125 f1 0.8254
step 40: train loss 0.0771 
cause_predict: train acc 0.9853 p 0.9706 r 0.9167 f1 0.9429
position_predict: train acc 0.9890 p 0.9394 r 0.9688 f1 0.9538
step 50: train loss 0.0828 
cause_predict: train acc 0.9873 p 0.9474 r 0.9730 f1 0.9600
position_predict: train acc 0.9831 p 0.9375 r 0.9375 f1 0.9375
step 60: train loss 0.0945 
cause_predict: train acc 0.9844 p 0.9697 r 0.9143 f1 0.9412
position_predict: train acc 0.9805 p 0.9375 r 0.9091 f1 0.9231
step 70: train loss 0.1480 
cause_predict: train acc 0.9595 p 0.8636 r 0.9048 f1 0.8837
position_predict: train acc 0.9757 p 0.8824 r 0.9375 f1 0.9091

epoch 13: test loss 0.7222 cost time: 10.9s

cause_predict: test acc 0.8861 p 0.6026 r 0.5741 f1 0.5880
max_acc 0.8861 max_p 0.6026 max_r 0.5741 max_f1 0.5880

position_predict: test acc 0.9120 p 0.6642 r 0.6341 f1 0.6488
max_acc 0.9303 max_p 0.7472 max_r 0.6899 max_f1 0.7174

Average max cause: max_acc 0.8914 max_p 0.6595 max_r 0.4826 max_f1 0.5574
Average max pos: max_acc 0.9267 max_p 0.7158 max_r 0.7108 max_f1 0.7133

step 10: train loss 0.1181 
cause_predict: train acc 0.9727 p 0.9688 r 0.8611 f1 0.9118
position_predict: train acc 0.9818 p 0.9394 r 0.9394 f1 0.9394
step 20: train loss 0.1319 
cause_predict: train acc 0.9680 p 0.8611 r 0.9118 f1 0.8857
position_predict: train acc 0.9720 p 0.9062 r 0.8788 f1 0.8923
step 30: train loss 0.0767 
cause_predict: train acc 0.9898 p 0.9730 r 0.9730 f1 0.9730
position_predict: train acc 0.9695 p 0.9091 r 0.9091 f1 0.9091
step 40: train loss 0.1193 
cause_predict: train acc 0.9845 p 0.9730 r 0.9474 f1 0.9600
position_predict: train acc 0.9691 p 0.8649 r 0.9697 f1 0.9143
step 50: train loss 0.0903 
cause_predict: train acc 0.9950 p 0.9714 r 1.0000 f1 0.9855
position_predict: train acc 0.9750 p 0.9375 r 0.9091 f1 0.9231
step 60: train loss 0.0901 
cause_predict: train acc 0.9891 p 0.9688 r 0.9394 f1 0.9538
position_predict: train acc 0.9891 p 0.9677 r 0.9375 f1 0.9524
step 70: train loss 0.1786 
cause_predict: train acc 0.9491 p 0.8485 r 0.8235 f1 0.8358
position_predict: train acc 0.9583 p 0.8485 r 0.8750 f1 0.8615

epoch 14: test loss 0.7879 cost time: 11.1s

cause_predict: test acc 0.8843 p 0.6036 r 0.5331 f1 0.5662
max_acc 0.8861 max_p 0.6026 max_r 0.5741 max_f1 0.5880

2024-06-22 18:59:04.180881: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1639] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 12703 MB memory:  -> device: 0, name: NVIDIA GeForce RTX 4080, pci bus id: 0000:3b:00.0, compute capability: 8.9
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/code/ECPE-master/utils/tf_funcs.py:181: UserWarning: `tf.nn.rnn_cell.LSTMCell` is deprecated and will be removed in a future version. This class is equivalent as `tf.keras.layers.LSTMCell`, and will be replaced by that in Tensorflow 2.0.
  cell_fw=tf.nn.rnn_cell.LSTMCell(n_hidden),
/home/oycj/code/ECPE-master/utils/tf_funcs.py:182: UserWarning: `tf.nn.rnn_cell.LSTMCell` is deprecated and will be removed in a future version. This class is equivalent as `tf.keras.layers.LSTMCell`, and will be replaced by that in Tensorflow 2.0.
  cell_bw=tf.nn.rnn_cell.LSTMCell(n_hidden),
position_predict: test acc 0.9111 p 0.6477 r 0.6725 f1 0.6598
max_acc 0.9303 max_p 0.7472 max_r 0.6899 max_f1 0.7174

Average max cause: max_acc 0.8914 max_p 0.6595 max_r 0.4826 max_f1 0.5574
Average max pos: max_acc 0.9267 max_p 0.7158 max_r 0.7108 max_f1 0.7133

write pair_data/Ind_BiLSTM_1/fold_10_test.txt done
write pair_data/Ind_BiLSTM_1/fold_10_train.txt done
Optimization Finished!

############# fold 10 end ###############


>>>>>>>>>>>>>>>>>>>>TRAINING INFO:

batch-32, lr-0.005, kb1-0.8, kb2-1.0, l2_reg-1e-05
training_iter-15, scope-Ind_BiLSTM_1


cause_predict: test f1 in 10 fold: [[0.55210238]
 [0.57097289]
 [0.57482993]
 [0.57594937]
 [0.55555556]
 [0.58471761]
 [0.59872611]
 [0.59495798]
 [0.60726073]
 [0.55737705]]
average : acc 0.8885 p 0.6263 r 0.5391 f1 0.5772

position_predict: test f1 in 10 fold: [[0.70037453]
 [0.67595819]
 [0.68402778]
 [0.68892794]
 [0.70758123]
 [0.68928571]
 [0.67741935]
 [0.69026549]
 [0.67978533]
 [0.71328671]]
average : acc 0.9223 p 0.7064 r 0.6763 f1 0.6907


----------2024-06-22 18:59:00----------

----------2024-06-22 18:59:00----------

load embedding...
w2v_file: data_en/w2v_200.txt
all_words: 14316 hit_words: 10987
embedding.shape: (14317, 200) embedding_pos.shape: (201, 50)
load embedding done!

build model...
build model done!



>>>>>>>>>>>>>>>>>>>>TRAINING INFO:

batch-32, lr-0.005, kb1-0.8, kb2-1.0, l2_reg-1e-05
training_iter-15, scope-Ind_BiLSTM_2

############# fold 1 begin ###############
load data_file: data_combine_en/fold_1_train.txt
y_position.shape (2275, 75, 2)
y_cause.shape (2275, 75, 2)
x.shape (2275, 75, 30)
sen_len.shape (2275, 75)
doc_len.shape (2275,)
n_cut 107
load data done!

load data_file: data_combine_en/fold_1_test.txt
y_position.shape (284, 75, 2)
y_cause.shape (284, 75, 2)
x.shape (284, 75, 30)
sen_len.shape (284, 75)
doc_len.shape (284,)
n_cut 22
load data done!

train docs: 2275    test docs: 284
step 10: train loss 0.9079 
cause_predict: train acc 0.8229 p 0.0000 r 0.0000 f1 0.0000
position_predict: train acc 0.8281 p 0.0000 r 0.0000 f1 0.0000
step 20: train loss 0.8009 
cause_predict: train acc 0.8232 p 0.0000 r 0.0000 f1 0.0000
position_predict: train acc 0.8333 p 0.0000 r 0.0000 f1 0.0000
step 30: train loss 0.6657 
cause_predict: train acc 0.8635 p 0.0000 r 0.0000 f1 0.0000
position_predict: train acc 0.8819 p 0.0000 r 0.0000 f1 0.0000
step 40: train loss 0.6984 
cause_predict: train acc 0.8102 p 0.0000 r 0.0000 f1 0.0000
position_predict: train acc 0.8750 p 0.6190 r 0.4062 f1 0.4906
step 50: train loss 0.5567 
cause_predict: train acc 0.8956 p 1.0000 r 0.1875 f1 0.3158
position_predict: train acc 0.9036 p 0.6452 r 0.6061 f1 0.6250
step 60: train loss 0.5623 
cause_predict: train acc 0.8889 p 0.8333 r 0.1471 f1 0.2500
position_predict: train acc 0.9111 p 0.7000 r 0.4375 f1 0.5385
step 70: train loss 0.4933 
cause_predict: train acc 0.8798 p 0.6667 r 0.2286 f1 0.3404
position_predict: train acc 0.9186 p 0.7200 r 0.5625 f1 0.6316

epoch 0: test loss 0.5219 cost time: 13.5s

cause_predict: test acc 0.8776 p 0.7945 r 0.1830 f1 0.2974
max_acc 0.8776 max_p 0.7945 max_r 0.1830 max_f1 0.2974

position_predict: test acc 0.9129 p 0.6742 r 0.6202 f1 0.6461
max_acc 0.9129 max_p 0.6742 max_r 0.6202 max_f1 0.6461

Average max cause: max_acc 0.8776 max_p 0.7945 max_r 0.1830 max_f1 0.2974
Average max pos: max_acc 0.9129 max_p 0.6742 max_r 0.6202 max_f1 0.6461

step 10: train loss 0.4984 
cause_predict: train acc 0.8636 p 0.6667 r 0.1667 f1 0.2667
position_predict: train acc 0.9298 p 0.7857 r 0.6667 f1 0.7213
step 20: train loss 0.4696 
cause_predict: train acc 0.8979 p 0.7619 r 0.4571 f1 0.5714
position_predict: train acc 0.9234 p 0.7917 r 0.5938 f1 0.6786
step 30: train loss 0.4667 
cause_predict: train acc 0.8924 p 0.7500 r 0.4412 f1 0.5556
position_predict: train acc 0.9103 p 0.7143 r 0.6250 f1 0.6667
step 40: train loss 0.5508 
cause_predict: train acc 0.8607 p 0.7000 r 0.3889 f1 0.5000
position_predict: train acc 0.9204 p 0.8077 r 0.6562 f1 0.7241
step 50: train loss 0.5144 
cause_predict: train acc 0.8728 p 0.7647 r 0.3421 f1 0.4727
position_predict: train acc 0.9386 p 0.8571 r 0.7059 f1 0.7742
step 60: train loss 0.3872 
cause_predict: train acc 0.9094 p 0.7500 r 0.2727 f1 0.4000
position_predict: train acc 0.9161 p 0.6207 r 0.5625 f1 0.5902
step 70: train loss 0.5409 
cause_predict: train acc 0.8787 p 0.7368 r 0.3684 f1 0.4912
position_predict: train acc 0.9205 p 0.7500 r 0.6364 f1 0.6885

epoch 1: test loss 0.4777 cost time: 10.8s

cause_predict: test acc 0.8887 p 0.7297 r 0.3407 f1 0.4645
max_acc 0.8887 max_p 0.7297 max_r 0.3407 max_f1 0.4645

position_predict: test acc 0.9169 p 0.7205 r 0.5749 f1 0.6395
max_acc 0.9129 max_p 0.6742 max_r 0.6202 max_f1 0.6461

Average max cause: max_acc 0.8887 max_p 0.7297 max_r 0.3407 max_f1 0.4645
Average max pos: max_acc 0.9169 max_p 0.7205 max_r 0.5749 max_f1 0.6395

step 10: train loss 0.4946 
cause_predict: train acc 0.8885 p 0.6923 r 0.2647 f1 0.3830
position_predict: train acc 0.9038 p 0.6522 r 0.4688 f1 0.5455
step 20: train loss 0.5211 
cause_predict: train acc 0.8571 p 0.6000 r 0.2647 f1 0.3673
position_predict: train acc 0.8986 p 0.6667 r 0.6667 f1 0.6667
step 30: train loss 0.3920 
cause_predict: train acc 0.8997 p 1.0000 r 0.2250 f1 0.3673
position_predict: train acc 0.9515 p 0.7742 r 0.7500 f1 0.7619
step 40: train loss 0.4871 
cause_predict: train acc 0.8694 p 0.6364 r 0.4000 f1 0.4912
position_predict: train acc 0.9324 p 0.7931 r 0.7188 f1 0.7541
step 50: train loss 0.5225 
cause_predict: train acc 0.8691 p 0.7368 r 0.4118 f1 0.5283
position_predict: train acc 0.9005 p 0.7407 r 0.6250 f1 0.6780
step 60: train loss 0.5099 
cause_predict: train acc 0.8715 p 0.6842 r 0.3333 f1 0.4483
position_predict: train acc 0.9036 p 0.6429 r 0.5625 f1 0.6000
step 70: train loss 0.4082 
cause_predict: train acc 0.9160 p 0.7692 r 0.5714 f1 0.6557
position_predict: train acc 0.9320 p 0.8261 r 0.5938 f1 0.6909

epoch 2: test loss 0.4607 cost time: 11.0s

cause_predict: test acc 0.8905 p 0.6682 r 0.4511 f1 0.5386
max_acc 0.8905 max_p 0.6682 max_r 0.4511 max_f1 0.5386

position_predict: test acc 0.9272 p 0.7460 r 0.6551 f1 0.6976
max_acc 0.9272 max_p 0.7460 max_r 0.6551 max_f1 0.6976

Average max cause: max_acc 0.8905 max_p 0.6682 max_r 0.4511 max_f1 0.5386
Average max pos: max_acc 0.9272 max_p 0.7460 max_r 0.6551 max_f1 0.6976

step 10: train loss 0.4357 
cause_predict: train acc 0.8894 p 0.6818 r 0.4545 f1 0.5455
position_predict: train acc 0.9381 p 0.7812 r 0.7812 f1 0.7812
step 20: train loss 0.3365 
cause_predict: train acc 0.9424 p 0.7308 r 0.5938 f1 0.6552
position_predict: train acc 0.9308 p 0.6800 r 0.5152 f1 0.5862
step 30: train loss 0.4817 
cause_predict: train acc 0.8445 p 0.5417 r 0.3333 f1 0.4127
position_predict: train acc 0.9286 p 0.7419 r 0.7188 f1 0.7302
step 40: train loss 0.4596 
cause_predict: train acc 0.8975 p 0.7778 r 0.4000 f1 0.5283
position_predict: train acc 0.9016 p 0.6452 r 0.6061 f1 0.6250
step 50: train loss 0.4391 
cause_predict: train acc 0.9058 p 0.9412 r 0.4444 f1 0.6038
position_predict: train acc 0.9372 p 0.8214 r 0.7188 f1 0.7667
step 60: train loss 0.4731 
cause_predict: train acc 0.8684 p 0.7200 r 0.5000 f1 0.5902
position_predict: train acc 0.9158 p 0.7742 r 0.7273 f1 0.7500
step 70: train loss 0.5776 
cause_predict: train acc 0.8258 p 0.5714 r 0.4571 f1 0.5079
position_predict: train acc 0.9157 p 0.7931 r 0.7188 f1 0.7541

epoch 3: test loss 0.4776 cost time: 10.5s

cause_predict: test acc 0.8905 p 0.6748 r 0.4385 f1 0.5315
max_acc 0.8905 max_p 0.6682 max_r 0.4511 max_f1 0.5386

position_predict: test acc 0.9254 p 0.7055 r 0.7178 f1 0.7116
max_acc 0.9254 max_p 0.7055 max_r 0.7178 max_f1 0.7116

Average max cause: max_acc 0.8905 max_p 0.6748 max_r 0.4385 max_f1 0.5315
Average max pos: max_acc 0.9254 max_p 0.7055 max_r 0.7178 max_f1 0.7116

step 10: train loss 0.3804 
cause_predict: train acc 0.9163 p 0.8214 r 0.6389 f1 0.7187
position_predict: train acc 0.9209 p 0.7143 r 0.7812 f1 0.7463
step 20: train loss 0.3655 
cause_predict: train acc 0.9013 p 0.7826 r 0.5143 f1 0.6207
position_predict: train acc 0.9238 p 0.7143 r 0.7812 f1 0.7463
step 30: train loss 0.3118 
cause_predict: train acc 0.9185 p 0.7917 r 0.5278 f1 0.6333
position_predict: train acc 0.9481 p 0.8000 r 0.7500 f1 0.7742
step 40: train loss 0.2856 
cause_predict: train acc 0.9355 p 0.7857 r 0.6471 f1 0.7097
position_predict: train acc 0.9498 p 0.8750 r 0.6562 f1 0.7500
step 50: train loss 0.4322 
cause_predict: train acc 0.9067 p 0.7619 r 0.4444 f1 0.5614
position_predict: train acc 0.9104 p 0.6786 r 0.5588 f1 0.6129
step 60: train loss 0.4050 
cause_predict: train acc 0.8756 p 0.6250 r 0.5714 f1 0.5970
position_predict: train acc 0.9309 p 0.7742 r 0.7500 f1 0.7619
step 70: train loss 0.3243 
cause_predict: train acc 0.9227 p 0.8696 r 0.5714 f1 0.6897
position_predict: train acc 0.9528 p 0.8182 r 0.8438 f1 0.8308

epoch 4: test loss 0.4788 cost time: 10.3s

cause_predict: test acc 0.8883 p 0.6476 r 0.4637 f1 0.5404
max_acc 0.8883 max_p 0.6476 max_r 0.4637 max_f1 0.5404

position_predict: test acc 0.9307 p 0.7308 r 0.7282 f1 0.7295
max_acc 0.9307 max_p 0.7308 max_r 0.7282 max_f1 0.7295

Average max cause: max_acc 0.8883 max_p 0.6476 max_r 0.4637 max_f1 0.5404
Average max pos: max_acc 0.9307 max_p 0.7308 max_r 0.7282 max_f1 0.7295

step 10: train loss 0.2601 
cause_predict: train acc 0.9324 p 0.7667 r 0.6571 f1 0.7077
position_predict: train acc 0.9609 p 0.8667 r 0.7879 f1 0.8254
step 20: train loss 0.2744 
cause_predict: train acc 0.9404 p 0.8387 r 0.6842 f1 0.7536
position_predict: train acc 0.9439 p 0.7353 r 0.7812 f1 0.7576
step 30: train loss 0.2337 
cause_predict: train acc 0.9437 p 0.8000 r 0.7059 f1 0.7500
position_predict: train acc 0.9542 p 0.7941 r 0.8182 f1 0.8060
step 40: train loss 0.2494 
cause_predict: train acc 0.9313 p 0.8214 r 0.6765 f1 0.7419
position_predict: train acc 0.9657 p 0.9000 r 0.8438 f1 0.8710
step 50: train loss 0.4174 
cause_predict: train acc 0.9275 p 0.8571 r 0.7059 f1 0.7742
position_predict: train acc 0.9275 p 0.7812 r 0.7812 f1 0.7812
step 60: train loss 0.4505 
cause_predict: train acc 0.9140 p 0.7586 r 0.6471 f1 0.6984
position_predict: train acc 0.9186 p 0.7333 r 0.6875 f1 0.7097
step 70: train loss 0.3904 
cause_predict: train acc 0.9194 p 0.6562 r 0.6562 f1 0.6562
position_predict: train acc 0.9304 p 0.7407 r 0.6250 f1 0.6780

epoch 5: test loss 0.4962 cost time: 10.7s

cause_predict: test acc 0.8910 p 0.6540 r 0.4890 f1 0.5596
max_acc 0.8910 max_p 0.6540 max_r 0.4890 max_f1 0.5596

position_predict: test acc 0.9240 p 0.6983 r 0.7178 f1 0.7079
max_acc 0.9307 max_p 0.7308 max_r 0.7282 max_f1 0.7295

Average max cause: max_acc 0.8883 max_p 0.6476 max_r 0.4637 max_f1 0.5404
Average max pos: max_acc 0.9307 max_p 0.7308 max_r 0.7282 max_f1 0.7295

step 10: train loss 0.3455 
cause_predict: train acc 0.9289 p 0.8529 r 0.7436 f1 0.7945
position_predict: train acc 0.9479 p 0.8929 r 0.7576 f1 0.8197
step 20: train loss 0.3411 
cause_predict: train acc 0.9005 p 0.7879 r 0.6500 f1 0.7123
position_predict: train acc 0.9716 p 0.9091 r 0.9091 f1 0.9091
step 30: train loss 0.2574 
cause_predict: train acc 0.9242 p 0.8333 r 0.6944 f1 0.7576
position_predict: train acc 0.9763 p 0.9091 r 0.9375 f1 0.9231
step 40: train loss 0.3304 
cause_predict: train acc 0.9231 p 0.7647 r 0.7222 f1 0.7429
position_predict: train acc 0.9402 p 0.8276 r 0.7273 f1 0.7742
step 50: train loss 0.2639 
cause_predict: train acc 0.9524 p 0.8182 r 0.8438 f1 0.8308
position_predict: train acc 0.9481 p 0.8333 r 0.7812 f1 0.8065
step 60: train loss 0.3324 
cause_predict: train acc 0.9220 p 0.8889 r 0.6316 f1 0.7385
position_predict: train acc 0.9633 p 0.9286 r 0.8125 f1 0.8667
step 70: train loss 0.3066 
cause_predict: train acc 0.9283 p 0.7576 r 0.7143 f1 0.7353
position_predict: train acc 0.9602 p 0.8485 r 0.8485 f1 0.8485

epoch 6: test loss 0.5004 cost time: 10.6s

cause_predict: test acc 0.8892 p 0.6211 r 0.5584 f1 0.5880
max_acc 0.8892 max_p 0.6211 max_r 0.5584 max_f1 0.5880

position_predict: test acc 0.9240 p 0.7191 r 0.6690 f1 0.6931
max_acc 0.9307 max_p 0.7308 max_r 0.7282 max_f1 0.7295

Average max cause: max_acc 0.8892 max_p 0.6211 max_r 0.5584 max_f1 0.5880
Average max pos: max_acc 0.9240 max_p 0.7191 max_r 0.6690 max_f1 0.6931

step 10: train loss 0.2511 
cause_predict: train acc 0.9270 p 0.8438 r 0.6429 f1 0.7297
position_predict: train acc 0.9745 p 0.8788 r 0.9062 f1 0.8923
step 20: train loss 0.2598 
cause_predict: train acc 0.9333 p 0.7778 r 0.8235 f1 0.8000
position_predict: train acc 0.9476 p 0.8182 r 0.8438 f1 0.8308
step 30: train loss 0.3016 
cause_predict: train acc 0.9333 p 0.8333 r 0.6944 f1 0.7576
position_predict: train acc 0.9458 p 0.7879 r 0.8125 f1 0.8000
step 40: train loss 0.2026 
cause_predict: train acc 0.9494 p 0.8158 r 0.8378 f1 0.8267
position_predict: train acc 0.9689 p 0.8750 r 0.8750 f1 0.8750
step 50: train loss 0.2743 
cause_predict: train acc 0.9537 p 0.8710 r 0.8182 f1 0.8438
position_predict: train acc 0.9352 p 0.7647 r 0.8125 f1 0.7879
step 60: train loss 0.3594 
cause_predict: train acc 0.9381 p 0.7576 r 0.7143 f1 0.7353
position_predict: train acc 0.9038 p 0.5625 r 0.5625 f1 0.5625
step 70: train loss 0.2664 
cause_predict: train acc 0.9427 p 0.9200 r 0.6765 f1 0.7797
position_predict: train acc 0.9559 p 0.8667 r 0.8125 f1 0.8387

epoch 7: test loss 0.5511 cost time: 10.7s

cause_predict: test acc 0.8834 p 0.6120 r 0.4826 f1 0.5397
max_acc 0.8892 max_p 0.6211 max_r 0.5584 max_f1 0.5880

position_predict: test acc 0.9151 p 0.6611 r 0.6934 f1 0.6769
max_acc 0.9307 max_p 0.7308 max_r 0.7282 max_f1 0.7295

Average max cause: max_acc 0.8892 max_p 0.6211 max_r 0.5584 max_f1 0.5880
Average max pos: max_acc 0.9240 max_p 0.7191 max_r 0.6690 max_f1 0.6931

step 10: train loss 0.2506 
cause_predict: train acc 0.9378 p 0.8611 r 0.7949 f1 0.8267
position_predict: train acc 0.9713 p 0.9062 r 0.9062 f1 0.9062
step 20: train loss 0.2973 
cause_predict: train acc 0.9384 p 0.9062 r 0.7436 f1 0.8169
position_predict: train acc 0.9384 p 0.8333 r 0.7576 f1 0.7937
step 30: train loss 0.2217 
cause_predict: train acc 0.9407 p 0.8000 r 0.7778 f1 0.7887
position_predict: train acc 0.9763 p 0.9062 r 0.9062 f1 0.9062
step 40: train loss 0.1205 
cause_predict: train acc 0.9824 p 0.9706 r 0.8919 f1 0.9296
position_predict: train acc 0.9718 p 0.8788 r 0.8788 f1 0.8788
step 50: train loss 0.2739 
cause_predict: train acc 0.9583 p 0.8710 r 0.7714 f1 0.8182
position_predict: train acc 0.9410 p 0.7419 r 0.7188 f1 0.7302
step 60: train loss 0.2190 
cause_predict: train acc 0.9591 p 0.9062 r 0.7838 f1 0.8406
position_predict: train acc 0.9517 p 0.8125 r 0.7879 f1 0.8000
step 70: train loss 0.2713 
cause_predict: train acc 0.9370 p 0.7895 r 0.7895 f1 0.7895
position_predict: train acc 0.9331 p 0.7667 r 0.6970 f1 0.7302

epoch 8: test loss 0.5755 cost time: 11.0s

cause_predict: test acc 0.8878 p 0.6138 r 0.5615 f1 0.5865
max_acc 0.8892 max_p 0.6211 max_r 0.5584 max_f1 0.5880

position_predict: test acc 0.9187 p 0.6937 r 0.6551 f1 0.6738
max_acc 0.9307 max_p 0.7308 max_r 0.7282 max_f1 0.7295

Average max cause: max_acc 0.8892 max_p 0.6211 max_r 0.5584 max_f1 0.5880
Average max pos: max_acc 0.9240 max_p 0.7191 max_r 0.6690 max_f1 0.6931

step 10: train loss 0.1408 
cause_predict: train acc 0.9643 p 0.9394 r 0.8158 f1 0.8732
position_predict: train acc 0.9881 p 0.9412 r 0.9697 f1 0.9552
step 20: train loss 0.2141 
cause_predict: train acc 0.9352 p 0.8125 r 0.7647 f1 0.7879
position_predict: train acc 0.9676 p 0.8788 r 0.9062 f1 0.8923
step 30: train loss 0.1390 
cause_predict: train acc 0.9745 p 0.9375 r 0.8824 f1 0.9091
position_predict: train acc 0.9787 p 0.9355 r 0.9062 f1 0.9206
step 40: train loss 0.1233 
cause_predict: train acc 0.9673 p 0.9394 r 0.8378 f1 0.8857
position_predict: train acc 0.9878 p 0.9394 r 0.9688 f1 0.9538
step 50: train loss 0.1599 
cause_predict: train acc 0.9673 p 0.8421 r 0.9697 f1 0.9014
position_predict: train acc 0.9720 p 0.9062 r 0.9062 f1 0.9062
step 60: train loss 0.2066 
cause_predict: train acc 0.9550 p 0.8788 r 0.8529 f1 0.8657
position_predict: train acc 0.9550 p 0.8710 r 0.8438 f1 0.8571
step 70: train loss 0.1750 
cause_predict: train acc 0.9439 p 0.8788 r 0.8056 f1 0.8406
position_predict: train acc 0.9898 p 1.0000 r 0.9375 f1 0.9677

epoch 9: test loss 0.6163 cost time: 10.7s

2024-06-22 19:01:58.316828: W tensorflow/c/c_api.cc:304] Operation '{name:'softmax_b_pos/Adam_1/Assign' id:5023 op device:{requested: '', assigned: ''} def:{{{node softmax_b_pos/Adam_1/Assign}} = Assign[T=DT_FLOAT, _class=["loc:@softmax_b_pos"], _has_manual_control_dependencies=true, use_locking=true, validate_shape=true](softmax_b_pos/Adam_1, softmax_b_pos/Adam_1/Initializer/zeros)}}' was changed by setting attribute after it was run by a session. This mutation will have no effect, and will trigger an error in the future. Either don't modify nodes after running them or create a new session.
cause_predict: test acc 0.8919 p 0.6543 r 0.5016 f1 0.5679
max_acc 0.8892 max_p 0.6211 max_r 0.5584 max_f1 0.5880

position_predict: test acc 0.9164 p 0.6825 r 0.6516 f1 0.6667
max_acc 0.9307 max_p 0.7308 max_r 0.7282 max_f1 0.7295

Average max cause: max_acc 0.8892 max_p 0.6211 max_r 0.5584 max_f1 0.5880
Average max pos: max_acc 0.9240 max_p 0.7191 max_r 0.6690 max_f1 0.6931

step 10: train loss 0.1519 
cause_predict: train acc 0.9729 p 0.9143 r 0.8649 f1 0.8889
position_predict: train acc 0.9661 p 0.8929 r 0.7812 f1 0.8333
step 20: train loss 0.1393 
cause_predict: train acc 0.9732 p 0.9143 r 0.9143 f1 0.9143
position_predict: train acc 0.9911 p 0.9688 r 0.9688 f1 0.9688
step 30: train loss 0.1022 
cause_predict: train acc 0.9802 p 0.9355 r 0.9062 f1 0.9206
position_predict: train acc 0.9841 p 0.9118 r 0.9688 f1 0.9394
step 40: train loss 0.1506 
cause_predict: train acc 0.9574 p 0.8529 r 0.8286 f1 0.8406
position_predict: train acc 0.9767 p 0.9333 r 0.8750 f1 0.9032
step 50: train loss 0.3296 
cause_predict: train acc 0.9378 p 0.8286 r 0.7838 f1 0.8056
position_predict: train acc 0.9644 p 0.8750 r 0.8750 f1 0.8750
step 60: train loss 0.1892 
cause_predict: train acc 0.9325 p 0.9062 r 0.6905 f1 0.7838
position_predict: train acc 0.9789 p 0.9091 r 0.9375 f1 0.9231
step 70: train loss 0.1573 
cause_predict: train acc 0.9675 p 0.9167 r 0.8684 f1 0.8919
position_predict: train acc 0.9675 p 0.9000 r 0.8438 f1 0.8710

epoch 10: test loss 0.6309 cost time: 10.7s

cause_predict: test acc 0.8852 p 0.6095 r 0.5268 f1 0.5651
max_acc 0.8892 max_p 0.6211 max_r 0.5584 max_f1 0.5880

position_predict: test acc 0.9223 p 0.6955 r 0.7003 f1 0.6979
max_acc 0.9307 max_p 0.7308 max_r 0.7282 max_f1 0.7295

Average max cause: max_acc 0.8892 max_p 0.6211 max_r 0.5584 max_f1 0.5880
Average max pos: max_acc 0.9240 max_p 0.7191 max_r 0.6690 max_f1 0.6931

step 10: train loss 0.1613 
cause_predict: train acc 0.9628 p 0.8611 r 0.9394 f1 0.8986
position_predict: train acc 0.9681 p 0.9643 r 0.8438 f1 0.9000
step 20: train loss 0.1483 
cause_predict: train acc 0.9570 p 0.8571 r 0.8333 f1 0.8451
position_predict: train acc 0.9922 p 0.9412 r 1.0000 f1 0.9697
step 30: train loss 0.1566 
cause_predict: train acc 0.9633 p 0.8889 r 0.8649 f1 0.8767
position_predict: train acc 0.9592 p 0.8929 r 0.7812 f1 0.8333
step 40: train loss 0.1380 
cause_predict: train acc 0.9696 p 0.8649 r 0.9412 f1 0.9014
position_predict: train acc 0.9783 p 0.9091 r 0.9375 f1 0.9231
step 50: train loss 0.1169 
cause_predict: train acc 0.9914 p 1.0000 r 0.9429 f1 0.9706
position_predict: train acc 0.9612 p 0.8966 r 0.8125 f1 0.8525
step 60: train loss 0.1964 
cause_predict: train acc 0.9397 p 0.8788 r 0.7436 f1 0.8056
position_predict: train acc 0.9784 p 0.9355 r 0.9062 f1 0.9206
step 70: train loss 0.1143 
cause_predict: train acc 0.9628 p 0.8684 r 0.8684 f1 0.8684
position_predict: train acc 0.9888 p 0.9394 r 0.9688 f1 0.9538

epoch 11: test loss 0.7127 cost time: 10.6s

cause_predict: test acc 0.8905 p 0.6385 r 0.5237 f1 0.5754
max_acc 0.8892 max_p 0.6211 max_r 0.5584 max_f1 0.5880

position_predict: test acc 0.9106 p 0.6548 r 0.6411 f1 0.6479
max_acc 0.9307 max_p 0.7308 max_r 0.7282 max_f1 0.7295

Average max cause: max_acc 0.8892 max_p 0.6211 max_r 0.5584 max_f1 0.5880
Average max pos: max_acc 0.9240 max_p 0.7191 max_r 0.6690 max_f1 0.6931

step 10: train loss 0.1493 
cause_predict: train acc 0.9799 p 0.9211 r 0.9459 f1 0.9333
position_predict: train acc 0.9639 p 0.9000 r 0.8182 f1 0.8571
step 20: train loss 0.1320 
cause_predict: train acc 0.9634 p 0.9189 r 0.8500 f1 0.8831
position_predict: train acc 0.9797 p 0.8857 r 0.9688 f1 0.9254
step 30: train loss 0.1685 
cause_predict: train acc 0.9662 p 0.8710 r 0.8182 f1 0.8438
position_predict: train acc 0.9561 p 0.8276 r 0.7500 f1 0.7869
step 40: train loss 0.0944 
cause_predict: train acc 0.9764 p 0.8750 r 0.9722 f1 0.9211
position_predict: train acc 0.9843 p 0.9394 r 0.9394 f1 0.9394
step 50: train loss 0.0797 
cause_predict: train acc 0.9899 p 0.9714 r 0.9714 f1 0.9714
position_predict: train acc 0.9899 p 0.9688 r 0.9688 f1 0.9688
step 60: train loss 0.2041 
cause_predict: train acc 0.9782 p 0.9375 r 0.9091 f1 0.9231
position_predict: train acc 0.9432 p 0.8065 r 0.7812 f1 0.7937
step 70: train loss 0.1616 
cause_predict: train acc 0.9603 p 0.9688 r 0.7750 f1 0.8611
position_predict: train acc 0.9802 p 0.9375 r 0.9091 f1 0.9231

epoch 12: test loss 0.7252 cost time: 10.3s

cause_predict: test acc 0.8834 p 0.6000 r 0.5300 f1 0.5628
max_acc 0.8892 max_p 0.6211 max_r 0.5584 max_f1 0.5880

position_predict: test acc 0.9147 p 0.6690 r 0.6620 f1 0.6655
max_acc 0.9307 max_p 0.7308 max_r 0.7282 max_f1 0.7295

Average max cause: max_acc 0.8892 max_p 0.6211 max_r 0.5584 max_f1 0.5880
Average max pos: max_acc 0.9240 max_p 0.7191 max_r 0.6690 max_f1 0.6931

step 10: train loss 0.0816 
cause_predict: train acc 0.9847 p 0.9722 r 0.9211 f1 0.9459
position_predict: train acc 0.9923 p 0.9697 r 0.9697 f1 0.9697
step 20: train loss 0.1195 
cause_predict: train acc 0.9841 p 0.9706 r 0.9429 f1 0.9565
position_predict: train acc 0.9735 p 0.9091 r 0.9375 f1 0.9231
step 30: train loss 0.1792 
cause_predict: train acc 0.9713 p 0.9355 r 0.8788 f1 0.9062
position_predict: train acc 0.9569 p 0.8485 r 0.8750 f1 0.8615
step 40: train loss 0.1357 
cause_predict: train acc 0.9641 p 0.9412 r 0.8649 f1 0.9014
position_predict: train acc 0.9744 p 0.9355 r 0.9062 f1 0.9206
step 50: train loss 0.1366 
cause_predict: train acc 0.9740 p 0.8649 r 0.9412 f1 0.9014
position_predict: train acc 0.9777 p 0.9355 r 0.8788 f1 0.9062
step 60: train loss 0.1510 
cause_predict: train acc 0.9786 p 0.9143 r 0.9412 f1 0.9275
position_predict: train acc 0.9658 p 0.8788 r 0.8788 f1 0.8788
step 70: train loss 0.1385 
cause_predict: train acc 0.9817 p 0.9444 r 0.9444 f1 0.9444
position_predict: train acc 0.9772 p 0.9091 r 0.9375 f1 0.9231

epoch 13: test loss 0.7389 cost time: 10.5s

cause_predict: test acc 0.8811 p 0.5901 r 0.5268 f1 0.5567
max_acc 0.8892 max_p 0.6211 max_r 0.5584 max_f1 0.5880

position_predict: test acc 0.9173 p 0.6848 r 0.6585 f1 0.6714
max_acc 0.9307 max_p 0.7308 max_r 0.7282 max_f1 0.7295

Average max cause: max_acc 0.8892 max_p 0.6211 max_r 0.5584 max_f1 0.5880
Average max pos: max_acc 0.9240 max_p 0.7191 max_r 0.6690 max_f1 0.6931

step 10: train loss 0.0661 
cause_predict: train acc 0.9888 p 0.9459 r 0.9722 f1 0.9589
position_predict: train acc 0.9888 p 1.0000 r 0.9062 f1 0.9508
step 20: train loss 0.0862 
cause_predict: train acc 0.9814 p 0.9167 r 0.9706 f1 0.9429
position_predict: train acc 0.9860 p 0.9394 r 0.9688 f1 0.9538
step 30: train loss 0.1152 
cause_predict: train acc 0.9743 p 0.9167 r 0.8684 f1 0.8919
position_predict: train acc 0.9839 p 0.9355 r 0.9062 f1 0.9206
step 40: train loss 0.0628 
cause_predict: train acc 0.9919 p 0.9737 r 0.9737 f1 0.9737
position_predict: train acc 0.9919 p 0.9688 r 0.9688 f1 0.9688
step 50: train loss 0.1160 
cause_predict: train acc 0.9747 p 0.9730 r 0.8780 f1 0.9231
position_predict: train acc 0.9873 p 0.9688 r 0.9394 f1 0.9538
step 60: train loss 0.1320 
cause_predict: train acc 0.9812 p 0.9444 r 0.9189 f1 0.9315
position_predict: train acc 0.9586 p 0.8529 r 0.8286 f1 0.8406
step 70: train loss 0.0770 
cause_predict: train acc 0.9918 p 0.9706 r 0.9706 f1 0.9706
position_predict: train acc 0.9835 p 0.9375 r 0.9375 f1 0.9375

epoch 14: test loss 0.7588 cost time: 10.6s

cause_predict: test acc 0.8807 p 0.5839 r 0.5489 f1 0.5659
max_acc 0.8892 max_p 0.6211 max_r 0.5584 max_f1 0.5880

position_predict: test acc 0.9106 p 0.6436 r 0.6794 f1 0.6610
max_acc 0.9307 max_p 0.7308 max_r 0.7282 max_f1 0.7295

Average max cause: max_acc 0.8892 max_p 0.6211 max_r 0.5584 max_f1 0.5880
Average max pos: max_acc 0.9240 max_p 0.7191 max_r 0.6690 max_f1 0.6931

write pair_data/Ind_BiLSTM_2/fold_1_test.txt done
write pair_data/Ind_BiLSTM_2/fold_1_train.txt done
Optimization Finished!

############# fold 1 end ###############
############# fold 2 begin ###############
load data_file: data_combine_en/fold_2_train.txt
y_position.shape (2275, 75, 2)
y_cause.shape (2275, 75, 2)
x.shape (2275, 75, 30)
sen_len.shape (2275, 75)
doc_len.shape (2275,)
n_cut 107
load data done!

load data_file: data_combine_en/fold_2_test.txt
y_position.shape (284, 75, 2)
y_cause.shape (284, 75, 2)
x.shape (284, 75, 30)
sen_len.shape (284, 75)
doc_len.shape (284,)
n_cut 22
load data done!

train docs: 2275    test docs: 284
step 10: train loss 0.8204 
cause_predict: train acc 0.8610 p 0.0000 r 0.0000 f1 0.0000
position_predict: train acc 0.8726 p 0.0000 r 0.0000 f1 0.0000
step 20: train loss 0.7778 
cause_predict: train acc 0.8398 p 0.0000 r 0.0000 f1 0.0000
position_predict: train acc 0.8447 p 0.0000 r 0.0000 f1 0.0000
step 30: train loss 0.7715 
cause_predict: train acc 0.8199 p 0.0000 r 0.0000 f1 0.0000
position_predict: train acc 0.8483 p 0.0000 r 0.0000 f1 0.0000
step 40: train loss 0.7262 
cause_predict: train acc 0.8254 p 0.0000 r 0.0000 f1 0.0000
position_predict: train acc 0.8307 p 1.0000 r 0.0303 f1 0.0588
step 50: train loss 0.6100 
cause_predict: train acc 0.8631 p 0.0000 r 0.0000 f1 0.0000
position_predict: train acc 0.8631 p 0.4884 r 0.6562 f1 0.5600
step 60: train loss 0.6036 
cause_predict: train acc 0.8268 p 0.0000 r 0.0000 f1 0.0000
position_predict: train acc 0.9091 p 0.7037 r 0.5938 f1 0.6441
step 70: train loss 0.5246 
cause_predict: train acc 0.8571 p 1.0000 r 0.1471 f1 0.2564
position_predict: train acc 0.9310 p 0.9091 r 0.6250 f1 0.7407

epoch 0: test loss 0.5386 cost time: 10.8s

cause_predict: test acc 0.8713 p 0.8718 r 0.1073 f1 0.1910
max_acc 0.8713 max_p 0.8718 max_r 0.1073 max_f1 0.1910

position_predict: test acc 0.9115 p 0.6787 r 0.5889 f1 0.6306
max_acc 0.9115 max_p 0.6787 max_r 0.5889 max_f1 0.6306

Average max cause: max_acc 0.8713 max_p 0.8718 max_r 0.1073 max_f1 0.1910
Average max pos: max_acc 0.9115 max_p 0.6787 max_r 0.5889 max_f1 0.6306

step 10: train loss 0.6169 
cause_predict: train acc 0.8815 p 1.0000 r 0.1053 f1 0.1905
position_predict: train acc 0.8780 p 0.4545 r 0.3030 f1 0.3636
step 20: train loss 0.5513 
cause_predict: train acc 0.8326 p 0.5238 r 0.2821 f1 0.3667
position_predict: train acc 0.9251 p 0.7778 r 0.6562 f1 0.7119
step 30: train loss 0.5012 
cause_predict: train acc 0.8973 p 0.7895 r 0.4412 f1 0.5660
position_predict: train acc 0.9241 p 0.7419 r 0.7188 f1 0.7302
step 40: train loss 0.4734 
cause_predict: train acc 0.8844 p 1.0000 r 0.2121 f1 0.3500
position_predict: train acc 0.9289 p 0.7857 r 0.6875 f1 0.7333
step 50: train loss 0.5103 
cause_predict: train acc 0.8669 p 0.8333 r 0.1282 f1 0.2222
position_predict: train acc 0.9392 p 0.8696 r 0.6061 f1 0.7143
step 60: train loss 0.4929 
cause_predict: train acc 0.8601 p 0.5385 r 0.2000 f1 0.2917
position_predict: train acc 0.9177 p 0.7826 r 0.5455 f1 0.6429
step 70: train loss 0.5457 
cause_predict: train acc 0.8767 p 0.7500 r 0.2647 f1 0.3913
position_predict: train acc 0.8899 p 0.6522 r 0.4688 f1 0.5455

epoch 1: test loss 0.4845 cost time: 10.3s

cause_predict: test acc 0.8896 p 0.7869 r 0.3028 f1 0.4374
max_acc 0.8896 max_p 0.7869 max_r 0.3028 max_f1 0.4374

position_predict: test acc 0.9178 p 0.7085 r 0.6098 f1 0.6554
max_acc 0.9178 max_p 0.7085 max_r 0.6098 max_f1 0.6554

Average max cause: max_acc 0.8896 max_p 0.7869 max_r 0.3028 max_f1 0.4374
Average max pos: max_acc 0.9178 max_p 0.7085 max_r 0.6098 max_f1 0.6554

step 10: train loss 0.6323 
cause_predict: train acc 0.8489 p 0.5000 r 0.4706 f1 0.4848
position_predict: train acc 0.8933 p 0.6333 r 0.5938 f1 0.6129
step 20: train loss 0.3895 
cause_predict: train acc 0.9161 p 0.9333 r 0.3784 f1 0.5385
position_predict: train acc 0.9406 p 0.8077 r 0.6364 f1 0.7119
step 30: train loss 0.4811 
cause_predict: train acc 0.8899 p 0.8095 r 0.4474 f1 0.5763
position_predict: train acc 0.9295 p 0.7667 r 0.7188 f1 0.7419
step 40: train loss 0.4598 
cause_predict: train acc 0.8901 p 0.7273 r 0.2286 f1 0.3478
position_predict: train acc 0.9414 p 0.7500 r 0.7500 f1 0.7500
step 50: train loss 0.5057 
cause_predict: train acc 0.8779 p 0.7500 r 0.3000 f1 0.4286
position_predict: train acc 0.9237 p 0.6765 r 0.7188 f1 0.6970
step 60: train loss 0.4769 
cause_predict: train acc 0.8935 p 0.6667 r 0.2632 f1 0.3774
position_predict: train acc 0.9355 p 0.7917 r 0.5588 f1 0.6552
step 70: train loss 0.4608 
cause_predict: train acc 0.8810 p 0.8571 r 0.2857 f1 0.4286
position_predict: train acc 0.9405 p 0.7667 r 0.7188 f1 0.7419

epoch 2: test loss 0.4660 cost time: 10.9s

cause_predict: test acc 0.8928 p 0.7484 r 0.3659 f1 0.4915
max_acc 0.8928 max_p 0.7484 max_r 0.3659 max_f1 0.4915

position_predict: test acc 0.9285 p 0.7396 r 0.6829 f1 0.7101
max_acc 0.9285 max_p 0.7396 max_r 0.6829 max_f1 0.7101

Average max cause: max_acc 0.8928 max_p 0.7484 max_r 0.3659 max_f1 0.4915
Average max pos: max_acc 0.9285 max_p 0.7396 max_r 0.6829 max_f1 0.7101

step 10: train loss 0.4429 
cause_predict: train acc 0.8661 p 0.6667 r 0.3415 f1 0.4516
position_predict: train acc 0.9291 p 0.7500 r 0.7059 f1 0.7273
step 20: train loss 0.5025 
cause_predict: train acc 0.8739 p 0.6071 r 0.4722 f1 0.5312
position_predict: train acc 0.9202 p 0.7500 r 0.6364 f1 0.6885
step 30: train loss 0.4703 
cause_predict: train acc 0.8889 p 0.7647 r 0.3095 f1 0.4407
position_predict: train acc 0.9428 p 0.7586 r 0.6875 f1 0.7213
step 40: train loss 0.3681 
cause_predict: train acc 0.9057 p 0.7917 r 0.5588 f1 0.6552
position_predict: train acc 0.9340 p 0.8462 r 0.6875 f1 0.7586
step 50: train loss 0.3742 
cause_predict: train acc 0.8793 p 0.6957 r 0.4324 f1 0.5333
position_predict: train acc 0.9526 p 0.8182 r 0.8438 f1 0.8308
step 60: train loss 0.4239 
cause_predict: train acc 0.8858 p 0.7143 r 0.2857 f1 0.4082
position_predict: train acc 0.9252 p 0.7407 r 0.6250 f1 0.6780
step 70: train loss 0.4464 
cause_predict: train acc 0.8816 p 0.7500 r 0.3429 f1 0.4706
position_predict: train acc 0.9123 p 0.7308 r 0.5938 f1 0.6552

epoch 3: test loss 0.4707 cost time: 10.7s

cause_predict: test acc 0.8995 p 0.7738 r 0.4101 f1 0.5361
max_acc 0.8995 max_p 0.7738 max_r 0.4101 max_f1 0.5361

position_predict: test acc 0.9294 p 0.7398 r 0.6934 f1 0.7158
max_acc 0.9294 max_p 0.7398 max_r 0.6934 max_f1 0.7158

Average max cause: max_acc 0.8995 max_p 0.7738 max_r 0.4101 max_f1 0.5361
Average max pos: max_acc 0.9294 max_p 0.7398 max_r 0.6934 max_f1 0.7158

step 10: train loss 0.4810 
cause_predict: train acc 0.8958 p 0.7407 r 0.6061 f1 0.6667
position_predict: train acc 0.8854 p 0.6667 r 0.6250 f1 0.6452
step 20: train loss 0.3793 
cause_predict: train acc 0.9041 p 0.7143 r 0.5000 f1 0.5882
position_predict: train acc 0.9452 p 0.8400 r 0.6364 f1 0.7241
step 30: train loss 0.4094 
cause_predict: train acc 0.8816 p 0.6429 r 0.4865 f1 0.5538
position_predict: train acc 0.9673 p 0.9286 r 0.8125 f1 0.8667
step 40: train loss 0.4354 
cause_predict: train acc 0.9057 p 0.7778 r 0.6000 f1 0.6774
position_predict: train acc 0.9340 p 0.8065 r 0.7576 f1 0.7812
step 50: train loss 0.4268 
cause_predict: train acc 0.8934 p 0.9130 r 0.5250 f1 0.6667
position_predict: train acc 0.9543 p 0.8710 r 0.8438 f1 0.8571
step 60: train loss 0.4042 
cause_predict: train acc 0.8864 p 0.6296 r 0.4474 f1 0.5231
position_predict: train acc 0.9560 p 0.8333 r 0.7812 f1 0.8065
step 70: train loss 0.3648 
cause_predict: train acc 0.9163 p 0.8500 r 0.5312 f1 0.6538
position_predict: train acc 0.9302 p 0.8333 r 0.7143 f1 0.7692

epoch 4: test loss 0.4751 cost time: 10.8s

cause_predict: test acc 0.8986 p 0.7528 r 0.4227 f1 0.5414
max_acc 0.8986 max_p 0.7528 max_r 0.4227 max_f1 0.5414

position_predict: test acc 0.9267 p 0.7375 r 0.6655 f1 0.6996
max_acc 0.9294 max_p 0.7398 max_r 0.6934 max_f1 0.7158

Average max cause: max_acc 0.8995 max_p 0.7738 max_r 0.4101 max_f1 0.5361
Average max pos: max_acc 0.9294 max_p 0.7398 max_r 0.6934 max_f1 0.7158

step 10: train loss 0.3241 
cause_predict: train acc 0.9151 p 0.7667 r 0.5897 f1 0.6667
position_predict: train acc 0.9520 p 0.7714 r 0.8438 f1 0.8060
step 20: train loss 0.2984 
cause_predict: train acc 0.9281 p 0.7778 r 0.5833 f1 0.6667
position_predict: train acc 0.9555 p 0.8276 r 0.7500 f1 0.7869
step 30: train loss 0.4752 
cause_predict: train acc 0.8962 p 0.6500 r 0.6667 f1 0.6582
position_predict: train acc 0.9077 p 0.6429 r 0.5625 f1 0.6000
step 40: train loss 0.2897 
cause_predict: train acc 0.9191 p 0.7500 r 0.6857 f1 0.7164
position_predict: train acc 0.9660 p 0.8750 r 0.8750 f1 0.8750
step 50: train loss 0.3454 
cause_predict: train acc 0.8857 p 0.6897 r 0.4651 f1 0.5556
position_predict: train acc 0.9536 p 0.7879 r 0.8125 f1 0.8000
step 60: train loss 0.3398 
cause_predict: train acc 0.9176 p 0.7826 r 0.5000 f1 0.6102
position_predict: train acc 0.9462 p 0.8000 r 0.7273 f1 0.7619
step 70: train loss 0.4402 
cause_predict: train acc 0.8903 p 0.7241 r 0.5385 f1 0.6176
position_predict: train acc 0.9198 p 0.7333 r 0.6667 f1 0.6984

epoch 5: test loss 0.4907 cost time: 10.9s

cause_predict: test acc 0.8950 p 0.6541 r 0.5489 f1 0.5969
max_acc 0.8950 max_p 0.6541 max_r 0.5489 max_f1 0.5969

position_predict: test acc 0.9209 p 0.7007 r 0.6690 f1 0.6845
max_acc 0.9294 max_p 0.7398 max_r 0.6934 max_f1 0.7158

Average max cause: max_acc 0.8950 max_p 0.6541 max_r 0.5489 max_f1 0.5969
Average max pos: max_acc 0.9209 max_p 0.7007 max_r 0.6690 max_f1 0.6845

step 10: train loss 0.2036 
cause_predict: train acc 0.9395 p 0.8333 r 0.5714 f1 0.6780
position_predict: train acc 0.9809 p 0.9062 r 0.9062 f1 0.9062
step 20: train loss 0.2881 
cause_predict: train acc 0.9324 p 0.8621 r 0.7143 f1 0.7813
position_predict: train acc 0.9517 p 0.8438 r 0.8438 f1 0.8438
step 30: train loss 0.3042 
cause_predict: train acc 0.9113 p 0.7419 r 0.6216 f1 0.6765
position_predict: train acc 0.9476 p 0.8276 r 0.7500 f1 0.7869
step 40: train loss 0.3094 
cause_predict: train acc 0.9351 p 0.7317 r 0.8333 f1 0.7792
position_predict: train acc 0.9427 p 0.8000 r 0.7273 f1 0.7619
step 50: train loss 0.2543 
cause_predict: train acc 0.9140 p 0.7368 r 0.7568 f1 0.7467
position_predict: train acc 0.9638 p 0.8750 r 0.8750 f1 0.8750
step 60: train loss 0.3828 
cause_predict: train acc 0.9250 p 0.8387 r 0.7222 f1 0.7761
position_predict: train acc 0.9350 p 0.8235 r 0.8000 f1 0.8116
step 70: train loss 0.3643 
cause_predict: train acc 0.9074 p 0.7333 r 0.6471 f1 0.6875
position_predict: train acc 0.9306 p 0.7742 r 0.7500 f1 0.7619

epoch 6: test loss 0.4937 cost time: 10.7s

cause_predict: test acc 0.8954 p 0.7005 r 0.4574 f1 0.5534
max_acc 0.8950 max_p 0.6541 max_r 0.5489 max_f1 0.5969

position_predict: test acc 0.9231 p 0.7091 r 0.6794 f1 0.6940
max_acc 0.9294 max_p 0.7398 max_r 0.6934 max_f1 0.7158

Average max cause: max_acc 0.8950 max_p 0.6541 max_r 0.5489 max_f1 0.5969
Average max pos: max_acc 0.9209 max_p 0.7007 max_r 0.6690 max_f1 0.6845

step 10: train loss 0.3033 
cause_predict: train acc 0.9179 p 0.6444 r 0.8286 f1 0.7250
position_predict: train acc 0.9440 p 0.7931 r 0.7188 f1 0.7541
step 20: train loss 0.3044 
cause_predict: train acc 0.9507 p 0.9310 r 0.7500 f1 0.8308
position_predict: train acc 0.9596 p 0.8710 r 0.8438 f1 0.8571
step 30: train loss 0.2304 
cause_predict: train acc 0.9576 p 0.9429 r 0.8049 f1 0.8684
position_predict: train acc 0.9746 p 0.8824 r 0.9375 f1 0.9091
step 40: train loss 0.2330 
cause_predict: train acc 0.9457 p 0.8800 r 0.6471 f1 0.7458
position_predict: train acc 0.9601 p 0.8929 r 0.7576 f1 0.8197
step 50: train loss 0.2193 
cause_predict: train acc 0.9664 p 0.9286 r 0.7879 f1 0.8525
position_predict: train acc 0.9328 p 0.7333 r 0.6875 f1 0.7097
step 60: train loss 0.3091 
cause_predict: train acc 0.9269 p 0.8400 r 0.6364 f1 0.7241
position_predict: train acc 0.9406 p 0.8333 r 0.7576 f1 0.7937
step 70: train loss 0.2134 
cause_predict: train acc 0.9370 p 0.7692 r 0.8333 f1 0.8000
position_predict: train acc 0.9664 p 0.8333 r 0.9375 f1 0.8824

epoch 7: test loss 0.5446 cost time: 11.1s

cause_predict: test acc 0.8901 p 0.6291 r 0.5457 f1 0.5845
max_acc 0.8950 max_p 0.6541 max_r 0.5489 max_f1 0.5969

position_predict: test acc 0.9209 p 0.6964 r 0.6794 f1 0.6878
max_acc 0.9294 max_p 0.7398 max_r 0.6934 max_f1 0.7158

Average max cause: max_acc 0.8950 max_p 0.6541 max_r 0.5489 max_f1 0.5969
Average max pos: max_acc 0.9209 max_p 0.7007 max_r 0.6690 max_f1 0.6845

step 10: train loss 0.1854 
cause_predict: train acc 0.9568 p 0.8286 r 0.8056 f1 0.8169
position_predict: train acc 0.9635 p 0.8621 r 0.7812 f1 0.8197
step 20: train loss 0.2297 
cause_predict: train acc 0.9323 p 0.8286 r 0.7250 f1 0.7733
position_predict: train acc 0.9641 p 0.8710 r 0.8438 f1 0.8571
step 30: train loss 0.2198 
cause_predict: train acc 0.9480 p 0.8788 r 0.7632 f1 0.8169
position_predict: train acc 0.9680 p 0.9000 r 0.8438 f1 0.8710
step 40: train loss 0.2459 
cause_predict: train acc 0.9316 p 0.7059 r 0.7500 f1 0.7273
position_predict: train acc 0.9658 p 0.8710 r 0.8438 f1 0.8571
step 50: train loss 0.2022 
cause_predict: train acc 0.9625 p 0.9333 r 0.8000 f1 0.8615
position_predict: train acc 0.9583 p 0.8667 r 0.8125 f1 0.8387
step 60: train loss 0.1842 
cause_predict: train acc 0.9402 p 0.8621 r 0.7143 f1 0.7813
position_predict: train acc 0.9658 p 0.9000 r 0.8438 f1 0.8710
step 70: train loss 0.1979 
cause_predict: train acc 0.9778 p 0.8947 r 0.9444 f1 0.9189
position_predict: train acc 0.9630 p 0.8108 r 0.9091 f1 0.8571

epoch 8: test loss 0.5546 cost time: 10.9s

cause_predict: test acc 0.8923 p 0.6397 r 0.5489 f1 0.5908
max_acc 0.8950 max_p 0.6541 max_r 0.5489 max_f1 0.5969

position_predict: test acc 0.9133 p 0.6525 r 0.6934 f1 0.6723
max_acc 0.9294 max_p 0.7398 max_r 0.6934 max_f1 0.7158

Average max cause: max_acc 0.8950 max_p 0.6541 max_r 0.5489 max_f1 0.5969
Average max pos: max_acc 0.9209 max_p 0.7007 max_r 0.6690 max_f1 0.6845

step 10: train loss 0.1639 
cause_predict: train acc 0.9598 p 0.9375 r 0.8108 f1 0.8696
position_predict: train acc 0.9688 p 0.8788 r 0.9062 f1 0.8923
step 20: train loss 0.2027 
cause_predict: train acc 0.9377 p 0.8438 r 0.7105 f1 0.7714
position_predict: train acc 0.9689 p 0.8788 r 0.8788 f1 0.8788
step 30: train loss 0.1870 
cause_predict: train acc 0.9472 p 0.8286 r 0.7838 f1 0.8056
position_predict: train acc 0.9698 p 0.9000 r 0.8438 f1 0.8710
step 40: train loss 0.1739 
cause_predict: train acc 0.9588 p 0.8485 r 0.8235 f1 0.8358
position_predict: train acc 0.9663 p 0.8710 r 0.8438 f1 0.8571
step 50: train loss 0.2813 
cause_predict: train acc 0.9423 p 0.8205 r 0.8649 f1 0.8421
position_predict: train acc 0.9375 p 0.7879 r 0.8125 f1 0.8000
step 60: train loss 0.2448 
cause_predict: train acc 0.9474 p 0.8667 r 0.7222 f1 0.7879
position_predict: train acc 0.9549 p 0.8333 r 0.7812 f1 0.8065
step 70: train loss 0.2160 
cause_predict: train acc 0.9412 p 0.8750 r 0.6829 f1 0.7671
position_predict: train acc 0.9689 p 0.7949 r 0.9688 f1 0.8732

epoch 9: test loss 0.5909 cost time: 10.6s

cause_predict: test acc 0.8856 p 0.6101 r 0.5331 f1 0.5690
max_acc 0.8950 max_p 0.6541 max_r 0.5489 max_f1 0.5969

position_predict: test acc 0.9173 p 0.6796 r 0.6725 f1 0.6760
max_acc 0.9294 max_p 0.7398 max_r 0.6934 max_f1 0.7158

Average max cause: max_acc 0.8950 max_p 0.6541 max_r 0.5489 max_f1 0.5969
Average max pos: max_acc 0.9209 max_p 0.7007 max_r 0.6690 max_f1 0.6845

step 10: train loss 0.1401 
cause_predict: train acc 0.9761 p 0.8649 r 0.9697 f1 0.9143
position_predict: train acc 0.9761 p 0.9333 r 0.8750 f1 0.9032
step 20: train loss 0.1509 
cause_predict: train acc 0.9655 p 0.8947 r 0.8718 f1 0.8831
position_predict: train acc 0.9655 p 0.8966 r 0.8125 f1 0.8525
step 30: train loss 0.1225 
cause_predict: train acc 0.9823 p 0.9722 r 0.9211 f1 0.9459
position_predict: train acc 0.9867 p 0.9429 r 0.9706 f1 0.9565
step 40: train loss 0.3591 
cause_predict: train acc 0.9423 p 0.8333 r 0.7812 f1 0.8065
position_predict: train acc 0.9231 p 0.7667 r 0.7188 f1 0.7419
step 50: train loss 0.2110 
cause_predict: train acc 0.9482 p 0.8611 r 0.7949 f1 0.8267
position_predict: train acc 0.9721 p 0.9032 r 0.8750 f1 0.8889
step 60: train loss 0.1682 
cause_predict: train acc 0.9521 p 0.9333 r 0.8000 f1 0.8615
position_predict: train acc 0.9787 p 0.9118 r 0.9688 f1 0.9394
step 70: train loss 0.1735 
cause_predict: train acc 0.9524 p 0.8421 r 0.8205 f1 0.8312
position_predict: train acc 0.9707 p 0.8750 r 0.8750 f1 0.8750

epoch 10: test loss 0.6472 cost time: 10.4s

cause_predict: test acc 0.8878 p 0.6187 r 0.5426 f1 0.5782
max_acc 0.8950 max_p 0.6541 max_r 0.5489 max_f1 0.5969

2024-06-22 19:04:46.924440: W tensorflow/c/c_api.cc:304] Operation '{name:'softmax_b_pos/Adam_1/Assign' id:5023 op device:{requested: '', assigned: ''} def:{{{node softmax_b_pos/Adam_1/Assign}} = Assign[T=DT_FLOAT, _class=["loc:@softmax_b_pos"], _has_manual_control_dependencies=true, use_locking=true, validate_shape=true](softmax_b_pos/Adam_1, softmax_b_pos/Adam_1/Initializer/zeros)}}' was changed by setting attribute after it was run by a session. This mutation will have no effect, and will trigger an error in the future. Either don't modify nodes after running them or create a new session.
position_predict: test acc 0.9169 p 0.6784 r 0.6690 f1 0.6737
max_acc 0.9294 max_p 0.7398 max_r 0.6934 max_f1 0.7158

Average max cause: max_acc 0.8950 max_p 0.6541 max_r 0.5489 max_f1 0.5969
Average max pos: max_acc 0.9209 max_p 0.7007 max_r 0.6690 max_f1 0.6845

step 10: train loss 0.1512 
cause_predict: train acc 0.9760 p 0.9231 r 0.9000 f1 0.9114
position_predict: train acc 0.9795 p 0.9062 r 0.9062 f1 0.9062
step 20: train loss 0.1193 
cause_predict: train acc 0.9746 p 0.9688 r 0.8378 f1 0.8986
position_predict: train acc 0.9783 p 0.9355 r 0.8788 f1 0.9062
step 30: train loss 0.1659 
cause_predict: train acc 0.9500 p 0.8824 r 0.8108 f1 0.8451
position_predict: train acc 0.9727 p 0.9062 r 0.9062 f1 0.9062
step 40: train loss 0.1904 
cause_predict: train acc 0.9662 p 0.8824 r 0.8824 f1 0.8824
position_predict: train acc 0.9705 p 0.9062 r 0.8788 f1 0.8923
step 50: train loss 0.2567 
cause_predict: train acc 0.9532 p 0.8286 r 0.8529 f1 0.8406
position_predict: train acc 0.9447 p 0.8125 r 0.7879 f1 0.8000
step 60: train loss 0.2557 
cause_predict: train acc 0.9390 p 0.8000 r 0.7778 f1 0.7887
position_predict: train acc 0.9593 p 0.8438 r 0.8438 f1 0.8438
step 70: train loss 0.1413 
cause_predict: train acc 0.9832 p 0.9737 r 0.9024 f1 0.9367
position_predict: train acc 0.9631 p 0.8387 r 0.8125 f1 0.8254

epoch 11: test loss 0.6372 cost time: 10.2s

cause_predict: test acc 0.8932 p 0.6466 r 0.5426 f1 0.5901
max_acc 0.8950 max_p 0.6541 max_r 0.5489 max_f1 0.5969

position_predict: test acc 0.9169 p 0.6906 r 0.6376 f1 0.6630
max_acc 0.9294 max_p 0.7398 max_r 0.6934 max_f1 0.7158

Average max cause: max_acc 0.8950 max_p 0.6541 max_r 0.5489 max_f1 0.5969
Average max pos: max_acc 0.9209 max_p 0.7007 max_r 0.6690 max_f1 0.6845

step 10: train loss 0.0885 
cause_predict: train acc 0.9741 p 0.9688 r 0.8611 f1 0.9118
position_predict: train acc 0.9914 p 0.9688 r 0.9688 f1 0.9688
step 20: train loss 0.0616 
cause_predict: train acc 0.9745 p 0.8857 r 0.9118 f1 0.8986
position_predict: train acc 0.9927 p 0.9412 r 1.0000 f1 0.9697
step 30: train loss 0.1364 
cause_predict: train acc 0.9684 p 0.9643 r 0.7941 f1 0.8710
position_predict: train acc 0.9644 p 0.8710 r 0.8438 f1 0.8571
step 40: train loss 0.1299 
cause_predict: train acc 0.9593 p 0.8205 r 0.9143 f1 0.8649
position_predict: train acc 0.9797 p 0.9118 r 0.9394 f1 0.9254
step 50: train loss 0.2146 
cause_predict: train acc 0.9571 p 0.8378 r 0.8857 f1 0.8611
position_predict: train acc 0.9485 p 0.8125 r 0.8125 f1 0.8125
step 60: train loss 0.0885 
cause_predict: train acc 0.9692 p 0.8286 r 0.9062 f1 0.8657
position_predict: train acc 0.9966 p 0.9697 r 1.0000 f1 0.9846
step 70: train loss 0.2159 
cause_predict: train acc 0.9707 p 0.8611 r 0.8857 f1 0.8732
position_predict: train acc 0.9642 p 0.8387 r 0.8125 f1 0.8254

epoch 12: test loss 0.6969 cost time: 10.4s

cause_predict: test acc 0.8941 p 0.6460 r 0.5584 f1 0.5990
max_acc 0.8941 max_p 0.6460 max_r 0.5584 max_f1 0.5990

position_predict: test acc 0.9191 p 0.7054 r 0.6341 f1 0.6679
max_acc 0.9294 max_p 0.7398 max_r 0.6934 max_f1 0.7158

Average max cause: max_acc 0.8950 max_p 0.6541 max_r 0.5489 max_f1 0.5969
Average max pos: max_acc 0.9209 max_p 0.7007 max_r 0.6690 max_f1 0.6845

step 10: train loss 0.0883 
cause_predict: train acc 0.9867 p 0.9429 r 0.9429 f1 0.9429
position_predict: train acc 0.9800 p 0.9062 r 0.9062 f1 0.9062
step 20: train loss 0.1356 
cause_predict: train acc 0.9676 p 0.8788 r 0.8788 f1 0.8788
position_predict: train acc 0.9757 p 0.9333 r 0.8750 f1 0.9032
step 30: train loss 0.1547 
cause_predict: train acc 0.9872 p 0.9697 r 0.9412 f1 0.9552
position_predict: train acc 0.9447 p 0.8065 r 0.7812 f1 0.7937
step 40: train loss 0.1597 
cause_predict: train acc 0.9595 p 0.8409 r 0.9487 f1 0.8916
position_predict: train acc 0.9640 p 0.8529 r 0.9062 f1 0.8788
step 50: train loss 0.1322 
cause_predict: train acc 0.9758 p 0.9394 r 0.8857 f1 0.9118
position_predict: train acc 0.9758 p 0.9062 r 0.9062 f1 0.9062
step 60: train loss 0.1911 
cause_predict: train acc 0.9558 p 0.7872 r 0.9737 f1 0.8706
position_predict: train acc 0.9719 p 0.8788 r 0.9062 f1 0.8923
step 70: train loss 0.2119 
cause_predict: train acc 0.9633 p 0.8462 r 0.9167 f1 0.8800
position_predict: train acc 0.9429 p 0.7879 r 0.7879 f1 0.7879

epoch 13: test loss 0.6844 cost time: 10.4s

cause_predict: test acc 0.8785 p 0.5738 r 0.5521 f1 0.5627
max_acc 0.8941 max_p 0.6460 max_r 0.5584 max_f1 0.5990

position_predict: test acc 0.9182 p 0.6884 r 0.6620 f1 0.6750
max_acc 0.9294 max_p 0.7398 max_r 0.6934 max_f1 0.7158

Average max cause: max_acc 0.8950 max_p 0.6541 max_r 0.5489 max_f1 0.5969
Average max pos: max_acc 0.9209 max_p 0.7007 max_r 0.6690 max_f1 0.6845

step 10: train loss 0.0871 
cause_predict: train acc 0.9808 p 0.9394 r 0.9118 f1 0.9254
position_predict: train acc 0.9846 p 0.9375 r 0.9375 f1 0.9375
step 20: train loss 0.1724 
cause_predict: train acc 0.9705 p 0.8649 r 0.9143 f1 0.8889
position_predict: train acc 0.9631 p 0.8710 r 0.8182 f1 0.8438
step 30: train loss 0.1143 
cause_predict: train acc 0.9567 p 0.8529 r 0.8788 f1 0.8657
position_predict: train acc 0.9808 p 0.9375 r 0.9375 f1 0.9375
step 40: train loss 0.0584 
cause_predict: train acc 0.9917 p 0.9730 r 0.9730 f1 0.9730
position_predict: train acc 0.9959 p 1.0000 r 0.9706 f1 0.9851
step 50: train loss 0.1231 
cause_predict: train acc 0.9811 p 0.9375 r 0.9091 f1 0.9231
position_predict: train acc 0.9660 p 0.8485 r 0.8750 f1 0.8615
step 60: train loss 0.0763 
cause_predict: train acc 0.9876 p 0.9783 r 0.9574 f1 0.9677
position_predict: train acc 0.9793 p 0.9355 r 0.9062 f1 0.9206
step 70: train loss 0.1131 
cause_predict: train acc 0.9917 p 1.0000 r 0.9444 f1 0.9714
position_predict: train acc 0.9792 p 0.9655 r 0.8750 f1 0.9180

epoch 14: test loss 0.6691 cost time: 10.2s

cause_predict: test acc 0.8856 p 0.5968 r 0.5931 f1 0.5949
max_acc 0.8941 max_p 0.6460 max_r 0.5584 max_f1 0.5990

position_predict: test acc 0.9173 p 0.6889 r 0.6481 f1 0.6679
max_acc 0.9294 max_p 0.7398 max_r 0.6934 max_f1 0.7158

Average max cause: max_acc 0.8950 max_p 0.6541 max_r 0.5489 max_f1 0.5969
Average max pos: max_acc 0.9209 max_p 0.7007 max_r 0.6690 max_f1 0.6845

write pair_data/Ind_BiLSTM_2/fold_2_test.txt done
write pair_data/Ind_BiLSTM_2/fold_2_train.txt done
Optimization Finished!

############# fold 2 end ###############
############# fold 3 begin ###############
load data_file: data_combine_en/fold_3_train.txt
y_position.shape (2275, 75, 2)
y_cause.shape (2275, 75, 2)
x.shape (2275, 75, 30)
sen_len.shape (2275, 75)
doc_len.shape (2275,)
n_cut 107
load data done!

load data_file: data_combine_en/fold_3_test.txt
y_position.shape (284, 75, 2)
y_cause.shape (284, 75, 2)
x.shape (284, 75, 30)
sen_len.shape (284, 75)
doc_len.shape (284,)
n_cut 22
load data done!

train docs: 2275    test docs: 284
step 10: train loss 0.8334 
cause_predict: train acc 0.8533 p 0.0000 r 0.0000 f1 0.0000
position_predict: train acc 0.8726 p 0.0000 r 0.0000 f1 0.0000
step 20: train loss 0.7266 
cause_predict: train acc 0.8640 p 0.0000 r 0.0000 f1 0.0000
position_predict: train acc 0.8720 p 0.0000 r 0.0000 f1 0.0000
step 30: train loss 0.7713 
cause_predict: train acc 0.8370 p 0.0000 r 0.0000 f1 0.0000
position_predict: train acc 0.8546 p 0.0000 r 0.0000 f1 0.0000
step 40: train loss 0.5964 
cause_predict: train acc 0.8577 p 0.0000 r 0.0000 f1 0.0000
position_predict: train acc 0.8740 p 1.0000 r 0.0312 f1 0.0606
step 50: train loss 0.6829 
cause_predict: train acc 0.8381 p 0.0000 r 0.0000 f1 0.0000
position_predict: train acc 0.8524 p 0.5106 r 0.7500 f1 0.6076
step 60: train loss 0.6183 
cause_predict: train acc 0.8593 p 0.5000 r 0.0270 f1 0.0513
position_predict: train acc 0.9125 p 0.6452 r 0.6250 f1 0.6349
step 70: train loss 0.5877 
cause_predict: train acc 0.8658 p 1.0000 r 0.0882 f1 0.1622
position_predict: train acc 0.9048 p 0.7273 r 0.5000 f1 0.5926

epoch 0: test loss 0.5340 cost time: 10.6s

cause_predict: test acc 0.8776 p 0.8525 r 0.1640 f1 0.2751
max_acc 0.8776 max_p 0.8525 max_r 0.1640 max_f1 0.2751

position_predict: test acc 0.9093 p 0.6544 r 0.6202 f1 0.6369
max_acc 0.9093 max_p 0.6544 max_r 0.6202 max_f1 0.6369

Average max cause: max_acc 0.8776 max_p 0.8525 max_r 0.1640 max_f1 0.2751
Average max pos: max_acc 0.9093 max_p 0.6544 max_r 0.6202 max_f1 0.6369

step 10: train loss 0.5525 
cause_predict: train acc 0.8537 p 0.5217 r 0.3243 f1 0.4000
position_predict: train acc 0.9065 p 0.6800 r 0.5312 f1 0.5965
step 20: train loss 0.4739 
cause_predict: train acc 0.8597 p 0.6429 r 0.2571 f1 0.3673
position_predict: train acc 0.9276 p 0.7667 r 0.7188 f1 0.7419
step 30: train loss 0.4437 
cause_predict: train acc 0.9066 p 0.9091 r 0.3030 f1 0.4545
position_predict: train acc 0.9261 p 0.7826 r 0.5625 f1 0.6545
step 40: train loss 0.4538 
cause_predict: train acc 0.8871 p 0.6316 r 0.3636 f1 0.4615
position_predict: train acc 0.9274 p 0.8261 r 0.5758 f1 0.6786
step 50: train loss 0.5703 
cause_predict: train acc 0.8479 p 0.7000 r 0.1892 f1 0.2979
position_predict: train acc 0.9032 p 0.7619 r 0.5000 f1 0.6038
step 60: train loss 0.4444 
cause_predict: train acc 0.8903 p 0.7083 r 0.4722 f1 0.5667
position_predict: train acc 0.9198 p 0.8095 r 0.5312 f1 0.6415
step 70: train loss 0.6246 
cause_predict: train acc 0.8534 p 0.6111 r 0.3438 f1 0.4400
position_predict: train acc 0.9110 p 0.7500 r 0.7273 f1 0.7385

epoch 1: test loss 0.4919 cost time: 10.7s

cause_predict: test acc 0.8843 p 0.8295 r 0.2303 f1 0.3605
max_acc 0.8843 max_p 0.8295 max_r 0.2303 max_f1 0.3605

position_predict: test acc 0.9191 p 0.7054 r 0.6341 f1 0.6679
max_acc 0.9191 max_p 0.7054 max_r 0.6341 max_f1 0.6679

Average max cause: max_acc 0.8843 max_p 0.8295 max_r 0.2303 max_f1 0.3605
Average max pos: max_acc 0.9191 max_p 0.7054 max_r 0.6341 max_f1 0.6679

step 10: train loss 0.4553 
cause_predict: train acc 0.8732 p 0.6552 r 0.5278 f1 0.5846
position_predict: train acc 0.9577 p 0.9615 r 0.7576 f1 0.8475
step 20: train loss 0.5090 
cause_predict: train acc 0.8685 p 0.6667 r 0.1667 f1 0.2667
position_predict: train acc 0.9243 p 0.7241 r 0.6562 f1 0.6885
step 30: train loss 0.3866 
cause_predict: train acc 0.9205 p 0.7097 r 0.5946 f1 0.6471
position_predict: train acc 0.9702 p 0.8966 r 0.8125 f1 0.8525
step 40: train loss 0.4737 
cause_predict: train acc 0.8846 p 0.6800 r 0.4722 f1 0.5574
position_predict: train acc 0.9060 p 0.6667 r 0.6250 f1 0.6452
step 50: train loss 0.4303 
cause_predict: train acc 0.8881 p 0.6316 r 0.3429 f1 0.4444
position_predict: train acc 0.9440 p 0.7931 r 0.7188 f1 0.7541
step 60: train loss 0.5202 
cause_predict: train acc 0.8938 p 0.7083 r 0.5000 f1 0.5862
position_predict: train acc 0.9159 p 0.7500 r 0.6364 f1 0.6885
step 70: train loss 0.4892 
cause_predict: train acc 0.8794 p 0.6087 r 0.3889 f1 0.4746
position_predict: train acc 0.9105 p 0.6452 r 0.6250 f1 0.6349

epoch 2: test loss 0.4891 cost time: 10.3s

cause_predict: test acc 0.8861 p 0.6435 r 0.4385 f1 0.5216
max_acc 0.8861 max_p 0.6435 max_r 0.4385 max_f1 0.5216

position_predict: test acc 0.9236 p 0.7266 r 0.6481 f1 0.6851
max_acc 0.9236 max_p 0.7266 max_r 0.6481 max_f1 0.6851

Average max cause: max_acc 0.8861 max_p 0.6435 max_r 0.4385 max_f1 0.5216
Average max pos: max_acc 0.9236 max_p 0.7266 max_r 0.6481 max_f1 0.6851

step 10: train loss 0.4513 
cause_predict: train acc 0.9144 p 0.8095 r 0.4857 f1 0.6071
position_predict: train acc 0.9183 p 0.7037 r 0.5938 f1 0.6441
step 20: train loss 0.4981 
cause_predict: train acc 0.8821 p 0.5882 r 0.2778 f1 0.3774
position_predict: train acc 0.9179 p 0.6800 r 0.5312 f1 0.5965
step 30: train loss 0.3073 
cause_predict: train acc 0.9197 p 0.9444 r 0.4722 f1 0.6296
position_predict: train acc 0.9518 p 0.8387 r 0.7879 f1 0.8125
step 40: train loss 0.5168 
cause_predict: train acc 0.8830 p 0.6818 r 0.3846 f1 0.4918
position_predict: train acc 0.9019 p 0.5938 r 0.5938 f1 0.5938
step 50: train loss 0.4563 
cause_predict: train acc 0.8897 p 0.6500 r 0.3514 f1 0.4561
position_predict: train acc 0.9146 p 0.6552 r 0.5758 f1 0.6129
step 60: train loss 0.3851 
cause_predict: train acc 0.9069 p 0.7000 r 0.4000 f1 0.5091
position_predict: train acc 0.9310 p 0.6875 r 0.6875 f1 0.6875
step 70: train loss 0.4935 
cause_predict: train acc 0.8730 p 0.5500 r 0.3333 f1 0.4151
position_predict: train acc 0.9098 p 0.7500 r 0.5294 f1 0.6207

epoch 3: test loss 0.4802 cost time: 10.2s

cause_predict: test acc 0.8937 p 0.7423 r 0.3817 f1 0.5042
max_acc 0.8861 max_p 0.6435 max_r 0.4385 max_f1 0.5216

position_predict: test acc 0.9236 p 0.7377 r 0.6272 f1 0.6780
max_acc 0.9236 max_p 0.7266 max_r 0.6481 max_f1 0.6851

Average max cause: max_acc 0.8861 max_p 0.6435 max_r 0.4385 max_f1 0.5216
Average max pos: max_acc 0.9236 max_p 0.7266 max_r 0.6481 max_f1 0.6851

step 10: train loss 0.3774 
cause_predict: train acc 0.9206 p 0.8947 r 0.4857 f1 0.6296
position_predict: train acc 0.9643 p 0.9615 r 0.7576 f1 0.8475
step 20: train loss 0.3032 
cause_predict: train acc 0.9424 p 0.8800 r 0.6111 f1 0.7213
position_predict: train acc 0.9559 p 0.8800 r 0.6875 f1 0.7719
step 30: train loss 0.3141 
cause_predict: train acc 0.9060 p 0.6786 r 0.5429 f1 0.6032
position_predict: train acc 0.9436 p 0.8000 r 0.7273 f1 0.7619
step 40: train loss 0.4068 
cause_predict: train acc 0.8930 p 0.7000 r 0.6000 f1 0.6462
position_predict: train acc 0.9349 p 0.8214 r 0.7188 f1 0.7667
step 50: train loss 0.3694 
cause_predict: train acc 0.9137 p 0.6970 r 0.6216 f1 0.6571
position_predict: train acc 0.9460 p 0.8148 r 0.6875 f1 0.7458
step 60: train loss 0.3553 
cause_predict: train acc 0.9121 p 0.7407 r 0.5882 f1 0.6557
position_predict: train acc 0.9414 p 0.7812 r 0.7812 f1 0.7812
step 70: train loss 0.4216 
cause_predict: train acc 0.8885 p 0.6667 r 0.5238 f1 0.5867
position_predict: train acc 0.9460 p 0.8214 r 0.6970 f1 0.7541

epoch 4: test loss 0.4852 cost time: 10.6s

cause_predict: test acc 0.8834 p 0.6000 r 0.5300 f1 0.5628
max_acc 0.8834 max_p 0.6000 max_r 0.5300 max_f1 0.5628

position_predict: test acc 0.9263 p 0.7440 r 0.6481 f1 0.6927
max_acc 0.9263 max_p 0.7440 max_r 0.6481 max_f1 0.6927

Average max cause: max_acc 0.8834 max_p 0.6000 max_r 0.5300 max_f1 0.5628
Average max pos: max_acc 0.9263 max_p 0.7440 max_r 0.6481 max_f1 0.6927

step 10: train loss 0.2685 
cause_predict: train acc 0.9219 p 0.7619 r 0.4444 f1 0.5614
position_predict: train acc 0.9688 p 0.8929 r 0.7812 f1 0.8333
step 20: train loss 0.3645 
cause_predict: train acc 0.8869 p 0.7308 r 0.4419 f1 0.5507
position_predict: train acc 0.9745 p 0.8571 r 0.9375 f1 0.8955
step 30: train loss 0.3715 
cause_predict: train acc 0.8804 p 0.7500 r 0.5385 f1 0.6269
position_predict: train acc 0.9617 p 0.8378 r 0.9394 f1 0.8857
step 40: train loss 0.3525 
cause_predict: train acc 0.9190 p 0.7727 r 0.4857 f1 0.5965
position_predict: train acc 0.9401 p 0.7419 r 0.7188 f1 0.7302
step 50: train loss 0.3789 
cause_predict: train acc 0.8919 p 0.6364 r 0.5676 f1 0.6000
position_predict: train acc 0.9421 p 0.8065 r 0.7353 f1 0.7692
step 60: train loss 0.3973 
cause_predict: train acc 0.8800 p 0.6667 r 0.5000 f1 0.5714
position_predict: train acc 0.9520 p 0.7941 r 0.8438 f1 0.8182
step 70: train loss 0.4005 
cause_predict: train acc 0.9087 p 0.7391 r 0.5312 f1 0.6182
position_predict: train acc 0.9304 p 0.7857 r 0.6875 f1 0.7333

epoch 5: test loss 0.4915 cost time: 10.6s

cause_predict: test acc 0.8870 p 0.6481 r 0.4416 f1 0.5253
max_acc 0.8834 max_p 0.6000 max_r 0.5300 max_f1 0.5628

position_predict: test acc 0.9209 p 0.6858 r 0.7073 f1 0.6964
max_acc 0.9209 max_p 0.6858 max_r 0.7073 max_f1 0.6964

Average max cause: max_acc 0.8834 max_p 0.6000 max_r 0.5300 max_f1 0.5628
Average max pos: max_acc 0.9263 max_p 0.7440 max_r 0.6481 max_f1 0.6927

step 10: train loss 0.2294 
cause_predict: train acc 0.9476 p 0.8621 r 0.7143 f1 0.7813
position_predict: train acc 0.9700 p 0.9286 r 0.8125 f1 0.8667
step 20: train loss 0.3120 
cause_predict: train acc 0.9324 p 0.7812 r 0.7576 f1 0.7692
position_predict: train acc 0.9324 p 0.7742 r 0.7500 f1 0.7619
step 30: train loss 0.3028 
cause_predict: train acc 0.9353 p 0.9615 r 0.6410 f1 0.7692
position_predict: train acc 0.9483 p 0.8889 r 0.7273 f1 0.8000
step 40: train loss 0.3318 
cause_predict: train acc 0.9364 p 0.8667 r 0.6500 f1 0.7429
position_predict: train acc 0.9541 p 0.8276 r 0.7500 f1 0.7869
step 50: train loss 0.2880 
cause_predict: train acc 0.9531 p 0.9630 r 0.7027 f1 0.8125
position_predict: train acc 0.9375 p 0.7857 r 0.6875 f1 0.7333
step 60: train loss 0.3254 
cause_predict: train acc 0.9339 p 0.8571 r 0.6857 f1 0.7619
position_predict: train acc 0.9559 p 0.8438 r 0.8438 f1 0.8438
step 70: train loss 0.3726 
cause_predict: train acc 0.9251 p 0.8276 r 0.6667 f1 0.7385
position_predict: train acc 0.9163 p 0.7333 r 0.6667 f1 0.6984

epoch 6: test loss 0.5289 cost time: 10.6s

cause_predict: test acc 0.8932 p 0.6822 r 0.4606 f1 0.5499
max_acc 0.8834 max_p 0.6000 max_r 0.5300 max_f1 0.5628

position_predict: test acc 0.9160 p 0.6645 r 0.6969 f1 0.6803
max_acc 0.9209 max_p 0.6858 max_r 0.7073 max_f1 0.6964

Average max cause: max_acc 0.8834 max_p 0.6000 max_r 0.5300 max_f1 0.5628
Average max pos: max_acc 0.9263 max_p 0.7440 max_r 0.6481 max_f1 0.6927

step 10: train loss 0.2919 
cause_predict: train acc 0.9273 p 0.7576 r 0.6579 f1 0.7042
position_predict: train acc 0.9689 p 0.9286 r 0.7879 f1 0.8525
step 20: train loss 0.2110 
cause_predict: train acc 0.9630 p 0.8966 r 0.7879 f1 0.8387
position_predict: train acc 0.9630 p 0.8710 r 0.8182 f1 0.8438
step 30: train loss 0.2556 
cause_predict: train acc 0.9317 p 0.7931 r 0.6389 f1 0.7077
position_predict: train acc 0.9640 p 0.8235 r 0.8750 f1 0.8485
step 40: train loss 0.2981 
cause_predict: train acc 0.9268 p 0.7667 r 0.6765 f1 0.7188
position_predict: train acc 0.9593 p 0.8750 r 0.8235 f1 0.8485
step 50: train loss 0.2294 
cause_predict: train acc 0.9255 p 0.7778 r 0.8235 f1 0.8000
position_predict: train acc 0.9734 p 0.9091 r 0.9375 f1 0.9231
step 60: train loss 0.2318 
cause_predict: train acc 0.9463 p 0.7632 r 0.8056 f1 0.7838
position_predict: train acc 0.9530 p 0.8276 r 0.7273 f1 0.7742
step 70: train loss 0.4518 
cause_predict: train acc 0.8857 p 0.7419 r 0.6571 f1 0.6970
position_predict: train acc 0.9371 p 0.8387 r 0.8125 f1 0.8254

epoch 7: test loss 0.5775 cost time: 10.5s

cause_predict: test acc 0.8776 p 0.5837 r 0.4732 f1 0.5226
max_acc 0.8834 max_p 0.6000 max_r 0.5300 max_f1 0.5628

position_predict: test acc 0.9160 p 0.6827 r 0.6446 f1 0.6631
max_acc 0.9209 max_p 0.6858 max_r 0.7073 max_f1 0.6964

Average max cause: max_acc 0.8834 max_p 0.6000 max_r 0.5300 max_f1 0.5628
Average max pos: max_acc 0.9263 max_p 0.7440 max_r 0.6481 max_f1 0.6927

step 10: train loss 0.1598 
cause_predict: train acc 0.9617 p 0.8611 r 0.9118 f1 0.8857
position_predict: train acc 0.9856 p 0.9394 r 0.9688 f1 0.9538
step 20: train loss 0.1533 
cause_predict: train acc 0.9640 p 0.8485 r 0.8000 f1 0.8235
position_predict: train acc 0.9700 p 0.8667 r 0.8125 f1 0.8387
step 30: train loss 0.1791 
cause_predict: train acc 0.9689 p 0.9143 r 0.8889 f1 0.9014
position_predict: train acc 0.9733 p 1.0000 r 0.8235 f1 0.9032
step 40: train loss 0.2725 
cause_predict: train acc 0.9459 p 0.9167 r 0.7500 f1 0.8250
position_predict: train acc 0.9421 p 0.7812 r 0.7576 f1 0.7692
step 50: train loss 0.2388 
cause_predict: train acc 0.9478 p 0.8286 r 0.7838 f1 0.8056
position_predict: train acc 0.9478 p 0.8000 r 0.7500 f1 0.7742
step 60: train loss 0.3007 
cause_predict: train acc 0.9401 p 0.8235 r 0.8000 f1 0.8116
position_predict: train acc 0.9447 p 0.8333 r 0.7812 f1 0.8065
step 70: train loss 0.1967 
cause_predict: train acc 0.9674 p 0.9143 r 0.8889 f1 0.9014
position_predict: train acc 0.9535 p 0.8438 r 0.8438 f1 0.8438

epoch 8: test loss 0.5773 cost time: 10.4s

cause_predict: test acc 0.8838 p 0.6044 r 0.5205 f1 0.5593
max_acc 0.8834 max_p 0.6000 max_r 0.5300 max_f1 0.5628

position_predict: test acc 0.9129 p 0.6597 r 0.6620 f1 0.6609
max_acc 0.9209 max_p 0.6858 max_r 0.7073 max_f1 0.6964

Average max cause: max_acc 0.8834 max_p 0.6000 max_r 0.5300 max_f1 0.5628
Average max pos: max_acc 0.9263 max_p 0.7440 max_r 0.6481 max_f1 0.6927

step 10: train loss 0.1941 
cause_predict: train acc 0.9429 p 0.9091 r 0.7692 f1 0.8333
position_predict: train acc 0.9667 p 0.8788 r 0.9062 f1 0.8923
step 20: train loss 0.1989 
cause_predict: train acc 0.9694 p 0.9333 r 0.8485 f1 0.8889
position_predict: train acc 0.9520 p 0.8235 r 0.8485 f1 0.8358
step 30: train loss 0.2847 
cause_predict: train acc 0.9533 p 0.8750 r 0.7778 f1 0.8235
position_predict: train acc 0.9455 p 0.7714 r 0.8182 f1 0.7941
step 40: train loss 0.1605 
cause_predict: train acc 0.9848 p 0.9118 r 0.9394 f1 0.9254
position_predict: train acc 0.9667 p 0.8621 r 0.7812 f1 0.8197
step 50: train loss 0.2174 
cause_predict: train acc 0.9654 p 0.9231 r 0.8780 f1 0.9000
position_predict: train acc 0.9567 p 0.8929 r 0.7812 f1 0.8333
step 60: train loss 0.1608 
cause_predict: train acc 0.9679 p 0.9143 r 0.8889 f1 0.9014
position_predict: train acc 0.9771 p 0.9091 r 0.9375 f1 0.9231
step 70: train loss 0.1950 
cause_predict: train acc 0.9533 p 0.8947 r 0.8095 f1 0.8500
position_predict: train acc 0.9533 p 0.8125 r 0.8125 f1 0.8125

epoch 9: test loss 0.6409 cost time: 10.6s

cause_predict: test acc 0.8874 p 0.6125 r 0.5584 f1 0.5842
max_acc 0.8874 max_p 0.6125 max_r 0.5584 max_f1 0.5842

position_predict: test acc 0.9147 p 0.6714 r 0.6551 f1 0.6631
max_acc 0.9209 max_p 0.6858 max_r 0.7073 max_f1 0.6964

Average max cause: max_acc 0.8834 max_p 0.6000 max_r 0.5300 max_f1 0.5628
Average max pos: max_acc 0.9263 max_p 0.7440 max_r 0.6481 max_f1 0.6927

step 10: train loss 0.1334 
cause_predict: train acc 0.9669 p 0.8438 r 0.8438 f1 0.8438
position_predict: train acc 0.9801 p 0.8824 r 0.9375 f1 0.9091
step 20: train loss 0.0965 
cause_predict: train acc 0.9890 p 0.9697 r 0.9412 f1 0.9552
position_predict: train acc 0.9743 p 0.9032 r 0.8750 f1 0.8889
step 30: train loss 0.1303 
cause_predict: train acc 0.9789 p 0.9268 r 0.9500 f1 0.9383
position_predict: train acc 0.9578 p 0.8235 r 0.8750 f1 0.8485
step 40: train loss 0.0922 
cause_predict: train acc 0.9879 p 1.0000 r 0.9118 f1 0.9538
position_predict: train acc 0.9839 p 0.9118 r 0.9688 f1 0.9394
step 50: train loss 0.1505 
cause_predict: train acc 0.9602 p 0.8788 r 0.8286 f1 0.8529
position_predict: train acc 0.9841 p 0.9394 r 0.9394 f1 0.9394
step 60: train loss 0.1876 
cause_predict: train acc 0.9435 p 0.8182 r 0.7714 f1 0.7941
position_predict: train acc 0.9758 p 0.9333 r 0.8750 f1 0.9032
step 70: train loss 0.2145 
cause_predict: train acc 0.9513 p 0.8571 r 0.8372 f1 0.8471
position_predict: train acc 0.9663 p 0.8286 r 0.9062 f1 0.8657

epoch 10: test loss 0.6434 cost time: 10.4s

cause_predict: test acc 0.8910 p 0.6347 r 0.5426 f1 0.5850
max_acc 0.8910 max_p 0.6347 max_r 0.5426 max_f1 0.5850

position_predict: test acc 0.9115 p 0.6584 r 0.6446 f1 0.6514
max_acc 0.9209 max_p 0.6858 max_r 0.7073 max_f1 0.6964

Average max cause: max_acc 0.8834 max_p 0.6000 max_r 0.5300 max_f1 0.5628
Average max pos: max_acc 0.9263 max_p 0.7440 max_r 0.6481 max_f1 0.6927

step 10: train loss 0.1280 
cause_predict: train acc 0.9839 p 0.9412 r 0.9412 f1 0.9412
position_predict: train acc 0.9719 p 0.9062 r 0.8788 f1 0.8923
step 20: train loss 0.0665 
cause_predict: train acc 0.9840 p 0.9394 r 0.9118 f1 0.9254
position_predict: train acc 0.9808 p 0.8857 r 0.9394 f1 0.9118
step 30: train loss 0.1368 
cause_predict: train acc 0.9842 p 0.9706 r 0.9429 f1 0.9565
position_predict: train acc 0.9737 p 0.9655 r 0.8750 f1 0.9180
step 40: train loss 0.0894 
cause_predict: train acc 0.9834 p 0.9231 r 0.9730 f1 0.9474
position_predict: train acc 0.9876 p 0.9143 r 1.0000 f1 0.9552
step 50: train loss 0.1520 
cause_predict: train acc 0.9684 p 0.9070 r 0.9070 f1 0.9070
position_predict: train acc 0.9723 p 0.8788 r 0.9062 f1 0.8923
step 60: train loss 0.1417 
cause_predict: train acc 0.9649 p 0.8611 r 0.8611 f1 0.8611
position_predict: train acc 0.9719 p 0.9032 r 0.8485 f1 0.8750
step 70: train loss 0.2590 
cause_predict: train acc 0.9619 p 0.8788 r 0.8529 f1 0.8657
position_predict: train acc 0.9576 p 0.8667 r 0.8125 f1 0.8387

epoch 11: test loss 0.6577 cost time: 10.7s

cause_predict: test acc 0.8776 p 0.5805 r 0.4890 f1 0.5308
max_acc 0.8910 max_p 0.6347 max_r 0.5426 max_f1 0.5850

position_predict: test acc 0.9133 p 0.6598 r 0.6690 f1 0.6644
max_acc 0.9209 max_p 0.6858 max_r 0.7073 max_f1 0.6964

Average max cause: max_acc 0.8834 max_p 0.6000 max_r 0.5300 max_f1 0.5628
2024-06-22 19:07:31.849286: W tensorflow/c/c_api.cc:304] Operation '{name:'softmax_b_pos/Adam_1/Assign' id:5023 op device:{requested: '', assigned: ''} def:{{{node softmax_b_pos/Adam_1/Assign}} = Assign[T=DT_FLOAT, _class=["loc:@softmax_b_pos"], _has_manual_control_dependencies=true, use_locking=true, validate_shape=true](softmax_b_pos/Adam_1, softmax_b_pos/Adam_1/Initializer/zeros)}}' was changed by setting attribute after it was run by a session. This mutation will have no effect, and will trigger an error in the future. Either don't modify nodes after running them or create a new session.
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Average max pos: max_acc 0.9263 max_p 0.7440 max_r 0.6481 max_f1 0.6927

step 10: train loss 0.1074 
cause_predict: train acc 0.9797 p 0.9211 r 0.9722 f1 0.9459
position_predict: train acc 0.9797 p 0.9118 r 0.9688 f1 0.9394
step 20: train loss 0.0963 
cause_predict: train acc 0.9885 p 0.9412 r 0.9697 f1 0.9552
position_predict: train acc 0.9770 p 0.8824 r 0.9375 f1 0.9091
step 30: train loss 0.0656 
cause_predict: train acc 0.9795 p 1.0000 r 0.8974 f1 0.9459
position_predict: train acc 0.9949 p 0.9697 r 1.0000 f1 0.9846
step 40: train loss 0.1542 
cause_predict: train acc 0.9660 p 0.9091 r 0.8571 f1 0.8824
position_predict: train acc 0.9574 p 0.7895 r 0.9375 f1 0.8571
step 50: train loss 0.2891 
cause_predict: train acc 0.9356 p 0.8056 r 0.8286 f1 0.8169
position_predict: train acc 0.9752 p 0.9355 r 0.9062 f1 0.9206
step 60: train loss 0.1664 
cause_predict: train acc 0.9780 p 0.9211 r 0.9459 f1 0.9333
position_predict: train acc 0.9692 p 0.9333 r 0.8485 f1 0.8889
step 70: train loss 0.2445 
cause_predict: train acc 0.9718 p 0.9348 r 0.9149 f1 0.9247
position_predict: train acc 0.9476 p 0.8065 r 0.7812 f1 0.7937

epoch 12: test loss 0.6864 cost time: 10.4s

cause_predict: test acc 0.8816 p 0.5872 r 0.5521 f1 0.5691
max_acc 0.8910 max_p 0.6347 max_r 0.5426 max_f1 0.5850

position_predict: test acc 0.9173 p 0.6848 r 0.6585 f1 0.6714
max_acc 0.9209 max_p 0.6858 max_r 0.7073 max_f1 0.6964

Average max cause: max_acc 0.8834 max_p 0.6000 max_r 0.5300 max_f1 0.5628
Average max pos: max_acc 0.9263 max_p 0.7440 max_r 0.6481 max_f1 0.6927

step 10: train loss 0.1875 
cause_predict: train acc 0.9541 p 0.9032 r 0.8235 f1 0.8615
position_predict: train acc 0.9643 p 0.8788 r 0.9062 f1 0.8923
step 20: train loss 0.1096 
cause_predict: train acc 0.9834 p 0.9722 r 0.9211 f1 0.9459
position_predict: train acc 0.9751 p 0.8857 r 0.9394 f1 0.9118
step 30: train loss 0.0561 
cause_predict: train acc 0.9914 p 0.9722 r 0.9722 f1 0.9722
position_predict: train acc 0.9914 p 0.9429 r 1.0000 f1 0.9706
step 40: train loss 0.2117 
cause_predict: train acc 0.9559 p 0.8788 r 0.8529 f1 0.8657
position_predict: train acc 0.9461 p 0.8182 r 0.8438 f1 0.8308
step 50: train loss 0.1294 
cause_predict: train acc 0.9893 p 0.9688 r 0.9688 f1 0.9688
position_predict: train acc 0.9679 p 0.9062 r 0.9062 f1 0.9062
step 60: train loss 0.2434 
cause_predict: train acc 0.9544 p 0.8378 r 0.8378 f1 0.8378
position_predict: train acc 0.9582 p 0.8387 r 0.8125 f1 0.8254
step 70: train loss 0.1494 
cause_predict: train acc 0.9676 p 0.8919 r 0.8919 f1 0.8919
position_predict: train acc 0.9717 p 0.8788 r 0.9062 f1 0.8923

epoch 13: test loss 0.6988 cost time: 10.3s

cause_predict: test acc 0.8816 p 0.5850 r 0.5647 f1 0.5746
max_acc 0.8910 max_p 0.6347 max_r 0.5426 max_f1 0.5850

position_predict: test acc 0.9129 p 0.6620 r 0.6551 f1 0.6585
max_acc 0.9209 max_p 0.6858 max_r 0.7073 max_f1 0.6964

Average max cause: max_acc 0.8834 max_p 0.6000 max_r 0.5300 max_f1 0.5628
Average max pos: max_acc 0.9263 max_p 0.7440 max_r 0.6481 max_f1 0.6927

step 10: train loss 0.0649 
cause_predict: train acc 0.9813 p 0.9375 r 0.9375 f1 0.9375
position_predict: train acc 1.0000 p 1.0000 r 1.0000 f1 1.0000
step 20: train loss 0.0769 
cause_predict: train acc 0.9776 p 0.9394 r 0.9118 f1 0.9254
position_predict: train acc 0.9865 p 0.9677 r 0.9375 f1 0.9524
step 30: train loss 0.1595 
cause_predict: train acc 0.9657 p 0.8788 r 0.8788 f1 0.8788
position_predict: train acc 0.9742 p 0.9062 r 0.9062 f1 0.9062
step 40: train loss 0.1723 
cause_predict: train acc 0.9624 p 0.8056 r 0.8529 f1 0.8286
position_predict: train acc 0.9655 p 0.8621 r 0.7812 f1 0.8197
step 50: train loss 0.1506 
cause_predict: train acc 0.9759 p 0.9444 r 0.8947 f1 0.9189
position_predict: train acc 0.9679 p 0.9032 r 0.8485 f1 0.8750
step 60: train loss 0.0988 
cause_predict: train acc 0.9735 p 0.9118 r 0.9118 f1 0.9118
position_predict: train acc 0.9823 p 0.9375 r 0.9375 f1 0.9375
step 70: train loss 0.1414 
cause_predict: train acc 0.9717 p 0.9118 r 0.8857 f1 0.8986
position_predict: train acc 0.9757 p 0.9333 r 0.8750 f1 0.9032

epoch 14: test loss 0.7448 cost time: 10.6s

cause_predict: test acc 0.8887 p 0.6269 r 0.5300 f1 0.5744
max_acc 0.8910 max_p 0.6347 max_r 0.5426 max_f1 0.5850

position_predict: test acc 0.9138 p 0.6679 r 0.6516 f1 0.6596
max_acc 0.9209 max_p 0.6858 max_r 0.7073 max_f1 0.6964

Average max cause: max_acc 0.8834 max_p 0.6000 max_r 0.5300 max_f1 0.5628
Average max pos: max_acc 0.9263 max_p 0.7440 max_r 0.6481 max_f1 0.6927

write pair_data/Ind_BiLSTM_2/fold_3_test.txt done
write pair_data/Ind_BiLSTM_2/fold_3_train.txt done
Optimization Finished!

############# fold 3 end ###############
############# fold 4 begin ###############
load data_file: data_combine_en/fold_4_train.txt
y_position.shape (2275, 75, 2)
y_cause.shape (2275, 75, 2)
x.shape (2275, 75, 30)
sen_len.shape (2275, 75)
doc_len.shape (2275,)
n_cut 107
load data done!

load data_file: data_combine_en/fold_4_test.txt
y_position.shape (284, 75, 2)
y_cause.shape (284, 75, 2)
x.shape (284, 75, 30)
sen_len.shape (284, 75)
doc_len.shape (284,)
n_cut 22
load data done!

train docs: 2275    test docs: 284
step 10: train loss 0.8116 
cause_predict: train acc 0.8589 p 0.0000 r 0.0000 f1 0.0000
position_predict: train acc 0.8710 p 0.0000 r 0.0000 f1 0.0000
step 20: train loss 0.7346 
cause_predict: train acc 0.8553 p 0.0000 r 0.0000 f1 0.0000
position_predict: train acc 0.8638 p 0.0000 r 0.0000 f1 0.0000
step 30: train loss 0.7201 
cause_predict: train acc 0.8451 p 0.0000 r 0.0000 f1 0.0000
position_predict: train acc 0.8498 p 0.0000 r 0.0000 f1 0.0000
step 40: train loss 0.6468 
cause_predict: train acc 0.8531 p 0.0000 r 0.0000 f1 0.0000
position_predict: train acc 0.8612 p 0.2500 r 0.0312 f1 0.0556
step 50: train loss 0.6112 
cause_predict: train acc 0.8509 p 0.0000 r 0.0000 f1 0.0000
position_predict: train acc 0.9079 p 0.7500 r 0.5455 f1 0.6316
step 60: train loss 0.6350 
cause_predict: train acc 0.8233 p 0.0000 r 0.0000 f1 0.0000
position_predict: train acc 0.8930 p 0.8125 r 0.3939 f1 0.5306
step 70: train loss 0.5988 
cause_predict: train acc 0.8548 p 0.0000 r 0.0000 f1 0.0000
position_predict: train acc 0.9087 p 0.7200 r 0.5455 f1 0.6207

epoch 0: test loss 0.5361 cost time: 10.4s

cause_predict: test acc 0.8619 p 1.0000 r 0.0252 f1 0.0492
max_acc 0.8619 max_p 1.0000 max_r 0.0252 max_f1 0.0492

position_predict: test acc 0.9164 p 0.7033 r 0.6028 f1 0.6492
max_acc 0.9164 max_p 0.7033 max_r 0.6028 max_f1 0.6492

Average max cause: max_acc 0.8619 max_p 1.0000 max_r 0.0252 max_f1 0.0492
Average max pos: max_acc 0.9164 max_p 0.7033 max_r 0.6028 max_f1 0.6492

step 10: train loss 0.5082 
cause_predict: train acc 0.8736 p 0.6000 r 0.0882 f1 0.1538
position_predict: train acc 0.9119 p 0.6452 r 0.6250 f1 0.6349
step 20: train loss 0.4337 
cause_predict: train acc 0.8771 p 0.6250 r 0.2500 f1 0.3571
position_predict: train acc 0.9590 p 0.8846 r 0.7188 f1 0.7931
step 30: train loss 0.5780 
cause_predict: train acc 0.8221 p 0.5217 r 0.3158 f1 0.3934
position_predict: train acc 0.9038 p 0.7308 r 0.5938 f1 0.6552
step 40: train loss 0.4685 
cause_predict: train acc 0.8824 p 0.5600 r 0.4000 f1 0.4667
position_predict: train acc 0.9265 p 0.7143 r 0.6250 f1 0.6667
step 50: train loss 0.5059 
cause_predict: train acc 0.8745 p 0.6471 r 0.2973 f1 0.4074
position_predict: train acc 0.9059 p 0.6667 r 0.5000 f1 0.5714
step 60: train loss 0.4274 
cause_predict: train acc 0.8854 p 1.0000 r 0.1714 f1 0.2927
position_predict: train acc 0.9328 p 0.8261 r 0.5938 f1 0.6909
step 70: train loss 0.4330 
cause_predict: train acc 0.9033 p 0.7000 r 0.2121 f1 0.3256
position_predict: train acc 0.9300 p 0.7200 r 0.5625 f1 0.6316

epoch 1: test loss 0.4784 cost time: 10.2s

cause_predict: test acc 0.8820 p 0.7732 r 0.2366 f1 0.3623
max_acc 0.8820 max_p 0.7732 max_r 0.2366 max_f1 0.3623

position_predict: test acc 0.9272 p 0.7263 r 0.6934 f1 0.7094
max_acc 0.9272 max_p 0.7263 max_r 0.6934 max_f1 0.7094

Average max cause: max_acc 0.8820 max_p 0.7732 max_r 0.2366 max_f1 0.3623
Average max pos: max_acc 0.9272 max_p 0.7263 max_r 0.6934 max_f1 0.7094

step 10: train loss 0.5369 
cause_predict: train acc 0.8780 p 0.6522 r 0.4054 f1 0.5000
position_predict: train acc 0.9146 p 0.7143 r 0.6061 f1 0.6557
step 20: train loss 0.4231 
cause_predict: train acc 0.8973 p 0.6667 r 0.2353 f1 0.3478
position_predict: train acc 0.9315 p 0.7308 r 0.5938 f1 0.6552
step 30: train loss 0.4094 
cause_predict: train acc 0.8973 p 0.7391 r 0.4474 f1 0.5574
position_predict: train acc 0.9278 p 0.7097 r 0.6875 f1 0.6984
step 40: train loss 0.3774 
cause_predict: train acc 0.8979 p 0.7500 r 0.4412 f1 0.5556
position_predict: train acc 0.9362 p 0.7742 r 0.7500 f1 0.7619
step 50: train loss 0.5172 
cause_predict: train acc 0.8546 p 0.5263 r 0.2941 f1 0.3774
position_predict: train acc 0.9031 p 0.7083 r 0.5312 f1 0.6071
step 60: train loss 0.3870 
cause_predict: train acc 0.8927 p 0.6957 r 0.4324 f1 0.5333
position_predict: train acc 0.9387 p 0.8077 r 0.6562 f1 0.7241
step 70: train loss 0.4239 
cause_predict: train acc 0.8932 p 0.5333 r 0.4571 f1 0.4923
position_predict: train acc 0.9353 p 0.7143 r 0.6250 f1 0.6667

epoch 2: test loss 0.4635 cost time: 10.6s

cause_predict: test acc 0.8950 p 0.6830 r 0.4826 f1 0.5656
max_acc 0.8950 max_p 0.6830 max_r 0.4826 max_f1 0.5656

position_predict: test acc 0.9316 p 0.7702 r 0.6655 f1 0.7140
max_acc 0.9316 max_p 0.7702 max_r 0.6655 max_f1 0.7140

Average max cause: max_acc 0.8950 max_p 0.6830 max_r 0.4826 max_f1 0.5656
Average max pos: max_acc 0.9316 max_p 0.7702 max_r 0.6655 max_f1 0.7140

step 10: train loss 0.3350 
cause_predict: train acc 0.9315 p 1.0000 r 0.5455 f1 0.7059
position_predict: train acc 0.9680 p 0.8788 r 0.9062 f1 0.8923
step 20: train loss 0.4250 
cause_predict: train acc 0.8797 p 0.7037 r 0.4750 f1 0.5672
position_predict: train acc 0.9129 p 0.6571 r 0.7188 f1 0.6866
step 30: train loss 0.5142 
cause_predict: train acc 0.8564 p 0.5909 r 0.3939 f1 0.4727
position_predict: train acc 0.9257 p 0.8000 r 0.7273 f1 0.7619
step 40: train loss 0.4583 
cause_predict: train acc 0.8507 p 0.4194 r 0.3421 f1 0.3768
position_predict: train acc 0.9410 p 0.7857 r 0.6667 f1 0.7213
step 50: train loss 0.6368 
cause_predict: train acc 0.8263 p 0.4783 r 0.3056 f1 0.3729
position_predict: train acc 0.8685 p 0.5714 r 0.5000 f1 0.5333
step 60: train loss 0.4786 
cause_predict: train acc 0.8996 p 0.8095 r 0.4595 f1 0.5862
position_predict: train acc 0.9163 p 0.7826 r 0.5455 f1 0.6429
step 70: train loss 0.4496 
cause_predict: train acc 0.8826 p 0.7500 r 0.3077 f1 0.4364
position_predict: train acc 0.9394 p 0.8636 r 0.5938 f1 0.7037

epoch 3: test loss 0.4564 cost time: 10.5s

cause_predict: test acc 0.8901 p 0.6859 r 0.4132 f1 0.5157
max_acc 0.8950 max_p 0.6830 max_r 0.4826 max_f1 0.5656

position_predict: test acc 0.9294 p 0.7398 r 0.6934 f1 0.7158
max_acc 0.9294 max_p 0.7398 max_r 0.6934 max_f1 0.7158

Average max cause: max_acc 0.8950 max_p 0.6830 max_r 0.4826 max_f1 0.5656
Average max pos: max_acc 0.9316 max_p 0.7702 max_r 0.6655 max_f1 0.7140

step 10: train loss 0.4010 
cause_predict: train acc 0.8844 p 0.7586 r 0.5789 f1 0.6567
position_predict: train acc 0.9548 p 0.8485 r 0.8750 f1 0.8615
step 20: train loss 0.4037 
cause_predict: train acc 0.8922 p 0.6957 r 0.4706 f1 0.5614
position_predict: train acc 0.9009 p 0.6364 r 0.6562 f1 0.6462
step 30: train loss 0.3931 
cause_predict: train acc 0.9065 p 0.6667 r 0.5143 f1 0.5806
position_predict: train acc 0.9353 p 0.7917 r 0.5938 f1 0.6786
step 40: train loss 0.4010 
cause_predict: train acc 0.8884 p 0.9375 r 0.3750 f1 0.5357
position_predict: train acc 0.9270 p 0.7273 r 0.7500 f1 0.7385
step 50: train loss 0.4053 
cause_predict: train acc 0.8947 p 0.8636 r 0.5000 f1 0.6333
position_predict: train acc 0.9234 p 0.7353 r 0.7812 f1 0.7576
step 60: train loss 0.3339 
cause_predict: train acc 0.9262 p 0.8261 r 0.5429 f1 0.6552
position_predict: train acc 0.9446 p 0.7931 r 0.7188 f1 0.7541
step 70: train loss 0.3245 
cause_predict: train acc 0.8831 p 0.6000 r 0.5143 f1 0.5538
position_predict: train acc 0.9435 p 0.7812 r 0.7812 f1 0.7812

epoch 4: test loss 0.5007 cost time: 10.4s

cause_predict: test acc 0.8865 p 0.6522 r 0.4259 f1 0.5153
max_acc 0.8950 max_p 0.6830 max_r 0.4826 max_f1 0.5656

position_predict: test acc 0.9249 p 0.7228 r 0.6725 f1 0.6968
max_acc 0.9294 max_p 0.7398 max_r 0.6934 max_f1 0.7158

Average max cause: max_acc 0.8950 max_p 0.6830 max_r 0.4826 max_f1 0.5656
Average max pos: max_acc 0.9316 max_p 0.7702 max_r 0.6655 max_f1 0.7140

step 10: train loss 0.3017 
cause_predict: train acc 0.9248 p 0.8800 r 0.6111 f1 0.7213
position_predict: train acc 0.9469 p 0.8571 r 0.7500 f1 0.8000
step 20: train loss 0.3619 
cause_predict: train acc 0.9225 p 0.6897 r 0.6061 f1 0.6452
position_predict: train acc 0.9190 p 0.6364 r 0.6562 f1 0.6462
step 30: train loss 0.3843 
cause_predict: train acc 0.8984 p 0.7222 r 0.7429 f1 0.7324
position_predict: train acc 0.9305 p 0.8276 r 0.7500 f1 0.7869
step 40: train loss 0.3999 
cause_predict: train acc 0.8913 p 0.6897 r 0.5556 f1 0.6154
position_predict: train acc 0.9348 p 0.8000 r 0.7273 f1 0.7619
step 50: train loss 0.3378 
cause_predict: train acc 0.9372 p 0.8667 r 0.7647 f1 0.8125
position_predict: train acc 0.9476 p 0.9231 r 0.7500 f1 0.8276
step 60: train loss 0.2934 
cause_predict: train acc 0.9375 p 0.8065 r 0.7353 f1 0.7692
position_predict: train acc 0.9583 p 0.8667 r 0.8125 f1 0.8387
step 70: train loss 0.2897 
cause_predict: train acc 0.9333 p 0.9167 r 0.6471 f1 0.7586
position_predict: train acc 0.9571 p 0.8710 r 0.8438 f1 0.8571

epoch 5: test loss 0.5055 cost time: 10.3s

cause_predict: test acc 0.8829 p 0.6078 r 0.4890 f1 0.5420
max_acc 0.8950 max_p 0.6830 max_r 0.4826 max_f1 0.5656

position_predict: test acc 0.9254 p 0.7027 r 0.7247 f1 0.7136
max_acc 0.9294 max_p 0.7398 max_r 0.6934 max_f1 0.7158

Average max cause: max_acc 0.8950 max_p 0.6830 max_r 0.4826 max_f1 0.5656
Average max pos: max_acc 0.9316 max_p 0.7702 max_r 0.6655 max_f1 0.7140

step 10: train loss 0.3609 
cause_predict: train acc 0.9215 p 0.8846 r 0.5897 f1 0.7077
position_predict: train acc 0.9587 p 0.8667 r 0.8125 f1 0.8387
step 20: train loss 0.2629 
cause_predict: train acc 0.9233 p 0.7586 r 0.5789 f1 0.6567
position_predict: train acc 0.9633 p 0.8000 r 0.8750 f1 0.8358
step 30: train loss 0.2370 
cause_predict: train acc 0.9435 p 0.8929 r 0.7143 f1 0.7937
position_predict: train acc 0.9652 p 0.9615 r 0.7812 f1 0.8621
step 40: train loss 0.3538 
cause_predict: train acc 0.9095 p 0.7419 r 0.6571 f1 0.6970
position_predict: train acc 0.9231 p 0.7500 r 0.7273 f1 0.7385
step 50: train loss 0.4013 
cause_predict: train acc 0.9167 p 0.8000 r 0.5405 f1 0.6452
position_predict: train acc 0.9432 p 0.8000 r 0.7273 f1 0.7619
step 60: train loss 0.4060 
cause_predict: train acc 0.8971 p 0.6176 r 0.5833 f1 0.6000
position_predict: train acc 0.9265 p 0.7188 r 0.6765 f1 0.6970
step 70: train loss 0.3452 
cause_predict: train acc 0.8884 p 0.7826 r 0.4737 f1 0.5902
position_predict: train acc 0.9688 p 0.9032 r 0.8750 f1 0.8889

epoch 6: test loss 0.5196 cost time: 10.8s

cause_predict: test acc 0.8874 p 0.6327 r 0.4890 f1 0.5516
max_acc 0.8950 max_p 0.6830 max_r 0.4826 max_f1 0.5656

position_predict: test acc 0.9218 p 0.7029 r 0.6760 f1 0.6892
max_acc 0.9294 max_p 0.7398 max_r 0.6934 max_f1 0.7158

Average max cause: max_acc 0.8950 max_p 0.6830 max_r 0.4826 max_f1 0.5656
Average max pos: max_acc 0.9316 max_p 0.7702 max_r 0.6655 max_f1 0.7140

step 10: train loss 0.2643 
cause_predict: train acc 0.9307 p 0.7931 r 0.6970 f1 0.7419
position_predict: train acc 0.9610 p 0.8710 r 0.8438 f1 0.8571
step 20: train loss 0.3788 
cause_predict: train acc 0.9062 p 0.6571 r 0.6571 f1 0.6571
position_predict: train acc 0.9336 p 0.7586 r 0.6875 f1 0.7213
step 30: train loss 0.2070 
cause_predict: train acc 0.9545 p 0.9062 r 0.8056 f1 0.8529
position_predict: train acc 0.9500 p 0.8438 r 0.8182 f1 0.8308
step 40: train loss 0.1797 
cause_predict: train acc 0.9597 p 0.8333 r 0.8824 f1 0.8571
position_predict: train acc 0.9677 p 0.9032 r 0.8485 f1 0.8750
step 50: train loss 0.3518 
cause_predict: train acc 0.9045 p 0.7419 r 0.6389 f1 0.6866
position_predict: train acc 0.9682 p 0.8788 r 0.9062 f1 0.8923
step 60: train loss 0.2486 
cause_predict: train acc 0.9286 p 0.8333 r 0.6410 f1 0.7246
position_predict: train acc 0.9586 p 0.8621 r 0.7812 f1 0.8197
step 70: train loss 0.2902 
cause_predict: train acc 0.9275 p 0.8276 r 0.7059 f1 0.7619
position_predict: train acc 0.9324 p 0.8276 r 0.7273 f1 0.7742

epoch 7: test loss 0.5509 cost time: 10.4s

cause_predict: test acc 0.8910 p 0.6377 r 0.5331 f1 0.5808
max_acc 0.8910 max_p 0.6377 max_r 0.5331 max_f1 0.5808

position_predict: test acc 0.9223 p 0.7055 r 0.6760 f1 0.6904
max_acc 0.9294 max_p 0.7398 max_r 0.6934 max_f1 0.7158

Average max cause: max_acc 0.8950 max_p 0.6830 max_r 0.4826 max_f1 0.5656
Average max pos: max_acc 0.9316 max_p 0.7702 max_r 0.6655 max_f1 0.7140

step 10: train loss 0.1619 
cause_predict: train acc 0.9636 p 0.9355 r 0.7838 f1 0.8529
position_predict: train acc 0.9782 p 0.9062 r 0.9062 f1 0.9062
step 20: train loss 0.2875 
cause_predict: train acc 0.9468 p 0.8710 r 0.8182 f1 0.8438
position_predict: train acc 0.9468 p 0.8667 r 0.8125 f1 0.8387
step 30: train loss 0.1975 
cause_predict: train acc 0.9570 p 0.8966 r 0.7429 f1 0.8125
position_predict: train acc 0.9570 p 0.8125 r 0.8125 f1 0.8125
step 40: train loss 0.2315 
cause_predict: train acc 0.9424 p 0.8667 r 0.7879 f1 0.8254
position_predict: train acc 0.9581 p 0.8750 r 0.8750 f1 0.8750
step 50: train loss 0.2832 
cause_predict: train acc 0.9050 p 0.7812 r 0.6410 f1 0.7042
position_predict: train acc 0.9683 p 0.8571 r 0.9375 f1 0.8955
step 60: train loss 0.2639 
cause_predict: train acc 0.9194 p 0.8000 r 0.6316 f1 0.7059
position_predict: train acc 0.9637 p 0.9000 r 0.8182 f1 0.8571
step 70: train loss 0.2461 
cause_predict: train acc 0.9506 p 0.8235 r 0.8000 f1 0.8116
position_predict: train acc 0.9544 p 0.7941 r 0.8438 f1 0.8182

epoch 8: test loss 0.6264 cost time: 10.4s

cause_predict: test acc 0.8794 p 0.5959 r 0.4606 f1 0.5196
max_acc 0.8910 max_p 0.6377 max_r 0.5331 max_f1 0.5808

position_predict: test acc 0.9218 p 0.7000 r 0.6829 f1 0.6914
max_acc 0.9294 max_p 0.7398 max_r 0.6934 max_f1 0.7158

Average max cause: max_acc 0.8950 max_p 0.6830 max_r 0.4826 max_f1 0.5656
Average max pos: max_acc 0.9316 max_p 0.7702 max_r 0.6655 max_f1 0.7140

step 10: train loss 0.2539 
cause_predict: train acc 0.9533 p 0.9167 r 0.7857 f1 0.8462
position_predict: train acc 0.9650 p 0.8750 r 0.8485 f1 0.8615
step 20: train loss 0.1641 
cause_predict: train acc 0.9515 p 0.8438 r 0.8182 f1 0.8308
position_predict: train acc 0.9868 p 0.9677 r 0.9375 f1 0.9524
step 30: train loss 0.1671 
cause_predict: train acc 0.9586 p 0.9091 r 0.7895 f1 0.8451
position_predict: train acc 0.9774 p 0.8857 r 0.9394 f1 0.9118
step 40: train loss 0.1768 
cause_predict: train acc 0.9522 p 0.8571 r 0.8108 f1 0.8333
position_predict: train acc 0.9721 p 0.9032 r 0.8750 f1 0.8889
step 50: train loss 0.1829 
cause_predict: train acc 0.9614 p 0.8529 r 0.8529 f1 0.8529
position_predict: train acc 0.9807 p 0.9355 r 0.9062 f1 0.9206
step 60: train loss 0.1471 
cause_predict: train acc 0.9710 p 0.9091 r 0.9091 f1 0.9091
position_predict: train acc 0.9758 p 0.9355 r 0.9062 f1 0.9206
step 70: train loss 0.2163 
cause_predict: train acc 0.9372 p 0.7647 r 0.8125 f1 0.7879
position_predict: train acc 0.9596 p 0.8485 r 0.8750 f1 0.8615

epoch 9: test loss 0.6500 cost time: 10.2s

cause_predict: test acc 0.8785 p 0.5763 r 0.5363 f1 0.5556
max_acc 0.8910 max_p 0.6377 max_r 0.5331 max_f1 0.5808

position_predict: test acc 0.9214 p 0.7079 r 0.6585 f1 0.6823
max_acc 0.9294 max_p 0.7398 max_r 0.6934 max_f1 0.7158

Average max cause: max_acc 0.8950 max_p 0.6830 max_r 0.4826 max_f1 0.5656
Average max pos: max_acc 0.9316 max_p 0.7702 max_r 0.6655 max_f1 0.7140

step 10: train loss 0.1141 
cause_predict: train acc 0.9817 p 0.9697 r 0.9412 f1 0.9552
position_predict: train acc 0.9817 p 0.9677 r 0.9375 f1 0.9524
step 20: train loss 0.1609 
cause_predict: train acc 0.9585 p 0.8333 r 0.9091 f1 0.8696
position_predict: train acc 0.9816 p 0.9667 r 0.9062 f1 0.9355
step 30: train loss 0.1600 
cause_predict: train acc 0.9618 p 0.8788 r 0.8286 f1 0.8529
position_predict: train acc 0.9656 p 0.9000 r 0.8182 f1 0.8571
step 40: train loss 0.1486 
cause_predict: train acc 0.9574 p 0.8889 r 0.8421 f1 0.8649
position_predict: train acc 0.9830 p 0.9667 r 0.9062 f1 0.9355
step 50: train loss 0.1899 
cause_predict: train acc 0.9628 p 0.8788 r 0.8788 f1 0.8788
position_predict: train acc 0.9628 p 0.9032 r 0.8485 f1 0.8750
step 60: train loss 0.2361 
cause_predict: train acc 0.9541 p 0.9643 r 0.7714 f1 0.8571
position_predict: train acc 0.9541 p 0.8485 r 0.8750 f1 0.8615
step 70: train loss 0.1082 
cause_predict: train acc 0.9721 p 0.9118 r 0.8611 f1 0.8857
position_predict: train acc 0.9791 p 0.9091 r 0.9091 f1 0.9091

epoch 10: test loss 0.6568 cost time: 10.8s

cause_predict: test acc 0.8829 p 0.6007 r 0.5174 f1 0.5559
max_acc 0.8910 max_p 0.6377 max_r 0.5331 max_f1 0.5808

position_predict: test acc 0.9209 p 0.6993 r 0.6725 f1 0.6856
max_acc 0.9294 max_p 0.7398 max_r 0.6934 max_f1 0.7158

Average max cause: max_acc 0.8950 max_p 0.6830 max_r 0.4826 max_f1 0.5656
Average max pos: max_acc 0.9316 max_p 0.7702 max_r 0.6655 max_f1 0.7140

step 10: train loss 0.1886 
cause_predict: train acc 0.9447 p 0.7750 r 0.8611 f1 0.8158
position_predict: train acc 0.9565 p 0.8182 r 0.8438 f1 0.8308
step 20: train loss 0.1030 
cause_predict: train acc 0.9852 p 0.9429 r 0.9429 f1 0.9429
position_predict: train acc 0.9778 p 0.8611 r 0.9688 f1 0.9118
step 30: train loss 0.1304 
cause_predict: train acc 0.9652 p 0.8378 r 0.9394 f1 0.8857
position_predict: train acc 0.9783 p 0.9655 r 0.8750 f1 0.9180
step 40: train loss 0.1564 
cause_predict: train acc 0.9806 p 0.9459 r 0.9459 f1 0.9459
position_predict: train acc 0.9612 p 0.8333 r 0.9375 f1 0.8824
step 50: train loss 0.1981 
cause_predict: train acc 0.9671 p 0.8824 r 0.9091 f1 0.8955
position_predict: train acc 0.9812 p 1.0000 r 0.8788 f1 0.9355
step 60: train loss 0.0756 
cause_predict: train acc 0.9846 p 0.9143 r 0.9412 f1 0.9275
position_predict: train acc 0.9938 p 0.9688 r 0.9688 f1 0.9688
step 70: train loss 0.1363 
cause_predict: train acc 0.9781 p 0.9667 r 0.8286 f1 0.8923
position_predict: train acc 0.9592 p 0.8065 r 0.7812 f1 0.7937

epoch 11: test loss 0.7213 cost time: 10.3s

cause_predict: test acc 0.8758 p 0.5670 r 0.5205 f1 0.5428
max_acc 0.8910 max_p 0.6377 max_r 0.5331 max_f1 0.5808

position_predict: test acc 0.9129 p 0.6494 r 0.6969 f1 0.6723
max_acc 0.9294 max_p 0.7398 max_r 0.6934 max_f1 0.7158

Average max cause: max_acc 0.8950 max_p 0.6830 max_r 0.4826 max_f1 0.5656
Average max pos: max_acc 0.9316 max_p 0.7702 max_r 0.6655 max_f1 0.7140

step 10: train loss 0.1630 
cause_predict: train acc 0.9644 p 0.9091 r 0.8333 f1 0.8696
position_predict: train acc 0.9684 p 0.8750 r 0.8750 f1 0.8750
step 20: train loss 0.1704 
cause_predict: train acc 0.9534 p 0.8462 r 0.8684 f1 0.8571
position_predict: train acc 0.9788 p 0.9091 r 0.9375 f1 0.9231
step 30: train loss 0.0616 
cause_predict: train acc 0.9915 p 0.9714 r 0.9714 f1 0.9714
position_predict: train acc 0.9830 p 0.9394 r 0.9394 f1 0.9394
step 40: train loss 0.1083 
cause_predict: train acc 0.9885 p 0.9706 r 0.9429 f1 0.9565
position_predict: train acc 0.9615 p 0.8485 r 0.8485 f1 0.8485
step 50: train loss 0.1320 
cause_predict: train acc 0.9605 p 0.8824 r 0.8333 f1 0.8571
position_predict: train acc 0.9723 p 0.9032 r 0.8750 f1 0.8889
step 60: train loss 0.1389 
cause_predict: train acc 0.9835 p 0.9459 r 0.9459 f1 0.9459
position_predict: train acc 0.9628 p 0.8529 r 0.8788 f1 0.8657
step 70: train loss 0.2304 
cause_predict: train acc 0.9440 p 0.7750 r 0.8611 f1 0.8158
position_predict: train acc 0.9680 p 0.9000 r 0.8438 f1 0.8710

epoch 12: test loss 0.7154 cost time: 10.6s

cause_predict: test acc 0.8803 p 0.5809 r 0.5552 f1 0.5677
max_acc 0.8910 max_p 0.6377 max_r 0.5331 max_f1 0.5808

position_predict: test acc 0.9196 p 0.7019 r 0.6481 f1 0.6739
max_acc 0.9294 max_p 0.7398 max_r 0.6934 max_f1 0.7158

Average max cause: max_acc 0.8950 max_p 0.6830 max_r 0.4826 max_f1 0.5656
Average max pos: max_acc 0.9316 max_p 0.7702 max_r 0.6655 max_f1 0.7140

step 10: train loss 0.0912 
2024-06-22 19:10:13.967255: W tensorflow/c/c_api.cc:304] Operation '{name:'softmax_b_pos/Adam_1/Assign' id:5023 op device:{requested: '', assigned: ''} def:{{{node softmax_b_pos/Adam_1/Assign}} = Assign[T=DT_FLOAT, _class=["loc:@softmax_b_pos"], _has_manual_control_dependencies=true, use_locking=true, validate_shape=true](softmax_b_pos/Adam_1, softmax_b_pos/Adam_1/Initializer/zeros)}}' was changed by setting attribute after it was run by a session. This mutation will have no effect, and will trigger an error in the future. Either don't modify nodes after running them or create a new session.
cause_predict: train acc 0.9727 p 0.9429 r 0.8684 f1 0.9041
position_predict: train acc 1.0000 p 1.0000 r 1.0000 f1 1.0000
step 20: train loss 0.1378 
cause_predict: train acc 0.9576 p 0.8421 r 0.8889 f1 0.8649
position_predict: train acc 0.9746 p 0.8857 r 0.9394 f1 0.9118
step 30: train loss 0.1546 
cause_predict: train acc 0.9921 p 0.9722 r 0.9722 f1 0.9722
position_predict: train acc 0.9524 p 0.8235 r 0.8235 f1 0.8235
step 40: train loss 0.1895 
cause_predict: train acc 0.9623 p 0.8788 r 0.8056 f1 0.8406
position_predict: train acc 0.9555 p 0.8333 r 0.7576 f1 0.7937
step 50: train loss 0.1555 
cause_predict: train acc 0.9814 p 0.9722 r 0.8974 f1 0.9333
position_predict: train acc 0.9814 p 0.9355 r 0.9062 f1 0.9206
step 60: train loss 0.1287 
cause_predict: train acc 0.9813 p 0.8974 r 0.9722 f1 0.9333
position_predict: train acc 0.9627 p 0.8438 r 0.8438 f1 0.8438
step 70: train loss 0.1882 
cause_predict: train acc 0.9524 p 0.8571 r 0.8571 f1 0.8571
position_predict: train acc 0.9619 p 0.8750 r 0.8750 f1 0.8750

epoch 13: test loss 0.7677 cost time: 10.0s

cause_predict: test acc 0.8798 p 0.5909 r 0.4921 f1 0.5370
max_acc 0.8910 max_p 0.6377 max_r 0.5331 max_f1 0.5808

position_predict: test acc 0.9164 p 0.6761 r 0.6690 f1 0.6725
max_acc 0.9294 max_p 0.7398 max_r 0.6934 max_f1 0.7158

Average max cause: max_acc 0.8950 max_p 0.6830 max_r 0.4826 max_f1 0.5656
Average max pos: max_acc 0.9316 max_p 0.7702 max_r 0.6655 max_f1 0.7140

step 10: train loss 0.0624 
cause_predict: train acc 0.9966 p 1.0000 r 0.9722 f1 0.9859
position_predict: train acc 0.9933 p 1.0000 r 0.9375 f1 0.9677
step 20: train loss 0.1198 
cause_predict: train acc 0.9718 p 0.8974 r 0.9722 f1 0.9333
position_predict: train acc 0.9831 p 0.9394 r 0.9688 f1 0.9538
step 30: train loss 0.1753 
cause_predict: train acc 0.9660 p 0.8947 r 0.8947 f1 0.8947
position_predict: train acc 0.9532 p 0.8387 r 0.8125 f1 0.8254
step 40: train loss 0.1297 
cause_predict: train acc 0.9847 p 0.9706 r 0.9429 f1 0.9565
position_predict: train acc 0.9745 p 0.9091 r 0.9375 f1 0.9231
step 50: train loss 0.1071 
cause_predict: train acc 0.9763 p 0.8919 r 0.9167 f1 0.9041
position_predict: train acc 0.9729 p 0.8750 r 0.8750 f1 0.8750
step 60: train loss 0.1785 
cause_predict: train acc 0.9574 p 0.8919 r 0.8250 f1 0.8571
position_predict: train acc 0.9612 p 0.8485 r 0.8485 f1 0.8485
step 70: train loss 0.1131 
cause_predict: train acc 0.9689 p 0.9167 r 0.9167 f1 0.9167
position_predict: train acc 0.9845 p 0.9677 r 0.9375 f1 0.9524

epoch 14: test loss 0.7569 cost time: 10.3s

cause_predict: test acc 0.8758 p 0.5623 r 0.5552 f1 0.5587
max_acc 0.8910 max_p 0.6377 max_r 0.5331 max_f1 0.5808

position_predict: test acc 0.9173 p 0.6848 r 0.6585 f1 0.6714
max_acc 0.9294 max_p 0.7398 max_r 0.6934 max_f1 0.7158

Average max cause: max_acc 0.8950 max_p 0.6830 max_r 0.4826 max_f1 0.5656
Average max pos: max_acc 0.9316 max_p 0.7702 max_r 0.6655 max_f1 0.7140

write pair_data/Ind_BiLSTM_2/fold_4_test.txt done
write pair_data/Ind_BiLSTM_2/fold_4_train.txt done
Optimization Finished!

############# fold 4 end ###############
############# fold 5 begin ###############
load data_file: data_combine_en/fold_5_train.txt
y_position.shape (2275, 75, 2)
y_cause.shape (2275, 75, 2)
x.shape (2275, 75, 30)
sen_len.shape (2275, 75)
doc_len.shape (2275,)
n_cut 107
load data done!

load data_file: data_combine_en/fold_5_test.txt
y_position.shape (284, 75, 2)
y_cause.shape (284, 75, 2)
x.shape (284, 75, 30)
sen_len.shape (284, 75)
doc_len.shape (284,)
n_cut 22
load data done!

train docs: 2275    test docs: 284
step 10: train loss 0.8283 
cause_predict: train acc 0.8549 p 0.0000 r 0.0000 f1 0.0000
position_predict: train acc 0.8745 p 0.0000 r 0.0000 f1 0.0000
step 20: train loss 0.8066 
cause_predict: train acc 0.8200 p 0.0000 r 0.0000 f1 0.0000
position_predict: train acc 0.8400 p 0.0000 r 0.0000 f1 0.0000
step 30: train loss 0.5907 
cause_predict: train acc 0.8850 p 0.0000 r 0.0000 f1 0.0000
position_predict: train acc 0.8885 p 0.0000 r 0.0000 f1 0.0000
step 40: train loss 0.6844 
cause_predict: train acc 0.8371 p 0.0000 r 0.0000 f1 0.0000
position_predict: train acc 0.9095 p 0.8000 r 0.5000 f1 0.6154
step 50: train loss 0.5270 
cause_predict: train acc 0.8834 p 1.0000 r 0.0294 f1 0.0571
position_predict: train acc 0.9399 p 0.8333 r 0.6061 f1 0.7018
step 60: train loss 0.5447 
cause_predict: train acc 0.8845 p 0.0000 r 0.0000 f1 0.0000
position_predict: train acc 0.8812 p 0.4348 r 0.3030 f1 0.3571
step 70: train loss 0.5903 
cause_predict: train acc 0.8548 p 0.0000 r 0.0000 f1 0.0000
position_predict: train acc 0.9073 p 0.7143 r 0.4688 f1 0.5660

epoch 0: test loss 0.5390 cost time: 10.0s

cause_predict: test acc 0.8610 p 1.0000 r 0.0189 f1 0.0372
max_acc 0.8610 max_p 1.0000 max_r 0.0189 max_f1 0.0372

position_predict: test acc 0.9169 p 0.7730 r 0.4983 f1 0.6059
max_acc 0.9169 max_p 0.7730 max_r 0.4983 max_f1 0.6059

Average max cause: max_acc 0.8610 max_p 1.0000 max_r 0.0189 max_f1 0.0372
Average max pos: max_acc 0.9169 max_p 0.7730 max_r 0.4983 max_f1 0.6059

step 10: train loss 0.5073 
cause_predict: train acc 0.8675 p 1.0000 r 0.0294 f1 0.0571
position_predict: train acc 0.9197 p 0.7500 r 0.5625 f1 0.6429
step 20: train loss 0.5069 
cause_predict: train acc 0.8664 p 1.0000 r 0.1389 f1 0.2439
position_predict: train acc 0.9526 p 0.9259 r 0.7353 f1 0.8197
step 30: train loss 0.5687 
cause_predict: train acc 0.8564 p 0.7333 r 0.3056 f1 0.4314
position_predict: train acc 0.9604 p 0.9000 r 0.8438 f1 0.8710
step 40: train loss 0.5797 
cause_predict: train acc 0.8546 p 0.7500 r 0.2308 f1 0.3529
position_predict: train acc 0.9163 p 0.7241 r 0.6562 f1 0.6885
step 50: train loss 0.4552 
cause_predict: train acc 0.8865 p 0.6667 r 0.3158 f1 0.4286
position_predict: train acc 0.9255 p 0.7000 r 0.6364 f1 0.6667
step 60: train loss 0.5432 
cause_predict: train acc 0.8614 p 0.6087 r 0.4242 f1 0.5000
position_predict: train acc 0.8960 p 0.6774 r 0.6562 f1 0.6667
step 70: train loss 0.5130 
cause_predict: train acc 0.8993 p 0.8571 r 0.3243 f1 0.4706
position_predict: train acc 0.9067 p 0.6538 r 0.5152 f1 0.5763

epoch 1: test loss 0.4962 cost time: 10.2s

cause_predict: test acc 0.8856 p 0.7402 r 0.2965 f1 0.4234
max_acc 0.8856 max_p 0.7402 max_r 0.2965 max_f1 0.4234

position_predict: test acc 0.9182 p 0.6884 r 0.6620 f1 0.6750
max_acc 0.9182 max_p 0.6884 max_r 0.6620 max_f1 0.6750

Average max cause: max_acc 0.8856 max_p 0.7402 max_r 0.2965 max_f1 0.4234
Average max pos: max_acc 0.9182 max_p 0.6884 max_r 0.6620 max_f1 0.6750

step 10: train loss 0.4425 
cause_predict: train acc 0.8750 p 0.6000 r 0.3429 f1 0.4364
position_predict: train acc 0.9315 p 0.7273 r 0.7500 f1 0.7385
step 20: train loss 0.3939 
cause_predict: train acc 0.9138 p 0.7895 r 0.4167 f1 0.5455
position_predict: train acc 0.9310 p 0.6667 r 0.7500 f1 0.7059
step 30: train loss 0.4297 
cause_predict: train acc 0.8824 p 0.7692 r 0.2857 f1 0.4167
position_predict: train acc 0.9286 p 0.7419 r 0.7188 f1 0.7302
step 40: train loss 0.4572 
cause_predict: train acc 0.8784 p 0.6818 r 0.3846 f1 0.4918
position_predict: train acc 0.9255 p 0.7600 r 0.5938 f1 0.6667
step 50: train loss 0.4953 
cause_predict: train acc 0.8865 p 0.6667 r 0.3750 f1 0.4800
position_predict: train acc 0.8996 p 0.7143 r 0.4688 f1 0.5660
step 60: train loss 0.4225 
cause_predict: train acc 0.8872 p 0.7778 r 0.3500 f1 0.4828
position_predict: train acc 0.9436 p 0.7429 r 0.8125 f1 0.7761
step 70: train loss 0.4677 
cause_predict: train acc 0.8755 p 0.5625 r 0.2647 f1 0.3600
position_predict: train acc 0.9105 p 0.7083 r 0.5152 f1 0.5965

epoch 2: test loss 0.4753 cost time: 10.4s

cause_predict: test acc 0.8945 p 0.6901 r 0.4637 f1 0.5547
max_acc 0.8945 max_p 0.6901 max_r 0.4637 max_f1 0.5547

position_predict: test acc 0.9214 p 0.6989 r 0.6794 f1 0.6890
max_acc 0.9214 max_p 0.6989 max_r 0.6794 max_f1 0.6890

Average max cause: max_acc 0.8945 max_p 0.6901 max_r 0.4637 max_f1 0.5547
Average max pos: max_acc 0.9214 max_p 0.6989 max_r 0.6794 max_f1 0.6890

step 10: train loss 0.4054 
cause_predict: train acc 0.8876 p 0.6000 r 0.3529 f1 0.4444
position_predict: train acc 0.9363 p 0.7667 r 0.6970 f1 0.7302
step 20: train loss 0.4389 
cause_predict: train acc 0.8776 p 0.6522 r 0.4167 f1 0.5085
position_predict: train acc 0.9451 p 0.8065 r 0.7812 f1 0.7937
step 30: train loss 0.5303 
cause_predict: train acc 0.8744 p 0.6129 r 0.5588 f1 0.5846
position_predict: train acc 0.9116 p 0.7097 r 0.6875 f1 0.6984
step 40: train loss 0.4188 
cause_predict: train acc 0.8996 p 0.7273 r 0.4571 f1 0.5614
position_predict: train acc 0.9518 p 0.7941 r 0.8438 f1 0.8182
step 50: train loss 0.4302 
cause_predict: train acc 0.8975 p 0.7143 r 0.4412 f1 0.5455
position_predict: train acc 0.9344 p 0.7576 r 0.7576 f1 0.7576
step 60: train loss 0.4557 
cause_predict: train acc 0.8845 p 0.5714 r 0.2353 f1 0.3333
position_predict: train acc 0.9386 p 0.7500 r 0.7273 f1 0.7385
step 70: train loss 0.3997 
cause_predict: train acc 0.9016 p 0.6786 r 0.5588 f1 0.6129
position_predict: train acc 0.9262 p 0.7419 r 0.6970 f1 0.7188

epoch 3: test loss 0.4783 cost time: 10.1s

cause_predict: test acc 0.8950 p 0.6990 r 0.4543 f1 0.5507
max_acc 0.8945 max_p 0.6901 max_r 0.4637 max_f1 0.5547

position_predict: test acc 0.9214 p 0.7018 r 0.6725 f1 0.6868
max_acc 0.9214 max_p 0.6989 max_r 0.6794 max_f1 0.6890

Average max cause: max_acc 0.8945 max_p 0.6901 max_r 0.4637 max_f1 0.5547
Average max pos: max_acc 0.9214 max_p 0.6989 max_r 0.6794 max_f1 0.6890

step 10: train loss 0.3314 
cause_predict: train acc 0.9272 p 0.7692 r 0.6061 f1 0.6780
position_predict: train acc 0.9579 p 0.8182 r 0.8438 f1 0.8308
step 20: train loss 0.3887 
cause_predict: train acc 0.9033 p 0.7333 r 0.5500 f1 0.6286
position_predict: train acc 0.9257 p 0.7241 r 0.6364 f1 0.6774
step 30: train loss 0.3911 
cause_predict: train acc 0.8924 p 0.6757 r 0.6757 f1 0.6757
position_predict: train acc 0.9462 p 0.8333 r 0.7812 f1 0.8065
step 40: train loss 0.4652 
cause_predict: train acc 0.8969 p 0.8261 r 0.5000 f1 0.6230
position_predict: train acc 0.9193 p 0.7059 r 0.7500 f1 0.7273
step 50: train loss 0.3664 
cause_predict: train acc 0.9052 p 0.6750 r 0.7941 f1 0.7297
position_predict: train acc 0.9526 p 0.8667 r 0.8125 f1 0.8387
step 60: train loss 0.3594 
cause_predict: train acc 0.9142 p 0.7619 r 0.4324 f1 0.5517
position_predict: train acc 0.9637 p 0.8621 r 0.7812 f1 0.8197
step 70: train loss 0.3715 
cause_predict: train acc 0.9101 p 0.8500 r 0.4474 f1 0.5862
position_predict: train acc 0.9401 p 0.7667 r 0.7188 f1 0.7419

epoch 4: test loss 0.4799 cost time: 10.3s

cause_predict: test acc 0.8905 p 0.6856 r 0.4196 f1 0.5205
max_acc 0.8945 max_p 0.6901 max_r 0.4637 max_f1 0.5547

position_predict: test acc 0.9196 p 0.7202 r 0.6098 f1 0.6604
max_acc 0.9214 max_p 0.6989 max_r 0.6794 max_f1 0.6890

Average max cause: max_acc 0.8945 max_p 0.6901 max_r 0.4637 max_f1 0.5547
Average max pos: max_acc 0.9214 max_p 0.6989 max_r 0.6794 max_f1 0.6890

step 10: train loss 0.3371 
cause_predict: train acc 0.9167 p 0.7097 r 0.6111 f1 0.6567
position_predict: train acc 0.9529 p 0.8276 r 0.7500 f1 0.7869
step 20: train loss 0.3020 
cause_predict: train acc 0.9427 p 0.7879 r 0.8125 f1 0.8000
position_predict: train acc 0.9251 p 0.7778 r 0.6562 f1 0.7119
step 30: train loss 0.3464 
cause_predict: train acc 0.8996 p 0.6944 r 0.6250 f1 0.6579
position_predict: train acc 0.9653 p 0.8529 r 0.8788 f1 0.8657
step 40: train loss 0.3507 
cause_predict: train acc 0.9124 p 0.8000 r 0.5405 f1 0.6452
position_predict: train acc 0.9442 p 0.7647 r 0.8125 f1 0.7879
step 50: train loss 0.3701 
cause_predict: train acc 0.9231 p 0.7812 r 0.6944 f1 0.7353
position_predict: train acc 0.9359 p 0.7576 r 0.7812 f1 0.7692
step 60: train loss 0.4610 
cause_predict: train acc 0.8978 p 0.7200 r 0.5294 f1 0.6102
position_predict: train acc 0.9200 p 0.7586 r 0.6667 f1 0.7097
step 70: train loss 0.3347 
cause_predict: train acc 0.8996 p 0.6452 r 0.5882 f1 0.6154
position_predict: train acc 0.9478 p 0.8621 r 0.7353 f1 0.7937

epoch 5: test loss 0.5141 cost time: 10.4s

cause_predict: test acc 0.8905 p 0.6513 r 0.4890 f1 0.5586
max_acc 0.8905 max_p 0.6513 max_r 0.4890 max_f1 0.5586

position_predict: test acc 0.9258 p 0.7168 r 0.6969 f1 0.7067
max_acc 0.9258 max_p 0.7168 max_r 0.6969 max_f1 0.7067

Average max cause: max_acc 0.8905 max_p 0.6513 max_r 0.4890 max_f1 0.5586
Average max pos: max_acc 0.9258 max_p 0.7168 max_r 0.6969 max_f1 0.7067

step 10: train loss 0.2465 
cause_predict: train acc 0.9484 p 0.9333 r 0.7568 f1 0.8358
position_predict: train acc 0.9671 p 0.9062 r 0.8788 f1 0.8923
step 20: train loss 0.2685 
cause_predict: train acc 0.9308 p 0.9259 r 0.6098 f1 0.7353
position_predict: train acc 0.9885 p 0.9394 r 0.9688 f1 0.9538
step 30: train loss 0.3479 
cause_predict: train acc 0.8768 p 0.6667 r 0.5946 f1 0.6286
position_predict: train acc 0.9336 p 0.8519 r 0.6970 f1 0.7667
step 40: train loss 0.3200 
cause_predict: train acc 0.9216 p 0.8333 r 0.4878 f1 0.6154
position_predict: train acc 0.9561 p 0.8214 r 0.7188 f1 0.7667
step 50: train loss 0.2103 
cause_predict: train acc 0.9689 p 0.9412 r 0.8649 f1 0.9014
position_predict: train acc 0.9689 p 0.9062 r 0.8788 f1 0.8923
step 60: train loss 0.2980 
cause_predict: train acc 0.9240 p 0.7568 r 0.7368 f1 0.7467
position_predict: train acc 0.9560 p 0.8667 r 0.7879 f1 0.8254
step 70: train loss 0.3366 
cause_predict: train acc 0.9103 p 0.8261 r 0.5278 f1 0.6441
position_predict: train acc 0.9658 p 0.8750 r 0.8750 f1 0.8750

epoch 6: test loss 0.5271 cost time: 10.4s

cause_predict: test acc 0.8892 p 0.6245 r 0.5457 f1 0.5825
max_acc 0.8892 max_p 0.6245 max_r 0.5457 max_f1 0.5825

position_predict: test acc 0.9133 p 0.6576 r 0.6760 f1 0.6667
max_acc 0.9258 max_p 0.7168 max_r 0.6969 max_f1 0.7067

Average max cause: max_acc 0.8905 max_p 0.6513 max_r 0.4890 max_f1 0.5586
Average max pos: max_acc 0.9258 max_p 0.7168 max_r 0.6969 max_f1 0.7067

step 10: train loss 0.2551 
cause_predict: train acc 0.9196 p 0.8800 r 0.5946 f1 0.7097
position_predict: train acc 0.9643 p 0.9286 r 0.8125 f1 0.8667
step 20: train loss 0.3460 
cause_predict: train acc 0.9200 p 0.8000 r 0.6667 f1 0.7273
position_predict: train acc 0.9289 p 0.7742 r 0.7273 f1 0.7500
step 30: train loss 0.3207 
cause_predict: train acc 0.9304 p 0.7419 r 0.6765 f1 0.7077
position_predict: train acc 0.9377 p 0.7273 r 0.7500 f1 0.7385
step 40: train loss 0.2815 
cause_predict: train acc 0.9485 p 0.8710 r 0.7714 f1 0.8182
position_predict: train acc 0.9571 p 0.8710 r 0.8182 f1 0.8438
step 50: train loss 0.2966 
cause_predict: train acc 0.9251 p 0.7576 r 0.7353 f1 0.7463
position_predict: train acc 0.9515 p 0.8621 r 0.7812 f1 0.8197
step 60: train loss 0.2540 
cause_predict: train acc 0.9395 p 0.8438 r 0.7714 f1 0.8060
position_predict: train acc 0.9535 p 0.8710 r 0.8182 f1 0.8438
step 70: train loss 0.2453 
cause_predict: train acc 0.9367 p 0.8276 r 0.6316 f1 0.7164
position_predict: train acc 0.9667 p 0.8235 r 0.8750 f1 0.8485

epoch 7: test loss 0.5842 cost time: 10.6s

cause_predict: test acc 0.8861 p 0.6157 r 0.5205 f1 0.5641
max_acc 0.8892 max_p 0.6245 max_r 0.5457 max_f1 0.5825

position_predict: test acc 0.9133 p 0.6643 r 0.6551 f1 0.6596
max_acc 0.9258 max_p 0.7168 max_r 0.6969 max_f1 0.7067

Average max cause: max_acc 0.8905 max_p 0.6513 max_r 0.4890 max_f1 0.5586
Average max pos: max_acc 0.9258 max_p 0.7168 max_r 0.6969 max_f1 0.7067

step 10: train loss 0.2618 
cause_predict: train acc 0.9504 p 0.8387 r 0.7647 f1 0.8000
position_predict: train acc 0.9427 p 0.7812 r 0.7576 f1 0.7692
step 20: train loss 0.1660 
cause_predict: train acc 0.9697 p 0.8810 r 0.9250 f1 0.9024
position_predict: train acc 0.9735 p 0.8824 r 0.9091 f1 0.8955
step 30: train loss 0.3323 
cause_predict: train acc 0.9021 p 0.7353 r 0.7143 f1 0.7246
position_predict: train acc 0.9588 p 0.8571 r 0.9091 f1 0.8824
step 40: train loss 0.2512 
cause_predict: train acc 0.9489 p 0.8611 r 0.8158 f1 0.8378
position_predict: train acc 0.9660 p 0.8788 r 0.8788 f1 0.8788
step 50: train loss 0.2573 
cause_predict: train acc 0.9432 p 0.7632 r 0.8788 f1 0.8169
position_predict: train acc 0.9563 p 0.8667 r 0.8125 f1 0.8387
step 60: train loss 0.2228 
cause_predict: train acc 0.9543 p 0.8485 r 0.8485 f1 0.8485
position_predict: train acc 0.9452 p 0.8387 r 0.7879 f1 0.8125
step 70: train loss 0.1503 
cause_predict: train acc 0.9766 p 0.9655 r 0.8485 f1 0.9032
position_predict: train acc 0.9688 p 0.8788 r 0.8788 f1 0.8788

epoch 8: test loss 0.5777 cost time: 10.2s

cause_predict: test acc 0.8856 p 0.6117 r 0.5268 f1 0.5661
max_acc 0.8892 max_p 0.6245 max_r 0.5457 max_f1 0.5825

position_predict: test acc 0.9249 p 0.7102 r 0.7003 f1 0.7053
max_acc 0.9258 max_p 0.7168 max_r 0.6969 max_f1 0.7067

Average max cause: max_acc 0.8856 max_p 0.6117 max_r 0.5268 max_f1 0.5661
Average max pos: max_acc 0.9249 max_p 0.7102 max_r 0.7003 max_f1 0.7053

step 10: train loss 0.1804 
cause_predict: train acc 0.9677 p 0.8611 r 0.9394 f1 0.8986
position_predict: train acc 0.9585 p 0.8966 r 0.8125 f1 0.8525
step 20: train loss 0.1497 
cause_predict: train acc 0.9848 p 0.9412 r 0.9697 f1 0.9552
position_predict: train acc 0.9797 p 0.9667 r 0.9062 f1 0.9355
step 30: train loss 0.2671 
cause_predict: train acc 0.9426 p 0.7714 r 0.8182 f1 0.7941
position_predict: train acc 0.9713 p 0.9062 r 0.8788 f1 0.8923
step 40: train loss 0.3058 
cause_predict: train acc 0.9289 p 0.7838 r 0.7838 f1 0.7838
position_predict: train acc 0.9556 p 0.8438 r 0.8438 f1 0.8438
step 50: train loss 0.2693 
cause_predict: train acc 0.9505 p 0.9000 r 0.7941 f1 0.8438
position_predict: train acc 0.9653 p 0.9062 r 0.8788 f1 0.8923
step 60: train loss 0.2714 
cause_predict: train acc 0.9628 p 0.9032 r 0.8235 f1 0.8615
position_predict: train acc 0.9628 p 0.8710 r 0.8438 f1 0.8571
step 70: train loss 0.1407 
cause_predict: train acc 0.9608 p 0.9250 r 0.8810 f1 0.9024
position_predict: train acc 0.9902 p 1.0000 r 0.9394 f1 0.9688

epoch 9: test loss 0.6154 cost time: 10.3s

cause_predict: test acc 0.8838 p 0.5973 r 0.5521 f1 0.5738
max_acc 0.8892 max_p 0.6245 max_r 0.5457 max_f1 0.5825

position_predict: test acc 0.9200 p 0.6971 r 0.6655 f1 0.6809
max_acc 0.9258 max_p 0.7168 max_r 0.6969 max_f1 0.7067

Average max cause: max_acc 0.8856 max_p 0.6117 max_r 0.5268 max_f1 0.5661
Average max pos: max_acc 0.9249 max_p 0.7102 max_r 0.7003 max_f1 0.7053

step 10: train loss 0.1161 
cause_predict: train acc 0.9825 p 0.9355 r 0.8788 f1 0.9062
position_predict: train acc 0.9737 p 0.8529 r 0.8788 f1 0.8657
step 20: train loss 0.0890 
cause_predict: train acc 0.9865 p 0.9697 r 0.9412 f1 0.9552
position_predict: train acc 0.9865 p 0.9394 r 0.9688 f1 0.9538
step 30: train loss 0.1933 
cause_predict: train acc 0.9717 p 0.9062 r 0.8788 f1 0.8923
position_predict: train acc 0.9352 p 0.7353 r 0.7812 f1 0.7576
step 40: train loss 0.1683 
cause_predict: train acc 0.9498 p 0.8667 r 0.7647 f1 0.8125
position_predict: train acc 0.9833 p 0.9375 r 0.9375 f1 0.9375
step 50: train loss 0.2821 
cause_predict: train acc 0.9353 p 0.7778 r 0.8000 f1 0.7887
position_predict: train acc 0.9526 p 0.8286 r 0.8529 f1 0.8406
step 60: train loss 0.1224 
cause_predict: train acc 0.9733 p 0.9000 r 0.9231 f1 0.9114
position_predict: train acc 0.9885 p 0.9394 r 0.9688 f1 0.9538
step 70: train loss 0.2222 
cause_predict: train acc 0.9559 p 0.8966 r 0.8125 f1 0.8525
position_predict: train acc 0.9412 p 0.7941 r 0.8438 f1 0.8182

epoch 10: test loss 0.6275 cost time: 10.4s

cause_predict: test acc 0.8798 p 0.5851 r 0.5205 f1 0.5509
max_acc 0.8892 max_p 0.6245 max_r 0.5457 max_f1 0.5825

position_predict: test acc 0.9218 p 0.7105 r 0.6585 f1 0.6835
max_acc 0.9258 max_p 0.7168 max_r 0.6969 max_f1 0.7067

Average max cause: max_acc 0.8856 max_p 0.6117 max_r 0.5268 max_f1 0.5661
Average max pos: max_acc 0.9249 max_p 0.7102 max_r 0.7003 max_f1 0.7053

step 10: train loss 0.1101 
cause_predict: train acc 0.9746 p 0.9032 r 0.8485 f1 0.8750
position_predict: train acc 0.9714 p 0.8710 r 0.8438 f1 0.8571
step 20: train loss 0.1581 
cause_predict: train acc 0.9500 p 0.9024 r 0.8409 f1 0.8706
position_predict: train acc 0.9727 p 0.9062 r 0.9062 f1 0.9062
step 30: train loss 0.1149 
cause_predict: train acc 0.9785 p 0.9444 r 0.9189 f1 0.9315
position_predict: train acc 0.9614 p 0.8286 r 0.9062 f1 0.8657
step 40: train loss 0.1794 
cause_predict: train acc 0.9594 p 0.9412 r 0.8421 f1 0.8889
position_predict: train acc 0.9645 p 0.9032 r 0.8750 f1 0.8889
step 50: train loss 0.1441 
cause_predict: train acc 0.9740 p 0.8250 r 0.9429 f1 0.8800
position_predict: train acc 0.9682 p 0.8000 r 0.8750 f1 0.8358
step 60: train loss 0.0898 
cause_predict: train acc 0.9885 p 1.0000 r 0.9118 f1 0.9538
position_predict: train acc 0.9885 p 0.9394 r 0.9688 f1 0.9538
step 70: train loss 0.1982 
cause_predict: train acc 0.9510 p 0.8095 r 0.8947 f1 0.8500
position_predict: train acc 0.9633 p 0.8485 r 0.8750 f1 0.8615

epoch 11: test loss 0.6383 cost time: 10.0s

cause_predict: test acc 0.8820 p 0.5964 r 0.5174 f1 0.5541
max_acc 0.8892 max_p 0.6245 max_r 0.5457 max_f1 0.5825

position_predict: test acc 0.9169 p 0.6823 r 0.6585 f1 0.6702
max_acc 0.9258 max_p 0.7168 max_r 0.6969 max_f1 0.7067

Average max cause: max_acc 0.8856 max_p 0.6117 max_r 0.5268 max_f1 0.5661
Average max pos: max_acc 0.9249 max_p 0.7102 max_r 0.7003 max_f1 0.7053

step 10: train loss 0.1659 
cause_predict: train acc 0.9609 p 0.8824 r 0.7895 f1 0.8333
position_predict: train acc 0.9674 p 0.8056 r 0.9062 f1 0.8529
step 20: train loss 0.1437 
cause_predict: train acc 0.9686 p 0.9355 r 0.8529 f1 0.8923
position_predict: train acc 0.9686 p 0.8788 r 0.9062 f1 0.8923
step 30: train loss 0.1259 
cause_predict: train acc 0.9676 p 0.8919 r 0.9429 f1 0.9167
position_predict: train acc 0.9838 p 0.9677 r 0.9375 f1 0.9524
step 40: train loss 0.1458 
cause_predict: train acc 0.9801 p 0.9024 r 0.9737 f1 0.9367
position_predict: train acc 0.9602 p 0.8235 r 0.8750 f1 0.8485
step 50: train loss 0.0876 
cause_predict: train acc 0.9830 p 0.9412 r 0.9412 f1 0.9412
position_predict: train acc 0.9830 p 0.9375 r 0.9375 f1 0.9375
step 60: train loss 0.1672 
cause_predict: train acc 0.9714 p 0.9143 r 0.9143 f1 0.9143
position_predict: train acc 0.9619 p 0.9062 r 0.8529 f1 0.8788
step 70: train loss 0.2298 
cause_predict: train acc 0.9609 p 0.8333 r 0.8571 f1 0.8451
position_predict: train acc 0.9609 p 0.9200 r 0.7188 f1 0.8070

epoch 12: test loss 0.7133 cost time: 10.0s

cause_predict: test acc 0.8878 p 0.6222 r 0.5300 f1 0.5724
max_acc 0.8892 max_p 0.6245 max_r 0.5457 max_f1 0.5825

position_predict: test acc 0.9142 p 0.6792 r 0.6272 f1 0.6522
max_acc 0.9258 max_p 0.7168 max_r 0.6969 max_f1 0.7067

Average max cause: max_acc 0.8856 max_p 0.6117 max_r 0.5268 max_f1 0.5661
Average max pos: max_acc 0.9249 max_p 0.7102 max_r 0.7003 max_f1 0.7053

step 10: train loss 0.0955 
cause_predict: train acc 0.9774 p 0.9143 r 0.9412 f1 0.9275
position_predict: train acc 0.9864 p 0.9412 r 0.9697 f1 0.9552
step 20: train loss 0.0839 
cause_predict: train acc 0.9740 p 0.9714 r 0.8947 f1 0.9315
position_predict: train acc 0.9896 p 1.0000 r 0.9375 f1 0.9677
step 30: train loss 0.0658 
cause_predict: train acc 0.9731 p 0.9394 r 0.8857 f1 0.9118
position_predict: train acc 1.0000 p 1.0000 r 1.0000 f1 1.0000
step 40: train loss 0.1512 
cause_predict: train acc 0.9802 p 0.9474 r 0.9231 f1 0.9351
position_predict: train acc 0.9722 p 0.9062 r 0.8788 f1 0.8923
step 50: train loss 0.1895 
cause_predict: train acc 0.9794 p 0.9412 r 0.9412 f1 0.9412
position_predict: train acc 0.9588 p 0.8529 r 0.9062 f1 0.8788
step 60: train loss 0.1581 
cause_predict: train acc 0.9700 p 0.8611 r 0.8857 f1 0.8732
position_predict: train acc 0.9633 p 0.8387 r 0.8125 f1 0.8254
step 70: train loss 0.1627 
cause_predict: train acc 0.9638 p 0.8824 r 0.8333 f1 0.8571
position_predict: train acc 0.9638 p 0.8235 r 0.8750 f1 0.8485

epoch 13: test loss 0.6676 cost time: 10.1s

cause_predict: test acc 0.8874 p 0.6066 r 0.5836 f1 0.5949
max_acc 0.8874 max_p 0.6066 max_r 0.5836 max_f1 0.5949

position_predict: test acc 0.9196 p 0.7019 r 0.6481 f1 0.6739
max_acc 0.9258 max_p 0.7168 max_r 0.6969 max_f1 0.7067

Average max cause: max_acc 0.8856 max_p 0.6117 max_r 0.5268 max_f1 0.5661
Average max pos: max_acc 0.9249 max_p 0.7102 max_r 0.7003 max_f1 0.7053

step 10: train loss 0.0501 
cause_predict: train acc 1.0000 p 1.0000 r 1.0000 f1 1.0000
position_predict: train acc 0.9844 p 0.9412 r 0.9697 f1 0.9552
step 20: train loss 0.0936 
2024-06-22 19:12:56.250480: W tensorflow/c/c_api.cc:304] Operation '{name:'softmax_b_pos/Adam_1/Assign' id:5023 op device:{requested: '', assigned: ''} def:{{{node softmax_b_pos/Adam_1/Assign}} = Assign[T=DT_FLOAT, _class=["loc:@softmax_b_pos"], _has_manual_control_dependencies=true, use_locking=true, validate_shape=true](softmax_b_pos/Adam_1, softmax_b_pos/Adam_1/Initializer/zeros)}}' was changed by setting attribute after it was run by a session. This mutation will have no effect, and will trigger an error in the future. Either don't modify nodes after running them or create a new session.
cause_predict: train acc 0.9858 p 0.9714 r 0.9444 f1 0.9577
position_predict: train acc 0.9906 p 0.9688 r 0.9688 f1 0.9688
step 30: train loss 0.0813 
cause_predict: train acc 0.9924 p 0.9744 r 0.9744 f1 0.9744
position_predict: train acc 0.9773 p 0.8611 r 0.9688 f1 0.9118
step 40: train loss 0.1276 
cause_predict: train acc 0.9775 p 0.9444 r 0.9444 f1 0.9444
position_predict: train acc 0.9719 p 0.9375 r 0.9091 f1 0.9231
step 50: train loss 0.0817 
cause_predict: train acc 0.9834 p 0.9677 r 0.8824 f1 0.9231
position_predict: train acc 0.9934 p 0.9688 r 0.9688 f1 0.9688
step 60: train loss 0.1859 
cause_predict: train acc 0.9587 p 0.8684 r 0.8684 f1 0.8684
position_predict: train acc 0.9628 p 0.8750 r 0.8485 f1 0.8615
step 70: train loss 0.1232 
cause_predict: train acc 0.9739 p 0.9697 r 0.8421 f1 0.9014
position_predict: train acc 0.9776 p 0.8857 r 0.9394 f1 0.9118

epoch 14: test loss 0.7237 cost time: 10.0s

cause_predict: test acc 0.8914 p 0.6457 r 0.5174 f1 0.5744
max_acc 0.8874 max_p 0.6066 max_r 0.5836 max_f1 0.5949

position_predict: test acc 0.9200 p 0.6862 r 0.6934 f1 0.6898
max_acc 0.9258 max_p 0.7168 max_r 0.6969 max_f1 0.7067

Average max cause: max_acc 0.8856 max_p 0.6117 max_r 0.5268 max_f1 0.5661
Average max pos: max_acc 0.9249 max_p 0.7102 max_r 0.7003 max_f1 0.7053

write pair_data/Ind_BiLSTM_2/fold_5_test.txt done
write pair_data/Ind_BiLSTM_2/fold_5_train.txt done
Optimization Finished!

############# fold 5 end ###############
############# fold 6 begin ###############
load data_file: data_combine_en/fold_6_train.txt
y_position.shape (2275, 75, 2)
y_cause.shape (2275, 75, 2)
x.shape (2275, 75, 30)
sen_len.shape (2275, 75)
doc_len.shape (2275,)
n_cut 107
load data done!

load data_file: data_combine_en/fold_6_test.txt
y_position.shape (284, 75, 2)
y_cause.shape (284, 75, 2)
x.shape (284, 75, 30)
sen_len.shape (284, 75)
doc_len.shape (284,)
n_cut 22
load data done!

train docs: 2275    test docs: 284
step 10: train loss 0.8074 
cause_predict: train acc 0.8480 p 0.0000 r 0.0000 f1 0.0000
position_predict: train acc 0.8720 p 0.0000 r 0.0000 f1 0.0000
step 20: train loss 0.7270 
cause_predict: train acc 0.8406 p 0.0000 r 0.0000 f1 0.0000
position_predict: train acc 0.8725 p 0.0000 r 0.0000 f1 0.0000
step 30: train loss 0.6144 
cause_predict: train acc 0.8707 p 0.0000 r 0.0000 f1 0.0000
position_predict: train acc 0.8745 p 0.0000 r 0.0000 f1 0.0000
step 40: train loss 0.7085 
cause_predict: train acc 0.8109 p 0.0000 r 0.0000 f1 0.0000
position_predict: train acc 0.8756 p 0.7000 r 0.4242 f1 0.5283
step 50: train loss 0.5780 
cause_predict: train acc 0.8669 p 1.0000 r 0.0541 f1 0.1026
position_predict: train acc 0.9049 p 0.6842 r 0.4062 f1 0.5098
step 60: train loss 0.5785 
cause_predict: train acc 0.8708 p 0.7500 r 0.0811 f1 0.1463
position_predict: train acc 0.9225 p 0.7391 r 0.5312 f1 0.6182
step 70: train loss 0.7187 
cause_predict: train acc 0.8129 p 0.6667 r 0.2222 f1 0.3333
position_predict: train acc 0.8655 p 0.6800 r 0.5312 f1 0.5965

epoch 0: test loss 0.5196 cost time: 10.3s

cause_predict: test acc 0.8878 p 0.6634 r 0.4227 f1 0.5164
max_acc 0.8878 max_p 0.6634 max_r 0.4227 max_f1 0.5164

position_predict: test acc 0.9173 p 0.7602 r 0.5192 f1 0.6170
max_acc 0.9173 max_p 0.7602 max_r 0.5192 max_f1 0.6170

Average max cause: max_acc 0.8878 max_p 0.6634 max_r 0.4227 max_f1 0.5164
Average max pos: max_acc 0.9173 max_p 0.7602 max_r 0.5192 max_f1 0.6170

step 10: train loss 0.5780 
cause_predict: train acc 0.8874 p 0.9091 r 0.2857 f1 0.4348
position_predict: train acc 0.8788 p 0.5833 r 0.4375 f1 0.5000
step 20: train loss 0.4619 
cause_predict: train acc 0.8971 p 0.6429 r 0.2500 f1 0.3600
position_predict: train acc 0.9293 p 0.6786 r 0.5938 f1 0.6333
step 30: train loss 0.5228 
cause_predict: train acc 0.8851 p 0.7692 r 0.2703 f1 0.4000
position_predict: train acc 0.9425 p 0.7742 r 0.7500 f1 0.7619
step 40: train loss 0.5448 
cause_predict: train acc 0.8486 p 0.5556 r 0.1282 f1 0.2083
position_predict: train acc 0.9124 p 0.6923 r 0.5625 f1 0.6207
step 50: train loss 0.4607 
cause_predict: train acc 0.9094 p 0.7273 r 0.2424 f1 0.3636
position_predict: train acc 0.9191 p 0.6667 r 0.5294 f1 0.5902
step 60: train loss 0.4899 
cause_predict: train acc 0.8800 p 1.0000 r 0.1538 f1 0.2667
position_predict: train acc 0.9200 p 0.7273 r 0.5000 f1 0.5926
step 70: train loss 0.3816 
cause_predict: train acc 0.9137 p 0.7778 r 0.4118 f1 0.5385
position_predict: train acc 0.9353 p 0.8261 r 0.5758 f1 0.6786

epoch 1: test loss 0.4904 cost time: 10.5s

cause_predict: test acc 0.8820 p 0.6305 r 0.4038 f1 0.4923
max_acc 0.8878 max_p 0.6634 max_r 0.4227 max_f1 0.5164

position_predict: test acc 0.9182 p 0.7016 r 0.6307 f1 0.6642
max_acc 0.9182 max_p 0.7016 max_r 0.6307 max_f1 0.6642

Average max cause: max_acc 0.8820 max_p 0.6305 max_r 0.4038 max_f1 0.4923
Average max pos: max_acc 0.9182 max_p 0.7016 max_r 0.6307 max_f1 0.6642

step 10: train loss 0.3736 
cause_predict: train acc 0.9035 p 0.7200 r 0.5000 f1 0.5902
position_predict: train acc 0.9344 p 0.7586 r 0.6875 f1 0.7213
step 20: train loss 0.4966 
cause_predict: train acc 0.9022 p 0.7368 r 0.3889 f1 0.5091
position_predict: train acc 0.9130 p 0.6452 r 0.6061 f1 0.6250
step 30: train loss 0.5023 
cause_predict: train acc 0.8349 p 0.5172 r 0.4054 f1 0.4545
position_predict: train acc 0.9450 p 0.8125 r 0.8125 f1 0.8125
step 40: train loss 0.4459 
cause_predict: train acc 0.8802 p 0.7273 r 0.2353 f1 0.3556
position_predict: train acc 0.9380 p 0.7931 r 0.7188 f1 0.7541
step 50: train loss 0.4990 
cause_predict: train acc 0.8631 p 0.6429 r 0.2432 f1 0.3529
position_predict: train acc 0.9419 p 0.8800 r 0.6667 f1 0.7586
step 60: train loss 0.4121 
cause_predict: train acc 0.9097 p 0.7368 r 0.4000 f1 0.5185
position_predict: train acc 0.9306 p 0.7143 r 0.6250 f1 0.6667
step 70: train loss 0.5571 
cause_predict: train acc 0.8623 p 0.6875 r 0.2750 f1 0.3929
position_predict: train acc 0.9069 p 0.7000 r 0.6000 f1 0.6462

epoch 2: test loss 0.4731 cost time: 10.5s

cause_predict: test acc 0.8874 p 0.6757 r 0.3943 f1 0.4980
max_acc 0.8878 max_p 0.6634 max_r 0.4227 max_f1 0.5164

position_predict: test acc 0.9223 p 0.6996 r 0.6899 f1 0.6947
max_acc 0.9223 max_p 0.6996 max_r 0.6899 max_f1 0.6947

Average max cause: max_acc 0.8874 max_p 0.6757 max_r 0.3943 max_f1 0.4980
Average max pos: max_acc 0.9223 max_p 0.6996 max_r 0.6899 max_f1 0.6947

step 10: train loss 0.4948 
cause_predict: train acc 0.8449 p 0.5500 r 0.2750 f1 0.3667
position_predict: train acc 0.9429 p 0.8462 r 0.6875 f1 0.7586
step 20: train loss 0.4180 
cause_predict: train acc 0.8689 p 0.5200 r 0.3611 f1 0.4262
position_predict: train acc 0.9213 p 0.7000 r 0.6364 f1 0.6667
step 30: train loss 0.6143 
cause_predict: train acc 0.8233 p 0.5333 r 0.4000 f1 0.4571
position_predict: train acc 0.9070 p 0.6970 r 0.6970 f1 0.6970
step 40: train loss 0.4440 
cause_predict: train acc 0.8690 p 0.5789 r 0.3333 f1 0.4231
position_predict: train acc 0.9563 p 0.8438 r 0.8438 f1 0.8438
step 50: train loss 0.4611 
cause_predict: train acc 0.8971 p 0.7500 r 0.3947 f1 0.5172
position_predict: train acc 0.9265 p 0.7143 r 0.6250 f1 0.6667
step 60: train loss 0.5748 
cause_predict: train acc 0.8542 p 0.7368 r 0.3182 f1 0.4444
position_predict: train acc 0.9292 p 0.8261 r 0.5938 f1 0.6909
step 70: train loss 0.4498 
cause_predict: train acc 0.8943 p 0.6429 r 0.5294 f1 0.5806
position_predict: train acc 0.9309 p 0.7778 r 0.6562 f1 0.7119

epoch 3: test loss 0.4644 cost time: 10.4s

cause_predict: test acc 0.8963 p 0.6592 r 0.5552 f1 0.6027
max_acc 0.8963 max_p 0.6592 max_r 0.5552 max_f1 0.6027

position_predict: test acc 0.9236 p 0.7358 r 0.6307 f1 0.6792
max_acc 0.9223 max_p 0.6996 max_r 0.6899 max_f1 0.6947

Average max cause: max_acc 0.8963 max_p 0.6592 max_r 0.5552 max_f1 0.6027
Average max pos: max_acc 0.9236 max_p 0.7358 max_r 0.6307 max_f1 0.6792

step 10: train loss 0.3458 
cause_predict: train acc 0.9144 p 0.8333 r 0.5263 f1 0.6452
position_predict: train acc 0.9494 p 0.8276 r 0.7500 f1 0.7869
step 20: train loss 0.3721 
cause_predict: train acc 0.9139 p 0.7037 r 0.5938 f1 0.6441
position_predict: train acc 0.9344 p 0.8077 r 0.6562 f1 0.7241
step 30: train loss 0.4849 
cause_predict: train acc 0.8980 p 0.7273 r 0.4000 f1 0.5161
position_predict: train acc 0.9354 p 0.7241 r 0.6562 f1 0.6885
step 40: train loss 0.4312 
cause_predict: train acc 0.8922 p 0.7600 r 0.5000 f1 0.6032
position_predict: train acc 0.9310 p 0.8077 r 0.6562 f1 0.7241
step 50: train loss 0.4979 
cause_predict: train acc 0.8908 p 0.8095 r 0.4474 f1 0.5763
position_predict: train acc 0.9214 p 0.7188 r 0.7188 f1 0.7188
step 60: train loss 0.3439 
cause_predict: train acc 0.9125 p 0.7500 r 0.4737 f1 0.5806
position_predict: train acc 0.9663 p 0.8438 r 0.8438 f1 0.8438
step 70: train loss 0.4243 
cause_predict: train acc 0.9149 p 0.7600 r 0.5758 f1 0.6552
position_predict: train acc 0.9277 p 0.7742 r 0.7059 f1 0.7385

epoch 4: test loss 0.4948 cost time: 10.3s

cause_predict: test acc 0.8905 p 0.7338 r 0.3565 f1 0.4798
max_acc 0.8963 max_p 0.6592 max_r 0.5552 max_f1 0.6027

position_predict: test acc 0.9205 p 0.7072 r 0.6481 f1 0.6764
max_acc 0.9223 max_p 0.6996 max_r 0.6899 max_f1 0.6947

Average max cause: max_acc 0.8963 max_p 0.6592 max_r 0.5552 max_f1 0.6027
Average max pos: max_acc 0.9236 max_p 0.7358 max_r 0.6307 max_f1 0.6792

step 10: train loss 0.3748 
cause_predict: train acc 0.9325 p 0.8333 r 0.6944 f1 0.7576
position_predict: train acc 0.9198 p 0.6970 r 0.7188 f1 0.7077
step 20: train loss 0.3435 
cause_predict: train acc 0.9070 p 0.7826 r 0.4865 f1 0.6000
position_predict: train acc 0.9535 p 0.8125 r 0.8125 f1 0.8125
step 30: train loss 0.4183 
cause_predict: train acc 0.8947 p 0.7000 r 0.5833 f1 0.6364
position_predict: train acc 0.9474 p 0.8125 r 0.8125 f1 0.8125
step 40: train loss 0.3538 
cause_predict: train acc 0.9095 p 0.8000 r 0.5882 f1 0.6780
position_predict: train acc 0.9381 p 0.8065 r 0.7812 f1 0.7937
step 50: train loss 0.3184 
cause_predict: train acc 0.9227 p 0.9167 r 0.6471 f1 0.7586
position_predict: train acc 0.9724 p 0.9655 r 0.8750 f1 0.9180
step 60: train loss 0.3641 
cause_predict: train acc 0.9240 p 0.8214 r 0.6053 f1 0.6970
position_predict: train acc 0.9316 p 0.7188 r 0.7188 f1 0.7188
step 70: train loss 0.3658 
cause_predict: train acc 0.9163 p 0.8696 r 0.5128 f1 0.6452
position_predict: train acc 0.9392 p 0.7667 r 0.7188 f1 0.7419

epoch 5: test loss 0.4881 cost time: 10.5s

cause_predict: test acc 0.8878 p 0.6486 r 0.4543 f1 0.5343
max_acc 0.8963 max_p 0.6592 max_r 0.5552 max_f1 0.6027

position_predict: test acc 0.9173 p 0.6947 r 0.6341 f1 0.6630
max_acc 0.9223 max_p 0.6996 max_r 0.6899 max_f1 0.6947

Average max cause: max_acc 0.8963 max_p 0.6592 max_r 0.5552 max_f1 0.6027
Average max pos: max_acc 0.9236 max_p 0.7358 max_r 0.6307 max_f1 0.6792

step 10: train loss 0.2871 
cause_predict: train acc 0.9205 p 0.8148 r 0.6111 f1 0.6984
position_predict: train acc 0.9623 p 0.9615 r 0.7576 f1 0.8475
step 20: train loss 0.2695 
cause_predict: train acc 0.9417 p 0.8000 r 0.7500 f1 0.7742
position_predict: train acc 0.9375 p 0.7297 r 0.8438 f1 0.7826
step 30: train loss 0.2432 
cause_predict: train acc 0.9394 p 0.8929 r 0.7353 f1 0.8065
position_predict: train acc 0.9646 p 0.8571 r 0.9375 f1 0.8955
step 40: train loss 0.2720 
cause_predict: train acc 0.9208 p 0.6304 r 0.8056 f1 0.7073
position_predict: train acc 0.9703 p 0.9259 r 0.7812 f1 0.8475
step 50: train loss 0.3616 
cause_predict: train acc 0.9315 p 0.8966 r 0.6500 f1 0.7536
position_predict: train acc 0.9274 p 0.7419 r 0.6970 f1 0.7188
step 60: train loss 0.2745 
cause_predict: train acc 0.9426 p 0.7188 r 0.6970 f1 0.7077
position_predict: train acc 0.9456 p 0.6944 r 0.7812 f1 0.7353
step 70: train loss 0.2828 
cause_predict: train acc 0.9238 p 0.7778 r 0.7778 f1 0.7778
position_predict: train acc 0.9429 p 0.8000 r 0.8485 f1 0.8235

epoch 6: test loss 0.5202 cost time: 10.2s

cause_predict: test acc 0.8834 p 0.5959 r 0.5489 f1 0.5714
max_acc 0.8963 max_p 0.6592 max_r 0.5552 max_f1 0.6027

position_predict: test acc 0.9205 p 0.6886 r 0.6934 f1 0.6910
max_acc 0.9223 max_p 0.6996 max_r 0.6899 max_f1 0.6947

Average max cause: max_acc 0.8963 max_p 0.6592 max_r 0.5552 max_f1 0.6027
Average max pos: max_acc 0.9236 max_p 0.7358 max_r 0.6307 max_f1 0.6792

step 10: train loss 0.1810 
cause_predict: train acc 0.9570 p 0.8529 r 0.8056 f1 0.8286
position_predict: train acc 0.9713 p 0.9032 r 0.8485 f1 0.8750
step 20: train loss 0.1748 
cause_predict: train acc 0.9584 p 0.8000 r 0.7273 f1 0.7619
position_predict: train acc 0.9668 p 0.8571 r 0.7500 f1 0.8000
step 30: train loss 0.3053 
cause_predict: train acc 0.9393 p 0.9231 r 0.6154 f1 0.7385
position_predict: train acc 0.9500 p 0.8000 r 0.7500 f1 0.7742
step 40: train loss 0.2763 
cause_predict: train acc 0.9570 p 0.9310 r 0.8182 f1 0.8710
position_predict: train acc 0.9516 p 0.9000 r 0.8182 f1 0.8571
step 50: train loss 0.2200 
cause_predict: train acc 0.9187 p 0.7317 r 0.7692 f1 0.7500
position_predict: train acc 0.9715 p 0.9333 r 0.8485 f1 0.8889
step 60: train loss 0.3334 
cause_predict: train acc 0.9313 p 0.7879 r 0.7429 f1 0.7647
position_predict: train acc 0.9356 p 0.8000 r 0.7273 f1 0.7619
step 70: train loss 0.2545 
cause_predict: train acc 0.9459 p 0.8621 r 0.7143 f1 0.7813
position_predict: train acc 0.9614 p 0.8929 r 0.7812 f1 0.8333

epoch 7: test loss 0.5538 cost time: 10.5s

cause_predict: test acc 0.8870 p 0.6176 r 0.5300 f1 0.5705
max_acc 0.8963 max_p 0.6592 max_r 0.5552 max_f1 0.6027

position_predict: test acc 0.9200 p 0.7015 r 0.6551 f1 0.6775
max_acc 0.9223 max_p 0.6996 max_r 0.6899 max_f1 0.6947

Average max cause: max_acc 0.8963 max_p 0.6592 max_r 0.5552 max_f1 0.6027
Average max pos: max_acc 0.9236 max_p 0.7358 max_r 0.6307 max_f1 0.6792

step 10: train loss 0.1333 
cause_predict: train acc 0.9697 p 0.8571 r 0.8824 f1 0.8696
position_predict: train acc 0.9764 p 0.9333 r 0.8485 f1 0.8889
step 20: train loss 0.2455 
cause_predict: train acc 0.9348 p 0.8276 r 0.6486 f1 0.7273
position_predict: train acc 0.9601 p 0.8387 r 0.8125 f1 0.8254
step 30: train loss 0.2310 
cause_predict: train acc 0.9487 p 0.8056 r 0.8529 f1 0.8286
position_predict: train acc 0.9701 p 0.9032 r 0.8750 f1 0.8889
step 40: train loss 0.2061 
cause_predict: train acc 0.9610 p 0.8857 r 0.8611 f1 0.8732
position_predict: train acc 0.9654 p 0.8750 r 0.8750 f1 0.8750
step 50: train loss 0.1828 
cause_predict: train acc 0.9601 p 0.9200 r 0.6970 f1 0.7931
position_predict: train acc 0.9767 p 0.9310 r 0.8438 f1 0.8852
step 60: train loss 0.3081 
cause_predict: train acc 0.9159 p 0.7368 r 0.7778 f1 0.7568
position_predict: train acc 0.9439 p 0.8333 r 0.7812 f1 0.8065
step 70: train loss 0.3076 
cause_predict: train acc 0.9342 p 0.8485 r 0.7179 f1 0.7778
position_predict: train acc 0.9383 p 0.7647 r 0.7879 f1 0.7761

epoch 8: test loss 0.5909 cost time: 10.5s

cause_predict: test acc 0.8758 p 0.5675 r 0.5174 f1 0.5413
max_acc 0.8963 max_p 0.6592 max_r 0.5552 max_f1 0.6027

position_predict: test acc 0.9214 p 0.6881 r 0.7073 f1 0.6976
max_acc 0.9214 max_p 0.6881 max_r 0.7073 max_f1 0.6976

Average max cause: max_acc 0.8963 max_p 0.6592 max_r 0.5552 max_f1 0.6027
Average max pos: max_acc 0.9236 max_p 0.7358 max_r 0.6307 max_f1 0.6792

step 10: train loss 0.2349 
cause_predict: train acc 0.9390 p 0.8182 r 0.7500 f1 0.7826
position_predict: train acc 0.9797 p 0.9355 r 0.9062 f1 0.9206
step 20: train loss 0.1529 
cause_predict: train acc 0.9745 p 0.9412 r 0.8889 f1 0.9143
position_predict: train acc 0.9787 p 0.9375 r 0.9091 f1 0.9231
step 30: train loss 0.1879 
cause_predict: train acc 0.9417 p 0.8182 r 0.7941 f1 0.8060
position_predict: train acc 0.9731 p 0.9333 r 0.8750 f1 0.9032
step 40: train loss 0.3145 
cause_predict: train acc 0.8950 p 0.6757 r 0.7353 f1 0.7042
position_predict: train acc 0.9500 p 0.8235 r 0.8750 f1 0.8485
step 50: train loss 0.2060 
cause_predict: train acc 0.9560 p 0.9062 r 0.7838 f1 0.8406
position_predict: train acc 0.9600 p 0.8667 r 0.8125 f1 0.8387
step 60: train loss 0.2159 
cause_predict: train acc 0.9651 p 0.8718 r 0.9189 f1 0.8947
position_predict: train acc 0.9694 p 0.9032 r 0.8750 f1 0.8889
step 70: train loss 0.1533 
cause_predict: train acc 0.9565 p 0.9032 r 0.8235 f1 0.8615
position_predict: train acc 0.9807 p 0.9375 r 0.9375 f1 0.9375
2024-06-22 19:15:38.346202: W tensorflow/c/c_api.cc:304] Operation '{name:'softmax_b_pos/Adam_1/Assign' id:5023 op device:{requested: '', assigned: ''} def:{{{node softmax_b_pos/Adam_1/Assign}} = Assign[T=DT_FLOAT, _class=["loc:@softmax_b_pos"], _has_manual_control_dependencies=true, use_locking=true, validate_shape=true](softmax_b_pos/Adam_1, softmax_b_pos/Adam_1/Initializer/zeros)}}' was changed by setting attribute after it was run by a session. This mutation will have no effect, and will trigger an error in the future. Either don't modify nodes after running them or create a new session.

epoch 9: test loss 0.6198 cost time: 10.3s

cause_predict: test acc 0.8883 p 0.6264 r 0.5237 f1 0.5704
max_acc 0.8963 max_p 0.6592 max_r 0.5552 max_f1 0.6027

position_predict: test acc 0.9155 p 0.6655 r 0.6864 f1 0.6758
max_acc 0.9214 max_p 0.6881 max_r 0.7073 max_f1 0.6976

Average max cause: max_acc 0.8963 max_p 0.6592 max_r 0.5552 max_f1 0.6027
Average max pos: max_acc 0.9236 max_p 0.7358 max_r 0.6307 max_f1 0.6792

step 10: train loss 0.1756 
cause_predict: train acc 0.9444 p 0.9189 r 0.7907 f1 0.8500
position_predict: train acc 0.9861 p 0.9677 r 0.9375 f1 0.9524
step 20: train loss 0.1291 
cause_predict: train acc 0.9738 p 0.9118 r 0.8857 f1 0.8986
position_predict: train acc 0.9850 p 0.9677 r 0.9091 f1 0.9375
step 30: train loss 0.1579 
cause_predict: train acc 0.9671 p 0.9118 r 0.8857 f1 0.8986
position_predict: train acc 0.9718 p 0.8824 r 0.9375 f1 0.9091
step 40: train loss 0.2648 
cause_predict: train acc 0.9556 p 0.8235 r 0.8485 f1 0.8358
position_predict: train acc 0.9435 p 0.8333 r 0.7353 f1 0.7812
step 50: train loss 0.2005 
cause_predict: train acc 0.9478 p 0.7941 r 0.8182 f1 0.8060
position_predict: train acc 0.9719 p 0.9062 r 0.8788 f1 0.8923
step 60: train loss 0.1358 
cause_predict: train acc 0.9635 p 0.9091 r 0.8571 f1 0.8824
position_predict: train acc 0.9817 p 0.9375 r 0.9375 f1 0.9375
step 70: train loss 0.2745 
cause_predict: train acc 0.9427 p 0.8438 r 0.7714 f1 0.8060
position_predict: train acc 0.9515 p 0.8438 r 0.8182 f1 0.8308

epoch 10: test loss 0.6487 cost time: 10.1s

cause_predict: test acc 0.8919 p 0.6426 r 0.5331 f1 0.5828
max_acc 0.8963 max_p 0.6592 max_r 0.5552 max_f1 0.6027

position_predict: test acc 0.9120 p 0.6471 r 0.6899 f1 0.6678
max_acc 0.9214 max_p 0.6881 max_r 0.7073 max_f1 0.6976

Average max cause: max_acc 0.8963 max_p 0.6592 max_r 0.5552 max_f1 0.6027
Average max pos: max_acc 0.9236 max_p 0.7358 max_r 0.6307 max_f1 0.6792

step 10: train loss 0.1134 
cause_predict: train acc 0.9827 p 0.9474 r 0.9474 f1 0.9474
position_predict: train acc 0.9784 p 0.9355 r 0.9062 f1 0.9206
step 20: train loss 0.2385 
cause_predict: train acc 0.9591 p 0.9167 r 0.8462 f1 0.8800
position_predict: train acc 0.9455 p 0.7778 r 0.8750 f1 0.8235
step 30: train loss 0.0706 
cause_predict: train acc 0.9925 p 0.9722 r 0.9722 f1 0.9722
position_predict: train acc 0.9849 p 0.9667 r 0.9062 f1 0.9355
step 40: train loss 0.2771 
cause_predict: train acc 0.9552 p 0.8710 r 0.7714 f1 0.8182
position_predict: train acc 0.9478 p 0.7812 r 0.7812 f1 0.7812
step 50: train loss 0.1914 
cause_predict: train acc 0.9643 p 0.8182 r 0.8438 f1 0.8308
position_predict: train acc 0.9481 p 0.7500 r 0.7500 f1 0.7500
step 60: train loss 0.1749 
cause_predict: train acc 0.9720 p 0.9730 r 0.8780 f1 0.9231
position_predict: train acc 0.9720 p 0.9062 r 0.9062 f1 0.9062
step 70: train loss 0.0911 
cause_predict: train acc 0.9832 p 1.0000 r 0.8571 f1 0.9231
position_predict: train acc 0.9899 p 0.9394 r 0.9688 f1 0.9538

epoch 11: test loss 0.6944 cost time: 10.1s

cause_predict: test acc 0.8856 p 0.6048 r 0.5552 f1 0.5789
max_acc 0.8963 max_p 0.6592 max_r 0.5552 max_f1 0.6027

position_predict: test acc 0.9075 p 0.6389 r 0.6411 f1 0.6400
max_acc 0.9214 max_p 0.6881 max_r 0.7073 max_f1 0.6976

Average max cause: max_acc 0.8963 max_p 0.6592 max_r 0.5552 max_f1 0.6027
Average max pos: max_acc 0.9236 max_p 0.7358 max_r 0.6307 max_f1 0.6792

step 10: train loss 0.1320 
cause_predict: train acc 0.9747 p 0.9697 r 0.8889 f1 0.9275
position_predict: train acc 0.9697 p 0.9091 r 0.9091 f1 0.9091
step 20: train loss 0.1541 
cause_predict: train acc 0.9763 p 0.9487 r 0.9250 f1 0.9367
position_predict: train acc 0.9763 p 0.9091 r 0.9375 f1 0.9231
step 30: train loss 0.1385 
cause_predict: train acc 0.9631 p 0.9032 r 0.8235 f1 0.8615
position_predict: train acc 0.9836 p 0.9375 r 0.9375 f1 0.9375
step 40: train loss 0.1914 
cause_predict: train acc 0.9684 p 0.8947 r 0.9444 f1 0.9189
position_predict: train acc 0.9474 p 0.8438 r 0.8438 f1 0.8438
step 50: train loss 0.2121 
cause_predict: train acc 0.9709 p 0.9118 r 0.9118 f1 0.9118
position_predict: train acc 0.9709 p 0.9062 r 0.9062 f1 0.9062
step 60: train loss 0.0902 
cause_predict: train acc 0.9860 p 0.9697 r 0.9412 f1 0.9552
position_predict: train acc 0.9907 p 0.9688 r 0.9688 f1 0.9688
step 70: train loss 0.2053 
cause_predict: train acc 0.9333 p 0.7750 r 0.8611 f1 0.8158
position_predict: train acc 0.9571 p 0.8485 r 0.8750 f1 0.8615

epoch 12: test loss 0.7255 cost time: 10.2s

cause_predict: test acc 0.8767 p 0.5704 r 0.5237 f1 0.5461
max_acc 0.8963 max_p 0.6592 max_r 0.5552 max_f1 0.6027

position_predict: test acc 0.9169 p 0.6784 r 0.6690 f1 0.6737
max_acc 0.9214 max_p 0.6881 max_r 0.7073 max_f1 0.6976

Average max cause: max_acc 0.8963 max_p 0.6592 max_r 0.5552 max_f1 0.6027
Average max pos: max_acc 0.9236 max_p 0.7358 max_r 0.6307 max_f1 0.6792

step 10: train loss 0.0944 
cause_predict: train acc 0.9855 p 0.9500 r 0.9744 f1 0.9620
position_predict: train acc 0.9807 p 0.9375 r 0.9375 f1 0.9375
step 20: train loss 0.1373 
cause_predict: train acc 0.9856 p 0.9286 r 0.9750 f1 0.9512
position_predict: train acc 0.9676 p 0.8485 r 0.8750 f1 0.8615
step 30: train loss 0.1056 
cause_predict: train acc 0.9815 p 0.9355 r 0.9062 f1 0.9206
position_predict: train acc 0.9778 p 0.9062 r 0.9062 f1 0.9062
step 40: train loss 0.1278 
cause_predict: train acc 0.9738 p 0.8857 r 0.8857 f1 0.8857
position_predict: train acc 0.9803 p 0.9643 r 0.8438 f1 0.9000
step 50: train loss 0.1527 
cause_predict: train acc 0.9703 p 0.8919 r 0.8919 f1 0.8919
position_predict: train acc 0.9554 p 0.7941 r 0.8438 f1 0.8182
step 60: train loss 0.1024 
cause_predict: train acc 0.9844 p 0.9688 r 0.9118 f1 0.9394
position_predict: train acc 0.9767 p 0.9091 r 0.9091 f1 0.9091
step 70: train loss 0.0942 
cause_predict: train acc 0.9950 p 0.9722 r 1.0000 f1 0.9859
position_predict: train acc 0.9799 p 0.9667 r 0.9062 f1 0.9355

epoch 13: test loss 0.7143 cost time: 10.2s

cause_predict: test acc 0.8767 p 0.5695 r 0.5300 f1 0.5490
max_acc 0.8963 max_p 0.6592 max_r 0.5552 max_f1 0.6027

position_predict: test acc 0.9142 p 0.6644 r 0.6690 f1 0.6667
max_acc 0.9214 max_p 0.6881 max_r 0.7073 max_f1 0.6976

Average max cause: max_acc 0.8963 max_p 0.6592 max_r 0.5552 max_f1 0.6027
Average max pos: max_acc 0.9236 max_p 0.7358 max_r 0.6307 max_f1 0.6792

step 10: train loss 0.0662 
cause_predict: train acc 0.9919 p 0.9500 r 1.0000 f1 0.9744
position_predict: train acc 0.9878 p 0.9677 r 0.9375 f1 0.9524
step 20: train loss 0.0457 
cause_predict: train acc 0.9910 p 0.9697 r 0.9697 f1 0.9697
position_predict: train acc 0.9955 p 0.9697 r 1.0000 f1 0.9846
step 30: train loss 0.1264 
cause_predict: train acc 0.9722 p 0.9062 r 0.9062 f1 0.9062
position_predict: train acc 0.9769 p 0.9091 r 0.9375 f1 0.9231
step 40: train loss 0.0816 
cause_predict: train acc 0.9875 p 0.9444 r 0.9714 f1 0.9577
position_predict: train acc 0.9833 p 0.9118 r 0.9688 f1 0.9394
step 50: train loss 0.0926 
cause_predict: train acc 0.9814 p 0.9688 r 0.9118 f1 0.9394
position_predict: train acc 0.9860 p 0.9394 r 0.9688 f1 0.9538
step 60: train loss 0.0917 
cause_predict: train acc 0.9903 p 0.9688 r 0.9688 f1 0.9688
position_predict: train acc 0.9903 p 0.9688 r 0.9688 f1 0.9688
step 70: train loss 0.1080 
cause_predict: train acc 0.9682 p 0.8611 r 0.8857 f1 0.8732
position_predict: train acc 0.9823 p 0.9091 r 0.9375 f1 0.9231

epoch 14: test loss 0.8027 cost time: 10.2s

cause_predict: test acc 0.8749 p 0.5640 r 0.5142 f1 0.5380
max_acc 0.8963 max_p 0.6592 max_r 0.5552 max_f1 0.6027

position_predict: test acc 0.9151 p 0.6777 r 0.6446 f1 0.6607
max_acc 0.9214 max_p 0.6881 max_r 0.7073 max_f1 0.6976

Average max cause: max_acc 0.8963 max_p 0.6592 max_r 0.5552 max_f1 0.6027
Average max pos: max_acc 0.9236 max_p 0.7358 max_r 0.6307 max_f1 0.6792

write pair_data/Ind_BiLSTM_2/fold_6_test.txt done
write pair_data/Ind_BiLSTM_2/fold_6_train.txt done
Optimization Finished!

############# fold 6 end ###############
############# fold 7 begin ###############
load data_file: data_combine_en/fold_7_train.txt
y_position.shape (2275, 75, 2)
y_cause.shape (2275, 75, 2)
x.shape (2275, 75, 30)
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
sen_len.shape (2275, 75)
doc_len.shape (2275,)
n_cut 107
load data done!

load data_file: data_combine_en/fold_7_test.txt
y_position.shape (284, 75, 2)
y_cause.shape (284, 75, 2)
x.shape (284, 75, 30)
sen_len.shape (284, 75)
doc_len.shape (284,)
n_cut 22
load data done!

train docs: 2275    test docs: 284
step 10: train loss 0.8609 
cause_predict: train acc 0.8362 p 0.0000 r 0.0000 f1 0.0000
position_predict: train acc 0.8621 p 0.0000 r 0.0000 f1 0.0000
step 20: train loss 0.7083 
cause_predict: train acc 0.8672 p 0.0000 r 0.0000 f1 0.0000
position_predict: train acc 0.8750 p 0.0000 r 0.0000 f1 0.0000
step 30: train loss 0.6539 
cause_predict: train acc 0.8674 p 0.0000 r 0.0000 f1 0.0000
position_predict: train acc 0.8788 p 0.0000 r 0.0000 f1 0.0000
step 40: train loss 0.6585 
cause_predict: train acc 0.8312 p 0.0000 r 0.0000 f1 0.0000
position_predict: train acc 0.8615 p 0.0000 r 0.0000 f1 0.0000
step 50: train loss 0.6258 
cause_predict: train acc 0.8386 p 0.0000 r 0.0000 f1 0.0000
position_predict: train acc 0.8879 p 0.6842 r 0.4062 f1 0.5098
step 60: train loss 0.5513 
cause_predict: train acc 0.8654 p 0.0000 r 0.0000 f1 0.0000
position_predict: train acc 0.9115 p 0.6667 r 0.6061 f1 0.6349
step 70: train loss 0.6578 
cause_predict: train acc 0.8417 p 1.0000 r 0.0256 f1 0.0500
position_predict: train acc 0.9000 p 0.6667 r 0.5000 f1 0.5714

epoch 0: test loss 0.5432 cost time: 10.4s

cause_predict: test acc 0.8642 p 0.9333 r 0.0442 f1 0.0843
max_acc 0.8642 max_p 0.9333 max_r 0.0442 max_f1 0.0843

position_predict: test acc 0.9093 p 0.7727 r 0.4146 f1 0.5397
max_acc 0.9093 max_p 0.7727 max_r 0.4146 max_f1 0.5397

Average max cause: max_acc 0.8642 max_p 0.9333 max_r 0.0442 max_f1 0.0843
Average max pos: max_acc 0.9093 max_p 0.7727 max_r 0.4146 max_f1 0.5397

step 10: train loss 0.6195 
cause_predict: train acc 0.8565 p 0.6364 r 0.2000 f1 0.3043
position_predict: train acc 0.8924 p 0.6552 r 0.5758 f1 0.6129
step 20: train loss 0.5545 
cause_predict: train acc 0.8682 p 0.5556 r 0.1429 f1 0.2273
position_predict: train acc 0.9070 p 0.6818 r 0.4688 f1 0.5556
step 30: train loss 0.5055 
cause_predict: train acc 0.8760 p 0.6471 r 0.3056 f1 0.4151
position_predict: train acc 0.9320 p 0.8947 r 0.5312 f1 0.6667
step 40: train loss 0.4122 
cause_predict: train acc 0.9138 p 0.7778 r 0.2121 f1 0.3333
position_predict: train acc 0.9354 p 0.7407 r 0.5882 f1 0.6557
step 50: train loss 0.6023 
cause_predict: train acc 0.8571 p 0.7500 r 0.3243 f1 0.4528
position_predict: train acc 0.9113 p 0.7692 r 0.6250 f1 0.6897
step 60: train loss 0.5619 
cause_predict: train acc 0.8740 p 0.7857 r 0.2821 f1 0.4151
position_predict: train acc 0.9024 p 0.6538 r 0.5312 f1 0.5862
step 70: train loss 0.4557 
cause_predict: train acc 0.9184 p 0.8182 r 0.5294 f1 0.6429
position_predict: train acc 0.9265 p 0.7333 r 0.6875 f1 0.7097

epoch 1: test loss 0.4889 cost time: 10.5s

cause_predict: test acc 0.8856 p 0.6723 r 0.3754 f1 0.4818
max_acc 0.8856 max_p 0.6723 max_r 0.3754 max_f1 0.4818

position_predict: test acc 0.9196 p 0.6974 r 0.6585 f1 0.6774
max_acc 0.9196 max_p 0.6974 max_r 0.6585 max_f1 0.6774

Average max cause: max_acc 0.8856 max_p 0.6723 max_r 0.3754 max_f1 0.4818
Average max pos: max_acc 0.9196 max_p 0.6974 max_r 0.6585 max_f1 0.6774

step 10: train loss 0.3952 
cause_predict: train acc 0.8972 p 0.6190 r 0.3824 f1 0.4727
position_predict: train acc 0.9149 p 0.6429 r 0.5625 f1 0.6000
step 20: train loss 0.4521 
cause_predict: train acc 0.8929 p 0.8333 r 0.4167 f1 0.5556
position_predict: train acc 0.9286 p 0.7353 r 0.7812 f1 0.7576
step 30: train loss 0.4980 
cause_predict: train acc 0.8690 p 0.5455 r 0.1765 f1 0.2667
position_predict: train acc 0.9048 p 0.6538 r 0.5312 f1 0.5862
step 40: train loss 0.4400 
cause_predict: train acc 0.8985 p 0.6818 r 0.4286 f1 0.5263
position_predict: train acc 0.9474 p 0.8800 r 0.6667 f1 0.7586
step 50: train loss 0.4102 
cause_predict: train acc 0.8880 p 0.6667 r 0.2500 f1 0.3636
position_predict: train acc 0.9320 p 0.7353 r 0.7576 f1 0.7463
step 60: train loss 0.4584 
cause_predict: train acc 0.8729 p 0.6818 r 0.3947 f1 0.5000
position_predict: train acc 0.9195 p 0.7188 r 0.6970 f1 0.7077
step 70: train loss 0.4379 
cause_predict: train acc 0.8905 p 0.6500 r 0.3514 f1 0.4561
position_predict: train acc 0.9470 p 0.8148 r 0.6875 f1 0.7458

epoch 2: test loss 0.4913 cost time: 10.2s

cause_predict: test acc 0.8905 p 0.8000 r 0.3028 f1 0.4394
max_acc 0.8856 max_p 0.6723 max_r 0.3754 max_f1 0.4818

position_predict: test acc 0.9102 p 0.6257 r 0.7456 f1 0.6804
max_acc 0.9102 max_p 0.6257 max_r 0.7456 max_f1 0.6804

Average max cause: max_acc 0.8856 max_p 0.6723 max_r 0.3754 max_f1 0.4818
Average max pos: max_acc 0.9196 max_p 0.6974 max_r 0.6585 max_f1 0.6774

step 10: train loss 0.4276 
cause_predict: train acc 0.8991 p 0.7600 r 0.5429 f1 0.6333
position_predict: train acc 0.9312 p 0.8000 r 0.7273 f1 0.7619
step 20: train loss 0.3909 
cause_predict: train acc 0.8962 p 0.6154 r 0.2222 f1 0.3265
position_predict: train acc 0.9403 p 0.7407 r 0.6250 f1 0.6780
step 30: train loss 0.2928 
cause_predict: train acc 0.9317 p 0.7778 r 0.6176 f1 0.6885
position_predict: train acc 0.9640 p 0.8667 r 0.8125 f1 0.8387
step 40: train loss 0.4087 
cause_predict: train acc 0.8860 p 0.6522 r 0.4545 f1 0.5357
position_predict: train acc 0.9474 p 0.8571 r 0.7500 f1 0.8000
step 50: train loss 0.3910 
cause_predict: train acc 0.9356 p 0.7500 r 0.7273 f1 0.7385
position_predict: train acc 0.9167 p 0.6667 r 0.6250 f1 0.6452
step 60: train loss 0.4849 
cause_predict: train acc 0.8855 p 0.6538 r 0.5000 f1 0.5667
position_predict: train acc 0.9163 p 0.6970 r 0.7188 f1 0.7077
step 70: train loss 0.5010 
cause_predict: train acc 0.8596 p 0.6071 r 0.4359 f1 0.5075
position_predict: train acc 0.9277 p 0.8000 r 0.6250 f1 0.7018

epoch 3: test loss 0.4829 cost time: 10.4s

cause_predict: test acc 0.8892 p 0.6734 r 0.4227 f1 0.5194
max_acc 0.8892 max_p 0.6734 max_r 0.4227 max_f1 0.5194

position_predict: test acc 0.9236 p 0.7101 r 0.6829 f1 0.6963
max_acc 0.9236 max_p 0.7101 max_r 0.6829 max_f1 0.6963

Average max cause: max_acc 0.8892 max_p 0.6734 max_r 0.4227 max_f1 0.5194
Average max pos: max_acc 0.9236 max_p 0.7101 max_r 0.6829 max_f1 0.6963

step 10: train loss 0.3137 
cause_predict: train acc 0.9250 p 0.7667 r 0.6765 f1 0.7188
position_predict: train acc 0.9500 p 0.8125 r 0.8125 f1 0.8125
step 20: train loss 0.3392 
cause_predict: train acc 0.9112 p 0.7241 r 0.5833 f1 0.6462
position_predict: train acc 0.9575 p 0.8000 r 0.8750 f1 0.8358
step 30: train loss 0.5270 
cause_predict: train acc 0.8738 p 0.6452 r 0.5714 f1 0.6061
position_predict: train acc 0.9029 p 0.6875 r 0.6875 f1 0.6875
step 40: train loss 0.3808 
cause_predict: train acc 0.9280 p 0.8750 r 0.5833 f1 0.7000
position_predict: train acc 0.9320 p 0.7419 r 0.7188 f1 0.7302
step 50: train loss 0.4013 
cause_predict: train acc 0.9019 p 0.7241 r 0.5385 f1 0.6176
position_predict: train acc 0.9472 p 0.8000 r 0.7500 f1 0.7742
step 60: train loss 0.3371 
cause_predict: train acc 0.9091 p 0.7826 r 0.5294 f1 0.6316
position_predict: train acc 0.9567 p 0.8929 r 0.7812 f1 0.8333
step 70: train loss 0.3877 
cause_predict: train acc 0.9084 p 0.6552 r 0.5758 f1 0.6129
position_predict: train acc 0.9237 p 0.7308 r 0.5938 f1 0.6552

epoch 4: test loss 0.4934 cost time: 10.2s

cause_predict: test acc 0.8928 p 0.6711 r 0.4763 f1 0.5572
max_acc 0.8928 max_p 0.6711 max_r 0.4763 max_f1 0.5572

position_predict: test acc 0.9214 p 0.6961 r 0.6864 f1 0.6912
max_acc 0.9236 max_p 0.7101 max_r 0.6829 max_f1 0.6963

Average max cause: max_acc 0.8928 max_p 0.6711 max_r 0.4763 max_f1 0.5572
Average max pos: max_acc 0.9214 max_p 0.6961 max_r 0.6864 max_f1 0.6912

step 10: train loss 0.2973 
cause_predict: train acc 0.9163 p 0.8182 r 0.5143 f1 0.6316
position_predict: train acc 0.9681 p 0.8788 r 0.8788 f1 0.8788
step 20: train loss 0.3088 
cause_predict: train acc 0.9600 p 0.9630 r 0.7429 f1 0.8387
position_predict: train acc 0.9480 p 0.8276 r 0.7500 f1 0.7869
step 30: train loss 0.2860 
cause_predict: train acc 0.9354 p 0.8276 r 0.6667 f1 0.7385
position_predict: train acc 0.9544 p 0.8387 r 0.7879 f1 0.8125
step 40: train loss 0.3459 
cause_predict: train acc 0.9177 p 0.8214 r 0.6053 f1 0.6970
position_predict: train acc 0.9630 p 0.8966 r 0.8125 f1 0.8525
step 50: train loss 0.4253 
cause_predict: train acc 0.8915 p 0.6667 r 0.3590 f1 0.4667
position_predict: train acc 0.9254 p 0.6562 r 0.6562 f1 0.6562
step 60: train loss 0.3071 
cause_predict: train acc 0.9371 p 0.8462 r 0.5641 f1 0.6769
position_predict: train acc 0.9461 p 0.7500 r 0.6562 f1 0.7000
step 70: train loss 0.3690 
cause_predict: train acc 0.9167 p 0.7308 r 0.5429 f1 0.6230
position_predict: train acc 0.9275 p 0.6875 r 0.6875 f1 0.6875

epoch 5: test loss 0.5102 cost time: 10.3s

cause_predict: test acc 0.8914 p 0.6581 r 0.4858 f1 0.5590
max_acc 0.8914 max_p 0.6581 max_r 0.4858 max_f1 0.5590

position_predict: test acc 0.9236 p 0.7101 r 0.6829 f1 0.6963
max_acc 0.9236 max_p 0.7101 max_r 0.6829 max_f1 0.6963

Average max cause: max_acc 0.8914 max_p 0.6581 max_r 0.4858 max_f1 0.5590
Average max pos: max_acc 0.9236 max_p 0.7101 max_r 0.6829 max_f1 0.6963

step 10: train loss 0.3020 
cause_predict: train acc 0.9393 p 0.8571 r 0.6486 f1 0.7385
position_predict: train acc 0.9536 p 0.8276 r 0.7500 f1 0.7869
step 20: train loss 0.2885 
cause_predict: train acc 0.9388 p 0.7857 r 0.6471 f1 0.7097
position_predict: train acc 0.9490 p 0.7647 r 0.7879 f1 0.7761
step 30: train loss 0.2749 
cause_predict: train acc 0.9414 p 0.8824 r 0.7692 f1 0.8219
position_predict: train acc 0.9685 p 0.9310 r 0.8438 f1 0.8852
step 40: train loss 0.3196 
cause_predict: train acc 0.9113 p 0.8667 r 0.5909 f1 0.7027
position_predict: train acc 0.9798 p 0.9355 r 0.9062 f1 0.9206
step 50: train loss 0.3527 
cause_predict: train acc 0.9011 p 0.6667 r 0.5556 f1 0.6061
position_predict: train acc 0.9468 p 0.7812 r 0.7812 f1 0.7812
step 60: train loss 0.3540 
cause_predict: train acc 0.9251 p 0.9048 r 0.5588 f1 0.6909
position_predict: train acc 0.9471 p 0.8621 r 0.7576 f1 0.8065
step 70: train loss 0.3759 
cause_predict: train acc 0.8996 p 0.6970 r 0.6216 f1 0.6571
position_predict: train acc 0.9414 p 0.8214 r 0.7188 f1 0.7667

epoch 6: test loss 0.5584 cost time: 10.3s

cause_predict: test acc 0.8816 p 0.6111 r 0.4511 f1 0.5191
max_acc 0.8914 max_p 0.6581 max_r 0.4858 max_f1 0.5590

position_predict: test acc 0.9164 p 0.6838 r 0.6481 f1 0.6655
max_acc 0.9236 max_p 0.7101 max_r 0.6829 max_f1 0.6963

Average max cause: max_acc 0.8914 max_p 0.6581 max_r 0.4858 max_f1 0.5590
Average max pos: max_acc 0.9236 max_p 0.7101 max_r 0.6829 max_f1 0.6963

step 10: train loss 0.1963 
cause_predict: train acc 0.9604 p 0.8889 r 0.8649 f1 0.8767
position_predict: train acc 0.9824 p 0.9677 r 0.9091 f1 0.9375
step 20: train loss 0.3241 
cause_predict: train acc 0.9224 p 0.7778 r 0.7568 f1 0.7671
position_predict: train acc 0.9589 p 0.8485 r 0.8750 f1 0.8615
step 30: train loss 0.2743 
cause_predict: train acc 0.9498 p 0.8889 r 0.7619 f1 0.8205
position_predict: train acc 0.9642 p 0.8667 r 0.8125 f1 0.8387
step 40: train loss 0.2422 
cause_predict: train acc 0.9484 p 0.8857 r 0.7750 f1 0.8267
position_predict: train acc 0.9802 p 0.9375 r 0.9091 f1 0.9231
step 50: train loss 0.3569 
cause_predict: train acc 0.9075 p 0.7429 r 0.6842 f1 0.7123
position_predict: train acc 0.9692 p 0.8788 r 0.9062 f1 0.8923
step 60: train loss 0.2485 
cause_predict: train acc 0.9528 p 0.8966 r 0.7647 f1 0.8254
position_predict: train acc 0.9657 p 0.9000 r 0.8438 f1 0.8710
step 70: train loss 0.2375 
cause_predict: train acc 0.9522 p 0.8438 r 0.7941 f1 0.8182
position_predict: train acc 0.9681 p 0.8750 r 0.8750 f1 0.8750

epoch 7: test loss 0.5708 cost time: 10.4s

cause_predict: test acc 0.8825 p 0.6125 r 0.4637 f1 0.5278
max_acc 0.8914 max_p 0.6581 max_r 0.4858 max_f1 0.5590

position_predict: test acc 0.9120 p 0.6596 r 0.6481 f1 0.6538
max_acc 0.9236 max_p 0.7101 max_r 0.6829 max_f1 0.6963

Average max cause: max_acc 0.8914 max_p 0.6581 max_r 0.4858 max_f1 0.5590
Average max pos: max_acc 0.9236 max_p 0.7101 max_r 0.6829 max_f1 0.6963

step 10: train loss 0.2058 
cause_predict: train acc 0.9582 p 0.8333 r 0.8571 f1 0.8451
position_predict: train acc 0.9772 p 0.9062 r 0.9062 f1 0.9062
step 20: train loss 0.2118 
cause_predict: train acc 0.9200 p 0.7500 r 0.7059 f1 0.7273
position_predict: train acc 0.9822 p 0.9118 r 0.9688 f1 0.9394
step 30: train loss 0.2416 
cause_predict: train acc 0.9352 p 0.8333 r 0.6944 f1 0.7576
position_predict: train acc 0.9595 p 0.8438 r 0.8438 f1 0.8438
step 40: train loss 0.2672 
cause_predict: train acc 0.9234 p 0.8621 r 0.6410 f1 0.7353
position_predict: train acc 0.9745 p 0.9091 r 0.9091 f1 0.9091
step 50: train loss 0.2374 
cause_predict: train acc 0.9198 p 0.7500 r 0.7317 f1 0.7407
position_predict: train acc 0.9733 p 0.9062 r 0.8788 f1 0.8923
step 60: train loss 0.2540 
cause_predict: train acc 0.9442 p 0.9032 r 0.7179 f1 0.8000
position_predict: train acc 0.9522 p 0.8571 r 0.7500 f1 0.8000
step 70: train loss 0.2962 
cause_predict: train acc 0.9268 p 0.8000 r 0.6154 f1 0.6957
position_predict: train acc 0.9512 p 0.7568 r 0.8485 f1 0.8000

epoch 8: test loss 0.5881 cost time: 10.4s

cause_predict: test acc 0.8914 p 0.6652 r 0.4700 f1 0.5508
max_acc 0.8914 max_p 0.6581 max_r 0.4858 max_f1 0.5590

position_predict: test acc 0.9151 p 0.6830 r 0.6307 f1 0.6558
max_acc 0.9236 max_p 0.7101 max_r 0.6829 max_f1 0.6963

Average max cause: max_acc 0.8914 max_p 0.6581 max_r 0.4858 max_f1 0.5590
Average max pos: max_acc 0.9236 max_p 0.7101 max_r 0.6829 max_f1 0.6963

step 10: train loss 0.1244 
cause_predict: train acc 0.9863 p 0.9429 r 0.9429 f1 0.9429
position_predict: train acc 0.9863 p 0.9677 r 0.9091 f1 0.9375
step 20: train loss 0.1945 
cause_predict: train acc 0.9548 p 0.9143 r 0.8421 f1 0.8767
position_predict: train acc 0.9548 p 0.8286 r 0.9062 f1 0.8657
step 30: train loss 0.1902 
cause_predict: train acc 0.9649 p 0.9737 r 0.8409 f1 0.9024
position_predict: train acc 0.9737 p 0.9333 r 0.8750 f1 0.9032
step 40: train loss 0.1748 
cause_predict: train acc 0.9333 p 0.8571 r 0.6667 f1 0.7500
position_predict: train acc 0.9750 p 0.9062 r 0.9062 f1 0.9062
step 50: train loss 0.1784 
cause_predict: train acc 0.9457 p 0.9032 r 0.8000 f1 0.8485
position_predict: train acc 0.9783 p 0.9143 r 0.9697 f1 0.9412
step 60: train loss 0.1745 
cause_predict: train acc 0.9679 p 0.9032 r 0.8485 f1 0.8750
position_predict: train acc 0.9759 p 0.9062 r 0.9062 f1 0.9062
step 70: train loss 0.2779 
cause_predict: train acc 0.9465 p 0.8333 r 0.8824 f1 0.8571
position_predict: train acc 0.9465 p 0.8438 r 0.8438 f1 0.8438

epoch 9: test loss 0.6538 cost time: 10.1s

cause_predict: test acc 0.8896 p 0.6496 r 0.4795 f1 0.5517
max_acc 0.8914 max_p 0.6581 max_r 0.4858 max_f1 0.5590

position_predict: test acc 0.9147 p 0.6655 r 0.6725 f1 0.6690
max_acc 0.9236 max_p 0.7101 max_r 0.6829 max_f1 0.6963

Average max cause: max_acc 0.8914 max_p 0.6581 max_r 0.4858 max_f1 0.5590
Average max pos: max_acc 0.9236 max_p 0.7101 max_r 0.6829 max_f1 0.6963

step 10: train loss 0.1718 
cause_predict: train acc 0.9749 p 0.8857 r 0.9394 f1 0.9118
position_predict: train acc 0.9623 p 0.8710 r 0.8438 f1 0.8571
step 20: train loss 0.1661 
cause_predict: train acc 0.9698 p 0.9143 r 0.8649 f1 0.8889
position_predict: train acc 0.9547 p 0.8333 r 0.7812 f1 0.8065
step 30: train loss 0.1297 
cause_predict: train acc 0.9746 p 0.9655 r 0.8485 f1 0.9032
position_predict: train acc 0.9831 p 0.9394 r 0.9394 f1 0.9394
step 40: train loss 0.1815 
cause_predict: train acc 0.9648 p 0.9091 r 0.8571 f1 0.8824
position_predict: train acc 0.9780 p 0.9355 r 0.9062 f1 0.9206
step 50: train loss 0.1825 
cause_predict: train acc 0.9588 p 0.8857 r 0.8158 f1 0.8493
position_predict: train acc 0.9588 p 0.8438 r 0.8182 f1 0.8308
step 60: train loss 0.1867 
cause_predict: train acc 0.9727 p 0.8788 r 0.9062 f1 0.8923
position_predict: train acc 0.9609 p 0.8235 r 0.8750 f1 0.8485
step 70: train loss 0.1798 
cause_predict: train acc 0.9525 p 0.8276 r 0.7273 f1 0.7742
position_predict: train acc 0.9661 p 0.8667 r 0.8125 f1 0.8387

epoch 10: test loss 0.6503 cost time: 10.0s

cause_predict: test acc 0.8901 p 0.6360 r 0.5237 f1 0.5744
max_acc 0.8901 max_p 0.6360 max_r 0.5237 max_f1 0.5744

2024-06-22 19:18:21.845459: W tensorflow/c/c_api.cc:304] Operation '{name:'softmax_b_pos/Adam_1/Assign' id:5023 op device:{requested: '', assigned: ''} def:{{{node softmax_b_pos/Adam_1/Assign}} = Assign[T=DT_FLOAT, _class=["loc:@softmax_b_pos"], _has_manual_control_dependencies=true, use_locking=true, validate_shape=true](softmax_b_pos/Adam_1, softmax_b_pos/Adam_1/Initializer/zeros)}}' was changed by setting attribute after it was run by a session. This mutation will have no effect, and will trigger an error in the future. Either don't modify nodes after running them or create a new session.
position_predict: test acc 0.9142 p 0.6779 r 0.6307 f1 0.6534
max_acc 0.9236 max_p 0.7101 max_r 0.6829 max_f1 0.6963

Average max cause: max_acc 0.8914 max_p 0.6581 max_r 0.4858 max_f1 0.5590
Average max pos: max_acc 0.9236 max_p 0.7101 max_r 0.6829 max_f1 0.6963

step 10: train loss 0.1467 
cause_predict: train acc 0.9562 p 0.8824 r 0.8108 f1 0.8451
position_predict: train acc 0.9841 p 0.9375 r 0.9375 f1 0.9375
step 20: train loss 0.1411 
cause_predict: train acc 0.9617 p 0.8649 r 0.9143 f1 0.8889
position_predict: train acc 0.9856 p 0.9394 r 0.9688 f1 0.9538
step 30: train loss 0.1282 
cause_predict: train acc 0.9778 p 0.9118 r 0.9394 f1 0.9254
position_predict: train acc 0.9733 p 0.8824 r 0.9375 f1 0.9091
step 40: train loss 0.1639 
cause_predict: train acc 0.9586 p 0.8857 r 0.8158 f1 0.8493
position_predict: train acc 0.9699 p 0.8788 r 0.8788 f1 0.8788
step 50: train loss 0.2008 
cause_predict: train acc 0.9573 p 0.9000 r 0.8182 f1 0.8571
position_predict: train acc 0.9668 p 0.8824 r 0.9091 f1 0.8955
step 60: train loss 0.1755 
cause_predict: train acc 0.9812 p 0.9412 r 0.9143 f1 0.9275
position_predict: train acc 0.9586 p 0.8286 r 0.8529 f1 0.8406
step 70: train loss 0.1494 
cause_predict: train acc 0.9703 p 0.8947 r 0.9189 f1 0.9067
position_predict: train acc 0.9576 p 0.8667 r 0.8125 f1 0.8387

epoch 11: test loss 0.6529 cost time: 10.2s

cause_predict: test acc 0.8887 p 0.6298 r 0.5205 f1 0.5699
max_acc 0.8901 max_p 0.6360 max_r 0.5237 max_f1 0.5744

position_predict: test acc 0.9133 p 0.6566 r 0.6794 f1 0.6678
max_acc 0.9236 max_p 0.7101 max_r 0.6829 max_f1 0.6963

Average max cause: max_acc 0.8914 max_p 0.6581 max_r 0.4858 max_f1 0.5590
Average max pos: max_acc 0.9236 max_p 0.7101 max_r 0.6829 max_f1 0.6963

step 10: train loss 0.0730 
cause_predict: train acc 0.9876 p 1.0000 r 0.8889 f1 0.9412
position_predict: train acc 0.9876 p 0.9118 r 0.9688 f1 0.9394
step 20: train loss 0.2683 
cause_predict: train acc 0.9476 p 0.8421 r 0.8205 f1 0.8312
position_predict: train acc 0.9556 p 0.8667 r 0.7879 f1 0.8254
step 30: train loss 0.1304 
cause_predict: train acc 0.9763 p 0.9697 r 0.8889 f1 0.9275
position_predict: train acc 0.9763 p 0.9091 r 0.9375 f1 0.9231
step 40: train loss 0.2319 
cause_predict: train acc 0.9496 p 0.7805 r 0.8649 f1 0.8205
position_predict: train acc 0.9676 p 0.8710 r 0.8438 f1 0.8571
step 50: train loss 0.1294 
cause_predict: train acc 0.9896 p 0.9706 r 0.9706 f1 0.9706
position_predict: train acc 0.9740 p 0.9355 r 0.9062 f1 0.9206
step 60: train loss 0.1936 
cause_predict: train acc 0.9598 p 0.8919 r 0.8684 f1 0.8800
position_predict: train acc 0.9598 p 0.9000 r 0.8182 f1 0.8571
step 70: train loss 0.1079 
cause_predict: train acc 0.9834 p 0.9231 r 0.9474 f1 0.9351
position_predict: train acc 0.9801 p 0.9062 r 0.9062 f1 0.9062

epoch 12: test loss 0.7084 cost time: 10.5s

cause_predict: test acc 0.8767 p 0.5668 r 0.5489 f1 0.5577
max_acc 0.8901 max_p 0.6360 max_r 0.5237 max_f1 0.5744

position_predict: test acc 0.9093 p 0.6448 r 0.6516 f1 0.6482
max_acc 0.9236 max_p 0.7101 max_r 0.6829 max_f1 0.6963

Average max cause: max_acc 0.8914 max_p 0.6581 max_r 0.4858 max_f1 0.5590
Average max pos: max_acc 0.9236 max_p 0.7101 max_r 0.6829 max_f1 0.6963

step 10: train loss 0.1221 
cause_predict: train acc 0.9757 p 0.9412 r 0.9143 f1 0.9275
position_predict: train acc 0.9757 p 0.9655 r 0.8750 f1 0.9180
step 20: train loss 0.1021 
cause_predict: train acc 0.9874 p 0.9730 r 0.9474 f1 0.9600
position_predict: train acc 0.9749 p 0.8824 r 0.9375 f1 0.9091
step 30: train loss 0.0968 
cause_predict: train acc 0.9729 p 0.8378 r 0.9118 f1 0.8732
position_predict: train acc 0.9729 p 0.8966 r 0.8125 f1 0.8525
step 40: train loss 0.0873 
cause_predict: train acc 0.9864 p 0.9737 r 0.9487 f1 0.9610
position_predict: train acc 0.9909 p 0.9688 r 0.9688 f1 0.9688
step 50: train loss 0.1797 
cause_predict: train acc 0.9669 p 0.9286 r 0.8125 f1 0.8667
position_predict: train acc 0.9711 p 0.8788 r 0.9062 f1 0.8923
step 60: train loss 0.2013 
cause_predict: train acc 0.9665 p 0.8857 r 0.8857 f1 0.8857
position_predict: train acc 0.9707 p 0.9032 r 0.8750 f1 0.8889
step 70: train loss 0.1685 
cause_predict: train acc 0.9657 p 0.8788 r 0.8788 f1 0.8788
position_predict: train acc 0.9700 p 0.8571 r 0.9375 f1 0.8955

epoch 13: test loss 0.7942 cost time: 10.3s

cause_predict: test acc 0.8780 p 0.5797 r 0.5047 f1 0.5396
max_acc 0.8901 max_p 0.6360 max_r 0.5237 max_f1 0.5744

position_predict: test acc 0.9080 p 0.6421 r 0.6376 f1 0.6399
max_acc 0.9236 max_p 0.7101 max_r 0.6829 max_f1 0.6963

Average max cause: max_acc 0.8914 max_p 0.6581 max_r 0.4858 max_f1 0.5590
Average max pos: max_acc 0.9236 max_p 0.7101 max_r 0.6829 max_f1 0.6963

step 10: train loss 0.1706 
cause_predict: train acc 0.9529 p 0.8571 r 0.8108 f1 0.8333
position_predict: train acc 0.9569 p 0.8667 r 0.7879 f1 0.8254
step 20: train loss 0.0740 
cause_predict: train acc 0.9922 p 0.9583 r 1.0000 f1 0.9787
position_predict: train acc 0.9806 p 0.9091 r 0.9375 f1 0.9231
step 30: train loss 0.1505 
cause_predict: train acc 0.9619 p 0.9143 r 0.8649 f1 0.8889
position_predict: train acc 0.9762 p 0.9091 r 0.9375 f1 0.9231
step 40: train loss 0.0948 
cause_predict: train acc 0.9757 p 0.8947 r 0.9714 f1 0.9315
position_predict: train acc 0.9951 p 1.0000 r 0.9688 f1 0.9841
step 50: train loss 0.1871 
cause_predict: train acc 0.9683 p 0.8947 r 0.8947 f1 0.8947
position_predict: train acc 0.9484 p 0.7714 r 0.8438 f1 0.8060
step 60: train loss 0.0995 
cause_predict: train acc 0.9787 p 0.9250 r 0.9487 f1 0.9367
position_predict: train acc 0.9745 p 0.9333 r 0.8750 f1 0.9032
step 70: train loss 0.1587 
cause_predict: train acc 0.9826 p 0.9167 r 0.9706 f1 0.9429
position_predict: train acc 0.9522 p 0.8387 r 0.8125 f1 0.8254

epoch 14: test loss 0.8229 cost time: 10.3s

cause_predict: test acc 0.8892 p 0.6332 r 0.5174 f1 0.5694
max_acc 0.8901 max_p 0.6360 max_r 0.5237 max_f1 0.5744

position_predict: test acc 0.9053 p 0.6254 r 0.6516 f1 0.6382
max_acc 0.9236 max_p 0.7101 max_r 0.6829 max_f1 0.6963

Average max cause: max_acc 0.8914 max_p 0.6581 max_r 0.4858 max_f1 0.5590
Average max pos: max_acc 0.9236 max_p 0.7101 max_r 0.6829 max_f1 0.6963

write pair_data/Ind_BiLSTM_2/fold_7_test.txt done
write pair_data/Ind_BiLSTM_2/fold_7_train.txt done
Optimization Finished!

############# fold 7 end ###############
############# fold 8 begin ###############
load data_file: data_combine_en/fold_8_train.txt
y_position.shape (2275, 75, 2)
y_cause.shape (2275, 75, 2)
x.shape (2275, 75, 30)
sen_len.shape (2275, 75)
doc_len.shape (2275,)
n_cut 107
load data done!

load data_file: data_combine_en/fold_8_test.txt
y_position.shape (284, 75, 2)
y_cause.shape (284, 75, 2)
x.shape (284, 75, 30)
sen_len.shape (284, 75)
doc_len.shape (284,)
n_cut 22
load data done!

train docs: 2275    test docs: 284
step 10: train loss 0.8514 
cause_predict: train acc 0.8357 p 0.0000 r 0.0000 f1 0.0000
position_predict: train acc 0.8406 p 0.0000 r 0.0000 f1 0.0000
step 20: train loss 0.8861 
cause_predict: train acc 0.8073 p 0.0000 r 0.0000 f1 0.0000
position_predict: train acc 0.8532 p 0.0000 r 0.0000 f1 0.0000
step 30: train loss 0.5903 
cause_predict: train acc 0.8672 p 0.0000 r 0.0000 f1 0.0000
position_predict: train acc 0.8714 p 1.0000 r 0.0312 f1 0.0606
step 40: train loss 0.5553 
cause_predict: train acc 0.8697 p 1.0000 r 0.0811 f1 0.1500
position_predict: train acc 0.9157 p 0.6471 r 0.6875 f1 0.6667
step 50: train loss 0.6578 
cause_predict: train acc 0.8452 p 0.0000 r 0.0000 f1 0.0000
position_predict: train acc 0.9038 p 0.6923 r 0.5455 f1 0.6102
step 60: train loss 0.5246 
cause_predict: train acc 0.8889 p 0.8182 r 0.2500 f1 0.3830
position_predict: train acc 0.9234 p 0.7500 r 0.5625 f1 0.6429
step 70: train loss 0.4883 
cause_predict: train acc 0.8878 p 0.7500 r 0.2250 f1 0.3462
position_predict: train acc 0.9109 p 0.6071 r 0.5152 f1 0.5574

epoch 0: test loss 0.5287 cost time: 10.4s

cause_predict: test acc 0.8735 p 0.7931 r 0.1451 f1 0.2453
max_acc 0.8735 max_p 0.7931 max_r 0.1451 max_f1 0.2453

position_predict: test acc 0.9151 p 0.6873 r 0.6202 f1 0.6520
max_acc 0.9151 max_p 0.6873 max_r 0.6202 max_f1 0.6520

Average max cause: max_acc 0.8735 max_p 0.7931 max_r 0.1451 max_f1 0.2453
Average max pos: max_acc 0.9151 max_p 0.6873 max_r 0.6202 max_f1 0.6520

step 10: train loss 0.5232 
cause_predict: train acc 0.8571 p 0.7143 r 0.2778 f1 0.4000
position_predict: train acc 0.9333 p 0.8000 r 0.7500 f1 0.7742
step 20: train loss 0.4193 
cause_predict: train acc 0.9192 p 0.8750 r 0.4242 f1 0.5714
position_predict: train acc 0.9346 p 0.8636 r 0.5758 f1 0.6909
step 30: train loss 0.5849 
cause_predict: train acc 0.8617 p 1.0000 r 0.0789 f1 0.1463
position_predict: train acc 0.9249 p 0.8095 r 0.5312 f1 0.6415
step 40: train loss 0.5527 
cause_predict: train acc 0.8829 p 0.9286 r 0.3611 f1 0.5200
position_predict: train acc 0.8927 p 0.6786 r 0.5938 f1 0.6333
step 50: train loss 0.5584 
cause_predict: train acc 0.9066 p 0.9474 r 0.5294 f1 0.6792
position_predict: train acc 0.9286 p 0.8276 r 0.7500 f1 0.7869
step 60: train loss 0.4476 
cause_predict: train acc 0.8997 p 0.6500 r 0.3714 f1 0.4727
position_predict: train acc 0.9377 p 0.8182 r 0.5625 f1 0.6667
step 70: train loss 0.7170 
cause_predict: train acc 0.8304 p 0.6190 r 0.3824 f1 0.4727
position_predict: train acc 0.8772 p 0.7037 r 0.5938 f1 0.6441

epoch 1: test loss 0.4755 cost time: 10.2s

cause_predict: test acc 0.8914 p 0.7202 r 0.3817 f1 0.4990
max_acc 0.8914 max_p 0.7202 max_r 0.3817 max_f1 0.4990

position_predict: test acc 0.9240 p 0.7349 r 0.6376 f1 0.6828
max_acc 0.9240 max_p 0.7349 max_r 0.6376 max_f1 0.6828

Average max cause: max_acc 0.8914 max_p 0.7202 max_r 0.3817 max_f1 0.4990
Average max pos: max_acc 0.9240 max_p 0.7349 max_r 0.6376 max_f1 0.6828

step 10: train loss 0.4390 
cause_predict: train acc 0.8897 p 0.5769 r 0.4286 f1 0.4918
position_predict: train acc 0.9359 p 0.7917 r 0.5938 f1 0.6786
step 20: train loss 0.4776 
cause_predict: train acc 0.8655 p 0.5926 r 0.4571 f1 0.5161
position_predict: train acc 0.9372 p 0.8000 r 0.7500 f1 0.7742
step 30: train loss 0.4534 
cause_predict: train acc 0.8810 p 0.7500 r 0.4865 f1 0.5902
position_predict: train acc 0.9143 p 0.7500 r 0.6562 f1 0.7000
step 40: train loss 0.3864 
cause_predict: train acc 0.8982 p 0.6842 r 0.3714 f1 0.4815
position_predict: train acc 0.9382 p 0.8000 r 0.6250 f1 0.7018
step 50: train loss 0.3654 
cause_predict: train acc 0.9216 p 0.7188 r 0.6765 f1 0.6970
position_predict: train acc 0.9333 p 0.8261 r 0.5938 f1 0.6909
step 60: train loss 0.4469 
cause_predict: train acc 0.9008 p 0.7727 r 0.4595 f1 0.5763
position_predict: train acc 0.9444 p 0.8276 r 0.7273 f1 0.7742
step 70: train loss 0.4608 
cause_predict: train acc 0.8700 p 0.6667 r 0.3429 f1 0.4528
position_predict: train acc 0.9283 p 0.7500 r 0.7500 f1 0.7500

epoch 2: test loss 0.4722 cost time: 10.4s

cause_predict: test acc 0.8878 p 0.7260 r 0.3344 f1 0.4579
max_acc 0.8914 max_p 0.7202 max_r 0.3817 max_f1 0.4990

position_predict: test acc 0.9258 p 0.7531 r 0.6272 f1 0.6844
max_acc 0.9258 max_p 0.7531 max_r 0.6272 max_f1 0.6844

Average max cause: max_acc 0.8914 max_p 0.7202 max_r 0.3817 max_f1 0.4990
Average max pos: max_acc 0.9240 max_p 0.7349 max_r 0.6376 max_f1 0.6828

step 10: train loss 0.4400 
cause_predict: train acc 0.8667 p 0.5000 r 0.3947 f1 0.4412
position_predict: train acc 0.9298 p 0.7143 r 0.6250 f1 0.6667
step 20: train loss 0.4145 
cause_predict: train acc 0.8765 p 0.5455 r 0.3636 f1 0.4364
position_predict: train acc 0.9482 p 0.7941 r 0.8182 f1 0.8060
step 30: train loss 0.3988 
cause_predict: train acc 0.9261 p 0.8846 r 0.6970 f1 0.7797
position_predict: train acc 0.9205 p 0.7647 r 0.8125 f1 0.7879
step 40: train loss 0.4259 
cause_predict: train acc 0.8819 p 0.5172 r 0.4545 f1 0.4839
position_predict: train acc 0.9520 p 0.8800 r 0.6875 f1 0.7719
step 50: train loss 0.4240 
cause_predict: train acc 0.8719 p 0.6111 r 0.2750 f1 0.3793
position_predict: train acc 0.9502 p 0.8214 r 0.7188 f1 0.7667
step 60: train loss 0.3517 
cause_predict: train acc 0.9111 p 0.8065 r 0.6410 f1 0.7143
position_predict: train acc 0.9333 p 0.7576 r 0.7812 f1 0.7692
step 70: train loss 0.4810 
cause_predict: train acc 0.9033 p 0.7222 r 0.3824 f1 0.5000
position_predict: train acc 0.9071 p 0.6207 r 0.5625 f1 0.5902

epoch 3: test loss 0.4680 cost time: 10.4s

cause_predict: test acc 0.8995 p 0.7396 r 0.4479 f1 0.5580
max_acc 0.8995 max_p 0.7396 max_r 0.4479 max_f1 0.5580

position_predict: test acc 0.9147 p 0.6765 r 0.6411 f1 0.6583
max_acc 0.9258 max_p 0.7531 max_r 0.6272 max_f1 0.6844

Average max cause: max_acc 0.8995 max_p 0.7396 max_r 0.4479 max_f1 0.5580
Average max pos: max_acc 0.9147 max_p 0.6765 max_r 0.6411 max_f1 0.6583

step 10: train loss 0.4799 
cause_predict: train acc 0.8597 p 0.5909 r 0.3714 f1 0.4561
position_predict: train acc 0.9050 p 0.7500 r 0.5455 f1 0.6316
step 20: train loss 0.4471 
cause_predict: train acc 0.9193 p 0.8333 r 0.6579 f1 0.7353
position_predict: train acc 0.9327 p 0.7812 r 0.7576 f1 0.7692
step 30: train loss 0.3296 
cause_predict: train acc 0.9163 p 0.8077 r 0.5676 f1 0.6667
position_predict: train acc 0.9482 p 0.8333 r 0.7576 f1 0.7937
step 40: train loss 0.3922 
cause_predict: train acc 0.9037 p 0.6800 r 0.4857 f1 0.5667
position_predict: train acc 0.9296 p 0.7407 r 0.6250 f1 0.6780
step 50: train loss 0.5094 
cause_predict: train acc 0.9013 p 0.7600 r 0.5278 f1 0.6230
position_predict: train acc 0.9399 p 0.9091 r 0.6250 f1 0.7407
step 60: train loss 0.3360 
cause_predict: train acc 0.9245 p 0.8636 r 0.5135 f1 0.6441
position_predict: train acc 0.9532 p 0.8800 r 0.6875 f1 0.7719
step 70: train loss 0.4554 
cause_predict: train acc 0.8829 p 0.8095 r 0.4359 f1 0.5667
position_predict: train acc 0.9414 p 0.8276 r 0.7500 f1 0.7869

epoch 4: test loss 0.4649 cost time: 10.5s

cause_predict: test acc 0.8919 p 0.6794 r 0.4479 f1 0.5399
max_acc 0.8995 max_p 0.7396 max_r 0.4479 max_f1 0.5580

position_predict: test acc 0.9214 p 0.6975 r 0.6829 f1 0.6901
max_acc 0.9214 max_p 0.6975 max_r 0.6829 max_f1 0.6901

Average max cause: max_acc 0.8919 max_p 0.6794 max_r 0.4479 max_f1 0.5399
Average max pos: max_acc 0.9214 max_p 0.6975 max_r 0.6829 max_f1 0.6901

step 10: train loss 0.3397 
cause_predict: train acc 0.9390 p 0.9583 r 0.5750 f1 0.7188
position_predict: train acc 0.9492 p 0.7931 r 0.7188 f1 0.7541
step 20: train loss 0.2835 
cause_predict: train acc 0.9394 p 0.8148 r 0.6667 f1 0.7333
position_predict: train acc 0.9432 p 0.7742 r 0.7500 f1 0.7619
step 30: train loss 0.2804 
cause_predict: train acc 0.9237 p 0.7500 r 0.6176 f1 0.6774
position_predict: train acc 0.9580 p 0.8438 r 0.8182 f1 0.8308
step 40: train loss 0.3298 
cause_predict: train acc 0.9258 p 0.8261 r 0.5938 f1 0.6909
position_predict: train acc 0.9563 p 0.8667 r 0.8125 f1 0.8387
step 50: train loss 0.2920 
cause_predict: train acc 0.9467 p 0.8214 r 0.6765 f1 0.7419
position_predict: train acc 0.9533 p 0.8000 r 0.7500 f1 0.7742
step 60: train loss 0.3405 
cause_predict: train acc 0.9248 p 0.8235 r 0.4118 f1 0.5490
position_predict: train acc 0.9477 p 0.7353 r 0.7812 f1 0.7576
step 70: train loss 0.4152 
cause_predict: train acc 0.9062 p 0.7917 r 0.5429 f1 0.6441
position_predict: train acc 0.9286 p 0.7500 r 0.7500 f1 0.7500

epoch 5: test loss 0.4813 cost time: 10.1s

cause_predict: test acc 0.8954 p 0.7005 r 0.4574 f1 0.5534
max_acc 0.8995 max_p 0.7396 max_r 0.4479 max_f1 0.5580

position_predict: test acc 0.9240 p 0.7112 r 0.6864 f1 0.6986
max_acc 0.9240 max_p 0.7112 max_r 0.6864 max_f1 0.6986

Average max cause: max_acc 0.8954 max_p 0.7005 max_r 0.4574 max_f1 0.5534
Average max pos: max_acc 0.9240 max_p 0.7112 max_r 0.6864 max_f1 0.6986

step 10: train loss 0.3248 
cause_predict: train acc 0.9280 p 0.8387 r 0.6500 f1 0.7324
position_predict: train acc 0.9621 p 0.8235 r 0.8750 f1 0.8485
step 20: train loss 0.2509 
cause_predict: train acc 0.9455 p 0.9167 r 0.6286 f1 0.7458
position_predict: train acc 0.9709 p 0.9286 r 0.8125 f1 0.8667
step 30: train loss 0.2789 
cause_predict: train acc 0.9167 p 0.8462 r 0.6111 f1 0.7097
position_predict: train acc 0.9815 p 0.9375 r 0.9375 f1 0.9375
step 40: train loss 0.3009 
cause_predict: train acc 0.9355 p 0.7576 r 0.6757 f1 0.7143
position_predict: train acc 0.9516 p 0.7742 r 0.7500 f1 0.7619
step 50: train loss 0.3247 
cause_predict: train acc 0.9118 p 0.6786 r 0.5588 f1 0.6129
position_predict: train acc 0.9559 p 0.8621 r 0.7576 f1 0.8065
step 60: train loss 0.2528 
cause_predict: train acc 0.9449 p 0.8667 r 0.7222 f1 0.7879
position_predict: train acc 0.9409 p 0.7742 r 0.7500 f1 0.7619
step 70: train loss 0.2948 
cause_predict: train acc 0.9231 p 0.7308 r 0.5758 f1 0.6441
position_predict: train acc 0.9304 p 0.6857 r 0.7500 f1 0.7164

epoch 6: test loss 0.5096 cost time: 10.3s

cause_predict: test acc 0.8932 p 0.6667 r 0.4921 f1 0.5662
max_acc 0.8932 max_p 0.6667 max_r 0.4921 max_f1 0.5662

position_predict: test acc 0.9240 p 0.7010 r 0.7108 f1 0.7059
max_acc 0.9240 max_p 0.7010 max_r 0.7108 max_f1 0.7059

Average max cause: max_acc 0.8932 max_p 0.6667 max_r 0.4921 max_f1 0.5662
Average max pos: max_acc 0.9240 max_p 0.7010 max_r 0.7108 max_f1 0.7059

step 10: train loss 0.2187 
cause_predict: train acc 0.9453 p 0.8108 r 0.7895 f1 0.8000
position_predict: train acc 0.9635 p 0.8750 r 0.8235 f1 0.8485
step 20: train loss 0.2518 
cause_predict: train acc 0.9406 p 0.8286 r 0.8056 f1 0.8169
position_predict: train acc 0.9772 p 0.9667 r 0.8788 f1 0.9206
step 30: train loss 0.2127 
cause_predict: train acc 0.9406 p 0.8387 r 0.7879 f1 0.8125
position_predict: train acc 0.9653 p 0.8788 r 0.9062 f1 0.8923
step 40: train loss 0.4113 
cause_predict: train acc 0.9148 p 0.7879 r 0.7647 f1 0.7761
position_predict: train acc 0.9489 p 0.8966 r 0.8125 f1 0.8525
step 50: train loss 0.2625 
cause_predict: train acc 0.9356 p 0.8667 r 0.7429 f1 0.8000
position_predict: train acc 0.9554 p 0.8966 r 0.8125 f1 0.8525
step 60: train loss 0.2633 
cause_predict: train acc 0.9261 p 0.8148 r 0.6875 f1 0.7458
position_predict: train acc 0.9507 p 0.9259 r 0.7576 f1 0.8333
step 70: train loss 0.3396 
cause_predict: train acc 0.9279 p 0.7368 r 0.8485 f1 0.7887
position_predict: train acc 0.9615 p 0.8824 r 0.8824 f1 0.8824

epoch 7: test loss 0.5388 cost time: 10.6s

cause_predict: test acc 0.8892 p 0.6273 r 0.5363 f1 0.5782
max_acc 0.8892 max_p 0.6273 max_r 0.5363 max_f1 0.5782

position_predict: test acc 0.9178 p 0.6770 r 0.6864 f1 0.6817
max_acc 0.9240 max_p 0.7010 max_r 0.7108 max_f1 0.7059

Average max cause: max_acc 0.8932 max_p 0.6667 max_r 0.4921 max_f1 0.5662
Average max pos: max_acc 0.9240 max_p 0.7010 max_r 0.7108 max_f1 0.7059

step 10: train loss 0.2112 
cause_predict: train acc 0.9665 p 0.9655 r 0.8000 f1 0.8750
position_predict: train acc 0.9749 p 0.9062 r 0.9062 f1 0.9062
step 20: train loss 0.1956 
cause_predict: train acc 0.9613 p 0.8571 r 0.7500 f1 0.8000
position_predict: train acc 0.9645 p 0.8387 r 0.8125 f1 0.8254
step 30: train loss 0.2138 
cause_predict: train acc 0.9563 p 0.8485 r 0.8485 f1 0.8485
position_predict: train acc 0.9694 p 0.9032 r 0.8750 f1 0.8889
step 40: train loss 0.2455 
cause_predict: train acc 0.9345 p 0.8929 r 0.6757 f1 0.7692
position_predict: train acc 0.9607 p 0.8485 r 0.8750 f1 0.8615
step 50: train loss 0.3107 
cause_predict: train acc 0.9008 p 0.7333 r 0.5789 f1 0.6471
position_predict: train acc 0.9669 p 0.8750 r 0.8750 f1 0.8750
step 60: train loss 0.1593 
cause_predict: train acc 0.9547 p 0.9032 r 0.7000 f1 0.7887
position_predict: train acc 0.9819 p 0.9333 r 0.8750 f1 0.9032
step 70: train loss 0.2812 
cause_predict: train acc 0.9283 p 0.8788 r 0.7073 f1 0.7838
position_predict: train acc 0.9462 p 0.7778 r 0.8750 f1 0.8235

epoch 8: test loss 0.5548 cost time: 10.1s

cause_predict: test acc 0.8923 p 0.6407 r 0.5457 f1 0.5894
max_acc 0.8923 max_p 0.6407 max_r 0.5457 max_f1 0.5894

position_predict: test acc 0.9214 p 0.6989 r 0.6794 f1 0.6890
max_acc 0.9240 max_p 0.7010 max_r 0.7108 max_f1 0.7059

Average max cause: max_acc 0.8923 max_p 0.6407 max_r 0.5457 max_f1 0.5894
Average max pos: max_acc 0.9214 max_p 0.6989 max_r 0.6794 max_f1 0.6890

step 10: train loss 0.1853 
cause_predict: train acc 0.9643 p 0.9118 r 0.8158 f1 0.8611
position_predict: train acc 0.9750 p 0.9032 r 0.8750 f1 0.8889
step 20: train loss 0.1932 
cause_predict: train acc 0.9648 p 0.9143 r 0.8649 f1 0.8889
position_predict: train acc 0.9692 p 0.9062 r 0.8788 f1 0.8923
step 30: train loss 0.2427 
cause_predict: train acc 0.9504 p 0.8378 r 0.8378 f1 0.8378
position_predict: train acc 0.9587 p 0.8438 r 0.8438 f1 0.8438
step 40: train loss 0.1978 
cause_predict: train acc 0.9679 p 0.8529 r 0.8529 f1 0.8529
position_predict: train acc 0.9423 p 0.7333 r 0.6875 f1 0.7097
step 50: train loss 0.2070 
cause_predict: train acc 0.9597 p 0.8529 r 0.8529 f1 0.8529
position_predict: train acc 0.9758 p 0.9062 r 0.9062 f1 0.9062
step 60: train loss 0.3002 
cause_predict: train acc 0.9190 p 0.7879 r 0.6667 f1 0.7222
position_predict: train acc 0.9555 p 0.7838 r 0.9062 f1 0.8406
step 70: train loss 0.2629 
cause_predict: train acc 0.9550 p 0.9355 r 0.8056 f1 0.8657
position_predict: train acc 0.9400 p 0.7941 r 0.8438 f1 0.8182

epoch 9: test loss 0.5740 cost time: 10.2s

cause_predict: test acc 0.8981 p 0.6831 r 0.5237 f1 0.5929
max_acc 0.8981 max_p 0.6831 max_r 0.5237 max_f1 0.5929

position_predict: test acc 0.9178 p 0.6758 r 0.6899 f1 0.6828
max_acc 0.9240 max_p 0.7010 max_r 0.7108 max_f1 0.7059

Average max cause: max_acc 0.8923 max_p 0.6407 max_r 0.5457 max_f1 0.5894
Average max pos: max_acc 0.9214 max_p 0.6989 max_r 0.6794 max_f1 0.6890

step 10: train loss 0.1624 
cause_predict: train acc 0.9717 p 0.9091 r 0.9091 f1 0.9091
position_predict: train acc 0.9717 p 0.9333 r 0.8750 f1 0.9032
step 20: train loss 0.1921 
cause_predict: train acc 0.9459 p 0.8750 r 0.8235 f1 0.8485
position_predict: train acc 0.9514 p 0.8485 r 0.8750 f1 0.8615
step 30: train loss 0.2115 
cause_predict: train acc 0.9455 p 0.9189 r 0.7907 f1 0.8500
position_predict: train acc 0.9727 p 0.9062 r 0.9062 f1 0.9062
step 40: train loss 0.1575 
cause_predict: train acc 0.9658 p 0.9032 r 0.8485 f1 0.8750
position_predict: train acc 0.9744 p 0.9355 r 0.8788 f1 0.9062
step 50: train loss 0.1837 
cause_predict: train acc 0.9610 p 0.8889 r 0.8649 f1 0.8767
position_predict: train acc 0.9697 p 0.9032 r 0.8750 f1 0.8889
step 60: train loss 0.1565 
cause_predict: train acc 0.9701 p 0.8788 r 0.9062 f1 0.8923
position_predict: train acc 0.9744 p 0.9355 r 0.8788 f1 0.9062
step 70: train loss 0.2297 
cause_predict: train acc 0.9580 p 0.9643 r 0.7297 f1 0.8308
position_predict: train acc 0.9618 p 0.8710 r 0.8182 f1 0.8438

epoch 10: test loss 0.5909 cost time: 10.2s

cause_predict: test acc 0.8963 p 0.6721 r 0.5237 f1 0.5887
max_acc 0.8981 max_p 0.6831 max_r 0.5237 max_f1 0.5929

position_predict: test acc 0.9182 p 0.6912 r 0.6551 f1 0.6726
max_acc 0.9240 max_p 0.7010 max_r 0.7108 max_f1 0.7059

Average max cause: max_acc 0.8923 max_p 0.6407 max_r 0.5457 max_f1 0.5894
Average max pos: max_acc 0.9214 max_p 0.6989 max_r 0.6794 max_f1 0.6890

step 10: train loss 0.1236 
cause_predict: train acc 0.9625 p 0.9355 r 0.8056 f1 0.8657
position_predict: train acc 0.9833 p 0.9375 r 0.9375 f1 0.9375
step 20: train loss 0.1333 
cause_predict: train acc 0.9817 p 0.9722 r 0.9211 f1 0.9459
position_predict: train acc 0.9725 p 0.9062 r 0.9062 f1 0.9062
step 30: train loss 0.1433 
cause_predict: train acc 0.9759 p 0.9444 r 0.8947 f1 0.9189
position_predict: train acc 0.9759 p 0.9062 r 0.9062 f1 0.9062
step 40: train loss 0.1562 
cause_predict: train acc 0.9670 p 0.8611 r 0.8611 f1 0.8611
position_predict: train acc 0.9604 p 0.7778 r 0.8750 f1 0.8235
step 50: train loss 0.1941 
cause_predict: train acc 0.9755 p 0.9429 r 0.9167 f1 0.9296
position_predict: train acc 0.9510 p 0.8667 r 0.8125 f1 0.8387
step 60: train loss 0.3350 
cause_predict: train acc 0.9315 p 0.7778 r 0.8000 f1 0.7887
position_predict: train acc 0.9361 p 0.7647 r 0.8125 f1 0.7879
step 70: train loss 0.2093 
cause_predict: train acc 0.9603 p 0.8857 r 0.8378 f1 0.8611
position_predict: train acc 0.9643 p 0.8485 r 0.8750 f1 0.8615

epoch 11: test loss 0.6543 cost time: 10.2s

cause_predict: test acc 0.8852 p 0.6071 r 0.5363 f1 0.5695
max_acc 0.8981 max_p 0.6831 max_r 0.5237 max_f1 0.5929

position_predict: test acc 0.9191 p 0.6866 r 0.6794 f1 0.6830
max_acc 0.9240 max_p 0.7010 max_r 0.7108 max_f1 0.7059

Average max cause: max_acc 0.8923 max_p 0.6407 max_r 0.5457 max_f1 0.5894
2024-06-22 19:21:08.964378: W tensorflow/c/c_api.cc:304] Operation '{name:'softmax_b_pos/Adam_1/Assign' id:5023 op device:{requested: '', assigned: ''} def:{{{node softmax_b_pos/Adam_1/Assign}} = Assign[T=DT_FLOAT, _class=["loc:@softmax_b_pos"], _has_manual_control_dependencies=true, use_locking=true, validate_shape=true](softmax_b_pos/Adam_1, softmax_b_pos/Adam_1/Initializer/zeros)}}' was changed by setting attribute after it was run by a session. This mutation will have no effect, and will trigger an error in the future. Either don't modify nodes after running them or create a new session.
Average max pos: max_acc 0.9214 max_p 0.6989 max_r 0.6794 max_f1 0.6890

step 10: train loss 0.1926 
cause_predict: train acc 0.9596 p 0.9032 r 0.8235 f1 0.8615
position_predict: train acc 0.9686 p 0.8788 r 0.9062 f1 0.8923
step 20: train loss 0.1161 
cause_predict: train acc 0.9888 p 1.0000 r 0.9231 f1 0.9600
position_predict: train acc 0.9776 p 0.9062 r 0.9062 f1 0.9062
step 30: train loss 0.0919 
cause_predict: train acc 0.9719 p 0.9062 r 0.8788 f1 0.8923
position_predict: train acc 0.9839 p 0.9375 r 0.9375 f1 0.9375
step 40: train loss 0.2160 
cause_predict: train acc 0.9421 p 0.8750 r 0.7368 f1 0.8000
position_predict: train acc 0.9545 p 0.8387 r 0.8125 f1 0.8254
step 50: train loss 0.2624 
cause_predict: train acc 0.9609 p 0.8788 r 0.8056 f1 0.8406
position_predict: train acc 0.9181 p 0.6774 r 0.6176 f1 0.6462
step 60: train loss 0.0982 
cause_predict: train acc 0.9960 p 0.9714 r 1.0000 f1 0.9855
position_predict: train acc 0.9681 p 0.9032 r 0.8485 f1 0.8750
step 70: train loss 0.1075 
cause_predict: train acc 0.9812 p 0.9429 r 0.8919 f1 0.9167
position_predict: train acc 0.9875 p 0.9375 r 0.9375 f1 0.9375

epoch 12: test loss 0.6671 cost time: 10.6s

cause_predict: test acc 0.8856 p 0.6142 r 0.5174 f1 0.5616
max_acc 0.8981 max_p 0.6831 max_r 0.5237 max_f1 0.5929

position_predict: test acc 0.9187 p 0.6895 r 0.6655 f1 0.6773
max_acc 0.9240 max_p 0.7010 max_r 0.7108 max_f1 0.7059

Average max cause: max_acc 0.8923 max_p 0.6407 max_r 0.5457 max_f1 0.5894
Average max pos: max_acc 0.9214 max_p 0.6989 max_r 0.6794 max_f1 0.6890

step 10: train loss 0.1106 
cause_predict: train acc 0.9711 p 0.9143 r 0.8889 f1 0.9014
position_predict: train acc 0.9876 p 0.9677 r 0.9375 f1 0.9524
step 20: train loss 0.1092 
cause_predict: train acc 0.9821 p 0.9697 r 0.9143 f1 0.9412
position_predict: train acc 0.9641 p 0.8333 r 0.9375 f1 0.8824
step 30: train loss 0.0984 
cause_predict: train acc 0.9745 p 0.9118 r 0.8857 f1 0.8986
position_predict: train acc 0.9818 p 0.9091 r 0.9375 f1 0.9231
step 40: train loss 0.1265 
cause_predict: train acc 0.9846 p 0.9714 r 0.9189 f1 0.9444
position_predict: train acc 0.9730 p 0.9333 r 0.8485 f1 0.8889
step 50: train loss 0.1364 
cause_predict: train acc 0.9662 p 0.9143 r 0.8649 f1 0.8889
position_predict: train acc 0.9705 p 0.8788 r 0.9062 f1 0.8923
step 60: train loss 0.1852 
cause_predict: train acc 0.9544 p 0.8684 r 0.8462 f1 0.8571
position_predict: train acc 0.9544 p 0.8621 r 0.7812 f1 0.8197
step 70: train loss 0.2268 
cause_predict: train acc 0.9495 p 0.7949 r 0.7949 f1 0.7949
position_predict: train acc 0.9558 p 0.7812 r 0.7812 f1 0.7812

epoch 13: test loss 0.6976 cost time: 10.6s

cause_predict: test acc 0.8856 p 0.6125 r 0.5237 f1 0.5646
max_acc 0.8981 max_p 0.6831 max_r 0.5237 max_f1 0.5929

position_predict: test acc 0.9196 p 0.6789 r 0.7073 f1 0.6928
max_acc 0.9240 max_p 0.7010 max_r 0.7108 max_f1 0.7059

Average max cause: max_acc 0.8923 max_p 0.6407 max_r 0.5457 max_f1 0.5894
Average max pos: max_acc 0.9214 max_p 0.6989 max_r 0.6794 max_f1 0.6890

step 10: train loss 0.1260 
cause_predict: train acc 0.9818 p 0.9231 r 0.9730 f1 0.9474
position_predict: train acc 0.9591 p 0.8485 r 0.8750 f1 0.8615
step 20: train loss 0.0793 
cause_predict: train acc 0.9837 p 1.0000 r 0.9000 f1 0.9474
position_predict: train acc 0.9919 p 0.9688 r 0.9688 f1 0.9688
step 30: train loss 0.2093 
cause_predict: train acc 0.9693 p 0.9189 r 0.8947 f1 0.9067
position_predict: train acc 0.9342 p 0.7742 r 0.7500 f1 0.7619
step 40: train loss 0.1178 
cause_predict: train acc 0.9767 p 0.9697 r 0.9143 f1 0.9412
position_predict: train acc 0.9651 p 0.9375 r 0.8824 f1 0.9091
step 50: train loss 0.1314 
cause_predict: train acc 0.9732 p 0.8919 r 0.9429 f1 0.9167
position_predict: train acc 0.9911 p 0.9688 r 0.9688 f1 0.9688
step 60: train loss 0.1307 
cause_predict: train acc 0.9815 p 0.9474 r 0.9231 f1 0.9351
position_predict: train acc 0.9741 p 0.9062 r 0.8788 f1 0.8923
step 70: train loss 0.0683 
cause_predict: train acc 0.9955 p 1.0000 r 0.9688 f1 0.9841
position_predict: train acc 0.9864 p 0.9677 r 0.9375 f1 0.9524

epoch 14: test loss 0.7076 cost time: 10.5s

cause_predict: test acc 0.8820 p 0.5911 r 0.5426 f1 0.5658
max_acc 0.8981 max_p 0.6831 max_r 0.5237 max_f1 0.5929

position_predict: test acc 0.9173 p 0.6735 r 0.6899 f1 0.6816
max_acc 0.9240 max_p 0.7010 max_r 0.7108 max_f1 0.7059

Average max cause: max_acc 0.8923 max_p 0.6407 max_r 0.5457 max_f1 0.5894
Average max pos: max_acc 0.9214 max_p 0.6989 max_r 0.6794 max_f1 0.6890

write pair_data/Ind_BiLSTM_2/fold_8_test.txt done
write pair_data/Ind_BiLSTM_2/fold_8_train.txt done
Optimization Finished!

############# fold 8 end ###############
############# fold 9 begin ###############
load data_file: data_combine_en/fold_9_train.txt
y_position.shape (2275, 75, 2)
y_cause.shape (2275, 75, 2)
x.shape (2275, 75, 30)
sen_len.shape (2275, 75)
doc_len.shape (2275,)
n_cut 107
load data done!

load data_file: data_combine_en/fold_9_test.txt
y_position.shape (284, 75, 2)
y_cause.shape (284, 75, 2)
x.shape (284, 75, 30)
sen_len.shape (284, 75)
doc_len.shape (284,)
n_cut 22
load data done!

train docs: 2275    test docs: 284
step 10: train loss 0.7647 
cause_predict: train acc 0.8664 p 0.0000 r 0.0000 f1 0.0000
position_predict: train acc 0.8845 p 0.0000 r 0.0000 f1 0.0000
step 20: train loss 0.7491 
cause_predict: train acc 0.8514 p 0.0000 r 0.0000 f1 0.0000
position_predict: train acc 0.8675 p 0.0000 r 0.0000 f1 0.0000
step 30: train loss 0.7489 
cause_predict: train acc 0.8378 p 0.0000 r 0.0000 f1 0.0000
position_predict: train acc 0.8559 p 0.0000 r 0.0000 f1 0.0000
step 40: train loss 0.6597 
cause_predict: train acc 0.8565 p 0.0000 r 0.0000 f1 0.0000
position_predict: train acc 0.8565 p 0.0000 r 0.0000 f1 0.0000
step 50: train loss 0.6854 
cause_predict: train acc 0.8276 p 0.0000 r 0.0000 f1 0.0000
position_predict: train acc 0.8621 p 0.5909 r 0.4062 f1 0.4815
step 60: train loss 0.5357 
cause_predict: train acc 0.8760 p 1.0000 r 0.0909 f1 0.1667
position_predict: train acc 0.8926 p 0.5938 r 0.5938 f1 0.5938
step 70: train loss 0.5743 
cause_predict: train acc 0.8541 p 0.8000 r 0.1081 f1 0.1905
position_predict: train acc 0.8884 p 0.6364 r 0.4375 f1 0.5185

epoch 0: test loss 0.5330 cost time: 10.4s

cause_predict: test acc 0.8803 p 0.6690 r 0.3060 f1 0.4199
max_acc 0.8803 max_p 0.6690 max_r 0.3060 max_f1 0.4199

position_predict: test acc 0.9111 p 0.6654 r 0.6167 f1 0.6401
max_acc 0.9111 max_p 0.6654 max_r 0.6167 max_f1 0.6401

Average max cause: max_acc 0.8803 max_p 0.6690 max_r 0.3060 max_f1 0.4199
Average max pos: max_acc 0.9111 max_p 0.6654 max_r 0.6167 max_f1 0.6401

step 10: train loss 0.5571 
cause_predict: train acc 0.8564 p 0.8750 r 0.2059 f1 0.3333
position_predict: train acc 0.8923 p 0.6897 r 0.6250 f1 0.6557
step 20: train loss 0.6571 
cause_predict: train acc 0.8138 p 0.4000 r 0.0588 f1 0.1026
position_predict: train acc 0.8723 p 0.6538 r 0.5312 f1 0.5862
step 30: train loss 0.4781 
cause_predict: train acc 0.8803 p 0.6429 r 0.4615 f1 0.5373
position_predict: train acc 0.9614 p 0.9231 r 0.7500 f1 0.8276
step 40: train loss 0.5271 
cause_predict: train acc 0.8609 p 0.5909 r 0.3611 f1 0.4483
position_predict: train acc 0.9304 p 0.7857 r 0.6875 f1 0.7333
step 50: train loss 0.5788 
cause_predict: train acc 0.8706 p 0.5556 r 0.4167 f1 0.4762
position_predict: train acc 0.9020 p 0.6207 r 0.5625 f1 0.5902
step 60: train loss 0.5200 
cause_predict: train acc 0.8881 p 0.6154 r 0.4444 f1 0.5161
position_predict: train acc 0.9030 p 0.6000 r 0.5625 f1 0.5806
step 70: train loss 0.4499 
cause_predict: train acc 0.9123 p 0.8889 r 0.4706 f1 0.6154
position_predict: train acc 0.9430 p 0.7879 r 0.8125 f1 0.8000

epoch 1: test loss 0.4791 cost time: 10.3s

cause_predict: test acc 0.8896 p 0.7692 r 0.3155 f1 0.4474
max_acc 0.8896 max_p 0.7692 max_r 0.3155 max_f1 0.4474

position_predict: test acc 0.9272 p 0.7422 r 0.6620 f1 0.6998
max_acc 0.9272 max_p 0.7422 max_r 0.6620 max_f1 0.6998

Average max cause: max_acc 0.8896 max_p 0.7692 max_r 0.3155 max_f1 0.4474
Average max pos: max_acc 0.9272 max_p 0.7422 max_r 0.6620 max_f1 0.6998

step 10: train loss 0.4897 
cause_predict: train acc 0.8485 p 0.5000 r 0.2286 f1 0.3137
position_predict: train acc 0.9351 p 0.8148 r 0.6875 f1 0.7458
step 20: train loss 0.4525 
cause_predict: train acc 0.8612 p 0.8333 r 0.1316 f1 0.2273
position_predict: train acc 0.9551 p 0.8182 r 0.8438 f1 0.8308
step 30: train loss 0.5493 
cause_predict: train acc 0.8631 p 0.6429 r 0.2432 f1 0.3529
position_predict: train acc 0.8963 p 0.6129 r 0.5938 f1 0.6032
step 40: train loss 0.3385 
cause_predict: train acc 0.9155 p 0.7188 r 0.7188 f1 0.7188
position_predict: train acc 0.9531 p 0.9259 r 0.7576 f1 0.8333
step 50: train loss 0.3737 
cause_predict: train acc 0.9109 p 0.7500 r 0.2368 f1 0.3600
position_predict: train acc 0.9471 p 0.7917 r 0.5758 f1 0.6667
step 60: train loss 0.4241 
cause_predict: train acc 0.9175 p 0.8261 r 0.5938 f1 0.6909
position_predict: train acc 0.9175 p 0.7586 r 0.6875 f1 0.7213
step 70: train loss 0.4257 
cause_predict: train acc 0.8843 p 0.6471 r 0.3056 f1 0.4151
position_predict: train acc 0.9478 p 0.8750 r 0.6562 f1 0.7500

epoch 2: test loss 0.4714 cost time: 10.6s

cause_predict: test acc 0.8843 p 0.6686 r 0.3628 f1 0.4703
max_acc 0.8843 max_p 0.6686 max_r 0.3628 max_f1 0.4703

position_predict: test acc 0.9263 p 0.7500 r 0.6376 f1 0.6893
max_acc 0.9272 max_p 0.7422 max_r 0.6620 max_f1 0.6998

Average max cause: max_acc 0.8843 max_p 0.6686 max_r 0.3628 max_f1 0.4703
Average max pos: max_acc 0.9263 max_p 0.7500 max_r 0.6376 max_f1 0.6893

step 10: train loss 0.4474 
cause_predict: train acc 0.8989 p 0.7222 r 0.3714 f1 0.4906
position_predict: train acc 0.9438 p 0.8214 r 0.6970 f1 0.7541
step 20: train loss 0.3644 
cause_predict: train acc 0.8925 p 0.5789 r 0.3056 f1 0.4000
position_predict: train acc 0.9674 p 0.8438 r 0.8438 f1 0.8438
step 30: train loss 0.5388 
cause_predict: train acc 0.8645 p 0.6471 r 0.2821 f1 0.3929
position_predict: train acc 0.9243 p 0.7407 r 0.6250 f1 0.6780
step 40: train loss 0.4913 
cause_predict: train acc 0.8634 p 0.6923 r 0.5143 f1 0.5902
position_predict: train acc 0.9126 p 0.7500 r 0.7500 f1 0.7500
step 50: train loss 0.4135 
cause_predict: train acc 0.9091 p 0.7857 r 0.2973 f1 0.4314
position_predict: train acc 0.9310 p 0.6667 r 0.6250 f1 0.6452
step 60: train loss 0.4246 
cause_predict: train acc 0.9078 p 0.7586 r 0.6471 f1 0.6984
position_predict: train acc 0.8932 p 0.7037 r 0.5758 f1 0.6333
step 70: train loss 0.4526 
cause_predict: train acc 0.8787 p 0.7647 r 0.3421 f1 0.4727
position_predict: train acc 0.9331 p 0.7667 r 0.7188 f1 0.7419

epoch 3: test loss 0.4813 cost time: 10.3s

cause_predict: test acc 0.8780 p 0.7245 r 0.2240 f1 0.3422
max_acc 0.8843 max_p 0.6686 max_r 0.3628 max_f1 0.4703

position_predict: test acc 0.9285 p 0.7797 r 0.6167 f1 0.6887
max_acc 0.9272 max_p 0.7422 max_r 0.6620 max_f1 0.6998

Average max cause: max_acc 0.8843 max_p 0.6686 max_r 0.3628 max_f1 0.4703
Average max pos: max_acc 0.9263 max_p 0.7500 max_r 0.6376 max_f1 0.6893

step 10: train loss 0.3708 
cause_predict: train acc 0.9153 p 0.7241 r 0.6176 f1 0.6667
position_predict: train acc 0.9476 p 0.8571 r 0.7273 f1 0.7869
step 20: train loss 0.3312 
cause_predict: train acc 0.8947 p 0.6667 r 0.5946 f1 0.6286
position_predict: train acc 0.9595 p 0.8485 r 0.8485 f1 0.8485
step 30: train loss 0.5126 
cause_predict: train acc 0.8263 p 0.4400 r 0.2895 f1 0.3492
position_predict: train acc 0.9153 p 0.7241 r 0.6364 f1 0.6774
step 40: train loss 0.3415 
cause_predict: train acc 0.9351 p 0.8333 r 0.7143 f1 0.7692
position_predict: train acc 0.9481 p 0.8438 r 0.7941 f1 0.8182
step 50: train loss 0.4638 
cause_predict: train acc 0.8843 p 0.6129 r 0.5429 f1 0.5758
position_predict: train acc 0.9091 p 0.6897 r 0.6061 f1 0.6452
step 60: train loss 0.4101 
cause_predict: train acc 0.8951 p 0.6129 r 0.5135 f1 0.5588
position_predict: train acc 0.9301 p 0.6765 r 0.7188 f1 0.6970
step 70: train loss 0.3318 
cause_predict: train acc 0.9197 p 0.7778 r 0.6000 f1 0.6774
position_predict: train acc 0.9639 p 0.8710 r 0.8438 f1 0.8571

epoch 4: test loss 0.4818 cost time: 10.4s

cause_predict: test acc 0.8843 p 0.6169 r 0.4826 f1 0.5416
max_acc 0.8843 max_p 0.6169 max_r 0.4826 max_f1 0.5416

position_predict: test acc 0.9231 p 0.7091 r 0.6794 f1 0.6940
max_acc 0.9272 max_p 0.7422 max_r 0.6620 max_f1 0.6998

Average max cause: max_acc 0.8843 max_p 0.6169 max_r 0.4826 max_f1 0.5416
Average max pos: max_acc 0.9231 max_p 0.7091 max_r 0.6794 max_f1 0.6940

step 10: train loss 0.3380 
cause_predict: train acc 0.9253 p 0.8696 r 0.5263 f1 0.6557
position_predict: train acc 0.9431 p 0.7667 r 0.7188 f1 0.7419
step 20: train loss 0.4000 
cause_predict: train acc 0.9012 p 0.7742 r 0.7059 f1 0.7385
position_predict: train acc 0.8953 p 0.7059 r 0.7500 f1 0.7273
step 30: train loss 0.3368 
cause_predict: train acc 0.9173 p 0.7419 r 0.6389 f1 0.6866
position_predict: train acc 0.9409 p 0.8148 r 0.6875 f1 0.7458
step 40: train loss 0.3602 
cause_predict: train acc 0.9234 p 0.7931 r 0.6970 f1 0.7419
position_predict: train acc 0.9234 p 0.7667 r 0.7188 f1 0.7419
step 50: train loss 0.2472 
cause_predict: train acc 0.9139 p 0.6296 r 0.4722 f1 0.5397
position_predict: train acc 0.9674 p 0.8387 r 0.8125 f1 0.8254
step 60: train loss 0.3562 
cause_predict: train acc 0.9283 p 0.7500 r 0.7059 f1 0.7273
position_predict: train acc 0.9243 p 0.6757 r 0.7812 f1 0.7246
step 70: train loss 0.3584 
cause_predict: train acc 0.9163 p 0.8000 r 0.7368 f1 0.7671
position_predict: train acc 0.9458 p 0.8182 r 0.8438 f1 0.8308

epoch 5: test loss 0.5149 cost time: 10.7s

cause_predict: test acc 0.8798 p 0.6000 r 0.4543 f1 0.5171
max_acc 0.8843 max_p 0.6169 max_r 0.4826 max_f1 0.5416

position_predict: test acc 0.9240 p 0.7143 r 0.6794 f1 0.6964
max_acc 0.9272 max_p 0.7422 max_r 0.6620 max_f1 0.6998

Average max cause: max_acc 0.8843 max_p 0.6169 max_r 0.4826 max_f1 0.5416
Average max pos: max_acc 0.9231 max_p 0.7091 max_r 0.6794 max_f1 0.6940

step 10: train loss 0.2870 
cause_predict: train acc 0.9381 p 0.8710 r 0.7500 f1 0.8060
position_predict: train acc 0.9429 p 0.8182 r 0.8182 f1 0.8182
step 20: train loss 0.3105 
cause_predict: train acc 0.9259 p 0.7879 r 0.7027 f1 0.7429
position_predict: train acc 0.9588 p 0.8667 r 0.8125 f1 0.8387
step 30: train loss 0.3022 
cause_predict: train acc 0.9381 p 0.8276 r 0.7500 f1 0.7869
position_predict: train acc 0.9333 p 0.7941 r 0.7941 f1 0.7941
step 40: train loss 0.3126 
cause_predict: train acc 0.9502 p 0.8108 r 0.8571 f1 0.8333
position_predict: train acc 0.9461 p 0.8276 r 0.7500 f1 0.7869
step 50: train loss 0.2641 
cause_predict: train acc 0.9301 p 0.8333 r 0.6410 f1 0.7246
position_predict: train acc 0.9743 p 0.8788 r 0.9062 f1 0.8923
step 60: train loss 0.2954 
cause_predict: train acc 0.9200 p 0.7931 r 0.6216 f1 0.6970
position_predict: train acc 0.9480 p 0.8276 r 0.7500 f1 0.7869
step 70: train loss 0.3132 
cause_predict: train acc 0.9395 p 0.8800 r 0.6111 f1 0.7213
position_predict: train acc 0.9431 p 0.7429 r 0.7879 f1 0.7647

epoch 6: test loss 0.5387 cost time: 10.6s

cause_predict: test acc 0.8780 p 0.5815 r 0.4953 f1 0.5349
max_acc 0.8843 max_p 0.6169 max_r 0.4826 max_f1 0.5416

position_predict: test acc 0.9187 p 0.6733 r 0.7108 f1 0.6915
max_acc 0.9272 max_p 0.7422 max_r 0.6620 max_f1 0.6998

Average max cause: max_acc 0.8843 max_p 0.6169 max_r 0.4826 max_f1 0.5416
Average max pos: max_acc 0.9231 max_p 0.7091 max_r 0.6794 max_f1 0.6940

step 10: train loss 0.1828 
cause_predict: train acc 0.9587 p 0.9333 r 0.7778 f1 0.8485
position_predict: train acc 0.9669 p 0.8824 r 0.8824 f1 0.8824
step 20: train loss 0.1804 
cause_predict: train acc 0.9483 p 0.8000 r 0.8421 f1 0.8205
position_predict: train acc 0.9705 p 0.9000 r 0.8438 f1 0.8710
step 30: train loss 0.2521 
cause_predict: train acc 0.9625 p 0.9062 r 0.8056 f1 0.8529
position_predict: train acc 0.9551 p 0.8387 r 0.7879 f1 0.8125
step 40: train loss 0.2931 
cause_predict: train acc 0.9422 p 0.8000 r 0.8649 f1 0.8312
position_predict: train acc 0.9422 p 0.7778 r 0.8485 f1 0.8116
step 50: train loss 0.1778 
cause_predict: train acc 0.9640 p 0.8710 r 0.8182 f1 0.8438
position_predict: train acc 0.9748 p 0.9310 r 0.8438 f1 0.8852
step 60: train loss 0.2706 
cause_predict: train acc 0.9306 p 0.7949 r 0.8158 f1 0.8052
position_predict: train acc 0.9769 p 0.9355 r 0.9062 f1 0.9206
step 70: train loss 0.3936 
cause_predict: train acc 0.9171 p 0.7273 r 0.7500 f1 0.7385
position_predict: train acc 0.9366 p 0.8065 r 0.7812 f1 0.7937

epoch 7: test loss 0.5622 cost time: 10.4s

cause_predict: test acc 0.8825 p 0.5964 r 0.5268 f1 0.5595
max_acc 0.8825 max_p 0.5964 max_r 0.5268 max_f1 0.5595

position_predict: test acc 0.9209 p 0.7022 r 0.6655 f1 0.6834
max_acc 0.9272 max_p 0.7422 max_r 0.6620 max_f1 0.6998

Average max cause: max_acc 0.8825 max_p 0.5964 max_r 0.5268 max_f1 0.5595
Average max pos: max_acc 0.9209 max_p 0.7022 max_r 0.6655 max_f1 0.6834

step 10: train loss 0.1219 
cause_predict: train acc 0.9800 p 0.9688 r 0.8857 f1 0.9254
position_predict: train acc 0.9880 p 0.9688 r 0.9394 f1 0.9538
step 20: train loss 0.1567 
cause_predict: train acc 0.9504 p 0.7778 r 0.8485 f1 0.8116
position_predict: train acc 0.9847 p 0.9375 r 0.9375 f1 0.9375
step 30: train loss 0.1842 
cause_predict: train acc 0.9688 p 0.8810 r 0.9737 f1 0.9250
position_predict: train acc 0.9583 p 0.8529 r 0.9062 f1 0.8788
step 40: train loss 0.2402 
cause_predict: train acc 0.9526 p 0.9355 r 0.8056 f1 0.8657
position_predict: train acc 0.9684 p 0.9062 r 0.9062 f1 0.9062
step 50: train loss 0.2398 
cause_predict: train acc 0.9548 p 0.8649 r 0.8649 f1 0.8649
position_predict: train acc 0.9502 p 0.8000 r 0.8750 f1 0.8358
step 60: train loss 0.2102 
cause_predict: train acc 0.9559 p 0.9118 r 0.8158 f1 0.8611
position_predict: train acc 0.9515 p 0.8667 r 0.7879 f1 0.8254
step 70: train loss 0.2277 
cause_predict: train acc 0.9575 p 0.8158 r 0.8378 f1 0.8267
position_predict: train acc 0.9412 p 0.7188 r 0.7188 f1 0.7188

epoch 8: test loss 0.5880 cost time: 10.4s

cause_predict: test acc 0.8695 p 0.5436 r 0.4921 f1 0.5166
max_acc 0.8825 max_p 0.5964 max_r 0.5268 max_f1 0.5595

position_predict: test acc 0.9209 p 0.6993 r 0.6725 f1 0.6856
max_acc 0.9272 max_p 0.7422 max_r 0.6620 max_f1 0.6998

Average max cause: max_acc 0.8825 max_p 0.5964 max_r 0.5268 max_f1 0.5595
Average max pos: max_acc 0.9209 max_p 0.7022 max_r 0.6655 max_f1 0.6834

step 10: train loss 0.1648 
cause_predict: train acc 0.9672 p 0.9333 r 0.8235 f1 0.8750
position_predict: train acc 0.9713 p 0.9062 r 0.8788 f1 0.8923
step 20: train loss 0.1544 
cause_predict: train acc 0.9685 p 0.9062 r 0.8056 f1 0.8529
position_predict: train acc 0.9842 p 0.9375 r 0.9091 f1 0.9231
step 30: train loss 0.2537 
cause_predict: train acc 0.9480 p 0.9091 r 0.7500 f1 0.8219
position_predict: train acc 0.9480 p 0.8065 r 0.7812 f1 0.7937
step 40: train loss 0.1494 
cause_predict: train acc 0.9619 p 0.8857 r 0.8857 f1 0.8857
position_predict: train acc 0.9762 p 0.9118 r 0.9394 f1 0.9254
step 50: train loss 0.1924 
cause_predict: train acc 0.9662 p 0.8780 r 0.8571 f1 0.8675
position_predict: train acc 0.9662 p 0.8182 r 0.8438 f1 0.8308
step 60: train loss 0.2045 
cause_predict: train acc 0.9469 p 0.7949 r 0.8857 f1 0.8378
position_predict: train acc 0.9735 p 0.9333 r 0.8750 f1 0.9032
step 70: train loss 0.1795 
cause_predict: train acc 0.9565 p 0.8286 r 0.8056 f1 0.8169
position_predict: train acc 0.9666 p 0.8108 r 0.9091 f1 0.8571

epoch 9: test loss 0.6703 cost time: 10.4s

cause_predict: test acc 0.8718 p 0.5517 r 0.5047 f1 0.5272
max_acc 0.8825 max_p 0.5964 max_r 0.5268 max_f1 0.5595

position_predict: test acc 0.9218 p 0.6842 r 0.7247 f1 0.7039
max_acc 0.9218 max_p 0.6842 max_r 0.7247 max_f1 0.7039

Average max cause: max_acc 0.8825 max_p 0.5964 max_r 0.5268 max_f1 0.5595
Average max pos: max_acc 0.9209 max_p 0.7022 max_r 0.6655 max_f1 0.6834

step 10: train loss 0.1432 
cause_predict: train acc 0.9759 p 0.8780 r 0.9730 f1 0.9231
position_predict: train acc 0.9719 p 0.9310 r 0.8438 f1 0.8852
step 20: train loss 0.0989 
cause_predict: train acc 0.9907 p 0.9459 r 0.9722 f1 0.9589
position_predict: train acc 0.9688 p 0.8438 r 0.8438 f1 0.8438
step 30: train loss 0.1005 
cause_predict: train acc 0.9739 p 0.9667 r 0.8286 f1 0.8923
position_predict: train acc 0.9888 p 0.9394 r 0.9688 f1 0.9538
step 40: train loss 0.1259 
cause_predict: train acc 0.9749 p 0.9429 r 0.8919 f1 0.9167
position_predict: train acc 0.9791 p 0.9355 r 0.9062 f1 0.9206
step 50: train loss 0.1872 
cause_predict: train acc 0.9614 p 0.9412 r 0.8421 f1 0.8889
position_predict: train acc 0.9517 p 0.8929 r 0.7812 f1 0.8333
step 60: train loss 0.1051 
cause_predict: train acc 0.9877 p 0.9677 r 0.9091 f1 0.9375
position_predict: train acc 0.9724 p 0.8333 r 0.9091 f1 0.8696
step 70: train loss 0.1806 
cause_predict: train acc 0.9785 p 0.8889 r 0.9697 f1 0.9275
position_predict: train acc 0.9485 p 0.8182 r 0.8182 f1 0.8182

epoch 10: test loss 0.6498 cost time: 9.9s

cause_predict: test acc 0.8843 p 0.6036 r 0.5331 f1 0.5662
max_acc 0.8843 max_p 0.6036 max_r 0.5331 max_f1 0.5662

position_predict: test acc 0.9245 p 0.7077 r 0.7003 f1 0.7040
max_acc 0.9245 max_p 0.7077 max_r 0.7003 max_f1 0.7040

Average max cause: max_acc 0.8843 max_p 0.6036 max_r 0.5331 max_f1 0.5662
Average max pos: max_acc 0.9245 max_p 0.7077 max_r 0.7003 max_f1 0.7040

step 10: train loss 0.1121 
cause_predict: train acc 0.9783 p 0.9677 r 0.8824 f1 0.9231
position_predict: train acc 0.9870 p 0.9394 r 0.9688 f1 0.9538
step 20: train loss 0.1221 
cause_predict: train acc 0.9661 p 0.8378 r 0.8857 f1 0.8611
position_predict: train acc 0.9864 p 0.9375 r 0.9375 f1 0.9375
step 30: train loss 0.2212 
cause_predict: train acc 0.9748 p 0.8788 r 0.8788 f1 0.8788
position_predict: train acc 0.9591 p 0.7879 r 0.8125 f1 0.8000
step 40: train loss 0.1922 
cause_predict: train acc 0.9598 p 0.8056 r 0.8286 f1 0.8169
position_predict: train acc 0.9783 p 0.9310 r 0.8438 f1 0.8852
step 50: train loss 0.1678 
cause_predict: train acc 0.9631 p 0.8974 r 0.8537 f1 0.8750
position_predict: train acc 0.9705 p 0.8529 r 0.9062 f1 0.8788
step 60: train loss 0.1223 
cause_predict: train acc 0.9724 p 0.9444 r 0.8500 f1 0.8947
position_predict: train acc 0.9724 p 0.9000 r 0.8438 f1 0.8710
step 70: train loss 0.1684 
cause_predict: train acc 0.9585 p 0.8108 r 0.8824 f1 0.8451
position_predict: train acc 0.9698 p 0.8750 r 0.8750 f1 0.8750

epoch 11: test loss 0.6819 cost time: 10.6s

cause_predict: test acc 0.8794 p 0.5786 r 0.5457 f1 0.5617
max_acc 0.8843 max_p 0.6036 max_r 0.5331 max_f1 0.5662

position_predict: test acc 0.9191 p 0.6815 r 0.6934 f1 0.6874
max_acc 0.9245 max_p 0.7077 max_r 0.7003 max_f1 0.7040

Average max cause: max_acc 0.8843 max_p 0.6036 max_r 0.5331 max_f1 0.5662
Average max pos: max_acc 0.9245 max_p 0.7077 max_r 0.7003 max_f1 0.7040

step 10: train loss 0.1509 
cause_predict: train acc 0.9819 p 0.8947 r 1.0000 f1 0.9444
position_predict: train acc 0.9729 p 0.9355 r 0.8788 f1 0.9062
step 20: train loss 0.0874 
cause_predict: train acc 0.9824 p 0.9394 r 0.9118 f1 0.9254
position_predict: train acc 0.9789 p 0.9091 r 0.9091 f1 0.9091
step 30: train loss 0.1322 
cause_predict: train acc 0.9813 p 0.9394 r 0.9394 f1 0.9394
position_predict: train acc 0.9720 p 0.9062 r 0.9062 f1 0.9062
step 40: train loss 0.1209 
cause_predict: train acc 0.9779 p 0.9697 r 0.8649 f1 0.9143
position_predict: train acc 0.9889 p 0.9394 r 0.9688 f1 0.9538
step 50: train loss 0.1604 
cause_predict: train acc 0.9802 p 0.9444 r 0.9189 f1 0.9315
position_predict: train acc 0.9526 p 0.8182 r 0.8182 f1 0.8182
step 60: train loss 0.1878 
cause_predict: train acc 0.9481 p 0.8378 r 0.8378 f1 0.8378
position_predict: train acc 0.9827 p 0.9375 r 0.9375 f1 0.9375
step 70: train loss 0.1417 
cause_predict: train acc 0.9673 p 0.8857 r 0.8857 f1 0.8857
position_predict: train acc 0.9673 p 0.8788 r 0.8788 f1 0.8788

epoch 12: test loss 0.7470 cost time: 10.3s

cause_predict: test acc 0.8856 p 0.6125 r 0.5237 f1 0.5646
max_acc 0.8843 max_p 0.6036 max_r 0.5331 max_f1 0.5662

position_predict: test acc 0.9267 p 0.7220 r 0.6969 f1 0.7092
max_acc 0.9267 max_p 0.7220 max_r 0.6969 max_f1 0.7092

Average max cause: max_acc 0.8856 max_p 0.6125 max_r 0.5237 max_f1 0.5646
Average max pos: max_acc 0.9267 max_p 0.7220 max_r 0.6969 max_f1 0.7092

step 10: train loss 0.0738 
2024-06-22 19:23:56.447793: W tensorflow/c/c_api.cc:304] Operation '{name:'softmax_b_pos/Adam_1/Assign' id:5023 op device:{requested: '', assigned: ''} def:{{{node softmax_b_pos/Adam_1/Assign}} = Assign[T=DT_FLOAT, _class=["loc:@softmax_b_pos"], _has_manual_control_dependencies=true, use_locking=true, validate_shape=true](softmax_b_pos/Adam_1, softmax_b_pos/Adam_1/Initializer/zeros)}}' was changed by setting attribute after it was run by a session. This mutation will have no effect, and will trigger an error in the future. Either don't modify nodes after running them or create a new session.
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
cause_predict: train acc 0.9797 p 0.9459 r 0.9211 f1 0.9333
position_predict: train acc 0.9919 p 0.9697 r 0.9697 f1 0.9697
step 20: train loss 0.2091 
cause_predict: train acc 0.9802 p 0.9118 r 0.9394 f1 0.9254
position_predict: train acc 0.9405 p 0.7742 r 0.7500 f1 0.7619
step 30: train loss 0.2581 
cause_predict: train acc 0.9515 p 0.8605 r 0.9024 f1 0.8810
position_predict: train acc 0.9417 p 0.8387 r 0.7879 f1 0.8125
step 40: train loss 0.1171 
cause_predict: train acc 0.9835 p 0.9697 r 0.9143 f1 0.9412
position_predict: train acc 0.9794 p 0.9091 r 0.9375 f1 0.9231
step 50: train loss 0.1322 
cause_predict: train acc 0.9811 p 0.9394 r 0.9118 f1 0.9254
position_predict: train acc 0.9735 p 0.8824 r 0.9091 f1 0.8955
step 60: train loss 0.1755 
cause_predict: train acc 0.9638 p 0.8750 r 0.8750 f1 0.8750
position_predict: train acc 0.9710 p 0.8571 r 0.9091 f1 0.8824
step 70: train loss 0.1582 
cause_predict: train acc 0.9796 p 0.9167 r 0.9167 f1 0.9167
position_predict: train acc 0.9626 p 0.8438 r 0.8182 f1 0.8308

epoch 13: test loss 0.8068 cost time: 10.2s

cause_predict: test acc 0.8825 p 0.6023 r 0.5016 f1 0.5473
max_acc 0.8843 max_p 0.6036 max_r 0.5331 max_f1 0.5662

position_predict: test acc 0.9160 p 0.6737 r 0.6690 f1 0.6713
max_acc 0.9267 max_p 0.7220 max_r 0.6969 max_f1 0.7092

Average max cause: max_acc 0.8856 max_p 0.6125 max_r 0.5237 max_f1 0.5646
Average max pos: max_acc 0.9267 max_p 0.7220 max_r 0.6969 max_f1 0.7092

step 10: train loss 0.0520 
cause_predict: train acc 1.0000 p 1.0000 r 1.0000 f1 1.0000
position_predict: train acc 0.9842 p 0.9375 r 0.9375 f1 0.9375
step 20: train loss 0.0702 
cause_predict: train acc 0.9826 p 0.9444 r 0.9444 f1 0.9444
position_predict: train acc 0.9913 p 0.9688 r 0.9688 f1 0.9688
step 30: train loss 0.0759 
cause_predict: train acc 0.9870 p 0.9730 r 0.9474 f1 0.9600
position_predict: train acc 0.9784 p 0.9118 r 0.9394 f1 0.9254
step 40: train loss 0.0926 
cause_predict: train acc 0.9912 p 1.0000 r 0.9429 f1 0.9706
position_predict: train acc 0.9646 p 0.8529 r 0.9062 f1 0.8788
step 50: train loss 0.1994 
cause_predict: train acc 0.9679 p 0.8571 r 0.8824 f1 0.8696
position_predict: train acc 0.9679 p 0.8529 r 0.8788 f1 0.8657
step 60: train loss 0.1572 
cause_predict: train acc 0.9773 p 0.9189 r 0.9189 f1 0.9189
position_predict: train acc 0.9697 p 0.8750 r 0.8750 f1 0.8750
step 70: train loss 0.1639 
cause_predict: train acc 0.9718 p 0.9429 r 0.8462 f1 0.8919
position_predict: train acc 0.9683 p 0.8529 r 0.8788 f1 0.8657

epoch 14: test loss 0.8078 cost time: 10.3s

cause_predict: test acc 0.8820 p 0.6000 r 0.5016 f1 0.5464
max_acc 0.8843 max_p 0.6036 max_r 0.5331 max_f1 0.5662

position_predict: test acc 0.9147 p 0.6702 r 0.6585 f1 0.6643
max_acc 0.9267 max_p 0.7220 max_r 0.6969 max_f1 0.7092

Average max cause: max_acc 0.8856 max_p 0.6125 max_r 0.5237 max_f1 0.5646
Average max pos: max_acc 0.9267 max_p 0.7220 max_r 0.6969 max_f1 0.7092

write pair_data/Ind_BiLSTM_2/fold_9_test.txt done
write pair_data/Ind_BiLSTM_2/fold_9_train.txt done
Optimization Finished!

############# fold 9 end ###############
############# fold 10 begin ###############
load data_file: data_combine_en/fold_10_train.txt
y_position.shape (2275, 75, 2)
y_cause.shape (2275, 75, 2)
x.shape (2275, 75, 30)
sen_len.shape (2275, 75)
doc_len.shape (2275,)
n_cut 107
load data done!

load data_file: data_combine_en/fold_10_test.txt
y_position.shape (284, 75, 2)
y_cause.shape (284, 75, 2)
x.shape (284, 75, 30)
sen_len.shape (284, 75)
doc_len.shape (284,)
n_cut 22
load data done!

train docs: 2275    test docs: 284
step 10: train loss 0.7219 
cause_predict: train acc 0.8900 p 0.0000 r 0.0000 f1 0.0000
position_predict: train acc 0.8933 p 0.0000 r 0.0000 f1 0.0000
step 20: train loss 0.8059 
cause_predict: train acc 0.8264 p 0.0000 r 0.0000 f1 0.0000
position_predict: train acc 0.8678 p 0.0000 r 0.0000 f1 0.0000
step 30: train loss 0.7077 
cause_predict: train acc 0.8363 p 0.0000 r 0.0000 f1 0.0000
position_predict: train acc 0.8496 p 0.0000 r 0.0000 f1 0.0000
step 40: train loss 0.6270 
cause_predict: train acc 0.8448 p 0.0000 r 0.0000 f1 0.0000
position_predict: train acc 0.9009 p 0.7143 r 0.4688 f1 0.5660
step 50: train loss 0.6545 
cause_predict: train acc 0.8196 p 1.0000 r 0.0541 f1 0.1026
position_predict: train acc 0.8918 p 0.7143 r 0.6061 f1 0.6557
step 60: train loss 0.7183 
cause_predict: train acc 0.8485 p 1.0000 r 0.0541 f1 0.1026
position_predict: train acc 0.8615 p 0.5217 r 0.3636 f1 0.4286
step 70: train loss 0.5763 
cause_predict: train acc 0.8544 p 0.8000 r 0.2222 f1 0.3478
position_predict: train acc 0.9126 p 0.7692 r 0.6250 f1 0.6897

epoch 0: test loss 0.5148 cost time: 10.4s

cause_predict: test acc 0.8856 p 0.7020 r 0.3344 f1 0.4530
max_acc 0.8856 max_p 0.7020 max_r 0.3344 max_f1 0.4530

position_predict: test acc 0.9124 p 0.6631 r 0.6446 f1 0.6537
max_acc 0.9124 max_p 0.6631 max_r 0.6446 max_f1 0.6537

Average max cause: max_acc 0.8856 max_p 0.7020 max_r 0.3344 max_f1 0.4530
Average max pos: max_acc 0.9124 max_p 0.6631 max_r 0.6446 max_f1 0.6537

step 10: train loss 0.3984 
cause_predict: train acc 0.8875 p 0.5833 r 0.1842 f1 0.2800
position_predict: train acc 0.9437 p 0.7188 r 0.7188 f1 0.7188
step 20: train loss 0.4486 
cause_predict: train acc 0.9036 p 0.8000 r 0.4444 f1 0.5714
position_predict: train acc 0.9398 p 0.7576 r 0.7812 f1 0.7692
step 30: train loss 0.5094 
cause_predict: train acc 0.8696 p 0.4737 r 0.2571 f1 0.3333
position_predict: train acc 0.9275 p 0.7000 r 0.6562 f1 0.6774
step 40: train loss 0.4710 
cause_predict: train acc 0.8657 p 0.5217 r 0.3243 f1 0.4000
position_predict: train acc 0.9478 p 0.9130 r 0.6364 f1 0.7500
step 50: train loss 0.5375 
cause_predict: train acc 0.8667 p 0.6538 r 0.4474 f1 0.5312
position_predict: train acc 0.9244 p 0.8261 r 0.5938 f1 0.6909
step 60: train loss 0.4679 
cause_predict: train acc 0.8565 p 0.7692 r 0.2632 f1 0.3922
position_predict: train acc 0.9491 p 0.8182 r 0.8438 f1 0.8308
step 70: train loss 0.5879 
cause_predict: train acc 0.8325 p 0.7778 r 0.1795 f1 0.2917
position_predict: train acc 0.8916 p 0.7083 r 0.5312 f1 0.6071

epoch 1: test loss 0.4938 cost time: 10.4s

cause_predict: test acc 0.8829 p 0.7391 r 0.2681 f1 0.3935
max_acc 0.8856 max_p 0.7020 max_r 0.3344 max_f1 0.4530

position_predict: test acc 0.9205 p 0.7444 r 0.5784 f1 0.6510
max_acc 0.9124 max_p 0.6631 max_r 0.6446 max_f1 0.6537

Average max cause: max_acc 0.8856 max_p 0.7020 max_r 0.3344 max_f1 0.4530
Average max pos: max_acc 0.9124 max_p 0.6631 max_r 0.6446 max_f1 0.6537

step 10: train loss 0.3768 
cause_predict: train acc 0.8997 p 0.7143 r 0.2857 f1 0.4082
position_predict: train acc 0.9239 p 0.6923 r 0.5625 f1 0.6207
step 20: train loss 0.4779 
cause_predict: train acc 0.8939 p 0.8182 r 0.2571 f1 0.3913
position_predict: train acc 0.9394 p 0.7857 r 0.6875 f1 0.7333
step 30: train loss 0.3845 
cause_predict: train acc 0.9031 p 0.8571 r 0.4865 f1 0.6207
position_predict: train acc 0.9559 p 0.8929 r 0.7812 f1 0.8333
step 40: train loss 0.3369 
cause_predict: train acc 0.9088 p 0.7647 r 0.3714 f1 0.5000
position_predict: train acc 0.9614 p 0.8889 r 0.7500 f1 0.8136
step 50: train loss 0.4984 
cause_predict: train acc 0.8821 p 0.6471 r 0.3235 f1 0.4314
position_predict: train acc 0.9106 p 0.6786 r 0.5938 f1 0.6333
step 60: train loss 0.4854 
cause_predict: train acc 0.8921 p 0.7857 r 0.2895 f1 0.4231
position_predict: train acc 0.9281 p 0.7500 r 0.5625 f1 0.6429
step 70: train loss 0.4310 
cause_predict: train acc 0.8885 p 0.7500 r 0.3158 f1 0.4444
position_predict: train acc 0.9405 p 0.7742 r 0.7273 f1 0.7500

epoch 2: test loss 0.4825 cost time: 10.3s

cause_predict: test acc 0.8919 p 0.6943 r 0.4227 f1 0.5255
max_acc 0.8919 max_p 0.6943 max_r 0.4227 max_f1 0.5255

position_predict: test acc 0.9254 p 0.7222 r 0.6794 f1 0.7002
max_acc 0.9254 max_p 0.7222 max_r 0.6794 max_f1 0.7002

Average max cause: max_acc 0.8919 max_p 0.6943 max_r 0.4227 max_f1 0.5255
Average max pos: max_acc 0.9254 max_p 0.7222 max_r 0.6794 max_f1 0.7002

step 10: train loss 0.3937 
cause_predict: train acc 0.8848 p 0.6522 r 0.4286 f1 0.5172
position_predict: train acc 0.9506 p 0.8125 r 0.8125 f1 0.8125
step 20: train loss 0.4254 
cause_predict: train acc 0.9039 p 0.8696 r 0.5128 f1 0.6452
position_predict: train acc 0.9476 p 0.8333 r 0.7812 f1 0.8065
step 30: train loss 0.3579 
cause_predict: train acc 0.8852 p 0.6800 r 0.5152 f1 0.5862
position_predict: train acc 0.9569 p 0.8750 r 0.8485 f1 0.8615
step 40: train loss 0.5084 
cause_predict: train acc 0.8486 p 0.7222 r 0.3611 f1 0.4815
position_predict: train acc 0.9297 p 0.8800 r 0.6875 f1 0.7719
step 50: train loss 0.4719 
cause_predict: train acc 0.8577 p 0.6667 r 0.2439 f1 0.3571
position_predict: train acc 0.9368 p 0.8696 r 0.6061 f1 0.7143
step 60: train loss 0.4605 
cause_predict: train acc 0.8380 p 0.5000 r 0.4286 f1 0.4615
position_predict: train acc 0.9583 p 0.9259 r 0.7812 f1 0.8475
step 70: train loss 0.4500 
cause_predict: train acc 0.8693 p 0.5000 r 0.2500 f1 0.3333
position_predict: train acc 0.9281 p 0.6786 r 0.5938 f1 0.6333

epoch 3: test loss 0.4840 cost time: 10.4s

cause_predict: test acc 0.8910 p 0.6872 r 0.4227 f1 0.5234
max_acc 0.8919 max_p 0.6943 max_r 0.4227 max_f1 0.5255

position_predict: test acc 0.9254 p 0.7174 r 0.6899 f1 0.7034
max_acc 0.9254 max_p 0.7174 max_r 0.6899 max_f1 0.7034

Average max cause: max_acc 0.8910 max_p 0.6872 max_r 0.4227 max_f1 0.5234
Average max pos: max_acc 0.9254 max_p 0.7174 max_r 0.6899 max_f1 0.7034

step 10: train loss 0.3600 
cause_predict: train acc 0.9073 p 0.7778 r 0.6176 f1 0.6885
position_predict: train acc 0.9463 p 0.8182 r 0.8438 f1 0.8308
step 20: train loss 0.3116 
cause_predict: train acc 0.9478 p 0.8276 r 0.7273 f1 0.7742
position_predict: train acc 0.9328 p 0.7188 r 0.7188 f1 0.7188
step 30: train loss 0.4042 
cause_predict: train acc 0.8996 p 0.6800 r 0.4857 f1 0.5667
position_predict: train acc 0.9382 p 0.7500 r 0.7500 f1 0.7500
step 40: train loss 0.3868 
cause_predict: train acc 0.9091 p 0.8667 r 0.3514 f1 0.5000
position_predict: train acc 0.9371 p 0.7419 r 0.6970 f1 0.7188
step 50: train loss 0.4240 
cause_predict: train acc 0.8894 p 0.8261 r 0.5000 f1 0.6230
position_predict: train acc 0.9327 p 0.8000 r 0.7500 f1 0.7742
step 60: train loss 0.3057 
cause_predict: train acc 0.9262 p 0.8000 r 0.4706 f1 0.5926
position_predict: train acc 0.9530 p 0.7647 r 0.8125 f1 0.7879
step 70: train loss 0.4063 
cause_predict: train acc 0.9188 p 0.7143 r 0.5882 f1 0.6452
position_predict: train acc 0.9188 p 0.7000 r 0.6176 f1 0.6562

epoch 4: test loss 0.4907 cost time: 10.7s

cause_predict: test acc 0.8820 p 0.6318 r 0.4006 f1 0.4903
max_acc 0.8919 max_p 0.6943 max_r 0.4227 max_f1 0.5255

position_predict: test acc 0.9236 p 0.7132 r 0.6760 f1 0.6941
max_acc 0.9254 max_p 0.7174 max_r 0.6899 max_f1 0.7034

Average max cause: max_acc 0.8910 max_p 0.6872 max_r 0.4227 max_f1 0.5234
Average max pos: max_acc 0.9254 max_p 0.7174 max_r 0.6899 max_f1 0.7034

step 10: train loss 0.2797 
cause_predict: train acc 0.9433 p 0.8800 r 0.6111 f1 0.7213
position_predict: train acc 0.9433 p 0.8571 r 0.5625 f1 0.6792
step 20: train loss 0.2689 
cause_predict: train acc 0.9442 p 0.8125 r 0.7647 f1 0.7879
position_predict: train acc 0.9602 p 0.8929 r 0.7812 f1 0.8333
step 30: train loss 0.3603 
cause_predict: train acc 0.8734 p 0.6207 r 0.5000 f1 0.5538
position_predict: train acc 0.9651 p 0.8788 r 0.8788 f1 0.8788
step 40: train loss 0.3098 
cause_predict: train acc 0.9034 p 0.8947 r 0.4474 f1 0.5965
position_predict: train acc 0.9538 p 0.8889 r 0.7500 f1 0.8136
step 50: train loss 0.3556 
cause_predict: train acc 0.9154 p 0.7353 r 0.6579 f1 0.6944
position_predict: train acc 0.9346 p 0.7778 r 0.6562 f1 0.7119
step 60: train loss 0.3548 
cause_predict: train acc 0.8971 p 0.7895 r 0.4167 f1 0.5455
position_predict: train acc 0.9424 p 0.8462 r 0.6875 f1 0.7586
step 70: train loss 0.4461 
cause_predict: train acc 0.8939 p 0.7500 r 0.6000 f1 0.6667
position_predict: train acc 0.9242 p 0.8148 r 0.6875 f1 0.7458

epoch 5: test loss 0.5080 cost time: 10.5s

cause_predict: test acc 0.8937 p 0.6787 r 0.4732 f1 0.5576
max_acc 0.8937 max_p 0.6787 max_r 0.4732 max_f1 0.5576

position_predict: test acc 0.9263 p 0.7226 r 0.6899 f1 0.7059
max_acc 0.9263 max_p 0.7226 max_r 0.6899 max_f1 0.7059

Average max cause: max_acc 0.8937 max_p 0.6787 max_r 0.4732 max_f1 0.5576
Average max pos: max_acc 0.9263 max_p 0.7226 max_r 0.6899 max_f1 0.7059

step 10: train loss 0.2151 
cause_predict: train acc 0.9517 p 0.9231 r 0.6667 f1 0.7742
position_predict: train acc 0.9655 p 0.9583 r 0.7188 f1 0.8214
step 20: train loss 0.2502 
cause_predict: train acc 0.9480 p 0.8667 r 0.7222 f1 0.7879
position_predict: train acc 0.9517 p 0.8519 r 0.7188 f1 0.7797
step 30: train loss 0.2631 
cause_predict: train acc 0.9420 p 0.8387 r 0.7027 f1 0.7647
position_predict: train acc 0.9565 p 0.8333 r 0.7812 f1 0.8065
step 40: train loss 0.3722 
cause_predict: train acc 0.8759 p 0.6296 r 0.4250 f1 0.5075
position_predict: train acc 0.9624 p 0.8929 r 0.7812 f1 0.8333
step 50: train loss 0.4194 
cause_predict: train acc 0.8995 p 0.7241 r 0.6000 f1 0.6562
position_predict: train acc 0.9178 p 0.7419 r 0.6970 f1 0.7188
step 60: train loss 0.3500 
cause_predict: train acc 0.9297 p 0.8519 r 0.6216 f1 0.7187
position_predict: train acc 0.9102 p 0.6452 r 0.6250 f1 0.6349
step 70: train loss 0.2748 
cause_predict: train acc 0.9496 p 0.8824 r 0.7895 f1 0.8333
position_predict: train acc 0.9496 p 0.7778 r 0.8750 f1 0.8235

epoch 6: test loss 0.5283 cost time: 10.5s

cause_predict: test acc 0.8878 p 0.6410 r 0.4732 f1 0.5445
max_acc 0.8937 max_p 0.6787 max_r 0.4732 max_f1 0.5576

position_predict: test acc 0.9258 p 0.7266 r 0.6760 f1 0.7004
max_acc 0.9263 max_p 0.7226 max_r 0.6899 max_f1 0.7059

Average max cause: max_acc 0.8937 max_p 0.6787 max_r 0.4732 max_f1 0.5576
Average max pos: max_acc 0.9263 max_p 0.7226 max_r 0.6899 max_f1 0.7059

step 10: train loss 0.2340 
cause_predict: train acc 0.9179 p 0.7027 r 0.7027 f1 0.7027
position_predict: train acc 0.9739 p 0.8788 r 0.9062 f1 0.8923
step 20: train loss 0.3171 
cause_predict: train acc 0.9083 p 0.7143 r 0.6757 f1 0.6944
position_predict: train acc 0.9625 p 0.8710 r 0.8438 f1 0.8571
step 30: train loss 0.1912 
cause_predict: train acc 0.9667 p 0.9355 r 0.8286 f1 0.8788
position_predict: train acc 0.9708 p 0.9310 r 0.8438 f1 0.8852
step 40: train loss 0.3246 
cause_predict: train acc 0.9360 p 0.8125 r 0.7222 f1 0.7647
position_predict: train acc 0.9440 p 0.8214 r 0.7188 f1 0.7667
step 50: train loss 0.2115 
cause_predict: train acc 0.9372 p 0.8065 r 0.7353 f1 0.7692
position_predict: train acc 0.9623 p 0.8485 r 0.8750 f1 0.8615
step 60: train loss 0.2673 
cause_predict: train acc 0.9325 p 0.8667 r 0.6667 f1 0.7536
position_predict: train acc 0.9643 p 0.8485 r 0.8750 f1 0.8615
step 70: train loss 0.3719 
cause_predict: train acc 0.8909 p 0.7391 r 0.4857 f1 0.5862
position_predict: train acc 0.9545 p 0.8667 r 0.8125 f1 0.8387

epoch 7: test loss 0.5595 cost time: 10.5s

cause_predict: test acc 0.8914 p 0.6832 r 0.4353 f1 0.5318
max_acc 0.8937 max_p 0.6787 max_r 0.4732 max_f1 0.5576

position_predict: test acc 0.9187 p 0.6829 r 0.6829 f1 0.6829
max_acc 0.9263 max_p 0.7226 max_r 0.6899 max_f1 0.7059

Average max cause: max_acc 0.8937 max_p 0.6787 max_r 0.4732 max_f1 0.5576
Average max pos: max_acc 0.9263 max_p 0.7226 max_r 0.6899 max_f1 0.7059

step 10: train loss 0.2251 
cause_predict: train acc 0.9644 p 0.9688 r 0.8158 f1 0.8857
position_predict: train acc 0.9467 p 0.8125 r 0.8125 f1 0.8125
step 20: train loss 0.2380 
cause_predict: train acc 0.9703 p 0.9655 r 0.8235 f1 0.8889
position_predict: train acc 0.9619 p 0.8710 r 0.8438 f1 0.8571
step 30: train loss 0.2533 
cause_predict: train acc 0.9382 p 0.8000 r 0.7568 f1 0.7778
position_predict: train acc 0.9730 p 0.8611 r 0.9394 f1 0.8986
step 40: train loss 0.2753 
cause_predict: train acc 0.9509 p 0.8710 r 0.7500 f1 0.8060
position_predict: train acc 0.9547 p 0.8125 r 0.8125 f1 0.8125
step 50: train loss 0.2533 
cause_predict: train acc 0.9216 p 0.7297 r 0.7105 f1 0.7200
position_predict: train acc 0.9590 p 0.8667 r 0.7879 f1 0.8254
step 60: train loss 0.2965 
cause_predict: train acc 0.9556 p 0.9310 r 0.7714 f1 0.8438
position_predict: train acc 0.9511 p 0.8387 r 0.8125 f1 0.8254
step 70: train loss 0.1932 
cause_predict: train acc 0.9635 p 0.8649 r 0.8649 f1 0.8649
position_predict: train acc 0.9672 p 0.8529 r 0.8788 f1 0.8657

epoch 8: test loss 0.6205 cost time: 10.7s

cause_predict: test acc 0.8825 p 0.6164 r 0.4511 f1 0.5209
max_acc 0.8937 max_p 0.6787 max_r 0.4732 max_f1 0.5576

position_predict: test acc 0.9151 p 0.6777 r 0.6446 f1 0.6607
max_acc 0.9263 max_p 0.7226 max_r 0.6899 max_f1 0.7059

Average max cause: max_acc 0.8937 max_p 0.6787 max_r 0.4732 max_f1 0.5576
Average max pos: max_acc 0.9263 max_p 0.7226 max_r 0.6899 max_f1 0.7059

step 10: train loss 0.2494 
cause_predict: train acc 0.9238 p 0.7714 r 0.7500 f1 0.7606
position_predict: train acc 0.9641 p 0.8529 r 0.9062 f1 0.8788
step 20: train loss 0.2535 
cause_predict: train acc 0.9261 p 0.7667 r 0.6970 f1 0.7302
position_predict: train acc 0.9739 p 0.9091 r 0.9091 f1 0.9091
step 30: train loss 0.1137 
cause_predict: train acc 0.9817 p 0.8684 r 0.9706 f1 0.9167
position_predict: train acc 0.9726 p 0.8485 r 0.8750 f1 0.8615
step 40: train loss 0.2360 
cause_predict: train acc 0.9369 p 0.8611 r 0.7750 f1 0.8158
position_predict: train acc 0.9505 p 0.8667 r 0.7879 f1 0.8254
step 50: train loss 0.2185 
cause_predict: train acc 0.9515 p 0.8421 r 0.8205 f1 0.8312
position_predict: train acc 0.9664 p 0.8485 r 0.8750 f1 0.8615
step 60: train loss 0.1575 
cause_predict: train acc 0.9743 p 0.9143 r 0.8889 f1 0.9014
position_predict: train acc 0.9632 p 0.8667 r 0.8125 f1 0.8387
step 70: train loss 0.3729 
cause_predict: train acc 0.9378 p 0.8000 r 0.8485 f1 0.8235
position_predict: train acc 0.9067 p 0.7500 r 0.6562 f1 0.7000

epoch 9: test loss 0.6601 cost time: 10.6s

cause_predict: test acc 0.8874 p 0.6395 r 0.4700 f1 0.5418
max_acc 0.8937 max_p 0.6787 max_r 0.4732 max_f1 0.5576

position_predict: test acc 0.9155 p 0.6713 r 0.6690 f1 0.6702
max_acc 0.9263 max_p 0.7226 max_r 0.6899 max_f1 0.7059

Average max cause: max_acc 0.8937 max_p 0.6787 max_r 0.4732 max_f1 0.5576
Average max pos: max_acc 0.9263 max_p 0.7226 max_r 0.6899 max_f1 0.7059

step 10: train loss 0.1837 
cause_predict: train acc 0.9403 p 0.8286 r 0.8286 f1 0.8286
position_predict: train acc 0.9900 p 1.0000 r 0.9375 f1 0.9677
step 20: train loss 0.1698 
cause_predict: train acc 0.9637 p 0.9091 r 0.8333 f1 0.8696
position_predict: train acc 0.9556 p 0.8000 r 0.8750 f1 0.8358
step 30: train loss 0.2212 
cause_predict: train acc 0.9657 p 0.9333 r 0.8235 f1 0.8750
position_predict: train acc 0.9571 p 0.8966 r 0.7879 f1 0.8387
step 40: train loss 0.2357 
cause_predict: train acc 0.9256 p 0.7568 r 0.7568 f1 0.7568
position_predict: train acc 0.9711 p 0.9032 r 0.8750 f1 0.8889
step 50: train loss 0.1412 
cause_predict: train acc 0.9780 p 0.9091 r 0.8824 f1 0.8955
position_predict: train acc 0.9780 p 0.9032 r 0.8750 f1 0.8889
step 60: train loss 0.1390 
cause_predict: train acc 0.9713 p 0.9394 r 0.8611 f1 0.8986
position_predict: train acc 0.9836 p 0.9375 r 0.9375 f1 0.9375
step 70: train loss 0.1284 
cause_predict: train acc 0.9670 p 0.8710 r 0.7941 f1 0.8308
position_predict: train acc 0.9820 p 0.9643 r 0.8438 f1 0.9000

epoch 10: test loss 0.6359 cost time: 10.4s

cause_predict: test acc 0.8941 p 0.6613 r 0.5174 f1 0.5805
max_acc 0.8941 max_p 0.6613 max_r 0.5174 max_f1 0.5805

position_predict: test acc 0.9173 p 0.6835 r 0.6620 f1 0.6726
max_acc 0.9263 max_p 0.7226 max_r 0.6899 max_f1 0.7059

Average max cause: max_acc 0.8937 max_p 0.6787 max_r 0.4732 max_f1 0.5576
Average max pos: max_acc 0.9263 max_p 0.7226 max_r 0.6899 max_f1 0.7059

step 10: train loss 0.2395 
cause_predict: train acc 0.9560 p 0.8537 r 0.8537 f1 0.8537
position_predict: train acc 0.9634 p 0.8438 r 0.8438 f1 0.8438
step 20: train loss 0.1568 
cause_predict: train acc 0.9659 p 0.8824 r 0.8571 f1 0.8696
position_predict: train acc 0.9621 p 0.8235 r 0.8750 f1 0.8485
step 30: train loss 0.1598 
cause_predict: train acc 0.9761 p 0.9211 r 0.9211 f1 0.9211
position_predict: train acc 0.9641 p 0.8750 r 0.8485 f1 0.8615
step 40: train loss 0.1307 
cause_predict: train acc 0.9753 p 0.9167 r 0.8919 f1 0.9041
position_predict: train acc 0.9823 p 0.9355 r 0.9062 f1 0.9206
step 50: train loss 0.1644 
cause_predict: train acc 0.9520 p 0.8387 r 0.7647 f1 0.8000
position_predict: train acc 0.9742 p 0.8788 r 0.9062 f1 0.8923
step 60: train loss 0.1436 
cause_predict: train acc 0.9776 p 0.9394 r 0.9118 f1 0.9254
position_predict: train acc 0.9641 p 0.8571 r 0.9091 f1 0.8824
step 70: train loss 0.2032 
cause_predict: train acc 0.9527 p 0.8158 r 0.8378 f1 0.8267
position_predict: train acc 0.9564 p 0.8125 r 0.8125 f1 0.8125

epoch 11: test loss 0.7034 cost time: 10.4s

cause_predict: test acc 0.8740 p 0.5651 r 0.4795 f1 0.5188
max_acc 0.8941 max_p 0.6613 max_r 0.5174 max_f1 0.5805

position_predict: test acc 0.9182 p 0.6806 r 0.6829 f1 0.6817
max_acc 0.9263 max_p 0.7226 max_r 0.6899 max_f1 0.7059

Average max cause: max_acc 0.8937 max_p 0.6787 max_r 0.4732 max_f1 0.5576
Average max pos: max_acc 0.9263 max_p 0.7226 max_r 0.6899 max_f1 0.7059

step 10: train loss 0.2841 
cause_predict: train acc 0.9299 p 0.7895 r 0.8108 f1 0.8000
position_predict: train acc 0.9579 p 0.8485 r 0.8750 f1 0.8615
step 20: train loss 0.1556 
cause_predict: train acc 0.9617 p 0.9118 r 0.8378 f1 0.8732
position_predict: train acc 0.9787 p 0.8857 r 0.9688 f1 0.9254
step 30: train loss 0.1681 
cause_predict: train acc 0.9728 p 0.9487 r 0.8810 f1 0.9136
position_predict: train acc 0.9689 p 0.8529 r 0.9062 f1 0.8788
step 40: train loss 0.1383 
cause_predict: train acc 0.9724 p 0.9118 r 0.9118 f1 0.9118
position_predict: train acc 0.9677 p 0.9032 r 0.8750 f1 0.8889
step 50: train loss 0.0993 
cause_predict: train acc 0.9817 p 0.8947 r 0.9444 f1 0.9189
position_predict: train acc 0.9847 p 0.9091 r 0.9375 f1 0.9231
step 60: train loss 0.1907 
cause_predict: train acc 0.9446 p 0.7812 r 0.7353 f1 0.7576
position_predict: train acc 0.9654 p 0.8056 r 0.9062 f1 0.8529
step 70: train loss 0.2498 
cause_predict: train acc 0.9775 p 0.9355 r 0.9062 f1 0.9206
position_predict: train acc 0.9234 p 0.7353 r 0.7576 f1 0.7463

epoch 12: test loss 0.6916 cost time: 10.3s

cause_predict: test acc 0.8892 p 0.6386 r 0.5016 f1 0.5618
max_acc 0.8941 max_p 0.6613 max_r 0.5174 max_f1 0.5805

position_predict: test acc 0.9209 p 0.6978 r 0.6760 f1 0.6867
max_acc 0.9263 max_p 0.7226 max_r 0.6899 max_f1 0.7059

Average max cause: max_acc 0.8937 max_p 0.6787 max_r 0.4732 max_f1 0.5576
Average max pos: max_acc 0.9263 max_p 0.7226 max_r 0.6899 max_f1 0.7059

step 10: train loss 0.1165 
cause_predict: train acc 0.9737 p 0.9355 r 0.8529 f1 0.8923
position_predict: train acc 0.9737 p 0.9062 r 0.8788 f1 0.8923
step 20: train loss 0.0480 
cause_predict: train acc 0.9957 p 0.9697 r 1.0000 f1 0.9846
position_predict: train acc 0.9957 p 0.9706 r 1.0000 f1 0.9851
step 30: train loss 0.2018 
cause_predict: train acc 0.9832 p 0.9429 r 0.9706 f1 0.9565
position_predict: train acc 0.9721 p 0.9375 r 0.9091 f1 0.9231
step 40: train loss 0.0862 
cause_predict: train acc 0.9774 p 0.8684 r 1.0000 f1 0.9296
position_predict: train acc 0.9864 p 0.9677 r 0.9375 f1 0.9524
step 50: train loss 0.1512 
cause_predict: train acc 0.9855 p 0.9143 r 0.9697 f1 0.9412
position_predict: train acc 0.9565 p 0.8182 r 0.8182 f1 0.8182
step 60: train loss 0.1846 
cause_predict: train acc 0.9762 p 0.9167 r 0.9429 f1 0.9296
position_predict: train acc 0.9524 p 0.8667 r 0.8125 f1 0.8387
step 70: train loss 0.1534 
cause_predict: train acc 0.9879 p 0.9697 r 0.9412 f1 0.9552
position_predict: train acc 0.9636 p 0.9032 r 0.8235 f1 0.8615

epoch 13: test loss 0.6979 cost time: 10.5s

cause_predict: test acc 0.8704 p 0.5421 r 0.5489 f1 0.5455
max_acc 0.8941 max_p 0.6613 max_r 0.5174 max_f1 0.5805

position_predict: test acc 0.9164 p 0.6773 r 0.6655 f1 0.6714
max_acc 0.9263 max_p 0.7226 max_r 0.6899 max_f1 0.7059

Average max cause: max_acc 0.8937 max_p 0.6787 max_r 0.4732 max_f1 0.5576
Average max pos: max_acc 0.9263 max_p 0.7226 max_r 0.6899 max_f1 0.7059

step 10: train loss 0.1210 
cause_predict: train acc 0.9868 p 0.9706 r 0.9167 f1 0.9429
position_predict: train acc 0.9801 p 0.9062 r 0.9062 f1 0.9062
step 20: train loss 0.0966 
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
cause_predict: train acc 0.9886 p 0.9444 r 0.9714 f1 0.9577
position_predict: train acc 0.9848 p 0.9375 r 0.9375 f1 0.9375
step 30: train loss 0.1023 
cause_predict: train acc 0.9823 p 0.9167 r 0.9429 f1 0.9296
position_predict: train acc 0.9752 p 0.8788 r 0.9062 f1 0.8923
step 40: train loss 0.1592 
cause_predict: train acc 0.9792 p 0.9333 r 0.8750 f1 0.9032
position_predict: train acc 0.9583 p 0.8125 r 0.8125 f1 0.8125
step 50: train loss 0.2376 
cause_predict: train acc 0.9545 p 0.8462 r 0.8684 f1 0.8571
position_predict: train acc 0.9587 p 0.8235 r 0.8750 f1 0.8485
step 60: train loss 0.1370 
cause_predict: train acc 0.9860 p 0.9189 r 0.9714 f1 0.9444
position_predict: train acc 0.9545 p 0.8125 r 0.7879 f1 0.8000
step 70: train loss 0.1296 
cause_predict: train acc 0.9769 p 0.9167 r 0.9429 f1 0.9296
position_predict: train acc 0.9676 p 0.9032 r 0.8750 f1 0.8889

epoch 14: test loss 0.7418 cost time: 10.4s

cause_predict: test acc 0.8954 p 0.6751 r 0.5047 f1 0.5776
max_acc 0.8941 max_p 0.6613 max_r 0.5174 max_f1 0.5805

position_predict: test acc 0.9133 p 0.6691 r 0.6411 f1 0.6548
max_acc 0.9263 max_p 0.7226 max_r 0.6899 max_f1 0.7059

Average max cause: max_acc 0.8937 max_p 0.6787 max_r 0.4732 max_f1 0.5576
Average max pos: max_acc 0.9263 max_p 0.7226 max_r 0.6899 max_f1 0.7059

write pair_data/Ind_BiLSTM_2/fold_10_test.txt done
write pair_data/Ind_BiLSTM_2/fold_10_train.txt done
Optimization Finished!

############# fold 10 end ###############


>>>>>>>>>>>>>>>>>>>>TRAINING INFO:

batch-32, lr-0.005, kb1-0.8, kb2-1.0, l2_reg-1e-05
training_iter-15, scope-Ind_BiLSTM_2


cause_predict: test f1 in 10 fold: [[0.58803987]
 [0.59691252]
 [0.56281407]
 [0.56561922]
 [0.56610169]
 [0.60273973]
 [0.55898367]
 [0.58943782]
 [0.56462585]
 [0.55762082]]
average : acc 0.8908 p 0.6419 r 0.5230 f1 0.5753

position_predict: test f1 in 10 fold: [[0.69314079]
 [0.68449198]
 [0.69273743]
 [0.71401869]
 [0.70526316]
 [0.67917448]
 [0.69626998]
 [0.68904594]
 [0.70921986]
 [0.70588235]]
average : acc 0.9249 p 0.7234 r 0.6732 f1 0.6969


----------2024-06-22 19:26:40----------
