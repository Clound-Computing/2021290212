WARNING:tensorflow:From /home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/tensorflow/python/compat/v2_compat.py:111: disable_resource_variables (from tensorflow.python.ops.variable_scope) is deprecated and will be removed in a future version.
Instructions for updating:
non-resource variables are not supported in the long term
WARNING:tensorflow:From /home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/tensorflow/python/util/dispatch.py:1096: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
W0707 23:58:13.663338 140571177567424 deprecation.py:545] From /home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/tensorflow/python/util/dispatch.py:1096: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
/home/oycj/code/ECPE-master/utils/tf_funcs.py:181: UserWarning: `tf.nn.rnn_cell.LSTMCell` is deprecated and will be removed in a future version. This class is equivalent as `tf.keras.layers.LSTMCell`, and will be replaced by that in Tensorflow 2.0.
  cell_fw=tf.nn.rnn_cell.LSTMCell(n_hidden),
/home/oycj/code/ECPE-master/utils/tf_funcs.py:182: UserWarning: `tf.nn.rnn_cell.LSTMCell` is deprecated and will be removed in a future version. This class is equivalent as `tf.keras.layers.LSTMCell`, and will be replaced by that in Tensorflow 2.0.
  cell_bw=tf.nn.rnn_cell.LSTMCell(n_hidden),
WARNING:tensorflow:From /home/oycj/code/ECPE-master/utils/tf_funcs.py:180: bidirectional_dynamic_rnn (from tensorflow.python.ops.rnn) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `keras.layers.Bidirectional(keras.layers.RNN(cell))`, which is equivalent to this API
W0707 23:58:13.697302 140571177567424 deprecation.py:341] From /home/oycj/code/ECPE-master/utils/tf_funcs.py:180: bidirectional_dynamic_rnn (from tensorflow.python.ops.rnn) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `keras.layers.Bidirectional(keras.layers.RNN(cell))`, which is equivalent to this API
WARNING:tensorflow:From /home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/tensorflow/python/ops/rnn.py:441: dynamic_rnn (from tensorflow.python.ops.rnn) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `keras.layers.RNN(cell)`, which is equivalent to this API
W0707 23:58:13.697796 140571177567424 deprecation.py:341] From /home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/tensorflow/python/ops/rnn.py:441: dynamic_rnn (from tensorflow.python.ops.rnn) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `keras.layers.RNN(cell)`, which is equivalent to this API
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/keras/layers/legacy_rnn/rnn_cell_impl.py:984: UserWarning: `layer.add_variable` is deprecated and will be removed in a future version. Please use `layer.add_weight` method instead.
  self._kernel = self.add_variable(
WARNING:tensorflow:From /home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/keras/layers/legacy_rnn/rnn_cell_impl.py:992: calling Zeros.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
W0707 23:58:13.763515 140571177567424 deprecation.py:545] From /home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/keras/layers/legacy_rnn/rnn_cell_impl.py:992: calling Zeros.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor

----------2024-07-07 23:58:11----------

load embedding...
w2v_file: data_en/w2v_200.txt
all_words: 14316 hit_words: 10987
embedding.shape: (14317, 200) embedding_pos.shape: (201, 50)
load embedding done!

build model...
build model done!



>>>>>>>>>>>>>>>>>>>>TRAINING INFO:

batch-32, lr-0.005, kb1-0.8, kb2-1.0, l2_reg-1e-05
training_iter-15, scope-Ind_BiLSTM_1

############# fold 1 begin ###############
load data_file: data_combine_en/fold_1_train.txt
y_position.shape (2275, 75, 2)
y_cause.shape (2275, 75, 2)
x.shape (2275, 75, 30)
sen_len.shape (2275, 75)
doc_len.shape (2275,)
n_cut 107
load data done!

load data_file: data_combine_en/fold_1_test.txt
y_position.shape (284, 75, 2)
y_cause.shape (284, 75, 2)
x.shape (284, 75, 30)
sen_len.shape (284, 75)
doc_len.shape (284,)
n_cut 22
load data done!

train docs: 2275    test docs: 284
step 10: train loss 0.8059 
cause_predict: train acc 0.8500 p 0.0000 r 0.0000 f1 0.0000
position_predict: train acc 0.8769 p 0.0000 r 0.0000 f1 0.0000
step 20: train loss 0.6861 
cause_predict: train acc 0.8657 p 0.0000 r 0.0000 f1 0.0000
position_predict: train acc 0.8769 p 0.0000 r 0.0000 f1 0.0000
step 30: train loss 0.8633 
cause_predict: train acc 0.7730 p 0.0000 r 0.0000 f1 0.0000
position_predict: train acc 0.8216 p 0.0000 r 0.0000 f1 0.0000
step 40: train loss 0.6229 
cause_predict: train acc 0.8625 p 0.0000 r 0.0000 f1 0.0000
position_predict: train acc 0.8885 p 0.5500 r 0.3438 f1 0.4231
step 50: train loss 0.6771 
cause_predict: train acc 0.7935 p 0.0000 r 0.0000 f1 0.0000
position_predict: train acc 0.8859 p 0.6774 r 0.6562 f1 0.6667
step 60: train loss 0.5468 
cause_predict: train acc 0.8675 p 1.0000 r 0.0882 f1 0.1622
position_predict: train acc 0.9274 p 0.7778 r 0.6562 f1 0.7119
step 70: train loss 0.5784 
cause_predict: train acc 0.8701 p 0.0000 r 0.0000 f1 0.0000
position_predict: train acc 0.8976 p 0.6129 r 0.5758 f1 0.5938

epoch 0: test loss 0.5356 cost time: 16.9s

cause_predict: test acc 0.8584 p 0.0000 r 0.0000 f1 0.0000
max_acc 0.8584 max_p 0.0000 max_r 0.0000 max_f1 0.0000

position_predict: test acc 0.9191 p 0.7789 r 0.5157 f1 0.6205
max_acc 0.9191 max_p 0.7789 max_r 0.5157 max_f1 0.6205

Average max cause: max_acc 0.8584 max_p 0.0000 max_r 0.0000 max_f1 0.0000
Average max pos: max_acc 0.9191 max_p 0.7789 max_r 0.5157 max_f1 0.6205

step 10: train loss 0.5607 
cause_predict: train acc 0.8502 p 0.0000 r 0.0000 f1 0.0000
position_predict: train acc 0.8987 p 0.6667 r 0.6061 f1 0.6349
step 20: train loss 0.5010 
cause_predict: train acc 0.8835 p 0.6667 r 0.1053 f1 0.1818
position_predict: train acc 0.9126 p 0.6071 r 0.5152 f1 0.5574
step 30: train loss 0.4899 
cause_predict: train acc 0.9004 p 1.0000 r 0.3056 f1 0.4681
position_predict: train acc 0.8884 p 0.5909 r 0.4062 f1 0.4815
step 40: train loss 0.4438 
cause_predict: train acc 0.8892 p 0.5000 r 0.4000 f1 0.4444
position_predict: train acc 0.9399 p 0.7826 r 0.5625 f1 0.6545
step 50: train loss 0.5687 
cause_predict: train acc 0.8560 p 0.5500 r 0.2895 f1 0.3793
position_predict: train acc 0.9280 p 0.7917 r 0.5938 f1 0.6786
step 60: train loss 0.5425 
cause_predict: train acc 0.8893 p 0.7619 r 0.4211 f1 0.5424
position_predict: train acc 0.9221 p 0.6970 r 0.7188 f1 0.7077
step 70: train loss 0.5469 
cause_predict: train acc 0.8775 p 0.8182 r 0.2368 f1 0.3673
position_predict: train acc 0.9012 p 0.6538 r 0.5152 f1 0.5763

epoch 1: test loss 0.4752 cost time: 12.6s

cause_predict: test acc 0.8919 p 0.7622 r 0.3438 f1 0.4739
max_acc 0.8919 max_p 0.7622 max_r 0.3438 max_f1 0.4739

position_predict: test acc 0.9240 p 0.7427 r 0.6237 f1 0.6780
max_acc 0.9240 max_p 0.7427 max_r 0.6237 max_f1 0.6780

Average max cause: max_acc 0.8919 max_p 0.7622 max_r 0.3438 max_f1 0.4739
Average max pos: max_acc 0.9240 max_p 0.7427 max_r 0.6237 max_f1 0.6780

step 10: train loss 0.4574 
cause_predict: train acc 0.8646 p 0.7333 r 0.3333 f1 0.4583
position_predict: train acc 0.9323 p 0.8519 r 0.7188 f1 0.7797
step 20: train loss 0.3817 
cause_predict: train acc 0.9324 p 0.8182 r 0.5455 f1 0.6545
position_predict: train acc 0.9253 p 0.7308 r 0.5758 f1 0.6441
step 30: train loss 0.4061 
cause_predict: train acc 0.8806 p 0.5333 r 0.2424 f1 0.3333
position_predict: train acc 0.9403 p 0.8077 r 0.6562 f1 0.7241
step 40: train loss 0.4828 
cause_predict: train acc 0.9040 p 0.8000 r 0.5882 f1 0.6780
position_predict: train acc 0.9343 p 0.8065 r 0.7812 f1 0.7937
step 50: train loss 0.4481 
cause_predict: train acc 0.9164 p 0.7500 r 0.4167 f1 0.5357
position_predict: train acc 0.9293 p 0.6786 r 0.5938 f1 0.6333
step 60: train loss 0.3911 
cause_predict: train acc 0.8906 p 0.6818 r 0.4167 f1 0.5172
position_predict: train acc 0.9531 p 0.8387 r 0.7879 f1 0.8125
step 70: train loss 0.4427 
cause_predict: train acc 0.8797 p 0.5909 r 0.3939 f1 0.4727
position_predict: train acc 0.9419 p 0.7812 r 0.7812 f1 0.7812

epoch 2: test loss 0.4744 cost time: 12.5s

cause_predict: test acc 0.8914 p 0.7846 r 0.3218 f1 0.4564
max_acc 0.8919 max_p 0.7622 max_r 0.3438 max_f1 0.4739

position_predict: test acc 0.9164 p 0.6852 r 0.6446 f1 0.6643
max_acc 0.9240 max_p 0.7427 max_r 0.6237 max_f1 0.6780

Average max cause: max_acc 0.8919 max_p 0.7622 max_r 0.3438 max_f1 0.4739
Average max pos: max_acc 0.9240 max_p 0.7427 max_r 0.6237 max_f1 0.6780

step 10: train loss 0.3520 
cause_predict: train acc 0.9286 p 0.7857 r 0.6471 f1 0.7097
position_predict: train acc 0.9484 p 0.8800 r 0.6875 f1 0.7719
step 20: train loss 0.4043 
cause_predict: train acc 0.8826 p 0.7059 r 0.3000 f1 0.4211
position_predict: train acc 0.9502 p 0.8214 r 0.7188 f1 0.7667
step 30: train loss 0.3906 
cause_predict: train acc 0.9243 p 0.6897 r 0.5882 f1 0.6349
position_predict: train acc 0.9375 p 0.7692 r 0.6061 f1 0.6780
step 40: train loss 0.3996 
cause_predict: train acc 0.9130 p 0.7037 r 0.4872 f1 0.5758
position_predict: train acc 0.9503 p 0.7857 r 0.6875 f1 0.7333
step 50: train loss 0.3681 
cause_predict: train acc 0.9074 p 0.7727 r 0.4595 f1 0.5763
position_predict: train acc 0.9481 p 0.7812 r 0.7812 f1 0.7812
step 60: train loss 0.4560 
cause_predict: train acc 0.8992 p 0.7500 r 0.4865 f1 0.5902
position_predict: train acc 0.9194 p 0.7000 r 0.6562 f1 0.6774
step 70: train loss 0.5801 
cause_predict: train acc 0.8506 p 0.6842 r 0.2826 f1 0.4000
position_predict: train acc 0.9387 p 0.7353 r 0.7812 f1 0.7576

epoch 3: test loss 0.4724 cost time: 13.0s

cause_predict: test acc 0.8883 p 0.6754 r 0.4069 f1 0.5079
max_acc 0.8883 max_p 0.6754 max_r 0.4069 max_f1 0.5079

position_predict: test acc 0.9249 p 0.7017 r 0.7213 f1 0.7113
max_acc 0.9249 max_p 0.7017 max_r 0.7213 max_f1 0.7113

Average max cause: max_acc 0.8883 max_p 0.6754 max_r 0.4069 max_f1 0.5079
Average max pos: max_acc 0.9249 max_p 0.7017 max_r 0.7213 max_f1 0.7113

step 10: train loss 0.3425 
cause_predict: train acc 0.9052 p 0.7200 r 0.5455 f1 0.6207
position_predict: train acc 0.9655 p 0.9000 r 0.8438 f1 0.8710
step 20: train loss 0.3821 
cause_predict: train acc 0.9277 p 0.7714 r 0.7500 f1 0.7606
position_predict: train acc 0.9489 p 0.8846 r 0.7188 f1 0.7931
step 30: train loss 0.3646 
cause_predict: train acc 0.9051 p 0.7200 r 0.5143 f1 0.6000
position_predict: train acc 0.9565 p 0.8387 r 0.8125 f1 0.8254
step 40: train loss 0.2853 
cause_predict: train acc 0.9022 p 0.7826 r 0.5143 f1 0.6207
position_predict: train acc 0.9822 p 0.9375 r 0.9375 f1 0.9375
step 50: train loss 0.3578 
cause_predict: train acc 0.9127 p 0.8500 r 0.4722 f1 0.6071
position_predict: train acc 0.9484 p 0.8065 r 0.7812 f1 0.7937
step 60: train loss 0.4417 
cause_predict: train acc 0.9070 p 0.7917 r 0.5588 f1 0.6552
position_predict: train acc 0.9116 p 0.7600 r 0.5938 f1 0.6667
step 70: train loss 0.3489 
cause_predict: train acc 0.9377 p 0.7188 r 0.6571 f1 0.6866
position_predict: train acc 0.9436 p 0.7692 r 0.6061 f1 0.6780

epoch 4: test loss 0.4733 cost time: 12.8s

cause_predict: test acc 0.8968 p 0.6955 r 0.4826 f1 0.5698
max_acc 0.8968 max_p 0.6955 max_r 0.4826 max_f1 0.5698

position_predict: test acc 0.9290 p 0.7207 r 0.7282 f1 0.7244
max_acc 0.9290 max_p 0.7207 max_r 0.7282 max_f1 0.7244

Average max cause: max_acc 0.8968 max_p 0.6955 max_r 0.4826 max_f1 0.5698
Average max pos: max_acc 0.9290 max_p 0.7207 max_r 0.7282 max_f1 0.7244

step 10: train loss 0.3144 
cause_predict: train acc 0.9303 p 0.8333 r 0.6757 f1 0.7463
position_predict: train acc 0.9467 p 0.8276 r 0.7500 f1 0.7869
step 20: train loss 0.3343 
cause_predict: train acc 0.8903 p 0.6429 r 0.5294 f1 0.5806
position_predict: train acc 0.9620 p 0.8750 r 0.8485 f1 0.8615
step 30: train loss 0.2532 
cause_predict: train acc 0.9474 p 0.8125 r 0.8125 f1 0.8125
position_predict: train acc 0.9474 p 0.7941 r 0.8438 f1 0.8182
step 40: train loss 0.3973 
cause_predict: train acc 0.9253 p 0.7143 r 0.7576 f1 0.7353
position_predict: train acc 0.9212 p 0.7241 r 0.6562 f1 0.6885
step 50: train loss 0.3920 
cause_predict: train acc 0.8992 p 0.6757 r 0.6757 f1 0.6757
position_predict: train acc 0.9496 p 0.8571 r 0.7500 f1 0.8000
step 60: train loss 0.4156 
cause_predict: train acc 0.9016 p 0.7576 r 0.6944 f1 0.7246
position_predict: train acc 0.9171 p 0.7500 r 0.7500 f1 0.7500
step 70: train loss 0.2340 
cause_predict: train acc 0.9508 p 0.9630 r 0.7027 f1 0.8125
position_predict: train acc 0.9549 p 0.8387 r 0.8125 f1 0.8254

epoch 5: test loss 0.4933 cost time: 12.9s

cause_predict: test acc 0.8923 p 0.6652 r 0.4826 f1 0.5594
max_acc 0.8968 max_p 0.6955 max_r 0.4826 max_f1 0.5698

position_predict: test acc 0.9236 p 0.7028 r 0.7003 f1 0.7016
max_acc 0.9290 max_p 0.7207 max_r 0.7282 max_f1 0.7244

Average max cause: max_acc 0.8968 max_p 0.6955 max_r 0.4826 max_f1 0.5698
Average max pos: max_acc 0.9290 max_p 0.7207 max_r 0.7282 max_f1 0.7244

step 10: train loss 0.2226 
cause_predict: train acc 0.9513 p 0.8438 r 0.7297 f1 0.7826
position_predict: train acc 0.9513 p 0.7931 r 0.7188 f1 0.7541
step 20: train loss 0.2019 
cause_predict: train acc 0.9513 p 0.9355 r 0.7250 f1 0.8169
position_predict: train acc 0.9588 p 0.8235 r 0.8485 f1 0.8358
step 30: train loss 0.2592 
cause_predict: train acc 0.9571 p 0.8750 r 0.8235 f1 0.8485
position_predict: train acc 0.9571 p 0.8438 r 0.8438 f1 0.8438
step 40: train loss 0.2751 
cause_predict: train acc 0.9487 p 0.8667 r 0.7647 f1 0.8125
position_predict: train acc 0.9487 p 0.7941 r 0.8438 f1 0.8182
step 50: train loss 0.2435 
cause_predict: train acc 0.9234 p 0.7879 r 0.7027 f1 0.7429
position_predict: train acc 0.9532 p 0.8235 r 0.8485 f1 0.8358
step 60: train loss 0.3140 
cause_predict: train acc 0.9398 p 0.8529 r 0.7838 f1 0.8169
position_predict: train acc 0.9491 p 0.8889 r 0.7500 f1 0.8136
step 70: train loss 0.3491 
cause_predict: train acc 0.9141 p 0.8065 r 0.6944 f1 0.7463
position_predict: train acc 0.9444 p 0.8621 r 0.7812 f1 0.8197

epoch 6: test loss 0.5330 cost time: 12.8s

cause_predict: test acc 0.8825 p 0.6134 r 0.4606 f1 0.5261
max_acc 0.8968 max_p 0.6955 max_r 0.4826 max_f1 0.5698

position_predict: test acc 0.9169 p 0.7078 r 0.5993 f1 0.6491
max_acc 0.9290 max_p 0.7207 max_r 0.7282 max_f1 0.7244

Average max cause: max_acc 0.8968 max_p 0.6955 max_r 0.4826 max_f1 0.5698
Average max pos: max_acc 0.9290 max_p 0.7207 max_r 0.7282 max_f1 0.7244

step 10: train loss 0.2302 
cause_predict: train acc 0.9519 p 0.8378 r 0.8158 f1 0.8267
position_predict: train acc 0.9704 p 0.8824 r 0.8824 f1 0.8824
step 20: train loss 0.2643 
cause_predict: train acc 0.9296 p 0.7419 r 0.6571 f1 0.6970
position_predict: train acc 0.9683 p 0.9286 r 0.7879 f1 0.8525
step 30: train loss 0.2709 
cause_predict: train acc 0.9540 p 0.8710 r 0.7941 f1 0.8308
position_predict: train acc 0.9414 p 0.7812 r 0.7812 f1 0.7812
step 40: train loss 0.2600 
cause_predict: train acc 0.9264 p 0.7333 r 0.6667 f1 0.6984
position_predict: train acc 0.9690 p 0.8529 r 0.9062 f1 0.8788
step 50: train loss 0.3455 
cause_predict: train acc 0.9123 p 0.7576 r 0.6757 f1 0.7143
position_predict: train acc 0.9561 p 0.8235 r 0.8750 f1 0.8485
step 60: train loss 0.2541 
cause_predict: train acc 0.9286 p 0.8333 r 0.7576 f1 0.7937
position_predict: train acc 0.9725 p 0.9091 r 0.9375 f1 0.9231
step 70: train loss 0.3455 
cause_predict: train acc 0.9194 p 0.8519 r 0.6389 f1 0.7302
position_predict: train acc 0.9194 p 0.7419 r 0.7188 f1 0.7302

epoch 7: test loss 0.5438 cost time: 13.1s

cause_predict: test acc 0.8910 p 0.6553 r 0.4858 f1 0.5580
max_acc 0.8968 max_p 0.6955 max_r 0.4826 max_f1 0.5698

position_predict: test acc 0.9178 p 0.6943 r 0.6411 f1 0.6667
max_acc 0.9290 max_p 0.7207 max_r 0.7282 max_f1 0.7244

Average max cause: max_acc 0.8968 max_p 0.6955 max_r 0.4826 max_f1 0.5698
Average max pos: max_acc 0.9290 max_p 0.7207 max_r 0.7282 max_f1 0.7244

step 10: train loss 0.2006 
cause_predict: train acc 0.9570 p 0.8571 r 0.7895 f1 0.8219
position_predict: train acc 0.9669 p 0.8286 r 0.8788 f1 0.8529
step 20: train loss 0.2688 
cause_predict: train acc 0.9400 p 0.8108 r 0.8571 f1 0.8333
position_predict: train acc 0.9600 p 0.9000 r 0.8438 f1 0.8710
step 30: train loss 0.2433 
cause_predict: train acc 0.9363 p 0.8235 r 0.8000 f1 0.8116
position_predict: train acc 0.9608 p 0.8333 r 0.9375 f1 0.8824
step 40: train loss 0.1841 
cause_predict: train acc 0.9561 p 0.9091 r 0.8333 f1 0.8696
position_predict: train acc 0.9805 p 0.8889 r 1.0000 f1 0.9412
step 50: train loss 0.2281 
cause_predict: train acc 0.9286 p 0.7812 r 0.7143 f1 0.7463
position_predict: train acc 0.9580 p 0.8235 r 0.8750 f1 0.8485
step 60: train loss 0.2582 
cause_predict: train acc 0.9551 p 0.8611 r 0.8378 f1 0.8493
position_predict: train acc 0.9633 p 0.8485 r 0.8750 f1 0.8615
step 70: train loss 0.2356 
cause_predict: train acc 0.9557 p 0.8158 r 0.8611 f1 0.8378
position_predict: train acc 0.9557 p 0.8333 r 0.7812 f1 0.8065

epoch 8: test loss 0.6017 cost time: 12.5s

cause_predict: test acc 0.8838 p 0.6044 r 0.5205 f1 0.5593
max_acc 0.8968 max_p 0.6955 max_r 0.4826 max_f1 0.5698

position_predict: test acc 0.9191 p 0.7087 r 0.6272 f1 0.6654
max_acc 0.9290 max_p 0.7207 max_r 0.7282 max_f1 0.7244

Average max cause: max_acc 0.8968 max_p 0.6955 max_r 0.4826 max_f1 0.5698
Average max pos: max_acc 0.9290 max_p 0.7207 max_r 0.7282 max_f1 0.7244

step 10: train loss 0.1564 
cause_predict: train acc 0.9674 p 0.8571 r 0.8824 f1 0.8696
position_predict: train acc 0.9529 p 0.7714 r 0.8438 f1 0.8060
step 20: train loss 0.1929 
cause_predict: train acc 0.9461 p 0.8438 r 0.8182 f1 0.8308
position_predict: train acc 0.9657 p 0.9310 r 0.8438 f1 0.8852
step 30: train loss 0.2504 
cause_predict: train acc 0.9498 p 0.8378 r 0.8378 f1 0.8378
position_predict: train acc 0.9582 p 0.8667 r 0.8125 f1 0.8387
step 40: train loss 0.1627 
cause_predict: train acc 0.9447 p 0.8966 r 0.7429 f1 0.8125
position_predict: train acc 0.9908 p 0.9688 r 0.9688 f1 0.9688
step 50: train loss 0.2022 
cause_predict: train acc 0.9577 p 0.8235 r 0.8485 f1 0.8358
position_predict: train acc 0.9615 p 0.8750 r 0.8235 f1 0.8485
step 60: train loss 0.2069 
cause_predict: train acc 0.9556 p 0.8889 r 0.8421 f1 0.8649
position_predict: train acc 0.9600 p 0.8485 r 0.8750 f1 0.8615
step 70: train loss 0.2443 
cause_predict: train acc 0.9442 p 0.8667 r 0.7429 f1 0.8000
position_predict: train acc 0.9700 p 0.8824 r 0.9091 f1 0.8955

epoch 9: test loss 0.6422 cost time: 12.7s

cause_predict: test acc 0.8861 p 0.6148 r 0.5237 f1 0.5656
max_acc 0.8968 max_p 0.6955 max_r 0.4826 max_f1 0.5698

position_predict: test acc 0.9147 p 0.6589 r 0.6934 f1 0.6757
max_acc 0.9290 max_p 0.7207 max_r 0.7282 max_f1 0.7244

Average max cause: max_acc 0.8968 max_p 0.6955 max_r 0.4826 max_f1 0.5698
Average max pos: max_acc 0.9290 max_p 0.7207 max_r 0.7282 max_f1 0.7244

step 10: train loss 0.1716 
cause_predict: train acc 0.9776 p 0.9429 r 0.8684 f1 0.9041
position_predict: train acc 0.9457 p 0.8148 r 0.6471 f1 0.7213
step 20: train loss 0.1459 
cause_predict: train acc 0.9688 p 0.8529 r 0.8529 f1 0.8529
position_predict: train acc 0.9781 p 0.9630 r 0.8125 f1 0.8814
step 30: train loss 0.1801 
cause_predict: train acc 0.9451 p 0.7714 r 0.8438 f1 0.8060
position_predict: train acc 0.9705 p 0.9310 r 0.8438 f1 0.8852
step 40: train loss 0.1852 
cause_predict: train acc 0.9697 p 0.9714 r 0.8500 f1 0.9067
position_predict: train acc 0.9697 p 0.8788 r 0.9062 f1 0.8923
step 50: train loss 0.1651 
cause_predict: train acc 0.9725 p 0.8919 r 0.8919 f1 0.8919
position_predict: train acc 0.9622 p 0.8621 r 0.7812 f1 0.8197
step 60: train loss 0.0802 
cause_predict: train acc 0.9910 p 0.9412 r 1.0000 f1 0.9697
position_predict: train acc 0.9910 p 0.9697 r 0.9697 f1 0.9697
step 70: train loss 0.1337 
cause_predict: train acc 0.9673 p 0.8611 r 0.8857 f1 0.8732
position_predict: train acc 0.9782 p 0.9062 r 0.9062 f1 0.9062

epoch 10: test loss 0.6629 cost time: 12.9s

cause_predict: test acc 0.8794 p 0.5776 r 0.5521 f1 0.5645
max_acc 0.8968 max_p 0.6955 max_r 0.4826 max_f1 0.5698

position_predict: test acc 0.9124 p 0.6532 r 0.6760 f1 0.6644
max_acc 0.9290 max_p 0.7207 max_r 0.7282 max_f1 0.7244

Average max cause: max_acc 0.8968 max_p 0.6955 max_r 0.4826 max_f1 0.5698
Average max pos: max_acc 0.9290 max_p 0.7207 max_r 0.7282 max_f1 0.7244

step 10: train loss 0.1242 
cause_predict: train acc 0.9813 p 0.9091 r 0.9375 f1 0.9231
position_predict: train acc 0.9701 p 0.8788 r 0.8788 f1 0.8788
step 20: train loss 0.2583 
cause_predict: train acc 0.9665 p 0.9143 r 0.8889 f1 0.9014
position_predict: train acc 0.9617 p 0.8750 r 0.8750 f1 0.8750
step 30: train loss 0.2880 
cause_predict: train acc 0.9302 p 0.8889 r 0.7442 f1 0.8101
position_predict: train acc 0.9442 p 0.7941 r 0.8438 f1 0.8182
step 40: train loss 0.0418 
cause_predict: train acc 1.0000 p 1.0000 r 1.0000 f1 1.0000
position_predict: train acc 0.9889 p 0.9677 r 0.9375 f1 0.9524
step 50: train loss 0.1748 
cause_predict: train acc 0.9757 p 0.9394 r 0.9118 f1 0.9254
position_predict: train acc 0.9757 p 0.9355 r 0.9062 f1 0.9206
step 60: train loss 0.1260 
cause_predict: train acc 0.9590 p 0.8378 r 0.9394 f1 0.8857
position_predict: train acc 0.9846 p 0.9394 r 0.9688 f1 0.9538
step 70: train loss 0.1383 
cause_predict: train acc 0.9701 p 0.9355 r 0.8788 f1 0.9062
position_predict: train acc 0.9900 p 0.9688 r 0.9688 f1 0.9688

epoch 11: test loss 0.6998 cost time: 12.8s

cause_predict: test acc 0.8762 p 0.5641 r 0.5552 f1 0.5596
max_acc 0.8968 max_p 0.6955 max_r 0.4826 max_f1 0.5698

position_predict: test acc 0.9173 p 0.6735 r 0.6899 f1 0.6816
max_acc 0.9290 max_p 0.7207 max_r 0.7282 max_f1 0.7244

Average max cause: max_acc 0.8968 max_p 0.6955 max_r 0.4826 max_f1 0.5698
Average max pos: max_acc 0.9290 max_p 0.7207 max_r 0.7282 max_f1 0.7244

step 10: train loss 0.0672 
cause_predict: train acc 0.9924 p 0.9714 r 0.9714 f1 0.9714
position_predict: train acc 0.9848 p 0.9118 r 0.9688 f1 0.9394
step 20: train loss 0.1549 
cause_predict: train acc 0.9645 p 0.7949 r 0.9394 f1 0.8611
position_predict: train acc 0.9681 p 0.8485 r 0.8750 f1 0.8615
step 30: train loss 0.1207 
cause_predict: train acc 0.9823 p 0.9459 r 0.9211 f1 0.9333
position_predict: train acc 0.9647 p 0.8750 r 0.8235 f1 0.8485
step 40: train loss 0.1445 
cause_predict: train acc 0.9726 p 0.9091 r 0.9091 f1 0.9091
position_predict: train acc 0.9635 p 0.8750 r 0.8750 f1 0.8750
step 50: train loss 0.1211 
cause_predict: train acc 0.9696 p 0.8537 r 0.9211 f1 0.8861
position_predict: train acc 0.9831 p 0.9355 r 0.9062 f1 0.9206
step 60: train loss 0.1041 
cause_predict: train acc 0.9680 p 0.8889 r 0.8889 f1 0.8889
position_predict: train acc 0.9880 p 0.9677 r 0.9375 f1 0.9524
step 70: train loss 0.2189 
cause_predict: train acc 0.9787 p 0.8889 r 0.9697 f1 0.9275
position_predict: train acc 0.9447 p 0.7714 r 0.8438 f1 0.8060

epoch 12: test loss 0.7236 cost time: 13.0s

cause_predict: test acc 0.8780 p 0.5692 r 0.5710 f1 0.5701
max_acc 0.8780 max_p 0.5692 max_r 0.5710 max_f1 0.5701

position_predict: test acc 0.9164 p 0.6761 r 0.6690 f1 0.6725
max_acc 0.9290 max_p 0.7207 max_r 0.7282 max_f1 0.7244

Average max cause: max_acc 0.8968 max_p 0.6955 max_r 0.4826 max_f1 0.5698
Average max pos: max_acc 0.9290 max_p 0.7207 max_r 0.7282 max_f1 0.7244

step 10: train loss 0.1605 
cause_predict: train acc 0.9447 p 0.8529 r 0.7838 f1 0.8169
position_predict: train acc 0.9745 p 0.9355 r 0.8788 f1 0.9062
step 20: train loss 0.1126 
cause_predict: train acc 0.9751 p 0.9024 r 0.9737 f1 0.9367
position_predict: train acc 0.9701 p 0.8611 r 0.9688 f1 0.9118
step 30: train loss 0.0684 
cause_predict: train acc 0.9783 p 0.9118 r 0.9394 f1 0.9254
position_predict: train acc 0.9913 p 1.0000 r 0.9375 f1 0.9677
step 40: train loss 0.1430 
cause_predict: train acc 0.9754 p 0.8947 r 0.9444 f1 0.9189
position_predict: train acc 0.9713 p 0.8824 r 0.9091 f1 0.8955
step 50: train loss 0.1469 
cause_predict: train acc 0.9783 p 0.8889 r 0.9412 f1 0.9143
position_predict: train acc 0.9601 p 0.8387 r 0.8125 f1 0.8254
step 60: train loss 0.1046 
cause_predict: train acc 1.0000 p 1.0000 r 1.0000 f1 1.0000
position_predict: train acc 0.9720 p 0.9062 r 0.9062 f1 0.9062
step 70: train loss 0.1178 
cause_predict: train acc 0.9742 p 0.9189 r 0.9189 f1 0.9189
position_predict: train acc 0.9785 p 0.9655 r 0.8750 f1 0.9180

epoch 13: test loss 0.7524 cost time: 12.6s

cause_predict: test acc 0.8852 p 0.6064 r 0.5394 f1 0.5710
max_acc 0.8852 max_p 0.6064 max_r 0.5394 max_f1 0.5710

position_predict: test acc 0.9129 p 0.6608 r 0.6585 f1 0.6597
max_acc 0.9290 max_p 0.7207 max_r 0.7282 max_f1 0.7244

Average max cause: max_acc 0.8968 max_p 0.6955 max_r 0.4826 max_f1 0.5698
Average max pos: max_acc 0.9290 max_p 0.7207 max_r 0.7282 max_f1 0.7244

step 10: train loss 0.0828 
cause_predict: train acc 0.9793 p 0.9167 r 0.9429 f1 0.9296
position_predict: train acc 0.9959 p 0.9697 r 1.0000 f1 0.9846
step 20: train loss 0.0591 
cause_predict: train acc 0.9905 p 1.0000 r 0.9429 f1 0.9706
position_predict: train acc 0.9810 p 0.9375 r 0.9375 f1 0.9375
step 30: train loss 0.1355 
cause_predict: train acc 0.9775 p 0.9429 r 0.9167 f1 0.9296
position_predict: train acc 0.9910 p 0.9688 r 0.9688 f1 0.9688
step 40: train loss 0.0883 
cause_predict: train acc 0.9871 p 0.9714 r 0.9444 f1 0.9577
position_predict: train acc 0.9828 p 0.9375 r 0.9375 f1 0.9375
step 50: train loss 0.1035 
cause_predict: train acc 0.9791 p 0.9722 r 0.8974 f1 0.9333
position_predict: train acc 0.9791 p 0.9394 r 0.9118 f1 0.9254
step 60: train loss 0.0594 
cause_predict: train acc 0.9895 p 0.9706 r 0.9429 f1 0.9565
position_predict: train acc 0.9861 p 0.9375 r 0.9375 f1 0.9375
step 70: train loss 0.1461 
cause_predict: train acc 0.9769 p 0.9487 r 0.9250 f1 0.9367
position_predict: train acc 0.9769 p 0.9091 r 0.9375 f1 0.9231

epoch 14: test loss 0.7899 cost time: 12.5s

cause_predict: test acc 0.8811 p 0.5876 r 0.5394 f1 0.5625
max_acc 0.8852 max_p 0.6064 max_r 0.5394 max_f1 0.5710

position_predict: test acc 0.9115 p 0.6618 r 0.6341 f1 0.6477
max_acc 0.9290 max_p 0.7207 max_r 0.7282 max_f1 0.7244

Average max cause: max_acc 0.8968 max_p 0.6955 max_r 0.4826 max_f1 0.5698
Average max pos: max_acc 0.9290 max_p 0.7207 max_r 0.7282 max_f1 0.7244

write pair_data/Ind_BiLSTM_1/fold_1_test.txt done
write pair_data/Ind_BiLSTM_1/fold_1_train.txt done
Optimization Finished!

############# fold 1 end ###############
############# fold 2 begin ###############
load data_file: data_combine_en/fold_2_train.txt
y_position.shape (2275, 75, 2)
y_cause.shape (2275, 75, 2)
x.shape (2275, 75, 30)
sen_len.shape (2275, 75)
doc_len.shape (2275,)
n_cut 107
load data done!

load data_file: data_combine_en/fold_2_test.txt
y_position.shape (284, 75, 2)
y_cause.shape (284, 75, 2)
x.shape (284, 75, 30)
sen_len.shape (284, 75)
doc_len.shape (284,)
n_cut 22
load data done!

train docs: 2275    test docs: 284
step 10: train loss 0.7759 
cause_predict: train acc 0.8726 p 0.0000 r 0.0000 f1 0.0000
position_predict: train acc 0.8726 p 0.0000 r 0.0000 f1 0.0000
step 20: train loss 0.7838 
cause_predict: train acc 0.8333 p 0.0000 r 0.0000 f1 0.0000
position_predict: train acc 0.8596 p 0.0000 r 0.0000 f1 0.0000
step 30: train loss 0.8466 
cause_predict: train acc 0.7857 p 0.0000 r 0.0000 f1 0.0000
position_predict: train acc 0.8095 p 0.0000 r 0.0000 f1 0.0000
step 40: train loss 0.6782 
cause_predict: train acc 0.8373 p 0.0000 r 0.0000 f1 0.0000
position_predict: train acc 0.8900 p 0.8000 r 0.3750 f1 0.5106
step 50: train loss 0.5424 
cause_predict: train acc 0.8740 p 0.0000 r 0.0000 f1 0.0000
position_predict: train acc 0.8898 p 0.5833 r 0.4375 f1 0.5000
step 60: train loss 0.5736 
cause_predict: train acc 0.8640 p 1.0000 r 0.0556 f1 0.1053
position_predict: train acc 0.9000 p 1.0000 r 0.2188 f1 0.3590
step 70: train loss 0.5611 
cause_predict: train acc 0.8745 p 0.7500 r 0.2250 f1 0.3462
position_predict: train acc 0.9077 p 0.6818 r 0.4545 f1 0.5455

epoch 0: test loss 0.5224 cost time: 12.8s

cause_predict: test acc 0.8892 p 0.7482 r 0.3281 f1 0.4561
max_acc 0.8892 max_p 0.7482 max_r 0.3281 max_f1 0.4561

position_predict: test acc 0.9111 p 0.6517 r 0.6585 f1 0.6551
max_acc 0.9111 max_p 0.6517 max_r 0.6585 max_f1 0.6551

Average max cause: max_acc 0.8892 max_p 0.7482 max_r 0.3281 max_f1 0.4561
Average max pos: max_acc 0.9111 max_p 0.6517 max_r 0.6585 max_f1 0.6551

step 10: train loss 0.4942 
cause_predict: train acc 0.8721 p 0.7000 r 0.1892 f1 0.2979
position_predict: train acc 0.9225 p 0.7143 r 0.6250 f1 0.6667
step 20: train loss 0.5550 
cause_predict: train acc 0.8953 p 0.8182 r 0.2647 f1 0.4000
position_predict: train acc 0.9109 p 0.6957 r 0.5000 f1 0.5818
step 30: train loss 0.4616 
cause_predict: train acc 0.8769 p 0.8000 r 0.1111 f1 0.1951
position_predict: train acc 0.9366 p 0.8947 r 0.5312 f1 0.6667
step 40: train loss 0.5395 
cause_predict: train acc 0.8621 p 0.6667 r 0.0952 f1 0.1667
position_predict: train acc 0.9276 p 0.7000 r 0.6364 f1 0.6667
step 50: train loss 0.5191 
cause_predict: train acc 0.8938 p 0.7778 r 0.4118 f1 0.5385
position_predict: train acc 0.8894 p 0.6000 r 0.6562 f1 0.6269
step 60: train loss 0.5193 
cause_predict: train acc 0.8787 p 0.7500 r 0.2571 f1 0.3830
position_predict: train acc 0.9121 p 0.7308 r 0.5758 f1 0.6441
step 70: train loss 0.5327 
cause_predict: train acc 0.8612 p 0.6111 r 0.2895 f1 0.3929
position_predict: train acc 0.9102 p 0.6786 r 0.5938 f1 0.6333

epoch 1: test loss 0.4770 cost time: 12.7s

cause_predict: test acc 0.8883 p 0.6772 r 0.4038 f1 0.5059
max_acc 0.8883 max_p 0.6772 max_r 0.4038 max_f1 0.5059

position_predict: test acc 0.9191 p 0.7387 r 0.5714 f1 0.6444
max_acc 0.9111 max_p 0.6517 max_r 0.6585 max_f1 0.6551

Average max cause: max_acc 0.8883 max_p 0.6772 max_r 0.4038 max_f1 0.5059
Average max pos: max_acc 0.9191 max_p 0.7387 max_r 0.5714 max_f1 0.6444

step 10: train loss 0.4229 
cause_predict: train acc 0.9135 p 0.7826 r 0.4737 f1 0.5902
position_predict: train acc 0.9446 p 0.7742 r 0.7273 f1 0.7500
step 20: train loss 0.3595 
cause_predict: train acc 0.9106 p 0.8235 r 0.4242 f1 0.5600
position_predict: train acc 0.9431 p 0.8462 r 0.6875 f1 0.7586
step 30: train loss 0.4014 
cause_predict: train acc 0.9151 p 0.7143 r 0.4688 f1 0.5660
position_predict: train acc 0.9483 p 0.8214 r 0.7188 f1 0.7667
step 40: train loss 0.4895 
cause_predict: train acc 0.8784 p 0.6667 r 0.2778 f1 0.3922
position_predict: train acc 0.9059 p 0.7000 r 0.4375 f1 0.5385
step 50: train loss 0.4727 
cause_predict: train acc 0.9070 p 0.8095 r 0.5152 f1 0.6296
position_predict: train acc 0.9163 p 0.7188 r 0.7188 f1 0.7188
step 60: train loss 0.4846 
cause_predict: train acc 0.8857 p 0.8333 r 0.2778 f1 0.4167
position_predict: train acc 0.9143 p 0.6774 r 0.6562 f1 0.6667
step 70: train loss 0.4534 
cause_predict: train acc 0.8745 p 0.5926 r 0.4571 f1 0.5161
position_predict: train acc 0.9623 p 0.9000 r 0.8182 f1 0.8571

epoch 2: test loss 0.4758 cost time: 12.9s

cause_predict: test acc 0.8878 p 0.6650 r 0.4196 f1 0.5145
max_acc 0.8878 max_p 0.6650 max_r 0.4196 max_f1 0.5145

position_predict: test acc 0.9236 p 0.7117 r 0.6794 f1 0.6952
max_acc 0.9236 max_p 0.7117 max_r 0.6794 max_f1 0.6952

Average max cause: max_acc 0.8878 max_p 0.6650 max_r 0.4196 max_f1 0.5145
Average max pos: max_acc 0.9236 max_p 0.7117 max_r 0.6794 max_f1 0.6952

step 10: train loss 0.4543 
cause_predict: train acc 0.8555 p 0.5000 r 0.2432 f1 0.3273
position_predict: train acc 0.9453 p 0.8065 r 0.7576 f1 0.7812
step 20: train loss 0.5651 
cause_predict: train acc 0.8476 p 0.8750 r 0.1842 f1 0.3043
position_predict: train acc 0.9286 p 0.7576 r 0.7812 f1 0.7692
step 30: train loss 0.4042 
cause_predict: train acc 0.9190 p 0.7778 r 0.6562 f1 0.7119
position_predict: train acc 0.9143 p 0.7059 r 0.7500 f1 0.7273
step 40: train loss 0.4213 
cause_predict: train acc 0.8938 p 0.8500 r 0.4474 f1 0.5862
position_predict: train acc 0.9204 p 0.7692 r 0.6250 f1 0.6897
step 50: train loss 0.5066 
cause_predict: train acc 0.8780 p 0.6129 r 0.5938 f1 0.6032
position_predict: train acc 0.8829 p 0.6452 r 0.6061 f1 0.6250
step 60: train loss 0.5470 
cause_predict: train acc 0.8814 p 0.6818 r 0.3947 f1 0.5000
position_predict: train acc 0.8893 p 0.5625 r 0.5625 f1 0.5625
step 70: train loss 0.4488 
cause_predict: train acc 0.9027 p 0.6897 r 0.6061 f1 0.6452
position_predict: train acc 0.9336 p 0.8148 r 0.6875 f1 0.7458

epoch 3: test loss 0.4597 cost time: 12.7s

cause_predict: test acc 0.8990 p 0.7059 r 0.4921 f1 0.5799
max_acc 0.8990 max_p 0.7059 max_r 0.4921 max_f1 0.5799

position_predict: test acc 0.9272 p 0.7168 r 0.7143 f1 0.7155
max_acc 0.9272 max_p 0.7168 max_r 0.7143 max_f1 0.7155

Average max cause: max_acc 0.8990 max_p 0.7059 max_r 0.4921 max_f1 0.5799
Average max pos: max_acc 0.9272 max_p 0.7168 max_r 0.7143 max_f1 0.7155

step 10: train loss 0.3907 
cause_predict: train acc 0.8826 p 0.6667 r 0.5128 f1 0.5797
position_predict: train acc 0.9433 p 0.8214 r 0.7188 f1 0.7667
step 20: train loss 0.3776 
cause_predict: train acc 0.9447 p 0.8966 r 0.7647 f1 0.8254
position_predict: train acc 0.9246 p 0.7931 r 0.7188 f1 0.7541
step 30: train loss 0.3547 
cause_predict: train acc 0.9104 p 0.7241 r 0.5676 f1 0.6364
position_predict: train acc 0.9403 p 0.7667 r 0.7188 f1 0.7419
step 40: train loss 0.5259 
cause_predict: train acc 0.8713 p 0.8400 r 0.5385 f1 0.6562
position_predict: train acc 0.9298 p 0.7941 r 0.8438 f1 0.8182
step 50: train loss 0.3285 
cause_predict: train acc 0.9309 p 0.8696 r 0.5556 f1 0.6780
position_predict: train acc 0.9382 p 0.7273 r 0.7500 f1 0.7385
step 60: train loss 0.4117 
cause_predict: train acc 0.8770 p 0.6667 r 0.3243 f1 0.4364
position_predict: train acc 0.9444 p 0.8276 r 0.7273 f1 0.7742
step 70: train loss 0.4615 
cause_predict: train acc 0.8816 p 0.6957 r 0.4211 f1 0.5246
position_predict: train acc 0.9388 p 0.8148 r 0.6875 f1 0.7458

epoch 4: test loss 0.4768 cost time: 13.0s

cause_predict: test acc 0.8941 p 0.7083 r 0.4290 f1 0.5344
max_acc 0.8990 max_p 0.7059 max_r 0.4921 max_f1 0.5799

position_predict: test acc 0.9209 p 0.6964 r 0.6794 f1 0.6878
max_acc 0.9272 max_p 0.7168 max_r 0.7143 max_f1 0.7155

Average max cause: max_acc 0.8990 max_p 0.7059 max_r 0.4921 max_f1 0.5799
Average max pos: max_acc 0.9272 max_p 0.7168 max_r 0.7143 max_f1 0.7155

step 10: train loss 0.2939 
cause_predict: train acc 0.9245 p 0.7586 r 0.6286 f1 0.6875
position_predict: train acc 0.9623 p 0.8056 r 0.9062 f1 0.8529
step 20: train loss 0.3530 
cause_predict: train acc 0.9126 p 0.7500 r 0.7059 f1 0.7273
position_predict: train acc 0.9515 p 0.8929 r 0.7812 f1 0.8333
step 30: train loss 0.3683 
cause_predict: train acc 0.9025 p 0.8696 r 0.5000 f1 0.6349
position_predict: train acc 0.9534 p 0.8621 r 0.7812 f1 0.8197
step 40: train loss 0.3479 
cause_predict: train acc 0.8921 p 0.6176 r 0.6176 f1 0.6176
position_predict: train acc 0.9502 p 0.8333 r 0.7812 f1 0.8065
step 50: train loss 0.4446 
cause_predict: train acc 0.8973 p 0.6429 r 0.5143 f1 0.5714
position_predict: train acc 0.9240 p 0.6875 r 0.6875 f1 0.6875
step 60: train loss 0.2661 
cause_predict: train acc 0.9596 p 0.8286 r 0.8529 f1 0.8406
position_predict: train acc 0.9154 p 0.6364 r 0.6562 f1 0.6462
step 70: train loss 0.4377 
cause_predict: train acc 0.8936 p 0.7600 r 0.5758 f1 0.6552
position_predict: train acc 0.9149 p 0.7500 r 0.7500 f1 0.7500

epoch 5: test loss 0.4752 cost time: 12.8s

cause_predict: test acc 0.8887 p 0.6259 r 0.5331 f1 0.5758
max_acc 0.8990 max_p 0.7059 max_r 0.4921 max_f1 0.5799

position_predict: test acc 0.9214 p 0.7110 r 0.6516 f1 0.6800
max_acc 0.9272 max_p 0.7168 max_r 0.7143 max_f1 0.7155

Average max cause: max_acc 0.8990 max_p 0.7059 max_r 0.4921 max_f1 0.5799
Average max pos: max_acc 0.9272 max_p 0.7168 max_r 0.7143 max_f1 0.7155

step 10: train loss 0.2073 
cause_predict: train acc 0.9486 p 0.8621 r 0.7353 f1 0.7937
position_predict: train acc 0.9802 p 0.9375 r 0.9091 f1 0.9231
step 20: train loss 0.2364 
cause_predict: train acc 0.9678 p 0.9231 r 0.7273 f1 0.8136
position_predict: train acc 0.9444 p 0.7241 r 0.6562 f1 0.6885
step 30: train loss 0.3379 
cause_predict: train acc 0.9212 p 0.8519 r 0.6053 f1 0.7077
position_predict: train acc 0.9544 p 0.8387 r 0.8125 f1 0.8254
step 40: train loss 0.2703 
cause_predict: train acc 0.9336 p 0.8571 r 0.6857 f1 0.7619
position_predict: train acc 0.9602 p 0.8710 r 0.8438 f1 0.8571
step 50: train loss 0.2356 
cause_predict: train acc 0.9502 p 0.9259 r 0.6944 f1 0.7937
position_predict: train acc 0.9617 p 0.8710 r 0.8182 f1 0.8438
step 60: train loss 0.3221 
cause_predict: train acc 0.9370 p 0.8696 r 0.6061 f1 0.7143
position_predict: train acc 0.9488 p 0.8333 r 0.7576 f1 0.7937
step 70: train loss 0.2095 
cause_predict: train acc 0.9422 p 0.8000 r 0.6857 f1 0.7385
position_predict: train acc 0.9762 p 0.8788 r 0.9062 f1 0.8923

epoch 6: test loss 0.5388 cost time: 12.8s

cause_predict: test acc 0.8954 p 0.6828 r 0.4890 f1 0.5699
max_acc 0.8990 max_p 0.7059 max_r 0.4921 max_f1 0.5799

position_predict: test acc 0.9142 p 0.6753 r 0.6376 f1 0.6559
max_acc 0.9272 max_p 0.7168 max_r 0.7143 max_f1 0.7155

Average max cause: max_acc 0.8990 max_p 0.7059 max_r 0.4921 max_f1 0.5799
Average max pos: max_acc 0.9272 max_p 0.7168 max_r 0.7143 max_f1 0.7155

step 10: train loss 0.2340 
cause_predict: train acc 0.9397 p 0.8182 r 0.7105 f1 0.7606
position_predict: train acc 0.9681 p 0.9310 r 0.7941 f1 0.8571
step 20: train loss 0.2526 
cause_predict: train acc 0.9342 p 0.8438 r 0.7105 f1 0.7714
position_predict: train acc 0.9588 p 0.8235 r 0.8750 f1 0.8485
step 30: train loss 0.2227 
cause_predict: train acc 0.9558 p 0.8929 r 0.7812 f1 0.8333
position_predict: train acc 0.9602 p 0.8710 r 0.8438 f1 0.8571
step 40: train loss 0.2107 
cause_predict: train acc 0.9587 p 0.9091 r 0.8108 f1 0.8571
position_predict: train acc 0.9628 p 0.8966 r 0.8125 f1 0.8525
step 50: train loss 0.2147 
cause_predict: train acc 0.9597 p 0.8621 r 0.7576 f1 0.8065
position_predict: train acc 0.9564 p 0.8276 r 0.7500 f1 0.7869
step 60: train loss 0.3481 
cause_predict: train acc 0.9100 p 0.7857 r 0.6286 f1 0.6984
position_predict: train acc 0.9336 p 0.7812 r 0.7812 f1 0.7812
step 70: train loss 0.3079 
cause_predict: train acc 0.9312 p 0.7778 r 0.7179 f1 0.7467
position_predict: train acc 0.9457 p 0.7742 r 0.7500 f1 0.7619

epoch 7: test loss 0.5300 cost time: 13.0s

cause_predict: test acc 0.8896 p 0.6215 r 0.5647 f1 0.5917
max_acc 0.8896 max_p 0.6215 max_r 0.5647 max_f1 0.5917

position_predict: test acc 0.9231 p 0.6936 r 0.7178 f1 0.7055
max_acc 0.9272 max_p 0.7168 max_r 0.7143 max_f1 0.7155

Average max cause: max_acc 0.8896 max_p 0.6215 max_r 0.5647 max_f1 0.5917
Average max pos: max_acc 0.9231 max_p 0.6936 max_r 0.7178 max_f1 0.7055

step 10: train loss 0.1480 
cause_predict: train acc 0.9542 p 0.8667 r 0.7647 f1 0.8125
position_predict: train acc 0.9847 p 0.9118 r 0.9688 f1 0.9394
step 20: train loss 0.2483 
cause_predict: train acc 0.9415 p 0.8235 r 0.8235 f1 0.8235
position_predict: train acc 0.9610 p 0.8750 r 0.8750 f1 0.8750
step 30: train loss 0.3088 
cause_predict: train acc 0.9058 p 0.7500 r 0.6486 f1 0.6957
position_predict: train acc 0.9641 p 0.8750 r 0.8750 f1 0.8750
step 40: train loss 0.2291 
cause_predict: train acc 0.9570 p 0.8000 r 0.8889 f1 0.8421
position_predict: train acc 0.9427 p 0.8000 r 0.7059 f1 0.7500
step 50: train loss 0.2249 
cause_predict: train acc 0.9472 p 0.8276 r 0.7273 f1 0.7742
position_predict: train acc 0.9698 p 0.8750 r 0.8750 f1 0.8750
step 60: train loss 0.2671 
cause_predict: train acc 0.9423 p 0.8065 r 0.7353 f1 0.7692
position_predict: train acc 0.9538 p 0.8846 r 0.7188 f1 0.7931
step 70: train loss 0.2198 
cause_predict: train acc 0.9492 p 0.8750 r 0.7778 f1 0.8235
position_predict: train acc 0.9619 p 0.8485 r 0.8750 f1 0.8615

epoch 8: test loss 0.5849 cost time: 12.7s

cause_predict: test acc 0.8878 p 0.6352 r 0.4890 f1 0.5526
max_acc 0.8896 max_p 0.6215 max_r 0.5647 max_f1 0.5917

position_predict: test acc 0.9200 p 0.6971 r 0.6655 f1 0.6809
max_acc 0.9272 max_p 0.7168 max_r 0.7143 max_f1 0.7155

Average max cause: max_acc 0.8896 max_p 0.6215 max_r 0.5647 max_f1 0.5917
Average max pos: max_acc 0.9231 max_p 0.6936 max_r 0.7178 max_f1 0.7055

step 10: train loss 0.3126 
cause_predict: train acc 0.9388 p 0.8235 r 0.8235 f1 0.8235
position_predict: train acc 0.9337 p 0.7714 r 0.8438 f1 0.8060
step 20: train loss 0.2092 
cause_predict: train acc 0.9651 p 0.9070 r 0.8864 f1 0.8966
position_predict: train acc 0.9612 p 0.8529 r 0.8529 f1 0.8529
step 30: train loss 0.1388 
cause_predict: train acc 0.9740 p 0.9677 r 0.8824 f1 0.9231
position_predict: train acc 0.9740 p 0.9655 r 0.8750 f1 0.9180
step 40: train loss 0.2041 
cause_predict: train acc 0.9545 p 0.8889 r 0.8421 f1 0.8649
position_predict: train acc 0.9591 p 0.8485 r 0.8750 f1 0.8615
step 50: train loss 0.4021 
cause_predict: train acc 0.9113 p 0.7436 r 0.7838 f1 0.7632
position_predict: train acc 0.9360 p 0.7568 r 0.8750 f1 0.8116
step 60: train loss 0.1423 
cause_predict: train acc 0.9720 p 0.9091 r 0.8824 f1 0.8955
position_predict: train acc 0.9720 p 0.8788 r 0.9062 f1 0.8923
step 70: train loss 0.1980 
cause_predict: train acc 0.9412 p 0.8667 r 0.7222 f1 0.7879
position_predict: train acc 0.9622 p 0.8485 r 0.8750 f1 0.8615

epoch 9: test loss 0.6162 cost time: 12.9s

cause_predict: test acc 0.8843 p 0.6090 r 0.5110 f1 0.5557
max_acc 0.8896 max_p 0.6215 max_r 0.5647 max_f1 0.5917

position_predict: test acc 0.9115 p 0.6519 r 0.6655 f1 0.6586
max_acc 0.9272 max_p 0.7168 max_r 0.7143 max_f1 0.7155

Average max cause: max_acc 0.8896 max_p 0.6215 max_r 0.5647 max_f1 0.5917
Average max pos: max_acc 0.9231 max_p 0.6936 max_r 0.7178 max_f1 0.7055

step 10: train loss 0.1735 
cause_predict: train acc 0.9343 p 0.8710 r 0.7297 f1 0.7941
position_predict: train acc 0.9906 p 1.0000 r 0.9375 f1 0.9677
step 20: train loss 0.1148 
cause_predict: train acc 0.9811 p 0.9444 r 0.9189 f1 0.9315
position_predict: train acc 0.9886 p 0.9688 r 0.9394 f1 0.9538
step 30: train loss 0.1624 
cause_predict: train acc 0.9840 p 0.9737 r 0.9250 f1 0.9487
position_predict: train acc 0.9600 p 0.8485 r 0.8485 f1 0.8485
step 40: train loss 0.2167 
cause_predict: train acc 0.9590 p 0.9143 r 0.8205 f1 0.8649
position_predict: train acc 0.9631 p 0.8710 r 0.8438 f1 0.8571
step 50: train loss 0.1940 
cause_predict: train acc 0.9567 p 0.9024 r 0.8043 f1 0.8506
position_predict: train acc 0.9700 p 0.8485 r 0.8750 f1 0.8615
step 60: train loss 0.2248 
cause_predict: train acc 0.9346 p 0.8857 r 0.7561 f1 0.8158
position_predict: train acc 0.9813 p 0.9375 r 0.9375 f1 0.9375
step 70: train loss 0.3032 
cause_predict: train acc 0.9276 p 0.8438 r 0.7105 f1 0.7714
position_predict: train acc 0.9367 p 0.8065 r 0.7576 f1 0.7812

epoch 10: test loss 0.6478 cost time: 12.7s

cause_predict: test acc 0.8861 p 0.6202 r 0.5047 f1 0.5565
max_acc 0.8896 max_p 0.6215 max_r 0.5647 max_f1 0.5917

position_predict: test acc 0.9169 p 0.6747 r 0.6794 f1 0.6771
max_acc 0.9272 max_p 0.7168 max_r 0.7143 max_f1 0.7155

Average max cause: max_acc 0.8896 max_p 0.6215 max_r 0.5647 max_f1 0.5917
Average max pos: max_acc 0.9231 max_p 0.6936 max_r 0.7178 max_f1 0.7055

step 10: train loss 0.1010 
cause_predict: train acc 0.9701 p 0.8857 r 0.8857 f1 0.8857
position_predict: train acc 0.9925 p 0.9688 r 0.9688 f1 0.9688
step 20: train loss 0.1882 
cause_predict: train acc 0.9518 p 0.9091 r 0.7895 f1 0.8451
position_predict: train acc 0.9518 p 0.8621 r 0.7812 f1 0.8197
step 30: train loss 0.1544 
cause_predict: train acc 0.9657 p 0.9429 r 0.8919 f1 0.9167
position_predict: train acc 0.9943 p 1.0000 r 0.9697 f1 0.9846
step 40: train loss 0.1926 
cause_predict: train acc 0.9574 p 0.8462 r 0.8462 f1 0.8462
position_predict: train acc 0.9681 p 0.9032 r 0.8235 f1 0.8615
step 50: train loss 0.2943 
cause_predict: train acc 0.9474 p 0.8205 r 0.8649 f1 0.8421
position_predict: train acc 0.9298 p 0.7500 r 0.7500 f1 0.7500
step 60: train loss 0.1568 
cause_predict: train acc 0.9634 p 0.8889 r 0.8000 f1 0.8421
position_predict: train acc 0.9817 p 0.9062 r 0.9062 f1 0.9062
step 70: train loss 0.1810 
cause_predict: train acc 0.9850 p 1.0000 r 0.9118 f1 0.9538
position_predict: train acc 0.9650 p 0.9032 r 0.8750 f1 0.8889

epoch 11: test loss 0.6770 cost time: 12.5s

cause_predict: test acc 0.8852 p 0.6210 r 0.4858 f1 0.5451
max_acc 0.8896 max_p 0.6215 max_r 0.5647 max_f1 0.5917

position_predict: test acc 0.9169 p 0.6891 r 0.6411 f1 0.6643
max_acc 0.9272 max_p 0.7168 max_r 0.7143 max_f1 0.7155

Average max cause: max_acc 0.8896 max_p 0.6215 max_r 0.5647 max_f1 0.5917
Average max pos: max_acc 0.9231 max_p 0.6936 max_r 0.7178 max_f1 0.7055

step 10: train loss 0.1693 
cause_predict: train acc 0.9657 p 0.8974 r 0.8974 f1 0.8974
position_predict: train acc 0.9528 p 0.8000 r 0.8750 f1 0.8358
step 20: train loss 0.1045 
cause_predict: train acc 0.9717 p 0.9714 r 0.8718 f1 0.9189
position_predict: train acc 0.9811 p 0.9375 r 0.9375 f1 0.9375
step 30: train loss 0.0816 
cause_predict: train acc 0.9780 p 0.8611 r 0.9394 f1 0.8986
position_predict: train acc 0.9843 p 0.9118 r 0.9394 f1 0.9254
step 40: train loss 0.2227 
cause_predict: train acc 0.9714 p 0.8649 r 0.9412 f1 0.9014
position_predict: train acc 0.9469 p 0.8065 r 0.7812 f1 0.7937
step 50: train loss 0.0959 
cause_predict: train acc 0.9763 p 0.9167 r 0.9167 f1 0.9167
position_predict: train acc 0.9921 p 1.0000 r 0.9394 f1 0.9688
step 60: train loss 0.2110 
cause_predict: train acc 0.9430 p 0.8571 r 0.7500 f1 0.8000
position_predict: train acc 0.9810 p 0.9118 r 0.9394 f1 0.9254
step 70: train loss 0.1175 
cause_predict: train acc 0.9842 p 0.9697 r 0.9143 f1 0.9412
position_predict: train acc 0.9763 p 0.9355 r 0.8788 f1 0.9062

epoch 12: test loss 0.7054 cost time: 12.8s

cause_predict: test acc 0.8865 p 0.6216 r 0.5079 f1 0.5590
max_acc 0.8896 max_p 0.6215 max_r 0.5647 max_f1 0.5917

position_predict: test acc 0.9214 p 0.6934 r 0.6934 f1 0.6934
max_acc 0.9272 max_p 0.7168 max_r 0.7143 max_f1 0.7155

Average max cause: max_acc 0.8896 max_p 0.6215 max_r 0.5647 max_f1 0.5917
Average max pos: max_acc 0.9231 max_p 0.6936 max_r 0.7178 max_f1 0.7055

step 10: train loss 0.1257 
cause_predict: train acc 0.9843 p 0.9429 r 0.9429 f1 0.9429
position_predict: train acc 0.9686 p 0.9062 r 0.8529 f1 0.8788
step 20: train loss 0.0689 
cause_predict: train acc 0.9926 p 1.0000 r 0.9444 f1 0.9714
position_predict: train acc 0.9778 p 0.8824 r 0.9375 f1 0.9091
step 30: train loss 0.0937 
cause_predict: train acc 0.9817 p 0.9231 r 0.9730 f1 0.9474
position_predict: train acc 0.9817 p 0.9412 r 0.9412 f1 0.9412
step 40: train loss 0.1399 
cause_predict: train acc 0.9795 p 1.0000 r 0.8974 f1 0.9459
position_predict: train acc 0.9692 p 0.9062 r 0.9062 f1 0.9062
step 50: train loss 0.1015 
cause_predict: train acc 0.9858 p 0.9412 r 0.9412 f1 0.9412
position_predict: train acc 0.9823 p 0.9355 r 0.9062 f1 0.9206
step 60: train loss 0.1047 
cause_predict: train acc 0.9848 p 1.0000 r 0.9143 f1 0.9552
position_predict: train acc 0.9848 p 0.9677 r 0.9375 f1 0.9524
step 70: train loss 0.1100 
cause_predict: train acc 0.9682 p 0.8947 r 0.9189 f1 0.9067
position_predict: train acc 0.9864 p 0.9677 r 0.9375 f1 0.9524

epoch 13: test loss 0.7192 cost time: 12.6s

cause_predict: test acc 0.8825 p 0.5906 r 0.5552 f1 0.5724
max_acc 0.8896 max_p 0.6215 max_r 0.5647 max_f1 0.5917

position_predict: test acc 0.9173 p 0.6700 r 0.7003 f1 0.6848
max_acc 0.9272 max_p 0.7168 max_r 0.7143 max_f1 0.7155

Average max cause: max_acc 0.8896 max_p 0.6215 max_r 0.5647 max_f1 0.5917
Average max pos: max_acc 0.9231 max_p 0.6936 max_r 0.7178 max_f1 0.7055

step 10: train loss 0.1284 
cause_predict: train acc 0.9688 p 0.9444 r 0.8718 f1 0.9067
position_predict: train acc 0.9732 p 0.9355 r 0.8788 f1 0.9062
step 20: train loss 0.0990 
cause_predict: train acc 0.9846 p 0.8947 r 1.0000 f1 0.9444
position_predict: train acc 0.9807 p 0.9091 r 0.9375 f1 0.9231
step 30: train loss 0.0872 
cause_predict: train acc 0.9939 p 1.0000 r 0.9429 f1 0.9706
position_predict: train acc 0.9816 p 0.9333 r 0.8750 f1 0.9032
step 40: train loss 0.0683 
cause_predict: train acc 0.9847 p 0.9302 r 0.9756 f1 0.9524
position_predict: train acc 0.9962 p 0.9706 r 1.0000 f1 0.9851
step 50: train loss 0.2079 
cause_predict: train acc 0.9593 p 0.7895 r 0.9091 f1 0.8451
position_predict: train acc 0.9593 p 0.8387 r 0.8125 f1 0.8254
step 60: train loss 0.0840 
cause_predict: train acc 0.9828 p 0.9412 r 0.9412 f1 0.9412
position_predict: train acc 0.9871 p 0.9688 r 0.9394 f1 0.9538
step 70: train loss 0.2521 
cause_predict: train acc 0.9444 p 0.8108 r 0.8333 f1 0.8219
position_predict: train acc 0.9530 p 0.8182 r 0.8438 f1 0.8308

epoch 14: test loss 0.7475 cost time: 13.1s

cause_predict: test acc 0.8838 p 0.5973 r 0.5521 f1 0.5738
max_acc 0.8896 max_p 0.6215 max_r 0.5647 max_f1 0.5917

position_predict: test acc 0.9147 p 0.6702 r 0.6585 f1 0.6643
max_acc 0.9272 max_p 0.7168 max_r 0.7143 max_f1 0.7155

Average max cause: max_acc 0.8896 max_p 0.6215 max_r 0.5647 max_f1 0.5917
Average max pos: max_acc 0.9231 max_p 0.6936 max_r 0.7178 max_f1 0.7055

write pair_data/Ind_BiLSTM_1/fold_2_test.txt done
write pair_data/Ind_BiLSTM_1/fold_2_train.txt done
Optimization Finished!

############# fold 2 end ###############
############# fold 3 begin ###############
load data_file: data_combine_en/fold_3_train.txt
y_position.shape (2275, 75, 2)
y_cause.shape (2275, 75, 2)
x.shape (2275, 75, 30)
sen_len.shape (2275, 75)
doc_len.shape (2275,)
n_cut 107
load data done!

load data_file: data_combine_en/fold_3_test.txt
y_position.shape (284, 75, 2)
y_cause.shape (284, 75, 2)
x.shape (284, 75, 30)
sen_len.shape (284, 75)
doc_len.shape (284,)
n_cut 22
load data done!

train docs: 2275    test docs: 284
step 10: train loss 0.8413 
cause_predict: train acc 0.8326 p 0.0000 r 0.0000 f1 0.0000
position_predict: train acc 0.8507 p 0.0000 r 0.0000 f1 0.0000
step 20: train loss 0.6864 
cause_predict: train acc 0.8610 p 0.0000 r 0.0000 f1 0.0000
position_predict: train acc 0.8726 p 0.0000 r 0.0000 f1 0.0000
step 30: train loss 0.6483 
cause_predict: train acc 0.8600 p 0.0000 r 0.0000 f1 0.0000
position_predict: train acc 0.8720 p 0.0000 r 0.0000 f1 0.0000
step 40: train loss 0.5897 
cause_predict: train acc 0.8627 p 1.0000 r 0.0278 f1 0.0541
position_predict: train acc 0.8980 p 0.6400 r 0.4848 f1 0.5517
step 50: train loss 0.5373 
cause_predict: train acc 0.8721 p 0.6667 r 0.0588 f1 0.1081
position_predict: train acc 0.9031 p 0.8182 r 0.2812 f1 0.4186
step 60: train loss 0.6602 
cause_predict: train acc 0.8284 p 0.6667 r 0.1579 f1 0.2553
position_predict: train acc 0.8627 p 0.5833 r 0.4375 f1 0.5000
step 70: train loss 0.4181 
cause_predict: train acc 0.9039 p 0.7000 r 0.1944 f1 0.3043
position_predict: train acc 0.9399 p 0.7500 r 0.5625 f1 0.6429

epoch 0: test loss 0.5162 cost time: 12.7s

cause_predict: test acc 0.8749 p 0.7681 r 0.1672 f1 0.2746
max_acc 0.8749 max_p 0.7681 max_r 0.1672 max_f1 0.2746

position_predict: test acc 0.9231 p 0.7626 r 0.5819 f1 0.6601
max_acc 0.9231 max_p 0.7626 max_r 0.5819 max_f1 0.6601

Average max cause: max_acc 0.8749 max_p 0.7681 max_r 0.1672 max_f1 0.2746
Average max pos: max_acc 0.9231 max_p 0.7626 max_r 0.5819 max_f1 0.6601

step 10: train loss 0.4369 
cause_predict: train acc 0.9018 p 1.0000 r 0.2432 f1 0.3913
position_predict: train acc 0.9298 p 0.8750 r 0.4375 f1 0.5833
step 20: train loss 0.5741 
cause_predict: train acc 0.8673 p 0.7059 r 0.3636 f1 0.4800
position_predict: train acc 0.9286 p 0.8750 r 0.6562 f1 0.7500
step 30: train loss 0.4415 
cause_predict: train acc 0.8962 p 0.8462 r 0.3056 f1 0.4490
position_predict: train acc 0.9538 p 0.8571 r 0.7500 f1 0.8000
step 40: train loss 0.5577 
cause_predict: train acc 0.8744 p 0.7692 r 0.2857 f1 0.4167
position_predict: train acc 0.8879 p 0.6129 r 0.5938 f1 0.6032
step 50: train loss 0.5446 
cause_predict: train acc 0.8529 p 0.5294 r 0.2500 f1 0.3396
position_predict: train acc 0.8992 p 0.6429 r 0.5625 f1 0.6000
step 60: train loss 0.5442 
cause_predict: train acc 0.8504 p 0.5000 r 0.1429 f1 0.2222
position_predict: train acc 0.9017 p 0.6286 r 0.6875 f1 0.6567
step 70: train loss 0.4933 
cause_predict: train acc 0.8881 p 0.7895 r 0.3571 f1 0.4918
position_predict: train acc 0.9134 p 0.6538 r 0.5312 f1 0.5862

epoch 1: test loss 0.4794 cost time: 13.0s

cause_predict: test acc 0.8874 p 0.6349 r 0.4826 f1 0.5484
max_acc 0.8874 max_p 0.6349 max_r 0.4826 max_f1 0.5484

position_predict: test acc 0.9218 p 0.7029 r 0.6760 f1 0.6892
max_acc 0.9218 max_p 0.7029 max_r 0.6760 max_f1 0.6892

Average max cause: max_acc 0.8874 max_p 0.6349 max_r 0.4826 max_f1 0.5484
Average max pos: max_acc 0.9218 max_p 0.7029 max_r 0.6760 max_f1 0.6892

step 10: train loss 0.4233 
cause_predict: train acc 0.8911 p 0.6818 r 0.4167 f1 0.5172
position_predict: train acc 0.9416 p 0.8000 r 0.7273 f1 0.7619
step 20: train loss 0.4567 
cause_predict: train acc 0.8960 p 0.7500 r 0.3077 f1 0.4364
position_predict: train acc 0.9195 p 0.6538 r 0.5312 f1 0.5862
step 30: train loss 0.4757 
cause_predict: train acc 0.8745 p 0.6667 r 0.2778 f1 0.3922
position_predict: train acc 0.9069 p 0.6800 r 0.5312 f1 0.5965
step 40: train loss 0.4467 
cause_predict: train acc 0.8821 p 0.5769 r 0.4545 f1 0.5085
position_predict: train acc 0.9268 p 0.8182 r 0.5625 f1 0.6667
step 50: train loss 0.4892 
cause_predict: train acc 0.8797 p 0.7619 r 0.4000 f1 0.5246
position_predict: train acc 0.9253 p 0.7778 r 0.6364 f1 0.7000
step 60: train loss 0.3756 
cause_predict: train acc 0.9087 p 0.8148 r 0.5789 f1 0.6769
position_predict: train acc 0.9652 p 0.9286 r 0.8125 f1 0.8667
step 70: train loss 0.4855 
cause_predict: train acc 0.8975 p 0.8000 r 0.2286 f1 0.3556
position_predict: train acc 0.9223 p 0.6923 r 0.5625 f1 0.6207

epoch 2: test loss 0.4707 cost time: 12.8s

cause_predict: test acc 0.8905 p 0.7278 r 0.3628 f1 0.4842
max_acc 0.8874 max_p 0.6349 max_r 0.4826 max_f1 0.5484

position_predict: test acc 0.9249 p 0.7148 r 0.6899 f1 0.7021
max_acc 0.9249 max_p 0.7148 max_r 0.6899 max_f1 0.7021

Average max cause: max_acc 0.8874 max_p 0.6349 max_r 0.4826 max_f1 0.5484
Average max pos: max_acc 0.9218 max_p 0.7029 max_r 0.6760 max_f1 0.6892

step 10: train loss 0.3526 
cause_predict: train acc 0.9237 p 0.7407 r 0.6250 f1 0.6780
position_predict: train acc 0.9558 p 0.8621 r 0.7812 f1 0.8197
step 20: train loss 0.4246 
cause_predict: train acc 0.8856 p 0.5909 r 0.3714 f1 0.4561
position_predict: train acc 0.9262 p 0.7241 r 0.6364 f1 0.6774
step 30: train loss 0.3767 
cause_predict: train acc 0.9020 p 0.6000 r 0.5000 f1 0.5455
position_predict: train acc 0.9542 p 0.8276 r 0.7273 f1 0.7742
step 40: train loss 0.4395 
cause_predict: train acc 0.8657 p 0.5417 r 0.3421 f1 0.4194
position_predict: train acc 0.9291 p 0.7407 r 0.6250 f1 0.6780
step 50: train loss 0.4939 
cause_predict: train acc 0.8686 p 0.6190 r 0.3611 f1 0.4561
position_predict: train acc 0.9407 p 0.8214 r 0.7188 f1 0.7667
step 60: train loss 0.3997 
cause_predict: train acc 0.8796 p 0.8571 r 0.3333 f1 0.4800
position_predict: train acc 0.9306 p 0.8750 r 0.6364 f1 0.7368
step 70: train loss 0.4398 
cause_predict: train acc 0.8924 p 0.8182 r 0.4737 f1 0.6000
position_predict: train acc 0.9462 p 0.8889 r 0.7273 f1 0.8000

epoch 3: test loss 0.4728 cost time: 12.8s

cause_predict: test acc 0.8892 p 0.6994 r 0.3817 f1 0.4939
max_acc 0.8874 max_p 0.6349 max_r 0.4826 max_f1 0.5484

position_predict: test acc 0.9245 p 0.7269 r 0.6585 f1 0.6910
max_acc 0.9249 max_p 0.7148 max_r 0.6899 max_f1 0.7021

Average max cause: max_acc 0.8874 max_p 0.6349 max_r 0.4826 max_f1 0.5484
Average max pos: max_acc 0.9218 max_p 0.7029 max_r 0.6760 max_f1 0.6892

step 10: train loss 0.4747 
cause_predict: train acc 0.8623 p 0.6250 r 0.3750 f1 0.4688
position_predict: train acc 0.9474 p 0.8333 r 0.7576 f1 0.7937
step 20: train loss 0.4416 
cause_predict: train acc 0.8810 p 0.7200 r 0.5000 f1 0.5902
position_predict: train acc 0.9429 p 0.8125 r 0.8125 f1 0.8125
step 30: train loss 0.3025 
cause_predict: train acc 0.9323 p 0.8333 r 0.6061 f1 0.7018
position_predict: train acc 0.9482 p 0.8519 r 0.7188 f1 0.7797
step 40: train loss 0.4183 
cause_predict: train acc 0.8716 p 0.5862 r 0.4474 f1 0.5075
position_predict: train acc 0.9455 p 0.8276 r 0.7273 f1 0.7742
step 50: train loss 0.3277 
cause_predict: train acc 0.9277 p 0.8214 r 0.6389 f1 0.7187
position_predict: train acc 0.9438 p 0.8214 r 0.7188 f1 0.7667
step 60: train loss 0.4654 
cause_predict: train acc 0.8936 p 0.8148 r 0.5946 f1 0.6875
position_predict: train acc 0.9096 p 0.7586 r 0.6875 f1 0.7213
step 70: train loss 0.4074 
cause_predict: train acc 0.8956 p 0.6667 r 0.4706 f1 0.5517
position_predict: train acc 0.9357 p 0.7931 r 0.6970 f1 0.7419

epoch 4: test loss 0.5154 cost time: 12.7s

cause_predict: test acc 0.8847 p 0.7007 r 0.3249 f1 0.4440
max_acc 0.8874 max_p 0.6349 max_r 0.4826 max_f1 0.5484

position_predict: test acc 0.9227 p 0.7127 r 0.6655 f1 0.6883
max_acc 0.9249 max_p 0.7148 max_r 0.6899 max_f1 0.7021

Average max cause: max_acc 0.8874 max_p 0.6349 max_r 0.4826 max_f1 0.5484
Average max pos: max_acc 0.9218 max_p 0.7029 max_r 0.6760 max_f1 0.6892

step 10: train loss 0.2422 
cause_predict: train acc 0.9440 p 0.9231 r 0.6486 f1 0.7619
position_predict: train acc 0.9664 p 0.9259 r 0.7812 f1 0.8475
step 20: train loss 0.3312 
cause_predict: train acc 0.9158 p 0.7241 r 0.5833 f1 0.6462
position_predict: train acc 0.9560 p 0.7941 r 0.8438 f1 0.8182
step 30: train loss 0.3732 
cause_predict: train acc 0.9058 p 0.7241 r 0.6176 f1 0.6667
position_predict: train acc 0.9103 p 0.7097 r 0.6667 f1 0.6875
step 40: train loss 0.2906 
cause_predict: train acc 0.9234 p 0.9000 r 0.4865 f1 0.6316
position_predict: train acc 0.9708 p 0.9286 r 0.8125 f1 0.8667
step 50: train loss 0.2487 
cause_predict: train acc 0.9458 p 0.9583 r 0.6216 f1 0.7541
position_predict: train acc 0.9639 p 0.8929 r 0.7812 f1 0.8333
step 60: train loss 0.3656 
cause_predict: train acc 0.9333 p 0.8182 r 0.7297 f1 0.7714
position_predict: train acc 0.9500 p 0.8125 r 0.8125 f1 0.8125
step 70: train loss 0.3971 
cause_predict: train acc 0.9027 p 0.7500 r 0.5833 f1 0.6562
position_predict: train acc 0.9425 p 0.8065 r 0.7812 f1 0.7937

epoch 5: test loss 0.5017 cost time: 12.9s

cause_predict: test acc 0.8865 p 0.6180 r 0.5205 f1 0.5651
max_acc 0.8865 max_p 0.6180 max_r 0.5205 max_f1 0.5651

position_predict: test acc 0.9231 p 0.6910 r 0.7247 f1 0.7075
max_acc 0.9231 max_p 0.6910 max_r 0.7247 max_f1 0.7075

Average max cause: max_acc 0.8865 max_p 0.6180 max_r 0.5205 max_f1 0.5651
Average max pos: max_acc 0.9231 max_p 0.6910 max_r 0.7247 max_f1 0.7075

step 10: train loss 0.2312 
cause_predict: train acc 0.9515 p 0.8621 r 0.6944 f1 0.7692
position_predict: train acc 0.9709 p 0.9286 r 0.7879 f1 0.8525
step 20: train loss 0.3350 
cause_predict: train acc 0.8837 p 0.7407 r 0.5263 f1 0.6154
position_predict: train acc 0.9581 p 0.8710 r 0.8438 f1 0.8571
step 30: train loss 0.2880 
cause_predict: train acc 0.9400 p 0.8438 r 0.7941 f1 0.8182
position_predict: train acc 0.9550 p 0.8485 r 0.8750 f1 0.8615
step 40: train loss 0.3328 
cause_predict: train acc 0.8983 p 0.6538 r 0.4474 f1 0.5312
position_predict: train acc 0.9729 p 0.8750 r 0.8750 f1 0.8750
step 50: train loss 0.3280 
cause_predict: train acc 0.8992 p 0.7000 r 0.5833 f1 0.6364
position_predict: train acc 0.9664 p 0.8529 r 0.9062 f1 0.8788
step 60: train loss 0.3959 
cause_predict: train acc 0.9150 p 0.7241 r 0.6176 f1 0.6667
position_predict: train acc 0.9069 p 0.6389 r 0.6970 f1 0.6667
step 70: train loss 0.4722 
cause_predict: train acc 0.8756 p 0.7059 r 0.6316 f1 0.6667
position_predict: train acc 0.9430 p 0.8710 r 0.7941 f1 0.8308

epoch 6: test loss 0.5370 cost time: 12.8s

cause_predict: test acc 0.8901 p 0.6330 r 0.5331 f1 0.5788
max_acc 0.8901 max_p 0.6330 max_r 0.5331 max_f1 0.5788

position_predict: test acc 0.9267 p 0.7338 r 0.6725 f1 0.7018
max_acc 0.9231 max_p 0.6910 max_r 0.7247 max_f1 0.7075

Average max cause: max_acc 0.8901 max_p 0.6330 max_r 0.5331 max_f1 0.5788
Average max pos: max_acc 0.9267 max_p 0.7338 max_r 0.6725 max_f1 0.7018

step 10: train loss 0.1918 
cause_predict: train acc 0.9630 p 0.9615 r 0.7353 f1 0.8333
position_predict: train acc 0.9593 p 0.8387 r 0.8125 f1 0.8254
step 20: train loss 0.1926 
cause_predict: train acc 0.9605 p 0.8824 r 0.8333 f1 0.8571
position_predict: train acc 0.9723 p 0.9032 r 0.8750 f1 0.8889
step 30: train loss 0.3407 
cause_predict: train acc 0.8986 p 0.7429 r 0.6842 f1 0.7123
position_predict: train acc 0.9469 p 0.8387 r 0.8125 f1 0.8254
step 40: train loss 0.3741 
cause_predict: train acc 0.8989 p 0.7179 r 0.7778 f1 0.7467
position_predict: train acc 0.9415 p 0.8182 r 0.8438 f1 0.8308
step 50: train loss 0.2478 
cause_predict: train acc 0.9469 p 0.7941 r 0.8438 f1 0.8182
position_predict: train acc 0.9602 p 0.9000 r 0.8182 f1 0.8571
step 60: train loss 0.2281 
cause_predict: train acc 0.9474 p 0.8710 r 0.7297 f1 0.7941
position_predict: train acc 0.9737 p 0.9032 r 0.8750 f1 0.8889
step 70: train loss 0.3473 
cause_predict: train acc 0.9074 p 0.7353 r 0.6944 f1 0.7143
position_predict: train acc 0.9444 p 0.8333 r 0.7812 f1 0.8065

epoch 7: test loss 0.5660 cost time: 12.8s

cause_predict: test acc 0.8735 p 0.5599 r 0.5016 f1 0.5291
max_acc 0.8901 max_p 0.6330 max_r 0.5331 max_f1 0.5788

position_predict: test acc 0.9178 p 0.6914 r 0.6481 f1 0.6691
max_acc 0.9231 max_p 0.6910 max_r 0.7247 max_f1 0.7075

Average max cause: max_acc 0.8901 max_p 0.6330 max_r 0.5331 max_f1 0.5788
Average max pos: max_acc 0.9267 max_p 0.7338 max_r 0.6725 max_f1 0.7018

step 10: train loss 0.1520 
cause_predict: train acc 0.9960 p 1.0000 r 0.9688 f1 0.9841
position_predict: train acc 0.9486 p 0.8519 r 0.7188 f1 0.7797
step 20: train loss 0.2369 
cause_predict: train acc 0.9324 p 0.8158 r 0.7949 f1 0.8052
position_predict: train acc 0.9820 p 1.0000 r 0.8857 f1 0.9394
step 30: train loss 0.2644 
cause_predict: train acc 0.9509 p 0.8824 r 0.8824 f1 0.8824
position_predict: train acc 0.9755 p 0.9394 r 0.9394 f1 0.9394
step 40: train loss 0.1960 
cause_predict: train acc 0.9533 p 0.8286 r 0.8788 f1 0.8529
position_predict: train acc 0.9579 p 0.8710 r 0.8438 f1 0.8571
step 50: train loss 0.2180 
cause_predict: train acc 0.9567 p 0.8485 r 0.8000 f1 0.8235
position_predict: train acc 0.9603 p 0.9200 r 0.7188 f1 0.8070
step 60: train loss 0.2114 
cause_predict: train acc 0.9568 p 0.8387 r 0.7647 f1 0.8000
position_predict: train acc 0.9502 p 0.7742 r 0.7500 f1 0.7619
step 70: train loss 0.3479 
cause_predict: train acc 0.9174 p 0.7000 r 0.8000 f1 0.7467
position_predict: train acc 0.9348 p 0.7742 r 0.7500 f1 0.7619

epoch 8: test loss 0.5950 cost time: 12.9s

cause_predict: test acc 0.8865 p 0.6145 r 0.5331 f1 0.5709
max_acc 0.8901 max_p 0.6330 max_r 0.5331 max_f1 0.5788

position_predict: test acc 0.9223 p 0.7085 r 0.6690 f1 0.6882
max_acc 0.9231 max_p 0.6910 max_r 0.7247 max_f1 0.7075

Average max cause: max_acc 0.8901 max_p 0.6330 max_r 0.5331 max_f1 0.5788
Average max pos: max_acc 0.9267 max_p 0.7338 max_r 0.6725 max_f1 0.7018

step 10: train loss 0.1996 
cause_predict: train acc 0.9577 p 0.8529 r 0.8286 f1 0.8406
position_predict: train acc 0.9654 p 0.8750 r 0.8485 f1 0.8615
step 20: train loss 0.1298 
cause_predict: train acc 0.9782 p 0.9394 r 0.9118 f1 0.9254
position_predict: train acc 0.9825 p 0.9667 r 0.9062 f1 0.9355
step 30: train loss 0.2050 
cause_predict: train acc 0.9589 p 0.8108 r 0.9375 f1 0.8696
position_predict: train acc 0.9726 p 0.9333 r 0.8750 f1 0.9032
step 40: train loss 0.2147 
cause_predict: train acc 0.9520 p 0.8824 r 0.8108 f1 0.8451
position_predict: train acc 0.9476 p 0.7838 r 0.8788 f1 0.8286
step 50: train loss 0.2079 
cause_predict: train acc 0.9537 p 0.8824 r 0.7692 f1 0.8219
position_predict: train acc 0.9609 p 0.8182 r 0.8438 f1 0.8308
step 60: train loss 0.2101 
cause_predict: train acc 0.9417 p 0.8438 r 0.7714 f1 0.8060
position_predict: train acc 0.9731 p 0.9643 r 0.8438 f1 0.9000
step 70: train loss 0.2738 
cause_predict: train acc 0.9438 p 0.7714 r 0.7941 f1 0.7826
position_predict: train acc 0.9476 p 0.7714 r 0.8182 f1 0.7941

epoch 9: test loss 0.6532 cost time: 12.7s

cause_predict: test acc 0.8896 p 0.6400 r 0.5047 f1 0.5644
max_acc 0.8901 max_p 0.6330 max_r 0.5331 max_f1 0.5788

position_predict: test acc 0.9196 p 0.6931 r 0.6690 f1 0.6809
max_acc 0.9231 max_p 0.6910 max_r 0.7247 max_f1 0.7075

Average max cause: max_acc 0.8901 max_p 0.6330 max_r 0.5331 max_f1 0.5788
Average max pos: max_acc 0.9267 max_p 0.7338 max_r 0.6725 max_f1 0.7018

step 10: train loss 0.1639 
cause_predict: train acc 0.9786 p 0.8857 r 0.9394 f1 0.9118
position_predict: train acc 0.9714 p 0.8750 r 0.8750 f1 0.8750
step 20: train loss 0.1482 
cause_predict: train acc 0.9598 p 0.8889 r 0.8421 f1 0.8649
position_predict: train acc 0.9880 p 0.9394 r 0.9688 f1 0.9538
step 30: train loss 0.1743 
cause_predict: train acc 0.9454 p 0.8333 r 0.7576 f1 0.7937
position_predict: train acc 0.9664 p 0.8529 r 0.9062 f1 0.8788
step 40: train loss 0.1433 
cause_predict: train acc 0.9563 p 0.8889 r 0.8649 f1 0.8767
position_predict: train acc 0.9806 p 0.9375 r 0.9375 f1 0.9375
step 50: train loss 0.1616 
cause_predict: train acc 0.9500 p 0.8205 r 0.8649 f1 0.8421
position_predict: train acc 0.9708 p 0.9032 r 0.8750 f1 0.8889
step 60: train loss 0.2527 
cause_predict: train acc 0.9487 p 0.9000 r 0.7500 f1 0.8182
position_predict: train acc 0.9444 p 0.8065 r 0.7812 f1 0.7937
step 70: train loss 0.1200 
cause_predict: train acc 0.9763 p 0.9250 r 0.9250 f1 0.9250
position_predict: train acc 0.9842 p 0.9667 r 0.9062 f1 0.9355

epoch 10: test loss 0.7238 cost time: 12.9s

cause_predict: test acc 0.8878 p 0.6241 r 0.5237 f1 0.5695
max_acc 0.8901 max_p 0.6330 max_r 0.5331 max_f1 0.5788

position_predict: test acc 0.9178 p 0.6914 r 0.6481 f1 0.6691
max_acc 0.9231 max_p 0.6910 max_r 0.7247 max_f1 0.7075

Average max cause: max_acc 0.8901 max_p 0.6330 max_r 0.5331 max_f1 0.5788
Average max pos: max_acc 0.9267 max_p 0.7338 max_r 0.6725 max_f1 0.7018

step 10: train loss 0.0943 
cause_predict: train acc 0.9828 p 0.9286 r 0.9286 f1 0.9286
position_predict: train acc 0.9914 p 1.0000 r 0.9091 f1 0.9524
step 20: train loss 0.0759 
cause_predict: train acc 0.9914 p 0.9697 r 0.9697 f1 0.9697
position_predict: train acc 0.9871 p 0.9688 r 0.9394 f1 0.9538
step 30: train loss 0.0937 
cause_predict: train acc 0.9816 p 0.9355 r 0.9062 f1 0.9206
position_predict: train acc 0.9853 p 0.9667 r 0.9062 f1 0.9355
step 40: train loss 0.2096 
cause_predict: train acc 0.9751 p 0.9444 r 0.9189 f1 0.9315
position_predict: train acc 0.9453 p 0.8000 r 0.8750 f1 0.8358
step 50: train loss 0.1591 
cause_predict: train acc 0.9636 p 0.8529 r 0.7838 f1 0.8169
position_predict: train acc 0.9748 p 0.8750 r 0.8485 f1 0.8615
step 60: train loss 0.1545 
cause_predict: train acc 0.9786 p 0.9677 r 0.9091 f1 0.9375
position_predict: train acc 0.9786 p 0.9375 r 0.9375 f1 0.9375
step 70: train loss 0.2610 
cause_predict: train acc 0.9668 p 0.9375 r 0.8333 f1 0.8824
position_predict: train acc 0.9461 p 0.8065 r 0.7812 f1 0.7937

epoch 11: test loss 0.7138 cost time: 12.9s

cause_predict: test acc 0.8825 p 0.5964 r 0.5268 f1 0.5595
max_acc 0.8901 max_p 0.6330 max_r 0.5331 max_f1 0.5788

position_predict: test acc 0.9182 p 0.6793 r 0.6864 f1 0.6828
max_acc 0.9231 max_p 0.6910 max_r 0.7247 max_f1 0.7075

Average max cause: max_acc 0.8901 max_p 0.6330 max_r 0.5331 max_f1 0.5788
Average max pos: max_acc 0.9267 max_p 0.7338 max_r 0.6725 max_f1 0.7018

step 10: train loss 0.1246 
cause_predict: train acc 0.9737 p 0.9143 r 0.9143 f1 0.9143
position_predict: train acc 0.9737 p 0.9062 r 0.9062 f1 0.9062
step 20: train loss 0.1212 
cause_predict: train acc 0.9799 p 0.9429 r 0.9167 f1 0.9296
position_predict: train acc 0.9759 p 0.9062 r 0.9062 f1 0.9062
step 30: train loss 0.0828 
cause_predict: train acc 0.9867 p 0.9394 r 0.9688 f1 0.9538
position_predict: train acc 0.9778 p 0.9655 r 0.8750 f1 0.9180
step 40: train loss 0.1106 
cause_predict: train acc 0.9780 p 0.9394 r 0.9118 f1 0.9254
position_predict: train acc 0.9736 p 0.9412 r 0.8889 f1 0.9143
step 50: train loss 0.2167 
cause_predict: train acc 0.9661 p 0.8889 r 0.8889 f1 0.8889
position_predict: train acc 0.9407 p 0.8125 r 0.7647 f1 0.7879
step 60: train loss 0.1109 
cause_predict: train acc 0.9887 p 0.9394 r 0.9688 f1 0.9538
position_predict: train acc 0.9812 p 0.9394 r 0.9118 f1 0.9254
step 70: train loss 0.1704 
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/keras/layers/legacy_rnn/rnn_cell_impl.py:993: UserWarning: `layer.add_variable` is deprecated and will be removed in a future version. Please use `layer.add_weight` method instead.
  self._bias = self.add_variable(
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
cause_predict: train acc 0.9614 p 0.8485 r 0.8485 f1 0.8485
position_predict: train acc 0.9653 p 0.8485 r 0.8750 f1 0.8615

epoch 12: test loss 0.7388 cost time: 13.1s

cause_predict: test acc 0.8727 p 0.5523 r 0.5331 f1 0.5425
max_acc 0.8901 max_p 0.6330 max_r 0.5331 max_f1 0.5788

position_predict: test acc 0.9182 p 0.6733 r 0.7038 f1 0.6882
max_acc 0.9231 max_p 0.6910 max_r 0.7247 max_f1 0.7075

Average max cause: max_acc 0.8901 max_p 0.6330 max_r 0.5331 max_f1 0.5788
Average max pos: max_acc 0.9267 max_p 0.7338 max_r 0.6725 max_f1 0.7018

step 10: train loss 0.0487 
cause_predict: train acc 0.9908 p 1.0000 r 0.9474 f1 0.9730
position_predict: train acc 0.9954 p 1.0000 r 0.9688 f1 0.9841
step 20: train loss 0.1148 
cause_predict: train acc 0.9808 p 0.9167 r 0.9429 f1 0.9296
position_predict: train acc 0.9732 p 0.8788 r 0.9062 f1 0.8923
step 30: train loss 0.1966 
cause_predict: train acc 0.9688 p 0.8857 r 0.9118 f1 0.8986
position_predict: train acc 0.9464 p 0.8125 r 0.8125 f1 0.8125
step 40: train loss 0.2481 
cause_predict: train acc 0.9437 p 0.8438 r 0.7941 f1 0.8182
position_predict: train acc 0.9577 p 0.8485 r 0.8750 f1 0.8615
step 50: train loss 0.0830 
cause_predict: train acc 0.9870 p 0.9714 r 0.9444 f1 0.9577
position_predict: train acc 0.9913 p 1.0000 r 0.9375 f1 0.9677
step 60: train loss 0.0504 
cause_predict: train acc 0.9839 p 0.9189 r 0.9714 f1 0.9444
position_predict: train acc 1.0000 p 1.0000 r 1.0000 f1 1.0000
step 70: train loss 0.1933 
cause_predict: train acc 0.9612 p 0.8000 r 0.9730 f1 0.8780
position_predict: train acc 0.9496 p 0.8065 r 0.7812 f1 0.7937

epoch 13: test loss 0.8042 cost time: 12.9s

cause_predict: test acc 0.8820 p 0.5898 r 0.5489 f1 0.5686
max_acc 0.8901 max_p 0.6330 max_r 0.5331 max_f1 0.5788

position_predict: test acc 0.9178 p 0.6758 r 0.6899 f1 0.6828
max_acc 0.9231 max_p 0.6910 max_r 0.7247 max_f1 0.7075

Average max cause: max_acc 0.8901 max_p 0.6330 max_r 0.5331 max_f1 0.5788
Average max pos: max_acc 0.9267 max_p 0.7338 max_r 0.6725 max_f1 0.7018

step 10: train loss 0.1285 
cause_predict: train acc 0.9897 p 0.9722 r 0.9722 f1 0.9722
position_predict: train acc 0.9588 p 0.8750 r 0.8750 f1 0.8750
step 20: train loss 0.1304 
cause_predict: train acc 0.9831 p 0.9302 r 0.9756 f1 0.9524
position_predict: train acc 0.9576 p 0.8667 r 0.8125 f1 0.8387
step 30: train loss 0.1180 
cause_predict: train acc 0.9699 p 0.8889 r 0.8889 f1 0.8889
position_predict: train acc 0.9699 p 0.8750 r 0.8750 f1 0.8750
step 40: train loss 0.1516 
cause_predict: train acc 0.9690 p 0.8974 r 0.8974 f1 0.8974
position_predict: train acc 0.9729 p 0.9032 r 0.8750 f1 0.8889
step 50: train loss 0.0808 
cause_predict: train acc 0.9941 p 0.9750 r 0.9750 f1 0.9750
position_predict: train acc 0.9794 p 0.9333 r 0.8485 f1 0.8889
step 60: train loss 0.1506 
cause_predict: train acc 0.9745 p 0.9444 r 0.8947 f1 0.9189
position_predict: train acc 0.9574 p 0.8438 r 0.8438 f1 0.8438
step 70: train loss 0.0970 
cause_predict: train acc 0.9868 p 0.9697 r 0.9412 f1 0.9552
position_predict: train acc 0.9825 p 0.9375 r 0.9375 f1 0.9375

epoch 14: test loss 0.7848 cost time: 12.7s

cause_predict: test acc 0.8861 p 0.6140 r 0.5268 f1 0.5671
max_acc 0.8901 max_p 0.6330 max_r 0.5331 max_f1 0.5788

position_predict: test acc 0.9169 p 0.6724 r 0.6864 f1 0.6793
max_acc 0.9231 max_p 0.6910 max_r 0.7247 max_f1 0.7075

Average max cause: max_acc 0.8901 max_p 0.6330 max_r 0.5331 max_f1 0.5788
Average max pos: max_acc 0.9267 max_p 0.7338 max_r 0.6725 max_f1 0.7018

write pair_data/Ind_BiLSTM_1/fold_3_test.txt done
write pair_data/Ind_BiLSTM_1/fold_3_train.txt done
Optimization Finished!

############# fold 3 end ###############
############# fold 4 begin ###############
load data_file: data_combine_en/fold_4_train.txt
y_position.shape (2275, 75, 2)
y_cause.shape (2275, 75, 2)
x.shape (2275, 75, 30)
sen_len.shape (2275, 75)
doc_len.shape (2275,)
n_cut 107
load data done!

load data_file: data_combine_en/fold_4_test.txt
y_position.shape (284, 75, 2)
y_cause.shape (284, 75, 2)
x.shape (284, 75, 30)
sen_len.shape (284, 75)
doc_len.shape (284,)
n_cut 22
load data done!

train docs: 2275    test docs: 284
step 10: train loss 0.8062 
cause_predict: train acc 0.8571 p 0.0000 r 0.0000 f1 0.0000
position_predict: train acc 0.8828 p 0.0000 r 0.0000 f1 0.0000
step 20: train loss 0.6887 
cause_predict: train acc 0.8672 p 0.0000 r 0.0000 f1 0.0000
position_predict: train acc 0.8750 p 0.0000 r 0.0000 f1 0.0000
step 30: train loss 0.7136 
cause_predict: train acc 0.8421 p 0.0000 r 0.0000 f1 0.0000
position_predict: train acc 0.8469 p 0.0000 r 0.0000 f1 0.0000
step 40: train loss 0.6080 
cause_predict: train acc 0.8386 p 0.0000 r 0.0000 f1 0.0000
position_predict: train acc 0.8924 p 0.7368 r 0.4242 f1 0.5385
step 50: train loss 0.6772 
cause_predict: train acc 0.8326 p 0.0000 r 0.0000 f1 0.0000
position_predict: train acc 0.8778 p 0.5714 r 0.7273 f1 0.6400
step 60: train loss 0.5666 
cause_predict: train acc 0.8571 p 1.0000 r 0.0286 f1 0.0556
position_predict: train acc 0.9076 p 0.7500 r 0.4688 f1 0.5769
step 70: train loss 0.5343 
cause_predict: train acc 0.8557 p 0.0000 r 0.0000 f1 0.0000
position_predict: train acc 0.9161 p 0.6522 r 0.4688 f1 0.5455

epoch 0: test loss 0.5306 cost time: 12.7s

cause_predict: test acc 0.8615 p 1.0000 r 0.0221 f1 0.0432
max_acc 0.8615 max_p 1.0000 max_r 0.0221 max_f1 0.0432

position_predict: test acc 0.9111 p 0.6654 r 0.6167 f1 0.6401
max_acc 0.9111 max_p 0.6654 max_r 0.6167 max_f1 0.6401

Average max cause: max_acc 0.8615 max_p 1.0000 max_r 0.0221 max_f1 0.0432
Average max pos: max_acc 0.9111 max_p 0.6654 max_r 0.6167 max_f1 0.6401

step 10: train loss 0.4476 
cause_predict: train acc 0.8904 p 0.6000 r 0.0882 f1 0.1538
position_predict: train acc 0.9302 p 0.7143 r 0.6061 f1 0.6557
step 20: train loss 0.5249 
cause_predict: train acc 0.8477 p 0.4286 r 0.0833 f1 0.1395
position_predict: train acc 0.9424 p 0.8214 r 0.7188 f1 0.7667
step 30: train loss 0.4736 
cause_predict: train acc 0.8675 p 0.7273 r 0.2222 f1 0.3404
position_predict: train acc 0.9444 p 0.8519 r 0.7188 f1 0.7797
step 40: train loss 0.4391 
cause_predict: train acc 0.8939 p 0.8333 r 0.2778 f1 0.4167
position_predict: train acc 0.9394 p 0.8077 r 0.6562 f1 0.7241
step 50: train loss 0.4857 
cause_predict: train acc 0.8963 p 0.8333 r 0.1562 f1 0.2632
position_predict: train acc 0.9148 p 0.7083 r 0.5152 f1 0.5965
step 60: train loss 0.6245 
cause_predict: train acc 0.8362 p 0.5294 r 0.2308 f1 0.3214
position_predict: train acc 0.9052 p 0.6786 r 0.5938 f1 0.6333
step 70: train loss 0.4459 
cause_predict: train acc 0.8850 p 0.7619 r 0.4324 f1 0.5517
position_predict: train acc 0.9469 p 0.8571 r 0.7500 f1 0.8000

epoch 1: test loss 0.4723 cost time: 12.8s

cause_predict: test acc 0.8919 p 0.6812 r 0.4448 f1 0.5382
max_acc 0.8919 max_p 0.6812 max_r 0.4448 max_f1 0.5382

position_predict: test acc 0.9209 p 0.7273 r 0.6132 f1 0.6654
max_acc 0.9209 max_p 0.7273 max_r 0.6132 max_f1 0.6654

Average max cause: max_acc 0.8919 max_p 0.6812 max_r 0.4448 max_f1 0.5382
Average max pos: max_acc 0.9209 max_p 0.7273 max_r 0.6132 max_f1 0.6654

step 10: train loss 0.5398 
cause_predict: train acc 0.8611 p 0.5600 r 0.3684 f1 0.4444
position_predict: train acc 0.9286 p 0.7500 r 0.6562 f1 0.7000
step 20: train loss 0.5798 
cause_predict: train acc 0.8750 p 0.7143 r 0.4412 f1 0.5455
position_predict: train acc 0.8950 p 0.6897 r 0.6250 f1 0.6557
step 30: train loss 0.4714 
cause_predict: train acc 0.8868 p 0.6667 r 0.2353 f1 0.3478
position_predict: train acc 0.9094 p 0.6364 r 0.6364 f1 0.6364
step 40: train loss 0.5140 
cause_predict: train acc 0.8830 p 0.8421 r 0.4571 f1 0.5926
position_predict: train acc 0.9043 p 0.6944 r 0.7812 f1 0.7353
step 50: train loss 0.5109 
cause_predict: train acc 0.8520 p 0.5625 r 0.2308 f1 0.3273
position_predict: train acc 0.9200 p 0.7000 r 0.6562 f1 0.6774
step 60: train loss 0.4837 
cause_predict: train acc 0.8880 p 0.8333 r 0.3750 f1 0.5172
position_predict: train acc 0.9240 p 0.7241 r 0.6562 f1 0.6885
step 70: train loss 0.4644 
cause_predict: train acc 0.8989 p 0.8333 r 0.3750 f1 0.5172
position_predict: train acc 0.9278 p 0.7143 r 0.6250 f1 0.6667

epoch 2: test loss 0.4697 cost time: 12.8s

cause_predict: test acc 0.8932 p 0.7438 r 0.3754 f1 0.4990
max_acc 0.8919 max_p 0.6812 max_r 0.4448 max_f1 0.5382

position_predict: test acc 0.9200 p 0.7077 r 0.6411 f1 0.6728
max_acc 0.9200 max_p 0.7077 max_r 0.6411 max_f1 0.6728

Average max cause: max_acc 0.8919 max_p 0.6812 max_r 0.4448 max_f1 0.5382
Average max pos: max_acc 0.9209 max_p 0.7273 max_r 0.6132 max_f1 0.6654

step 10: train loss 0.4896 
cause_predict: train acc 0.8705 p 0.8000 r 0.3902 f1 0.5246
position_predict: train acc 0.9375 p 0.8214 r 0.7188 f1 0.7667
step 20: train loss 0.4124 
cause_predict: train acc 0.8661 p 0.7000 r 0.3684 f1 0.4828
position_predict: train acc 0.9330 p 0.7429 r 0.8125 f1 0.7761
step 30: train loss 0.5554 
cause_predict: train acc 0.8415 p 0.6129 r 0.5278 f1 0.5672
position_predict: train acc 0.9235 p 0.7879 r 0.7879 f1 0.7879
step 40: train loss 0.3002 
cause_predict: train acc 0.9307 p 0.7826 r 0.5294 f1 0.6316
position_predict: train acc 0.9472 p 0.7353 r 0.7812 f1 0.7576
step 50: train loss 0.4838 
cause_predict: train acc 0.8690 p 0.6111 r 0.3235 f1 0.4231
position_predict: train acc 0.9170 p 0.7097 r 0.6875 f1 0.6984
step 60: train loss 0.3820 
cause_predict: train acc 0.9236 p 0.8095 r 0.4722 f1 0.5965
position_predict: train acc 0.9502 p 0.8696 r 0.6250 f1 0.7273
step 70: train loss 0.4917 
cause_predict: train acc 0.8477 p 0.6111 r 0.2558 f1 0.3607
position_predict: train acc 0.9492 p 0.8276 r 0.7500 f1 0.7869

epoch 3: test loss 0.4747 cost time: 12.7s

cause_predict: test acc 0.8928 p 0.6611 r 0.4984 f1 0.5683
max_acc 0.8928 max_p 0.6611 max_r 0.4984 max_f1 0.5683

position_predict: test acc 0.9267 p 0.7573 r 0.6307 f1 0.6882
max_acc 0.9267 max_p 0.7573 max_r 0.6307 max_f1 0.6882

Average max cause: max_acc 0.8928 max_p 0.6611 max_r 0.4984 max_f1 0.5683
Average max pos: max_acc 0.9267 max_p 0.7573 max_r 0.6307 max_f1 0.6882

step 10: train loss 0.3830 
cause_predict: train acc 0.9040 p 0.7619 r 0.4571 f1 0.5714
position_predict: train acc 0.9440 p 0.8000 r 0.7500 f1 0.7742
step 20: train loss 0.3283 
cause_predict: train acc 0.9351 p 0.9130 r 0.6176 f1 0.7368
position_predict: train acc 0.9264 p 0.7500 r 0.7273 f1 0.7385
step 30: train loss 0.3803 
cause_predict: train acc 0.9138 p 0.8421 r 0.4211 f1 0.5614
position_predict: train acc 0.9207 p 0.6957 r 0.5000 f1 0.5818
step 40: train loss 0.5311 
cause_predict: train acc 0.8879 p 0.7143 r 0.6410 f1 0.6757
position_predict: train acc 0.9065 p 0.7143 r 0.6250 f1 0.6667
step 50: train loss 0.3596 
cause_predict: train acc 0.9098 p 0.7308 r 0.5278 f1 0.6129
position_predict: train acc 0.9549 p 0.8333 r 0.7812 f1 0.8065
step 60: train loss 0.3490 
cause_predict: train acc 0.9310 p 0.8800 r 0.6286 f1 0.7333
position_predict: train acc 0.9440 p 0.8276 r 0.7500 f1 0.7869
step 70: train loss 0.3382 
cause_predict: train acc 0.9266 p 0.8750 r 0.4242 f1 0.5714
position_predict: train acc 0.9476 p 0.7812 r 0.7576 f1 0.7692

epoch 4: test loss 0.4865 cost time: 12.7s

cause_predict: test acc 0.8847 p 0.7153 r 0.3091 f1 0.4317
max_acc 0.8928 max_p 0.6611 max_r 0.4984 max_f1 0.5683

position_predict: test acc 0.9258 p 0.7266 r 0.6760 f1 0.7004
max_acc 0.9258 max_p 0.7266 max_r 0.6760 max_f1 0.7004

Average max cause: max_acc 0.8928 max_p 0.6611 max_r 0.4984 max_f1 0.5683
Average max pos: max_acc 0.9267 max_p 0.7573 max_r 0.6307 max_f1 0.6882

step 10: train loss 0.3180 
cause_predict: train acc 0.9402 p 0.8214 r 0.6970 f1 0.7541
position_predict: train acc 0.9402 p 0.7742 r 0.7500 f1 0.7619
step 20: train loss 0.3368 
cause_predict: train acc 0.8992 p 0.8182 r 0.4737 f1 0.6000
position_predict: train acc 0.9622 p 0.9000 r 0.8182 f1 0.8571
step 30: train loss 0.4061 
cause_predict: train acc 0.8972 p 0.8095 r 0.4857 f1 0.6071
position_predict: train acc 0.9346 p 0.8276 r 0.7273 f1 0.7742
step 40: train loss 0.3184 
cause_predict: train acc 0.9018 p 0.6364 r 0.4242 f1 0.5091
position_predict: train acc 0.9527 p 0.8333 r 0.7576 f1 0.7937
step 50: train loss 0.4280 
cause_predict: train acc 0.8836 p 0.6786 r 0.5135 f1 0.5846
position_predict: train acc 0.9095 p 0.6897 r 0.6250 f1 0.6557
step 60: train loss 0.3905 
cause_predict: train acc 0.9136 p 0.7429 r 0.7222 f1 0.7324
position_predict: train acc 0.9364 p 0.7368 r 0.8750 f1 0.8000
step 70: train loss 0.5007 
cause_predict: train acc 0.8838 p 0.7333 r 0.5946 f1 0.6567
position_predict: train acc 0.9343 p 0.8276 r 0.7500 f1 0.7869

epoch 5: test loss 0.5055 cost time: 12.4s

cause_predict: test acc 0.8852 p 0.6364 r 0.4416 f1 0.5214
max_acc 0.8928 max_p 0.6611 max_r 0.4984 max_f1 0.5683

position_predict: test acc 0.9245 p 0.7021 r 0.7143 f1 0.7081
max_acc 0.9245 max_p 0.7021 max_r 0.7143 max_f1 0.7081

Average max cause: max_acc 0.8928 max_p 0.6611 max_r 0.4984 max_f1 0.5683
Average max pos: max_acc 0.9267 max_p 0.7573 max_r 0.6307 max_f1 0.6882

step 10: train loss 0.2986 
cause_predict: train acc 0.9293 p 0.7778 r 0.8235 f1 0.8000
position_predict: train acc 0.9394 p 0.8333 r 0.7812 f1 0.8065
step 20: train loss 0.4159 
cause_predict: train acc 0.9257 p 0.8065 r 0.7353 f1 0.7692
position_predict: train acc 0.9208 p 0.7353 r 0.7812 f1 0.7576
step 30: train loss 0.2448 
cause_predict: train acc 0.9301 p 0.8571 r 0.6667 f1 0.7500
position_predict: train acc 0.9389 p 0.7812 r 0.7812 f1 0.7812
step 40: train loss 0.2143 
cause_predict: train acc 0.9607 p 0.8667 r 0.7429 f1 0.8000
position_predict: train acc 0.9698 p 0.8966 r 0.7879 f1 0.8387
step 50: train loss 0.3455 
cause_predict: train acc 0.9077 p 0.7083 r 0.4857 f1 0.5763
position_predict: train acc 0.9410 p 0.7667 r 0.7188 f1 0.7419
step 60: train loss 0.3488 
cause_predict: train acc 0.9130 p 0.7692 r 0.5263 f1 0.6250
position_predict: train acc 0.9565 p 0.8333 r 0.7812 f1 0.8065
step 70: train loss 0.3988 
cause_predict: train acc 0.9158 p 0.7353 r 0.7576 f1 0.7463
position_predict: train acc 0.9257 p 0.7931 r 0.7188 f1 0.7541

epoch 6: test loss 0.5375 cost time: 12.3s

cause_predict: test acc 0.8861 p 0.6250 r 0.4890 f1 0.5487
max_acc 0.8928 max_p 0.6611 max_r 0.4984 max_f1 0.5683

position_predict: test acc 0.9227 p 0.6993 r 0.6969 f1 0.6981
max_acc 0.9245 max_p 0.7021 max_r 0.7143 max_f1 0.7081

Average max cause: max_acc 0.8928 max_p 0.6611 max_r 0.4984 max_f1 0.5683
Average max pos: max_acc 0.9267 max_p 0.7573 max_r 0.6307 max_f1 0.6882

step 10: train loss 0.1898 
cause_predict: train acc 0.9269 p 0.7742 r 0.6667 f1 0.7164
position_predict: train acc 1.0000 p 1.0000 r 1.0000 f1 1.0000
step 20: train loss 0.4460 
cause_predict: train acc 0.8871 p 0.7027 r 0.7222 f1 0.7123
position_predict: train acc 0.8925 p 0.6765 r 0.7188 f1 0.6970
step 30: train loss 0.3105 
cause_predict: train acc 0.9429 p 0.9032 r 0.8000 f1 0.8485
position_predict: train acc 0.9486 p 0.8485 r 0.8750 f1 0.8615
step 40: train loss 0.2743 
cause_predict: train acc 0.9286 p 0.6829 r 0.8485 f1 0.7568
position_predict: train acc 0.9405 p 0.7742 r 0.7500 f1 0.7619
step 50: train loss 0.2316 
cause_predict: train acc 0.9498 p 0.9000 r 0.7297 f1 0.8060
position_predict: train acc 0.9653 p 0.8333 r 0.9091 f1 0.8696
step 60: train loss 0.2647 
cause_predict: train acc 0.9211 p 0.7000 r 0.6364 f1 0.6667
position_predict: train acc 0.9586 p 0.8387 r 0.8125 f1 0.8254
step 70: train loss 0.2855 
cause_predict: train acc 0.9490 p 0.8966 r 0.7879 f1 0.8387
position_predict: train acc 0.9286 p 0.8276 r 0.7273 f1 0.7742

epoch 7: test loss 0.5872 cost time: 12.6s

cause_predict: test acc 0.8856 p 0.6160 r 0.5110 f1 0.5586
max_acc 0.8928 max_p 0.6611 max_r 0.4984 max_f1 0.5683

position_predict: test acc 0.9223 p 0.7148 r 0.6551 f1 0.6836
max_acc 0.9245 max_p 0.7021 max_r 0.7143 max_f1 0.7081

Average max cause: max_acc 0.8928 max_p 0.6611 max_r 0.4984 max_f1 0.5683
Average max pos: max_acc 0.9267 max_p 0.7573 max_r 0.6307 max_f1 0.6882

step 10: train loss 0.2531 
cause_predict: train acc 0.9342 p 0.8485 r 0.8485 f1 0.8485
position_predict: train acc 0.9342 p 0.8286 r 0.8788 f1 0.8529
step 20: train loss 0.2431 
cause_predict: train acc 0.9310 p 0.7941 r 0.7500 f1 0.7714
position_predict: train acc 0.9612 p 0.8485 r 0.8750 f1 0.8615
step 30: train loss 0.1292 
cause_predict: train acc 0.9649 p 0.8387 r 0.7879 f1 0.8125
position_predict: train acc 0.9766 p 0.8529 r 0.9062 f1 0.8788
step 40: train loss 0.1988 
cause_predict: train acc 0.9605 p 0.9630 r 0.7429 f1 0.8387
position_predict: train acc 0.9565 p 0.8387 r 0.8125 f1 0.8254
step 50: train loss 0.3092 
cause_predict: train acc 0.9310 p 0.8485 r 0.7568 f1 0.8000
position_predict: train acc 0.9409 p 0.8333 r 0.7812 f1 0.8065
step 60: train loss 0.3054 
cause_predict: train acc 0.9307 p 0.8387 r 0.7027 f1 0.7647
position_predict: train acc 0.9481 p 0.8387 r 0.7879 f1 0.8125
step 70: train loss 0.2948 
cause_predict: train acc 0.9385 p 0.7576 r 0.7576 f1 0.7576
position_predict: train acc 0.9269 p 0.7097 r 0.6875 f1 0.6984

epoch 8: test loss 0.6147 cost time: 12.4s

cause_predict: test acc 0.8870 p 0.6290 r 0.4921 f1 0.5522
max_acc 0.8928 max_p 0.6611 max_r 0.4984 max_f1 0.5683

position_predict: test acc 0.9182 p 0.6769 r 0.6934 f1 0.6850
max_acc 0.9245 max_p 0.7021 max_r 0.7143 max_f1 0.7081

Average max cause: max_acc 0.8928 max_p 0.6611 max_r 0.4984 max_f1 0.5683
Average max pos: max_acc 0.9267 max_p 0.7573 max_r 0.6307 max_f1 0.6882

step 10: train loss 0.2190 
cause_predict: train acc 0.9401 p 0.8537 r 0.8333 f1 0.8434
position_predict: train acc 0.9585 p 0.8710 r 0.8438 f1 0.8571
step 20: train loss 0.1411 
cause_predict: train acc 0.9658 p 0.8684 r 0.8919 f1 0.8800
position_predict: train acc 0.9734 p 0.9032 r 0.8750 f1 0.8889
step 30: train loss 0.1425 
cause_predict: train acc 0.9654 p 0.8788 r 0.8788 f1 0.8788
position_predict: train acc 0.9784 p 0.9655 r 0.8750 f1 0.9180
step 40: train loss 0.1806 
cause_predict: train acc 0.9661 p 0.9091 r 0.8571 f1 0.8824
position_predict: train acc 0.9703 p 0.9032 r 0.8750 f1 0.8889
step 50: train loss 0.2462 
cause_predict: train acc 0.9434 p 0.8158 r 0.7949 f1 0.8052
position_predict: train acc 0.9660 p 0.8966 r 0.8125 f1 0.8525
step 60: train loss 0.1993 
cause_predict: train acc 0.9594 p 0.8710 r 0.7941 f1 0.8308
position_predict: train acc 0.9446 p 0.7931 r 0.7188 f1 0.7541
step 70: train loss 0.1683 
cause_predict: train acc 0.9663 p 0.8611 r 0.8378 f1 0.8493
position_predict: train acc 0.9785 p 0.9310 r 0.8438 f1 0.8852

epoch 9: test loss 0.6534 cost time: 12.4s

cause_predict: test acc 0.8713 p 0.5495 r 0.5079 f1 0.5279
max_acc 0.8928 max_p 0.6611 max_r 0.4984 max_f1 0.5683

position_predict: test acc 0.9227 p 0.7050 r 0.6829 f1 0.6938
max_acc 0.9245 max_p 0.7021 max_r 0.7143 max_f1 0.7081

Average max cause: max_acc 0.8928 max_p 0.6611 max_r 0.4984 max_f1 0.5683
Average max pos: max_acc 0.9267 max_p 0.7573 max_r 0.6307 max_f1 0.6882

step 10: train loss 0.1831 
cause_predict: train acc 0.9662 p 0.9000 r 0.8182 f1 0.8571
position_predict: train acc 0.9774 p 0.8824 r 0.9375 f1 0.9091
step 20: train loss 0.1744 
cause_predict: train acc 0.9429 p 0.8293 r 0.8293 f1 0.8293
position_predict: train acc 0.9796 p 0.9355 r 0.9062 f1 0.9206
step 30: train loss 0.1772 
cause_predict: train acc 0.9626 p 0.9474 r 0.8571 f1 0.9000
position_predict: train acc 0.9579 p 0.9032 r 0.8235 f1 0.8615
step 40: train loss 0.1317 
cause_predict: train acc 0.9668 p 0.8649 r 0.9143 f1 0.8889
position_predict: train acc 0.9834 p 0.9375 r 0.9375 f1 0.9375
step 50: train loss 0.2648 
cause_predict: train acc 0.9462 p 0.8438 r 0.7941 f1 0.8182
position_predict: train acc 0.9596 p 0.8710 r 0.8438 f1 0.8571
step 60: train loss 0.2746 
cause_predict: train acc 0.9590 p 0.8750 r 0.8750 f1 0.8750
position_predict: train acc 0.9262 p 0.7188 r 0.7188 f1 0.7188
step 70: train loss 0.2086 
cause_predict: train acc 0.9619 p 0.9032 r 0.8235 f1 0.8615
position_predict: train acc 0.9661 p 0.8788 r 0.8788 f1 0.8788

epoch 10: test loss 0.6408 cost time: 12.7s

cause_predict: test acc 0.8803 p 0.5884 r 0.5142 f1 0.5488
max_acc 0.8928 max_p 0.6611 max_r 0.4984 max_f1 0.5683

position_predict: test acc 0.9182 p 0.6806 r 0.6829 f1 0.6817
max_acc 0.9245 max_p 0.7021 max_r 0.7143 max_f1 0.7081

Average max cause: max_acc 0.8928 max_p 0.6611 max_r 0.4984 max_f1 0.5683
Average max pos: max_acc 0.9267 max_p 0.7573 max_r 0.6307 max_f1 0.6882

step 10: train loss 0.1113 
cause_predict: train acc 0.9747 p 0.9143 r 0.9412 f1 0.9275
position_predict: train acc 0.9798 p 0.9375 r 0.9375 f1 0.9375
step 20: train loss 0.2805 
cause_predict: train acc 0.9511 p 0.8611 r 0.8378 f1 0.8493
position_predict: train acc 0.9289 p 0.7429 r 0.7879 f1 0.7647
step 30: train loss 0.1286 
cause_predict: train acc 0.9612 p 0.8571 r 0.9091 f1 0.8824
position_predict: train acc 0.9806 p 0.9394 r 0.9394 f1 0.9394
step 40: train loss 0.1745 
cause_predict: train acc 0.9660 p 0.8857 r 0.9118 f1 0.8986
position_predict: train acc 0.9660 p 0.8788 r 0.9062 f1 0.8923
step 50: train loss 0.1841 
cause_predict: train acc 0.9672 p 0.9655 r 0.8000 f1 0.8750
position_predict: train acc 0.9754 p 0.9333 r 0.8750 f1 0.9032
step 60: train loss 0.1464 
cause_predict: train acc 0.9753 p 0.9167 r 0.9167 f1 0.9167
position_predict: train acc 0.9712 p 0.9032 r 0.8750 f1 0.8889
step 70: train loss 0.0997 
cause_predict: train acc 0.9763 p 0.9211 r 0.9459 f1 0.9333
position_predict: train acc 0.9858 p 0.9677 r 0.9375 f1 0.9524

epoch 11: test loss 0.7069 cost time: 12.6s

cause_predict: test acc 0.8843 p 0.6169 r 0.4826 f1 0.5416
max_acc 0.8928 max_p 0.6611 max_r 0.4984 max_f1 0.5683

position_predict: test acc 0.9142 p 0.6667 r 0.6620 f1 0.6643
max_acc 0.9245 max_p 0.7021 max_r 0.7143 max_f1 0.7081

Average max cause: max_acc 0.8928 max_p 0.6611 max_r 0.4984 max_f1 0.5683
Average max pos: max_acc 0.9267 max_p 0.7573 max_r 0.6307 max_f1 0.6882

step 10: train loss 0.2055 
cause_predict: train acc 0.9660 p 0.9429 r 0.8684 f1 0.9041
position_predict: train acc 0.9515 p 0.8438 r 0.8438 f1 0.8438
step 20: train loss 0.1345 
cause_predict: train acc 0.9744 p 0.9677 r 0.8571 f1 0.9091
position_predict: train acc 0.9658 p 0.8750 r 0.8750 f1 0.8750
step 30: train loss 0.1744 
cause_predict: train acc 0.9344 p 0.8286 r 0.8286 f1 0.8286
position_predict: train acc 0.9891 p 0.9697 r 0.9697 f1 0.9697
step 40: train loss 0.1224 
cause_predict: train acc 0.9677 p 0.9429 r 0.8462 f1 0.8919
position_predict: train acc 0.9839 p 0.9394 r 0.9394 f1 0.9394
step 50: train loss 0.3271 
cause_predict: train acc 0.9339 p 0.7941 r 0.7500 f1 0.7714
position_predict: train acc 0.9256 p 0.7059 r 0.7500 f1 0.7273
step 60: train loss 0.1876 
cause_predict: train acc 0.9490 p 0.8333 r 0.8537 f1 0.8434
position_predict: train acc 0.9765 p 0.9333 r 0.8750 f1 0.9032
step 70: train loss 0.2094 
cause_predict: train acc 0.9372 p 0.8250 r 0.8462 f1 0.8354
position_predict: train acc 0.9517 p 0.8235 r 0.8750 f1 0.8485

epoch 12: test loss 0.7816 cost time: 12.3s

cause_predict: test acc 0.8919 p 0.6426 r 0.5331 f1 0.5828
max_acc 0.8919 max_p 0.6426 max_r 0.5331 max_f1 0.5828

position_predict: test acc 0.9124 p 0.6564 r 0.6655 f1 0.6609
max_acc 0.9245 max_p 0.7021 max_r 0.7143 max_f1 0.7081

Average max cause: max_acc 0.8928 max_p 0.6611 max_r 0.4984 max_f1 0.5683
Average max pos: max_acc 0.9267 max_p 0.7573 max_r 0.6307 max_f1 0.6882

step 10: train loss 0.1178 
cause_predict: train acc 0.9802 p 0.9688 r 0.8857 f1 0.9254
position_predict: train acc 0.9722 p 0.9310 r 0.8438 f1 0.8852
step 20: train loss 0.0986 
cause_predict: train acc 0.9827 p 0.9444 r 0.9444 f1 0.9444
position_predict: train acc 0.9784 p 0.9118 r 0.9394 f1 0.9254
step 30: train loss 0.1531 
cause_predict: train acc 0.9653 p 0.9062 r 0.8286 f1 0.8657
position_predict: train acc 0.9846 p 0.9118 r 0.9688 f1 0.9394
step 40: train loss 0.1269 
cause_predict: train acc 0.9846 p 0.9412 r 0.9412 f1 0.9412
position_predict: train acc 0.9692 p 0.8750 r 0.8750 f1 0.8750
step 50: train loss 0.1670 
cause_predict: train acc 0.9567 p 0.9000 r 0.7297 f1 0.8060
position_predict: train acc 0.9700 p 0.8710 r 0.8438 f1 0.8571
step 60: train loss 0.1178 
cause_predict: train acc 0.9710 p 0.9375 r 0.8824 f1 0.9091
position_predict: train acc 0.9710 p 0.9355 r 0.8788 f1 0.9062
step 70: train loss 0.2736 
cause_predict: train acc 0.9412 p 0.8049 r 0.8684 f1 0.8354
position_predict: train acc 0.9367 p 0.7812 r 0.7812 f1 0.7812

epoch 13: test loss 0.8025 cost time: 12.2s

cause_predict: test acc 0.8825 p 0.5957 r 0.5300 f1 0.5609
max_acc 0.8919 max_p 0.6426 max_r 0.5331 max_f1 0.5828

position_predict: test acc 0.9169 p 0.6724 r 0.6864 f1 0.6793
max_acc 0.9245 max_p 0.7021 max_r 0.7143 max_f1 0.7081

Average max cause: max_acc 0.8928 max_p 0.6611 max_r 0.4984 max_f1 0.5683
Average max pos: max_acc 0.9267 max_p 0.7573 max_r 0.6307 max_f1 0.6882

step 10: train loss 0.1266 
cause_predict: train acc 0.9646 p 0.8571 r 0.9091 f1 0.8824
position_predict: train acc 0.9690 p 0.9310 r 0.8438 f1 0.8852
step 20: train loss 0.0831 
cause_predict: train acc 0.9891 p 0.9474 r 0.9730 f1 0.9600
position_predict: train acc 0.9891 p 0.9394 r 0.9688 f1 0.9538
step 30: train loss 0.1046 
cause_predict: train acc 0.9843 p 0.9737 r 0.9250 f1 0.9487
position_predict: train acc 0.9724 p 0.9032 r 0.8750 f1 0.8889
step 40: train loss 0.0837 
cause_predict: train acc 0.9953 p 1.0000 r 0.9730 f1 0.9863
position_predict: train acc 0.9721 p 0.8824 r 0.9375 f1 0.9091
step 50: train loss 0.1034 
cause_predict: train acc 0.9871 p 0.9459 r 0.9722 f1 0.9589
position_predict: train acc 0.9871 p 0.9394 r 0.9688 f1 0.9538
step 60: train loss 0.0786 
cause_predict: train acc 0.9923 p 0.9706 r 0.9706 f1 0.9706
position_predict: train acc 0.9846 p 0.9667 r 0.9062 f1 0.9355
step 70: train loss 0.1783 
cause_predict: train acc 0.9671 p 0.8889 r 0.9143 f1 0.9014
position_predict: train acc 0.9437 p 0.8125 r 0.8125 f1 0.8125

epoch 14: test loss 0.7907 cost time: 12.9s

cause_predict: test acc 0.8834 p 0.5979 r 0.5394 f1 0.5672
max_acc 0.8919 max_p 0.6426 max_r 0.5331 max_f1 0.5828

position_predict: test acc 0.9138 p 0.6728 r 0.6376 f1 0.6547
max_acc 0.9245 max_p 0.7021 max_r 0.7143 max_f1 0.7081

Average max cause: max_acc 0.8928 max_p 0.6611 max_r 0.4984 max_f1 0.5683
Average max pos: max_acc 0.9267 max_p 0.7573 max_r 0.6307 max_f1 0.6882

write pair_data/Ind_BiLSTM_1/fold_4_test.txt done
write pair_data/Ind_BiLSTM_1/fold_4_train.txt done
Optimization Finished!

############# fold 4 end ###############
############# fold 5 begin ###############
load data_file: data_combine_en/fold_5_train.txt
y_position.shape (2275, 75, 2)
y_cause.shape (2275, 75, 2)
x.shape (2275, 75, 30)
sen_len.shape (2275, 75)
doc_len.shape (2275,)
n_cut 107
load data done!

load data_file: data_combine_en/fold_5_test.txt
y_position.shape (284, 75, 2)
y_cause.shape (284, 75, 2)
x.shape (284, 75, 30)
sen_len.shape (284, 75)
doc_len.shape (284,)
n_cut 22
load data done!

train docs: 2275    test docs: 284
step 10: train loss 0.8854 
cause_predict: train acc 0.8279 p 0.0000 r 0.0000 f1 0.0000
position_predict: train acc 0.8512 p 0.0000 r 0.0000 f1 0.0000
step 20: train loss 0.7726 
cause_predict: train acc 0.8452 p 0.0000 r 0.0000 f1 0.0000
position_predict: train acc 0.8661 p 0.0000 r 0.0000 f1 0.0000
step 30: train loss 0.6427 
cause_predict: train acc 0.8750 p 0.0000 r 0.0000 f1 0.0000
position_predict: train acc 0.8919 p 0.0000 r 0.0000 f1 0.0000
step 40: train loss 0.5423 
cause_predict: train acc 0.8811 p 0.0000 r 0.0000 f1 0.0000
position_predict: train acc 0.8881 p 0.0000 r 0.0000 f1 0.0000
step 50: train loss 0.5825 
cause_predict: train acc 0.8682 p 0.0000 r 0.0000 f1 0.0000
position_predict: train acc 0.8953 p 0.6000 r 0.4688 f1 0.5263
step 60: train loss 0.6571 
cause_predict: train acc 0.8475 p 0.0000 r 0.0000 f1 0.0000
position_predict: train acc 0.8686 p 1.0000 r 0.0312 f1 0.0606
step 70: train loss 0.5072 
cause_predict: train acc 0.8822 p 0.0000 r 0.0000 f1 0.0000
position_predict: train acc 0.9125 p 0.6364 r 0.4375 f1 0.5185

epoch 0: test loss 0.5499 cost time: 12.8s

cause_predict: test acc 0.8584 p 0.0000 r 0.0000 f1 0.0000
max_acc 0.8584 max_p 0.0000 max_r 0.0000 max_f1 0.0000

position_predict: test acc 0.9026 p 0.7347 r 0.3763 f1 0.4977
max_acc 0.9026 max_p 0.7347 max_r 0.3763 max_f1 0.4977

Average max cause: max_acc 0.8584 max_p 0.0000 max_r 0.0000 max_f1 0.0000
Average max pos: max_acc 0.9026 max_p 0.7347 max_r 0.3763 max_f1 0.4977

step 10: train loss 0.5681 
cause_predict: train acc 0.8471 p 0.0000 r 0.0000 f1 0.0000
position_predict: train acc 0.9174 p 0.7727 r 0.5312 f1 0.6296
step 20: train loss 0.4524 
cause_predict: train acc 0.8750 p 0.0000 r 0.0000 f1 0.0000
position_predict: train acc 0.9228 p 0.7619 r 0.5000 f1 0.6038
step 30: train loss 0.5277 
cause_predict: train acc 0.8710 p 0.7143 r 0.1429 f1 0.2381
position_predict: train acc 0.9153 p 0.6897 r 0.6250 f1 0.6557
step 40: train loss 0.3989 
cause_predict: train acc 0.8929 p 0.6667 r 0.3125 f1 0.4255
position_predict: train acc 0.9524 p 0.8333 r 0.7812 f1 0.8065
step 50: train loss 0.5432 
cause_predict: train acc 0.8714 p 0.6400 r 0.4706 f1 0.5424
position_predict: train acc 0.9190 p 0.7353 r 0.7576 f1 0.7463
step 60: train loss 0.5324 
cause_predict: train acc 0.8800 p 0.7619 r 0.4211 f1 0.5424
position_predict: train acc 0.9111 p 0.7097 r 0.6667 f1 0.6875
step 70: train loss 0.6659 
cause_predict: train acc 0.8333 p 0.7000 r 0.1628 f1 0.2642
position_predict: train acc 0.9274 p 0.7778 r 0.6562 f1 0.7119

epoch 1: test loss 0.4988 cost time: 12.9s

cause_predict: test acc 0.8838 p 0.7021 r 0.3123 f1 0.4323
max_acc 0.8838 max_p 0.7021 max_r 0.3123 max_f1 0.4323

position_predict: test acc 0.9142 p 0.6820 r 0.6202 f1 0.6496
max_acc 0.9142 max_p 0.6820 max_r 0.6202 max_f1 0.6496

Average max cause: max_acc 0.8838 max_p 0.7021 max_r 0.3123 max_f1 0.4323
Average max pos: max_acc 0.9142 max_p 0.6820 max_r 0.6202 max_f1 0.6496

step 10: train loss 0.5069 
cause_predict: train acc 0.8739 p 0.7143 r 0.4878 f1 0.5797
position_predict: train acc 0.8870 p 0.6061 r 0.6061 f1 0.6061
step 20: train loss 0.4003 
cause_predict: train acc 0.8960 p 0.6957 r 0.4571 f1 0.5517
position_predict: train acc 0.9560 p 0.8621 r 0.7812 f1 0.8197
step 30: train loss 0.3554 
cause_predict: train acc 0.8996 p 0.8333 r 0.2857 f1 0.4255
position_predict: train acc 0.9591 p 0.8889 r 0.7500 f1 0.8136
step 40: train loss 0.4010 
cause_predict: train acc 0.9155 p 0.7143 r 0.4412 f1 0.5455
position_predict: train acc 0.9257 p 0.6923 r 0.5625 f1 0.6207
step 50: train loss 0.5044 
cause_predict: train acc 0.8784 p 0.7000 r 0.4000 f1 0.5091
position_predict: train acc 0.8964 p 0.6452 r 0.6250 f1 0.6349
step 60: train loss 0.4921 
cause_predict: train acc 0.8443 p 0.4583 r 0.2558 f1 0.3284
position_predict: train acc 0.9446 p 0.7429 r 0.7879 f1 0.7647
step 70: train loss 0.4738 
cause_predict: train acc 0.8792 p 0.6522 r 0.3488 f1 0.4545
position_predict: train acc 0.9497 p 0.8696 r 0.6250 f1 0.7273

epoch 2: test loss 0.4727 cost time: 12.6s

cause_predict: test acc 0.8905 p 0.6651 r 0.4574 f1 0.5421
max_acc 0.8905 max_p 0.6651 max_r 0.4574 max_f1 0.5421

position_predict: test acc 0.9218 p 0.7258 r 0.6272 f1 0.6729
max_acc 0.9218 max_p 0.7258 max_r 0.6272 max_f1 0.6729

Average max cause: max_acc 0.8905 max_p 0.6651 max_r 0.4574 max_f1 0.5421
Average max pos: max_acc 0.9218 max_p 0.7258 max_r 0.6272 max_f1 0.6729

step 10: train loss 0.3806 
cause_predict: train acc 0.8780 p 0.5455 r 0.3158 f1 0.4000
position_predict: train acc 0.9424 p 0.7273 r 0.7500 f1 0.7385
step 20: train loss 0.4598 
cause_predict: train acc 0.8944 p 0.8065 r 0.6579 f1 0.7246
position_predict: train acc 0.9500 p 0.9259 r 0.7812 f1 0.8475
step 30: train loss 0.5788 
cause_predict: train acc 0.8261 p 0.6286 r 0.5946 f1 0.6111
position_predict: train acc 0.9006 p 0.7742 r 0.7273 f1 0.7500
step 40: train loss 0.3443 
cause_predict: train acc 0.9157 p 0.7308 r 0.5588 f1 0.6333
position_predict: train acc 0.9349 p 0.8000 r 0.6250 f1 0.7018
step 50: train loss 0.3266 
cause_predict: train acc 0.9207 p 0.7000 r 0.6000 f1 0.6462
position_predict: train acc 0.9448 p 0.7857 r 0.6875 f1 0.7333
step 60: train loss 0.5833 
cause_predict: train acc 0.8305 p 0.6154 r 0.4444 f1 0.5161
position_predict: train acc 0.8870 p 0.6970 r 0.6970 f1 0.6970
step 70: train loss 0.5058 
cause_predict: train acc 0.8874 p 0.6818 r 0.4412 f1 0.5357
position_predict: train acc 0.9437 p 0.8800 r 0.6875 f1 0.7719

epoch 3: test loss 0.4812 cost time: 12.1s

cause_predict: test acc 0.8932 p 0.6840 r 0.4574 f1 0.5482
max_acc 0.8932 max_p 0.6840 max_r 0.4574 max_f1 0.5482

position_predict: test acc 0.9205 p 0.7243 r 0.6132 f1 0.6642
max_acc 0.9218 max_p 0.7258 max_r 0.6272 max_f1 0.6729

Average max cause: max_acc 0.8905 max_p 0.6651 max_r 0.4574 max_f1 0.5421
Average max pos: max_acc 0.9218 max_p 0.7258 max_r 0.6272 max_f1 0.6729

step 10: train loss 0.5226 
cause_predict: train acc 0.8564 p 0.7600 r 0.4634 f1 0.5758
position_predict: train acc 0.9179 p 0.7857 r 0.6875 f1 0.7333
step 20: train loss 0.3660 
cause_predict: train acc 0.8870 p 0.6667 r 0.5000 f1 0.5714
position_predict: train acc 0.9498 p 0.8571 r 0.7500 f1 0.8000
step 30: train loss 0.3118 
cause_predict: train acc 0.9314 p 0.7778 r 0.6176 f1 0.6885
position_predict: train acc 0.9422 p 0.7500 r 0.7500 f1 0.7500
step 40: train loss 0.3439 
cause_predict: train acc 0.9000 p 0.6400 r 0.4706 f1 0.5424
position_predict: train acc 0.9556 p 0.8571 r 0.7500 f1 0.8000
step 50: train loss 0.4846 
cause_predict: train acc 0.8725 p 0.7273 r 0.4444 f1 0.5517
position_predict: train acc 0.9265 p 0.7576 r 0.7812 f1 0.7692
step 60: train loss 0.3952 
cause_predict: train acc 0.8963 p 0.6957 r 0.4706 f1 0.5614
position_predict: train acc 0.9378 p 0.7742 r 0.7500 f1 0.7619
step 70: train loss 0.3332 
cause_predict: train acc 0.9280 p 0.8400 r 0.6000 f1 0.7000
position_predict: train acc 0.9520 p 0.8333 r 0.7812 f1 0.8065

epoch 4: test loss 0.4684 cost time: 12.5s

cause_predict: test acc 0.8954 p 0.6912 r 0.4732 f1 0.5618
max_acc 0.8954 max_p 0.6912 max_r 0.4732 max_f1 0.5618

position_predict: test acc 0.9263 p 0.7311 r 0.6725 f1 0.7005
max_acc 0.9263 max_p 0.7311 max_r 0.6725 max_f1 0.7005

Average max cause: max_acc 0.8954 max_p 0.6912 max_r 0.4732 max_f1 0.5618
Average max pos: max_acc 0.9263 max_p 0.7311 max_r 0.6725 max_f1 0.7005

step 10: train loss 0.3155 
cause_predict: train acc 0.9286 p 0.7500 r 0.6000 f1 0.6667
position_predict: train acc 0.9388 p 0.7500 r 0.6562 f1 0.7000
step 20: train loss 0.3300 
cause_predict: train acc 0.9377 p 0.8182 r 0.7297 f1 0.7714
position_predict: train acc 0.9300 p 0.7500 r 0.6562 f1 0.7000
step 30: train loss 0.3406 
cause_predict: train acc 0.9246 p 0.7586 r 0.6471 f1 0.6984
position_predict: train acc 0.9365 p 0.7667 r 0.7188 f1 0.7419
step 40: train loss 0.3983 
cause_predict: train acc 0.9082 p 0.7273 r 0.7273 f1 0.7273
position_predict: train acc 0.9184 p 0.7742 r 0.7273 f1 0.7500
step 50: train loss 0.4326 
cause_predict: train acc 0.8571 p 0.5429 r 0.5588 f1 0.5507
position_predict: train acc 0.9263 p 0.7742 r 0.7273 f1 0.7500
step 60: train loss 0.3495 
cause_predict: train acc 0.9118 p 0.7143 r 0.6061 f1 0.6557
position_predict: train acc 0.9286 p 0.7143 r 0.7812 f1 0.7463
step 70: train loss 0.4004 
cause_predict: train acc 0.8979 p 0.6538 r 0.4595 f1 0.5397
position_predict: train acc 0.9261 p 0.6774 r 0.6562 f1 0.6667

epoch 5: test loss 0.5006 cost time: 12.2s

cause_predict: test acc 0.8847 p 0.6288 r 0.4543 f1 0.5275
max_acc 0.8954 max_p 0.6912 max_r 0.4732 max_f1 0.5618

position_predict: test acc 0.9196 p 0.6851 r 0.6899 f1 0.6875
max_acc 0.9263 max_p 0.7311 max_r 0.6725 max_f1 0.7005

Average max cause: max_acc 0.8954 max_p 0.6912 max_r 0.4732 max_f1 0.5618
Average max pos: max_acc 0.9263 max_p 0.7311 max_r 0.6725 max_f1 0.7005

step 10: train loss 0.2295 
cause_predict: train acc 0.9238 p 0.8214 r 0.6571 f1 0.7302
position_predict: train acc 0.9776 p 0.9655 r 0.8750 f1 0.9180
step 20: train loss 0.2856 
cause_predict: train acc 0.9362 p 0.8571 r 0.6857 f1 0.7619
position_predict: train acc 0.9574 p 0.8966 r 0.7879 f1 0.8387
step 30: train loss 0.2600 
cause_predict: train acc 0.9321 p 0.8889 r 0.6667 f1 0.7619
position_predict: train acc 0.9729 p 0.9333 r 0.8750 f1 0.9032
step 40: train loss 0.2655 
cause_predict: train acc 0.9348 p 0.7097 r 0.6471 f1 0.6769
position_predict: train acc 0.9596 p 0.8276 r 0.7500 f1 0.7869
step 50: train loss 0.4007 
cause_predict: train acc 0.9143 p 0.8125 r 0.7429 f1 0.7761
position_predict: train acc 0.9371 p 0.8182 r 0.8438 f1 0.8308
step 60: train loss 0.2868 
cause_predict: train acc 0.9354 p 0.7857 r 0.6286 f1 0.6984
position_predict: train acc 0.9490 p 0.8214 r 0.6970 f1 0.7541
step 70: train loss 0.2598 
cause_predict: train acc 0.9388 p 0.8125 r 0.7429 f1 0.7761
position_predict: train acc 0.9673 p 0.9032 r 0.8485 f1 0.8750

epoch 6: test loss 0.5264 cost time: 12.3s

cause_predict: test acc 0.8905 p 0.6488 r 0.4953 f1 0.5617
max_acc 0.8954 max_p 0.6912 max_r 0.4732 max_f1 0.5618

position_predict: test acc 0.9200 p 0.7126 r 0.6307 f1 0.6691
max_acc 0.9263 max_p 0.7311 max_r 0.6725 max_f1 0.7005

Average max cause: max_acc 0.8954 max_p 0.6912 max_r 0.4732 max_f1 0.5618
Average max pos: max_acc 0.9263 max_p 0.7311 max_r 0.6725 max_f1 0.7005

step 10: train loss 0.2555 
cause_predict: train acc 0.9449 p 0.8125 r 0.7647 f1 0.7879
position_predict: train acc 0.9528 p 0.8125 r 0.8125 f1 0.8125
step 20: train loss 0.1902 
cause_predict: train acc 0.9399 p 0.8125 r 0.7647 f1 0.7879
position_predict: train acc 0.9657 p 0.9333 r 0.8235 f1 0.8750
step 30: train loss 0.2211 
cause_predict: train acc 0.9612 p 0.9032 r 0.8485 f1 0.8750
position_predict: train acc 0.9466 p 0.8182 r 0.8438 f1 0.8308
step 40: train loss 0.2053 
cause_predict: train acc 0.9476 p 0.7895 r 0.8333 f1 0.8108
position_predict: train acc 0.9813 p 0.9355 r 0.9062 f1 0.9206
step 50: train loss 0.2421 
cause_predict: train acc 0.9378 p 0.8519 r 0.6765 f1 0.7541
position_predict: train acc 0.9585 p 0.8056 r 0.9062 f1 0.8529
step 60: train loss 0.1979 
cause_predict: train acc 0.9462 p 0.8125 r 0.7429 f1 0.7761
position_predict: train acc 0.9713 p 0.8788 r 0.8788 f1 0.8788
step 70: train loss 0.3216 
cause_predict: train acc 0.9279 p 0.7838 r 0.8056 f1 0.7945
position_predict: train acc 0.9423 p 0.8846 r 0.7188 f1 0.7931

epoch 7: test loss 0.5716 cost time: 12.4s

cause_predict: test acc 0.8852 p 0.6172 r 0.4984 f1 0.5515
max_acc 0.8954 max_p 0.6912 max_r 0.4732 max_f1 0.5618

position_predict: test acc 0.9218 p 0.7000 r 0.6829 f1 0.6914
max_acc 0.9263 max_p 0.7311 max_r 0.6725 max_f1 0.7005

Average max cause: max_acc 0.8954 max_p 0.6912 max_r 0.4732 max_f1 0.5618
Average max pos: max_acc 0.9263 max_p 0.7311 max_r 0.6725 max_f1 0.7005

step 10: train loss 0.2425 
cause_predict: train acc 0.9286 p 0.8065 r 0.7353 f1 0.7692
position_predict: train acc 0.9857 p 0.9394 r 0.9688 f1 0.9538
step 20: train loss 0.1630 
cause_predict: train acc 0.9498 p 0.7895 r 0.7895 f1 0.7895
position_predict: train acc 0.9875 p 0.9375 r 0.9375 f1 0.9375
step 30: train loss 0.2156 
cause_predict: train acc 0.9697 p 0.8857 r 0.8611 f1 0.8732
position_predict: train acc 0.9428 p 0.7273 r 0.7500 f1 0.7385
step 40: train loss 0.3076 
cause_predict: train acc 0.9524 p 0.8889 r 0.8421 f1 0.8649
position_predict: train acc 0.9381 p 0.7879 r 0.8125 f1 0.8000
step 50: train loss 0.2546 
cause_predict: train acc 0.9643 p 0.9062 r 0.8788 f1 0.8923
position_predict: train acc 0.9541 p 0.8966 r 0.8125 f1 0.8525
step 60: train loss 0.2604 
cause_predict: train acc 0.9588 p 0.8611 r 0.8611 f1 0.8611
position_predict: train acc 0.9465 p 0.8276 r 0.7500 f1 0.7869
step 70: train loss 0.3001 
cause_predict: train acc 0.9265 p 0.7568 r 0.7568 f1 0.7568
position_predict: train acc 0.9429 p 0.7812 r 0.7812 f1 0.7812

epoch 8: test loss 0.5908 cost time: 12.5s

cause_predict: test acc 0.8753 p 0.5709 r 0.4826 f1 0.5231
max_acc 0.8954 max_p 0.6912 max_r 0.4732 max_f1 0.5618

position_predict: test acc 0.9133 p 0.6535 r 0.6899 f1 0.6712
max_acc 0.9263 max_p 0.7311 max_r 0.6725 max_f1 0.7005

Average max cause: max_acc 0.8954 max_p 0.6912 max_r 0.4732 max_f1 0.5618
Average max pos: max_acc 0.9263 max_p 0.7311 max_r 0.6725 max_f1 0.7005

step 10: train loss 0.1617 
cause_predict: train acc 0.9694 p 0.9412 r 0.8649 f1 0.9014
position_predict: train acc 0.9782 p 0.9091 r 0.9375 f1 0.9231
step 20: train loss 0.1769 
cause_predict: train acc 0.9615 p 0.8378 r 0.8611 f1 0.8493
position_predict: train acc 0.9720 p 0.8788 r 0.8788 f1 0.8788
step 30: train loss 0.2551 
cause_predict: train acc 0.9385 p 0.8000 r 0.7273 f1 0.7619
position_predict: train acc 0.9672 p 0.9000 r 0.8438 f1 0.8710
step 40: train loss 0.2589 
cause_predict: train acc 0.9554 p 0.8611 r 0.8158 f1 0.8378
position_predict: train acc 0.9517 p 0.8276 r 0.7500 f1 0.7869
step 50: train loss 0.1737 
cause_predict: train acc 0.9757 p 0.9444 r 0.8947 f1 0.9189
position_predict: train acc 0.9717 p 0.8788 r 0.9062 f1 0.8923
step 60: train loss 0.1249 
cause_predict: train acc 0.9679 p 0.9333 r 0.8485 f1 0.8889
position_predict: train acc 0.9862 p 1.0000 r 0.9062 f1 0.9508
step 70: train loss 0.3045 
cause_predict: train acc 0.9402 p 0.8378 r 0.7949 f1 0.8158
position_predict: train acc 0.9316 p 0.7500 r 0.7500 f1 0.7500

epoch 9: test loss 0.6308 cost time: 12.7s

cause_predict: test acc 0.8856 p 0.6206 r 0.4953 f1 0.5509
max_acc 0.8954 max_p 0.6912 max_r 0.4732 max_f1 0.5618

position_predict: test acc 0.9164 p 0.6786 r 0.6620 f1 0.6702
max_acc 0.9263 max_p 0.7311 max_r 0.6725 max_f1 0.7005

Average max cause: max_acc 0.8954 max_p 0.6912 max_r 0.4732 max_f1 0.5618
Average max pos: max_acc 0.9263 max_p 0.7311 max_r 0.6725 max_f1 0.7005

step 10: train loss 0.1108 
cause_predict: train acc 0.9729 p 0.9412 r 0.8889 f1 0.9143
position_predict: train acc 0.9955 p 1.0000 r 0.9688 f1 0.9841
step 20: train loss 0.2174 
cause_predict: train acc 0.9507 p 0.8611 r 0.8378 f1 0.8493
position_predict: train acc 0.9552 p 0.8235 r 0.8750 f1 0.8485
step 30: train loss 0.1129 
cause_predict: train acc 0.9870 p 1.0000 r 0.9062 f1 0.9508
position_predict: train acc 0.9784 p 0.9355 r 0.9062 f1 0.9206
step 40: train loss 0.2969 
cause_predict: train acc 0.9315 p 0.7632 r 0.8286 f1 0.7945
position_predict: train acc 0.9406 p 0.8125 r 0.7879 f1 0.8000
step 50: train loss 0.2042 
cause_predict: train acc 0.9730 p 0.9189 r 0.9189 f1 0.9189
position_predict: train acc 0.9595 p 0.8485 r 0.8750 f1 0.8615
step 60: train loss 0.1988 
cause_predict: train acc 0.9565 p 0.8750 r 0.8000 f1 0.8358
position_predict: train acc 0.9723 p 0.8824 r 0.9091 f1 0.8955
step 70: train loss 0.1734 
cause_predict: train acc 0.9519 p 1.0000 r 0.7368 f1 0.8485
position_predict: train acc 0.9760 p 0.9091 r 0.9375 f1 0.9231

epoch 10: test loss 0.6716 cost time: 12.5s

cause_predict: test acc 0.8803 p 0.6061 r 0.4416 f1 0.5109
max_acc 0.8954 max_p 0.6912 max_r 0.4732 max_f1 0.5618

position_predict: test acc 0.9160 p 0.6737 r 0.6690 f1 0.6713
max_acc 0.9263 max_p 0.7311 max_r 0.6725 max_f1 0.7005

Average max cause: max_acc 0.8954 max_p 0.6912 max_r 0.4732 max_f1 0.5618
Average max pos: max_acc 0.9263 max_p 0.7311 max_r 0.6725 max_f1 0.7005

step 10: train loss 0.0948 
cause_predict: train acc 0.9767 p 0.8889 r 0.9412 f1 0.9143
position_predict: train acc 0.9883 p 0.9677 r 0.9375 f1 0.9524
step 20: train loss 0.0654 
cause_predict: train acc 0.9927 p 1.0000 r 0.9444 f1 0.9714
position_predict: train acc 0.9927 p 1.0000 r 0.9394 f1 0.9688
step 30: train loss 0.1414 
cause_predict: train acc 0.9586 p 0.8919 r 0.8250 f1 0.8571
position_predict: train acc 0.9774 p 0.9062 r 0.9062 f1 0.9062
step 40: train loss 0.0872 
cause_predict: train acc 0.9887 p 0.9706 r 0.9706 f1 0.9706
position_predict: train acc 0.9718 p 0.9677 r 0.8824 f1 0.9231
step 50: train loss 0.1531 
cause_predict: train acc 0.9770 p 0.9189 r 0.9189 f1 0.9189
position_predict: train acc 0.9502 p 0.8438 r 0.7714 f1 0.8060
step 60: train loss 0.2748 
cause_predict: train acc 0.9615 p 0.9032 r 0.8235 f1 0.8615
position_predict: train acc 0.9359 p 0.7576 r 0.7812 f1 0.7692
step 70: train loss 0.2236 
cause_predict: train acc 0.9571 p 0.8974 r 0.8537 f1 0.8750
position_predict: train acc 0.9614 p 0.8485 r 0.8750 f1 0.8615

epoch 11: test loss 0.6947 cost time: 12.5s

cause_predict: test acc 0.8825 p 0.6000 r 0.5110 f1 0.5520
max_acc 0.8954 max_p 0.6912 max_r 0.4732 max_f1 0.5618

position_predict: test acc 0.9138 p 0.6556 r 0.6899 f1 0.6723
max_acc 0.9263 max_p 0.7311 max_r 0.6725 max_f1 0.7005

Average max cause: max_acc 0.8954 max_p 0.6912 max_r 0.4732 max_f1 0.5618
Average max pos: max_acc 0.9263 max_p 0.7311 max_r 0.6725 max_f1 0.7005

step 10: train loss 0.0952 
cause_predict: train acc 0.9880 p 0.9167 r 0.9706 f1 0.9429
position_predict: train acc 0.9880 p 0.9677 r 0.9091 f1 0.9375
step 20: train loss 0.0793 
cause_predict: train acc 0.9925 p 0.9697 r 0.9697 f1 0.9697
position_predict: train acc 0.9736 p 0.8788 r 0.9062 f1 0.8923
step 30: train loss 0.0937 
cause_predict: train acc 0.9774 p 0.9394 r 0.9118 f1 0.9254
position_predict: train acc 0.9864 p 0.9412 r 0.9697 f1 0.9552
step 40: train loss 0.0898 
cause_predict: train acc 0.9672 p 0.9677 r 0.8571 f1 0.9091
position_predict: train acc 0.9945 p 0.9697 r 1.0000 f1 0.9846
step 50: train loss 0.1104 
cause_predict: train acc 0.9894 p 0.9706 r 0.9706 f1 0.9706
position_predict: train acc 0.9735 p 0.9355 r 0.9062 f1 0.9206
step 60: train loss 0.1502 
cause_predict: train acc 0.9801 p 0.9714 r 0.8947 f1 0.9315
position_predict: train acc 0.9522 p 0.8333 r 0.7812 f1 0.8065
step 70: train loss 0.1487 
cause_predict: train acc 0.9672 p 0.9091 r 0.8333 f1 0.8696
position_predict: train acc 0.9854 p 0.9677 r 0.9091 f1 0.9375

epoch 12: test loss 0.7445 cost time: 12.7s

cause_predict: test acc 0.8785 p 0.5789 r 0.5205 f1 0.5482
max_acc 0.8954 max_p 0.6912 max_r 0.4732 max_f1 0.5618

position_predict: test acc 0.9120 p 0.6500 r 0.6794 f1 0.6644
max_acc 0.9263 max_p 0.7311 max_r 0.6725 max_f1 0.7005

Average max cause: max_acc 0.8954 max_p 0.6912 max_r 0.4732 max_f1 0.5618
Average max pos: max_acc 0.9263 max_p 0.7311 max_r 0.6725 max_f1 0.7005

step 10: train loss 0.0793 
cause_predict: train acc 0.9933 p 1.0000 r 0.9444 f1 0.9714
position_predict: train acc 0.9765 p 0.9032 r 0.8750 f1 0.8889
step 20: train loss 0.1412 
cause_predict: train acc 0.9537 p 0.8235 r 0.8235 f1 0.8235
position_predict: train acc 0.9807 p 0.9091 r 0.9375 f1 0.9231
step 30: train loss 0.0676 
cause_predict: train acc 0.9907 p 0.9459 r 1.0000 f1 0.9722
position_predict: train acc 0.9861 p 0.9677 r 0.9375 f1 0.9524
step 40: train loss 0.1588 
cause_predict: train acc 0.9769 p 0.9167 r 0.8684 f1 0.8919
position_predict: train acc 0.9624 p 0.8065 r 0.7812 f1 0.7937
step 50: train loss 0.2241 
cause_predict: train acc 0.9540 p 0.8649 r 0.9143 f1 0.8889
position_predict: train acc 0.9655 p 0.9062 r 0.9062 f1 0.9062
step 60: train loss 0.1497 
cause_predict: train acc 0.9643 p 0.8571 r 0.7895 f1 0.8219
position_predict: train acc 0.9670 p 0.7941 r 0.8438 f1 0.8182
step 70: train loss 0.1404 
cause_predict: train acc 0.9677 p 0.9677 r 0.8333 f1 0.8955
position_predict: train acc 0.9908 p 0.9688 r 0.9688 f1 0.9688

epoch 13: test loss 0.7329 cost time: 12.5s

cause_predict: test acc 0.8820 p 0.5971 r 0.5142 f1 0.5525
max_acc 0.8954 max_p 0.6912 max_r 0.4732 max_f1 0.5618

position_predict: test acc 0.9164 p 0.6748 r 0.6725 f1 0.6736
max_acc 0.9263 max_p 0.7311 max_r 0.6725 max_f1 0.7005

Average max cause: max_acc 0.8954 max_p 0.6912 max_r 0.4732 max_f1 0.5618
Average max pos: max_acc 0.9263 max_p 0.7311 max_r 0.6725 max_f1 0.7005

step 10: train loss 0.1280 
cause_predict: train acc 0.9821 p 0.9394 r 0.9688 f1 0.9538
position_predict: train acc 0.9762 p 0.9375 r 0.9375 f1 0.9375
step 20: train loss 0.0746 
cause_predict: train acc 0.9890 p 0.9714 r 0.9444 f1 0.9577
position_predict: train acc 0.9853 p 0.9118 r 0.9688 f1 0.9394
step 30: train loss 0.0393 
cause_predict: train acc 0.9880 p 0.9444 r 0.9714 f1 0.9577
position_predict: train acc 0.9960 p 0.9706 r 1.0000 f1 0.9851
step 40: train loss 0.1483 
cause_predict: train acc 0.9740 p 0.9474 r 0.9000 f1 0.9231
position_predict: train acc 0.9697 p 0.8788 r 0.9062 f1 0.8923
step 50: train loss 0.1656 
cause_predict: train acc 0.9719 p 0.8611 r 0.9394 f1 0.8986
position_predict: train acc 0.9679 p 0.8788 r 0.8788 f1 0.8788
step 60: train loss 0.1160 
cause_predict: train acc 0.9837 p 0.9697 r 0.9143 f1 0.9412
position_predict: train acc 0.9714 p 0.8788 r 0.9062 f1 0.8923
step 70: train loss 0.1070 
cause_predict: train acc 0.9858 p 0.9688 r 0.9394 f1 0.9538
position_predict: train acc 0.9811 p 0.9394 r 0.9394 f1 0.9394

epoch 14: test loss 0.7671 cost time: 12.3s

cause_predict: test acc 0.8785 p 0.5789 r 0.5205 f1 0.5482
max_acc 0.8954 max_p 0.6912 max_r 0.4732 max_f1 0.5618

/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
position_predict: test acc 0.9160 p 0.6749 r 0.6655 f1 0.6702
max_acc 0.9263 max_p 0.7311 max_r 0.6725 max_f1 0.7005

Average max cause: max_acc 0.8954 max_p 0.6912 max_r 0.4732 max_f1 0.5618
Average max pos: max_acc 0.9263 max_p 0.7311 max_r 0.6725 max_f1 0.7005

write pair_data/Ind_BiLSTM_1/fold_5_test.txt done
write pair_data/Ind_BiLSTM_1/fold_5_train.txt done
Optimization Finished!

############# fold 5 end ###############
############# fold 6 begin ###############
load data_file: data_combine_en/fold_6_train.txt
y_position.shape (2275, 75, 2)
y_cause.shape (2275, 75, 2)
x.shape (2275, 75, 30)
sen_len.shape (2275, 75)
doc_len.shape (2275,)
n_cut 107
load data done!

load data_file: data_combine_en/fold_6_test.txt
y_position.shape (284, 75, 2)
y_cause.shape (284, 75, 2)
x.shape (284, 75, 30)
sen_len.shape (284, 75)
doc_len.shape (284,)
n_cut 22
load data done!

train docs: 2275    test docs: 284
step 10: train loss 0.7474 
cause_predict: train acc 0.8862 p 0.0000 r 0.0000 f1 0.0000
position_predict: train acc 0.8862 p 0.0000 r 0.0000 f1 0.0000
step 20: train loss 0.7144 
cause_predict: train acc 0.8649 p 0.0000 r 0.0000 f1 0.0000
position_predict: train acc 0.8764 p 0.0000 r 0.0000 f1 0.0000
step 30: train loss 0.6940 
cause_predict: train acc 0.8481 p 0.0000 r 0.0000 f1 0.0000
position_predict: train acc 0.8608 p 0.0000 r 0.0000 f1 0.0000
step 40: train loss 0.7055 
cause_predict: train acc 0.8152 p 0.0000 r 0.0000 f1 0.0000
position_predict: train acc 0.8533 p 0.7778 r 0.2188 f1 0.3415
step 50: train loss 0.6936 
cause_predict: train acc 0.8221 p 0.0000 r 0.0000 f1 0.0000
position_predict: train acc 0.8990 p 0.7895 r 0.4688 f1 0.5882
step 60: train loss 0.5196 
cause_predict: train acc 0.8635 p 0.0000 r 0.0000 f1 0.0000
position_predict: train acc 0.9036 p 0.6667 r 0.5000 f1 0.5714
step 70: train loss 0.5547 
cause_predict: train acc 0.8326 p 0.0000 r 0.0000 f1 0.0000
position_predict: train acc 0.9186 p 0.7917 r 0.5938 f1 0.6786

epoch 0: test loss 0.5241 cost time: 12.5s

cause_predict: test acc 0.8584 p 0.0000 r 0.0000 f1 0.0000
max_acc 0.8584 max_p 0.0000 max_r 0.0000 max_f1 0.0000

position_predict: test acc 0.9160 p 0.7089 r 0.5854 f1 0.6412
max_acc 0.9160 max_p 0.7089 max_r 0.5854 max_f1 0.6412

Average max cause: max_acc 0.8584 max_p 0.0000 max_r 0.0000 max_f1 0.0000
Average max pos: max_acc 0.9160 max_p 0.7089 max_r 0.5854 max_f1 0.6412

step 10: train loss 0.7056 
cause_predict: train acc 0.8125 p 1.0000 r 0.0270 f1 0.0526
position_predict: train acc 0.8802 p 0.6552 r 0.5938 f1 0.6230
step 20: train loss 0.5965 
cause_predict: train acc 0.8505 p 1.0000 r 0.0588 f1 0.1111
position_predict: train acc 0.8925 p 0.6786 r 0.5758 f1 0.6230
step 30: train loss 0.4809 
cause_predict: train acc 0.8603 p 1.0000 r 0.0857 f1 0.1579
position_predict: train acc 0.9258 p 0.7419 r 0.7188 f1 0.7302
step 40: train loss 0.5157 
cause_predict: train acc 0.8975 p 0.7500 r 0.3636 f1 0.4898
position_predict: train acc 0.9139 p 0.7200 r 0.5625 f1 0.6316
step 50: train loss 0.5355 
cause_predict: train acc 0.8785 p 0.6957 r 0.4571 f1 0.5517
position_predict: train acc 0.8645 p 0.5429 r 0.5938 f1 0.5672
step 60: train loss 0.5279 
cause_predict: train acc 0.8704 p 0.6000 r 0.3333 f1 0.4286
position_predict: train acc 0.9109 p 0.6923 r 0.5625 f1 0.6207
step 70: train loss 0.5280 
cause_predict: train acc 0.8872 p 0.5882 r 0.3030 f1 0.4000
position_predict: train acc 0.9248 p 0.8095 r 0.5152 f1 0.6296

epoch 1: test loss 0.4820 cost time: 12.3s

cause_predict: test acc 0.8878 p 0.6774 r 0.3975 f1 0.5010
max_acc 0.8878 max_p 0.6774 max_r 0.3975 max_f1 0.5010

position_predict: test acc 0.9191 p 0.7208 r 0.6028 f1 0.6565
max_acc 0.9191 max_p 0.7208 max_r 0.6028 max_f1 0.6565

Average max cause: max_acc 0.8878 max_p 0.6774 max_r 0.3975 max_f1 0.5010
Average max pos: max_acc 0.9191 max_p 0.7208 max_r 0.6028 max_f1 0.6565

step 10: train loss 0.5010 
cause_predict: train acc 0.8251 p 0.6667 r 0.1714 f1 0.2727
position_predict: train acc 0.9508 p 0.8966 r 0.8125 f1 0.8525
step 20: train loss 0.4208 
cause_predict: train acc 0.8850 p 0.6923 r 0.5000 f1 0.5806
position_predict: train acc 0.9425 p 0.8800 r 0.6875 f1 0.7719
step 30: train loss 0.4487 
cause_predict: train acc 0.8813 p 0.7895 r 0.4054 f1 0.5357
position_predict: train acc 0.9315 p 0.7931 r 0.7188 f1 0.7541
step 40: train loss 0.4075 
cause_predict: train acc 0.8912 p 0.6471 r 0.2683 f1 0.3793
position_predict: train acc 0.9607 p 0.8276 r 0.7500 f1 0.7869
step 50: train loss 0.3630 
cause_predict: train acc 0.9021 p 0.7143 r 0.4054 f1 0.5172
position_predict: train acc 0.9510 p 0.8214 r 0.7188 f1 0.7667
step 60: train loss 0.4408 
cause_predict: train acc 0.8898 p 0.6923 r 0.2812 f1 0.4000
position_predict: train acc 0.9184 p 0.7308 r 0.5938 f1 0.6552
step 70: train loss 0.4161 
cause_predict: train acc 0.9022 p 0.8095 r 0.4857 f1 0.6071
position_predict: train acc 0.9378 p 0.8462 r 0.6875 f1 0.7586

epoch 2: test loss 0.4734 cost time: 12.3s

cause_predict: test acc 0.8950 p 0.7228 r 0.4196 f1 0.5309
max_acc 0.8950 max_p 0.7228 max_r 0.4196 max_f1 0.5309

position_predict: test acc 0.9196 p 0.6890 r 0.6794 f1 0.6842
max_acc 0.9196 max_p 0.6890 max_r 0.6794 max_f1 0.6842

Average max cause: max_acc 0.8950 max_p 0.7228 max_r 0.4196 max_f1 0.5309
Average max pos: max_acc 0.9196 max_p 0.6890 max_r 0.6794 max_f1 0.6842

step 10: train loss 0.4477 
cause_predict: train acc 0.8967 p 0.9167 r 0.2895 f1 0.4400
position_predict: train acc 0.9262 p 0.7500 r 0.5625 f1 0.6429
step 20: train loss 0.4836 
cause_predict: train acc 0.8832 p 0.7391 r 0.4722 f1 0.5763
position_predict: train acc 0.9252 p 0.7667 r 0.7188 f1 0.7419
step 30: train loss 0.3719 
cause_predict: train acc 0.9119 p 0.7391 r 0.5000 f1 0.5965
position_predict: train acc 0.9349 p 0.7778 r 0.6562 f1 0.7119
step 40: train loss 0.4087 
cause_predict: train acc 0.8920 p 0.7000 r 0.6000 f1 0.6462
position_predict: train acc 0.9108 p 0.7241 r 0.6562 f1 0.6885
step 50: train loss 0.4033 
cause_predict: train acc 0.9208 p 0.7586 r 0.6471 f1 0.6984
position_predict: train acc 0.9333 p 0.7857 r 0.6875 f1 0.7333
step 60: train loss 0.4968 
cause_predict: train acc 0.8545 p 0.6207 r 0.4615 f1 0.5294
position_predict: train acc 0.9409 p 0.8519 r 0.7188 f1 0.7797
step 70: train loss 0.3985 
cause_predict: train acc 0.9170 p 0.9375 r 0.4286 f1 0.5882
position_predict: train acc 0.9526 p 0.8846 r 0.7188 f1 0.7931

epoch 3: test loss 0.4680 cost time: 12.4s

cause_predict: test acc 0.8887 p 0.7048 r 0.3691 f1 0.4845
max_acc 0.8950 max_p 0.7228 max_r 0.4196 max_f1 0.5309

position_predict: test acc 0.9267 p 0.7531 r 0.6376 f1 0.6906
max_acc 0.9267 max_p 0.7531 max_r 0.6376 max_f1 0.6906

Average max cause: max_acc 0.8950 max_p 0.7228 max_r 0.4196 max_f1 0.5309
Average max pos: max_acc 0.9196 max_p 0.6890 max_r 0.6794 max_f1 0.6842

step 10: train loss 0.3197 
cause_predict: train acc 0.9315 p 0.8462 r 0.6286 f1 0.7213
position_predict: train acc 0.9597 p 0.8235 r 0.8750 f1 0.8485
step 20: train loss 0.4327 
cause_predict: train acc 0.8653 p 0.7368 r 0.4000 f1 0.5185
position_predict: train acc 0.9430 p 0.9231 r 0.7273 f1 0.8136
step 30: train loss 0.3488 
cause_predict: train acc 0.9333 p 0.7241 r 0.6364 f1 0.6774
position_predict: train acc 0.9333 p 0.7097 r 0.6667 f1 0.6875
step 40: train loss 0.3463 
cause_predict: train acc 0.9076 p 0.6897 r 0.6061 f1 0.6452
position_predict: train acc 0.9370 p 0.7429 r 0.8125 f1 0.7761
step 50: train loss 0.4309 
cause_predict: train acc 0.8925 p 0.8000 r 0.5263 f1 0.6349
position_predict: train acc 0.9533 p 0.8966 r 0.7879 f1 0.8387
step 60: train loss 0.4911 
cause_predict: train acc 0.8728 p 0.7600 r 0.5429 f1 0.6333
position_predict: train acc 0.9249 p 0.8276 r 0.7500 f1 0.7869
step 70: train loss 0.3969 
cause_predict: train acc 0.8916 p 0.7083 r 0.4595 f1 0.5574
position_predict: train acc 0.9357 p 0.7500 r 0.7500 f1 0.7500

epoch 4: test loss 0.4818 cost time: 12.2s

cause_predict: test acc 0.8941 p 0.7151 r 0.4196 f1 0.5288
max_acc 0.8950 max_p 0.7228 max_r 0.4196 max_f1 0.5309

position_predict: test acc 0.9245 p 0.7077 r 0.7003 f1 0.7040
max_acc 0.9245 max_p 0.7077 max_r 0.7003 max_f1 0.7040

Average max cause: max_acc 0.8941 max_p 0.7151 max_r 0.4196 max_f1 0.5288
Average max pos: max_acc 0.9245 max_p 0.7077 max_r 0.7003 max_f1 0.7040

step 10: train loss 0.4648 
cause_predict: train acc 0.8727 p 0.6552 r 0.4419 f1 0.5278
position_predict: train acc 0.9476 p 0.7812 r 0.7812 f1 0.7812
step 20: train loss 0.2998 
cause_predict: train acc 0.9263 p 0.7308 r 0.5758 f1 0.6441
position_predict: train acc 0.9509 p 0.7812 r 0.7812 f1 0.7812
step 30: train loss 0.2798 
cause_predict: train acc 0.9388 p 0.8571 r 0.6486 f1 0.7385
position_predict: train acc 0.9460 p 0.7742 r 0.7500 f1 0.7619
step 40: train loss 0.3637 
cause_predict: train acc 0.8940 p 0.7667 r 0.5897 f1 0.6667
position_predict: train acc 0.9631 p 0.9000 r 0.8438 f1 0.8710
step 50: train loss 0.4032 
cause_predict: train acc 0.8996 p 0.6957 r 0.4324 f1 0.5333
position_predict: train acc 0.9462 p 0.8148 r 0.6875 f1 0.7458
step 60: train loss 0.3291 
cause_predict: train acc 0.9270 p 0.8636 r 0.5278 f1 0.6552
position_predict: train acc 0.9416 p 0.7931 r 0.6970 f1 0.7419
step 70: train loss 0.4334 
cause_predict: train acc 0.8797 p 0.6667 r 0.4324 f1 0.5246
position_predict: train acc 0.9419 p 0.8462 r 0.6875 f1 0.7586

epoch 5: test loss 0.4924 cost time: 12.4s

cause_predict: test acc 0.8870 p 0.6416 r 0.4574 f1 0.5341
max_acc 0.8870 max_p 0.6416 max_r 0.4574 max_f1 0.5341

position_predict: test acc 0.9231 p 0.7106 r 0.6760 f1 0.6929
max_acc 0.9245 max_p 0.7077 max_r 0.7003 max_f1 0.7040

Average max cause: max_acc 0.8941 max_p 0.7151 max_r 0.4196 max_f1 0.5288
Average max pos: max_acc 0.9245 max_p 0.7077 max_r 0.7003 max_f1 0.7040

step 10: train loss 0.2990 
cause_predict: train acc 0.9351 p 0.8929 r 0.6757 f1 0.7692
position_predict: train acc 0.9394 p 0.7812 r 0.7812 f1 0.7812
step 20: train loss 0.2670 
cause_predict: train acc 0.9454 p 0.8710 r 0.7500 f1 0.8060
position_predict: train acc 0.9454 p 0.8333 r 0.7576 f1 0.7937
step 30: train loss 0.2558 
cause_predict: train acc 0.9303 p 0.8148 r 0.6471 f1 0.7213
position_predict: train acc 0.9631 p 0.9286 r 0.7879 f1 0.8525
step 40: train loss 0.3971 
cause_predict: train acc 0.9076 p 0.7931 r 0.5897 f1 0.6765
position_predict: train acc 0.9454 p 0.8276 r 0.7500 f1 0.7869
step 50: train loss 0.3326 
cause_predict: train acc 0.8548 p 0.6552 r 0.5278 f1 0.5846
position_predict: train acc 0.9785 p 0.9667 r 0.9062 f1 0.9355
step 60: train loss 0.2330 
cause_predict: train acc 0.9350 p 0.7632 r 0.8788 f1 0.8169
position_predict: train acc 0.9750 p 0.9355 r 0.9062 f1 0.9206
step 70: train loss 0.2926 
cause_predict: train acc 0.9390 p 0.8065 r 0.7353 f1 0.7692
position_predict: train acc 0.9472 p 0.7941 r 0.8182 f1 0.8060

epoch 6: test loss 0.5477 cost time: 12.3s

cause_predict: test acc 0.8852 p 0.6172 r 0.4984 f1 0.5515
max_acc 0.8852 max_p 0.6172 max_r 0.4984 max_f1 0.5515

position_predict: test acc 0.9205 p 0.6873 r 0.6969 f1 0.6920
max_acc 0.9245 max_p 0.7077 max_r 0.7003 max_f1 0.7040

Average max cause: max_acc 0.8852 max_p 0.6172 max_r 0.4984 max_f1 0.5515
Average max pos: max_acc 0.9205 max_p 0.6873 max_r 0.6969 max_f1 0.6920

step 10: train loss 0.2446 
cause_predict: train acc 0.9358 p 0.8485 r 0.7568 f1 0.8000
position_predict: train acc 0.9679 p 0.8788 r 0.9062 f1 0.8923
step 20: train loss 0.1485 
cause_predict: train acc 0.9662 p 0.9688 r 0.7949 f1 0.8732
position_predict: train acc 0.9774 p 0.8824 r 0.9375 f1 0.9091
step 30: train loss 0.1751 
cause_predict: train acc 0.9600 p 0.9643 r 0.7297 f1 0.8308
position_predict: train acc 0.9745 p 0.9032 r 0.8750 f1 0.8889
step 40: train loss 0.2378 
cause_predict: train acc 0.9547 p 0.8929 r 0.7576 f1 0.8197
position_predict: train acc 0.9588 p 0.8929 r 0.7812 f1 0.8333
step 50: train loss 0.2807 
cause_predict: train acc 0.9538 p 0.8485 r 0.8235 f1 0.8358
position_predict: train acc 0.9538 p 0.8621 r 0.7812 f1 0.8197
step 60: train loss 0.2986 
cause_predict: train acc 0.9163 p 0.7143 r 0.7143 f1 0.7143
position_predict: train acc 0.9289 p 0.7419 r 0.7188 f1 0.7302
step 70: train loss 0.3178 
cause_predict: train acc 0.9455 p 0.9355 r 0.7632 f1 0.8406
position_predict: train acc 0.9356 p 0.7941 r 0.8182 f1 0.8060

epoch 7: test loss 0.5646 cost time: 12.7s

cause_predict: test acc 0.8865 p 0.6207 r 0.5110 f1 0.5606
max_acc 0.8865 max_p 0.6207 max_r 0.5110 max_f1 0.5606

position_predict: test acc 0.9173 p 0.6977 r 0.6272 f1 0.6606
max_acc 0.9245 max_p 0.7077 max_r 0.7003 max_f1 0.7040

Average max cause: max_acc 0.8852 max_p 0.6172 max_r 0.4984 max_f1 0.5515
Average max pos: max_acc 0.9205 max_p 0.6873 max_r 0.6969 max_f1 0.6920

step 10: train loss 0.2892 
cause_predict: train acc 0.9487 p 0.9259 r 0.7143 f1 0.8065
position_predict: train acc 0.9530 p 0.8286 r 0.8529 f1 0.8406
step 20: train loss 0.1690 
cause_predict: train acc 0.9755 p 0.9375 r 0.8571 f1 0.8955
position_predict: train acc 0.9650 p 0.8667 r 0.8125 f1 0.8387
step 30: train loss 0.2209 
cause_predict: train acc 0.9593 p 0.8824 r 0.8333 f1 0.8571
position_predict: train acc 0.9512 p 0.8125 r 0.8125 f1 0.8125
step 40: train loss 0.2116 
cause_predict: train acc 0.9557 p 0.8788 r 0.8529 f1 0.8657
position_predict: train acc 0.9606 p 0.9032 r 0.8485 f1 0.8750
step 50: train loss 0.1745 
cause_predict: train acc 0.9631 p 0.9062 r 0.8056 f1 0.8529
position_predict: train acc 0.9668 p 0.8485 r 0.8750 f1 0.8615
step 60: train loss 0.2505 
cause_predict: train acc 0.9307 p 0.7222 r 0.7429 f1 0.7324
position_predict: train acc 0.9562 p 0.8125 r 0.8125 f1 0.8125
step 70: train loss 0.2857 
cause_predict: train acc 0.9316 p 0.8000 r 0.7179 f1 0.7568
position_predict: train acc 0.9392 p 0.8214 r 0.6765 f1 0.7419

epoch 8: test loss 0.5833 cost time: 12.5s

cause_predict: test acc 0.8870 p 0.6081 r 0.5678 f1 0.5873
max_acc 0.8870 max_p 0.6081 max_r 0.5678 max_f1 0.5873

position_predict: test acc 0.9142 p 0.6578 r 0.6899 f1 0.6735
max_acc 0.9245 max_p 0.7077 max_r 0.7003 max_f1 0.7040

Average max cause: max_acc 0.8870 max_p 0.6081 max_r 0.5678 max_f1 0.5873
Average max pos: max_acc 0.9142 max_p 0.6578 max_r 0.6899 max_f1 0.6735

step 10: train loss 0.2888 
cause_predict: train acc 0.9469 p 0.8571 r 0.7895 f1 0.8219
position_predict: train acc 0.9347 p 0.7742 r 0.7273 f1 0.7500
step 20: train loss 0.1786 
cause_predict: train acc 0.9624 p 0.8387 r 0.7879 f1 0.8125
position_predict: train acc 0.9655 p 0.8056 r 0.8788 f1 0.8406
step 30: train loss 0.1509 
cause_predict: train acc 0.9589 p 0.8750 r 0.8974 f1 0.8861
position_predict: train acc 0.9772 p 0.9091 r 0.9375 f1 0.9231
step 40: train loss 0.1943 
cause_predict: train acc 0.9567 p 0.8710 r 0.7941 f1 0.8308
position_predict: train acc 0.9646 p 0.8788 r 0.8529 f1 0.8657
step 50: train loss 0.1230 
cause_predict: train acc 0.9686 p 0.9375 r 0.8333 f1 0.8824
position_predict: train acc 0.9843 p 0.9375 r 0.9375 f1 0.9375
step 60: train loss 0.1875 
cause_predict: train acc 0.9673 p 0.8718 r 0.8947 f1 0.8831
position_predict: train acc 0.9636 p 0.8235 r 0.8750 f1 0.8485
step 70: train loss 0.2660 
cause_predict: train acc 0.9489 p 0.9394 r 0.8158 f1 0.8732
position_predict: train acc 0.9432 p 0.8438 r 0.8438 f1 0.8438

epoch 9: test loss 0.6241 cost time: 12.3s

cause_predict: test acc 0.8874 p 0.6182 r 0.5363 f1 0.5743
max_acc 0.8870 max_p 0.6081 max_r 0.5678 max_f1 0.5873

position_predict: test acc 0.9147 p 0.6818 r 0.6272 f1 0.6534
max_acc 0.9245 max_p 0.7077 max_r 0.7003 max_f1 0.7040

Average max cause: max_acc 0.8870 max_p 0.6081 max_r 0.5678 max_f1 0.5873
Average max pos: max_acc 0.9142 max_p 0.6578 max_r 0.6899 max_f1 0.6735

step 10: train loss 0.0722 
cause_predict: train acc 0.9942 p 1.0000 r 0.9697 f1 0.9846
position_predict: train acc 0.9942 p 0.9697 r 1.0000 f1 0.9846
step 20: train loss 0.1611 
cause_predict: train acc 0.9583 p 0.9667 r 0.7838 f1 0.8657
position_predict: train acc 0.9676 p 0.8824 r 0.9091 f1 0.8955
step 30: train loss 0.1122 
cause_predict: train acc 0.9631 p 0.8140 r 0.9722 f1 0.8861
position_predict: train acc 0.9877 p 0.9394 r 0.9688 f1 0.9538
step 40: train loss 0.2232 
cause_predict: train acc 0.9531 p 0.8286 r 0.8056 f1 0.8169
position_predict: train acc 0.9603 p 0.8387 r 0.8125 f1 0.8254
step 50: train loss 0.1816 
cause_predict: train acc 0.9436 p 0.9032 r 0.7778 f1 0.8358
position_predict: train acc 0.9846 p 0.9412 r 0.9697 f1 0.9552
step 60: train loss 0.2056 
cause_predict: train acc 0.9570 p 0.8621 r 0.7576 f1 0.8065
position_predict: train acc 0.9713 p 0.8750 r 0.8750 f1 0.8750
step 70: train loss 0.1511 
cause_predict: train acc 0.9733 p 0.8611 r 0.9394 f1 0.8986
position_predict: train acc 0.9695 p 0.8750 r 0.8750 f1 0.8750

epoch 10: test loss 0.6189 cost time: 12.3s

cause_predict: test acc 0.8843 p 0.6036 r 0.5331 f1 0.5662
max_acc 0.8870 max_p 0.6081 max_r 0.5678 max_f1 0.5873

position_predict: test acc 0.9124 p 0.6679 r 0.6307 f1 0.6487
max_acc 0.9245 max_p 0.7077 max_r 0.7003 max_f1 0.7040

Average max cause: max_acc 0.8870 max_p 0.6081 max_r 0.5678 max_f1 0.5873
Average max pos: max_acc 0.9142 max_p 0.6578 max_r 0.6899 max_f1 0.6735

step 10: train loss 0.0843 
cause_predict: train acc 0.9813 p 0.9375 r 0.9091 f1 0.9231
position_predict: train acc 0.9888 p 0.9688 r 0.9394 f1 0.9538
step 20: train loss 0.1613 
cause_predict: train acc 0.9753 p 0.9394 r 0.8857 f1 0.9118
position_predict: train acc 0.9465 p 0.7941 r 0.8182 f1 0.8060
step 30: train loss 0.0891 
cause_predict: train acc 0.9796 p 0.9167 r 0.9167 f1 0.9167
position_predict: train acc 0.9796 p 0.9062 r 0.9062 f1 0.9062
step 40: train loss 0.1049 
cause_predict: train acc 0.9776 p 0.8649 r 0.9412 f1 0.9014
position_predict: train acc 0.9840 p 0.9375 r 0.9091 f1 0.9231
step 50: train loss 0.1788 
cause_predict: train acc 0.9819 p 0.9444 r 0.9189 f1 0.9315
position_predict: train acc 0.9638 p 0.8235 r 0.8750 f1 0.8485
step 60: train loss 0.1927 
cause_predict: train acc 0.9578 p 0.8250 r 0.8462 f1 0.8354
position_predict: train acc 0.9740 p 0.8750 r 0.8750 f1 0.8750
step 70: train loss 0.1016 
cause_predict: train acc 0.9787 p 0.9677 r 0.8824 f1 0.9231
position_predict: train acc 0.9830 p 0.9667 r 0.9062 f1 0.9355

epoch 11: test loss 0.6616 cost time: 12.3s

cause_predict: test acc 0.8861 p 0.6115 r 0.5363 f1 0.5714
max_acc 0.8870 max_p 0.6081 max_r 0.5678 max_f1 0.5873

position_predict: test acc 0.9160 p 0.6911 r 0.6237 f1 0.6557
max_acc 0.9245 max_p 0.7077 max_r 0.7003 max_f1 0.7040

Average max cause: max_acc 0.8870 max_p 0.6081 max_r 0.5678 max_f1 0.5873
Average max pos: max_acc 0.9142 max_p 0.6578 max_r 0.6899 max_f1 0.6735

step 10: train loss 0.1652 
cause_predict: train acc 0.9824 p 0.9412 r 0.9412 f1 0.9412
position_predict: train acc 0.9515 p 0.8387 r 0.8125 f1 0.8254
step 20: train loss 0.1096 
cause_predict: train acc 0.9676 p 0.8889 r 0.8889 f1 0.8889
position_predict: train acc 0.9757 p 0.9091 r 0.9091 f1 0.9091
step 30: train loss 0.1370 
cause_predict: train acc 0.9656 p 0.9394 r 0.8158 f1 0.8732
position_predict: train acc 0.9771 p 0.9643 r 0.8438 f1 0.9000
step 40: train loss 0.1033 
cause_predict: train acc 0.9783 p 0.9118 r 0.9118 f1 0.9118
position_predict: train acc 0.9747 p 0.9091 r 0.8824 f1 0.8955
step 50: train loss 0.1480 
cause_predict: train acc 0.9790 p 0.9375 r 0.8824 f1 0.9091
position_predict: train acc 0.9545 p 0.8065 r 0.7812 f1 0.7937
step 60: train loss 0.1320 
cause_predict: train acc 0.9828 p 0.9412 r 0.9412 f1 0.9412
position_predict: train acc 0.9655 p 0.8529 r 0.9062 f1 0.8788
step 70: train loss 0.1401 
cause_predict: train acc 0.9644 p 0.9118 r 0.8611 f1 0.8857
position_predict: train acc 0.9689 p 0.9333 r 0.8485 f1 0.8889

epoch 12: test loss 0.7569 cost time: 12.2s

cause_predict: test acc 0.8677 p 0.5358 r 0.4953 f1 0.5148
max_acc 0.8870 max_p 0.6081 max_r 0.5678 max_f1 0.5873

position_predict: test acc 0.9138 p 0.6610 r 0.6725 f1 0.6667
max_acc 0.9245 max_p 0.7077 max_r 0.7003 max_f1 0.7040

Average max cause: max_acc 0.8870 max_p 0.6081 max_r 0.5678 max_f1 0.5873
Average max pos: max_acc 0.9142 max_p 0.6578 max_r 0.6899 max_f1 0.6735

step 10: train loss 0.1731 
cause_predict: train acc 0.9792 p 0.9412 r 0.9143 f1 0.9275
position_predict: train acc 0.9583 p 0.8235 r 0.8750 f1 0.8485
step 20: train loss 0.1046 
cause_predict: train acc 0.9747 p 0.8889 r 0.9412 f1 0.9143
position_predict: train acc 0.9873 p 0.9394 r 0.9688 f1 0.9538
step 30: train loss 0.1051 
cause_predict: train acc 0.9795 p 0.9714 r 0.8947 f1 0.9315
position_predict: train acc 0.9795 p 0.8857 r 0.9688 f1 0.9254
step 40: train loss 0.1485 
cause_predict: train acc 0.9713 p 0.8824 r 0.9091 f1 0.8955
position_predict: train acc 0.9795 p 0.9091 r 0.9375 f1 0.9231
step 50: train loss 0.1712 
cause_predict: train acc 0.9731 p 0.9091 r 0.8824 f1 0.8955
position_predict: train acc 0.9615 p 0.8710 r 0.8182 f1 0.8438
step 60: train loss 0.1329 
cause_predict: train acc 0.9835 p 0.9444 r 0.9444 f1 0.9444
position_predict: train acc 0.9587 p 0.8710 r 0.8182 f1 0.8438
step 70: train loss 0.2033 
cause_predict: train acc 0.9587 p 0.8158 r 0.9118 f1 0.8611
position_predict: train acc 0.9421 p 0.7879 r 0.7879 f1 0.7879

epoch 13: test loss 0.7357 cost time: 12.0s

cause_predict: test acc 0.8838 p 0.6022 r 0.5300 f1 0.5638
max_acc 0.8870 max_p 0.6081 max_r 0.5678 max_f1 0.5873

position_predict: test acc 0.9173 p 0.6992 r 0.6237 f1 0.6593
max_acc 0.9245 max_p 0.7077 max_r 0.7003 max_f1 0.7040

Average max cause: max_acc 0.8870 max_p 0.6081 max_r 0.5678 max_f1 0.5873
Average max pos: max_acc 0.9142 max_p 0.6578 max_r 0.6899 max_f1 0.6735

step 10: train loss 0.0920 
cause_predict: train acc 0.9815 p 0.9737 r 0.9024 f1 0.9367
position_predict: train acc 0.9852 p 0.9143 r 0.9697 f1 0.9412
step 20: train loss 0.1012 
cause_predict: train acc 0.9749 p 0.8649 r 0.9697 f1 0.9143
position_predict: train acc 0.9916 p 0.9412 r 1.0000 f1 0.9697
step 30: train loss 0.1511 
cause_predict: train acc 0.9657 p 0.9429 r 0.8919 f1 0.9167
position_predict: train acc 0.9600 p 0.8611 r 0.9394 f1 0.8986
step 40: train loss 0.0865 
cause_predict: train acc 0.9828 p 0.9545 r 0.9333 f1 0.9438
position_predict: train acc 0.9828 p 0.9655 r 0.8750 f1 0.9180
step 50: train loss 0.0677 
cause_predict: train acc 0.9913 p 1.0000 r 0.9474 f1 0.9730
position_predict: train acc 0.9956 p 0.9697 r 1.0000 f1 0.9846
step 60: train loss 0.2273 
cause_predict: train acc 0.9602 p 0.8462 r 0.9429 f1 0.8919
position_predict: train acc 0.9502 p 0.8667 r 0.8125 f1 0.8387
step 70: train loss 0.2295 
cause_predict: train acc 0.9585 p 0.8824 r 0.8571 f1 0.8696
position_predict: train acc 0.9493 p 0.8387 r 0.8125 f1 0.8254

epoch 14: test loss 0.7413 cost time: 12.6s

cause_predict: test acc 0.8847 p 0.6081 r 0.5237 f1 0.5627
max_acc 0.8870 max_p 0.6081 max_r 0.5678 max_f1 0.5873

position_predict: test acc 0.9124 p 0.6608 r 0.6516 f1 0.6561
max_acc 0.9245 max_p 0.7077 max_r 0.7003 max_f1 0.7040

Average max cause: max_acc 0.8870 max_p 0.6081 max_r 0.5678 max_f1 0.5873
Average max pos: max_acc 0.9142 max_p 0.6578 max_r 0.6899 max_f1 0.6735

write pair_data/Ind_BiLSTM_1/fold_6_test.txt done
write pair_data/Ind_BiLSTM_1/fold_6_train.txt done
Optimization Finished!

############# fold 6 end ###############
############# fold 7 begin ###############
load data_file: data_combine_en/fold_7_train.txt
y_position.shape (2275, 75, 2)
y_cause.shape (2275, 75, 2)
x.shape (2275, 75, 30)
sen_len.shape (2275, 75)
doc_len.shape (2275,)
n_cut 107
load data done!

load data_file: data_combine_en/fold_7_test.txt
y_position.shape (284, 75, 2)
y_cause.shape (284, 75, 2)
x.shape (284, 75, 30)
sen_len.shape (284, 75)
doc_len.shape (284,)
n_cut 22
load data done!

train docs: 2275    test docs: 284
step 10: train loss 0.8039 
cause_predict: train acc 0.8601 p 0.0000 r 0.0000 f1 0.0000
position_predict: train acc 0.8683 p 0.0000 r 0.0000 f1 0.0000
step 20: train loss 0.6821 
cause_predict: train acc 0.8611 p 0.0000 r 0.0000 f1 0.0000
position_predict: train acc 0.8730 p 0.0000 r 0.0000 f1 0.0000
step 30: train loss 0.5583 
cause_predict: train acc 0.8797 p 0.0000 r 0.0000 f1 0.0000
position_predict: train acc 0.8935 p 1.0000 r 0.0312 f1 0.0606
step 40: train loss 0.5102 
cause_predict: train acc 0.8689 p 0.0000 r 0.0000 f1 0.0000
position_predict: train acc 0.9288 p 0.8824 r 0.4688 f1 0.6122
step 50: train loss 0.6395 
cause_predict: train acc 0.8356 p 1.0000 r 0.0270 f1 0.0526
position_predict: train acc 0.8721 p 0.5833 r 0.4375 f1 0.5000
step 60: train loss 0.6392 
cause_predict: train acc 0.8369 p 0.3333 r 0.0270 f1 0.0500
position_predict: train acc 0.8970 p 0.7222 r 0.4062 f1 0.5200
step 70: train loss 0.5408 
cause_predict: train acc 0.8843 p 0.7143 r 0.1471 f1 0.2439
position_predict: train acc 0.9067 p 0.6296 r 0.5312 f1 0.5763

epoch 0: test loss 0.5133 cost time: 12.7s

cause_predict: test acc 0.8803 p 0.8025 r 0.2050 f1 0.3266
max_acc 0.8803 max_p 0.8025 max_r 0.2050 max_f1 0.3266

position_predict: test acc 0.9133 p 0.6598 r 0.6690 f1 0.6644
max_acc 0.9133 max_p 0.6598 max_r 0.6690 max_f1 0.6644

Average max cause: max_acc 0.8803 max_p 0.8025 max_r 0.2050 max_f1 0.3266
Average max pos: max_acc 0.9133 max_p 0.6598 max_r 0.6690 max_f1 0.6644

step 10: train loss 0.5221 
cause_predict: train acc 0.8863 p 0.8000 r 0.1081 f1 0.1905
position_predict: train acc 0.9097 p 0.5862 r 0.5312 f1 0.5574
step 20: train loss 0.5983 
cause_predict: train acc 0.8418 p 0.5789 r 0.6471 f1 0.6111
position_predict: train acc 0.8983 p 0.7931 r 0.6571 f1 0.7188
step 30: train loss 0.5147 
cause_predict: train acc 0.8667 p 0.6667 r 0.1176 f1 0.2000
position_predict: train acc 0.9250 p 0.7333 r 0.6875 f1 0.7097
step 40: train loss 0.4809 
cause_predict: train acc 0.8956 p 0.7857 r 0.3235 f1 0.4583
position_predict: train acc 0.9116 p 0.7037 r 0.5758 f1 0.6333
step 50: train loss 0.6681 
cause_predict: train acc 0.8545 p 0.6000 r 0.4054 f1 0.4839
position_predict: train acc 0.9136 p 0.7097 r 0.6875 f1 0.6984
step 60: train loss 0.4930 
cause_predict: train acc 0.8589 p 0.5714 r 0.2162 f1 0.3137
position_predict: train acc 0.9073 p 0.6667 r 0.5625 f1 0.6102
step 70: train loss 0.5575 
cause_predict: train acc 0.8458 p 0.6500 r 0.3333 f1 0.4407
position_predict: train acc 0.9346 p 0.8065 r 0.7576 f1 0.7812

epoch 1: test loss 0.4854 cost time: 12.2s

cause_predict: test acc 0.8820 p 0.6345 r 0.3943 f1 0.4864
max_acc 0.8820 max_p 0.6345 max_r 0.3943 max_f1 0.4864

position_predict: test acc 0.9267 p 0.7490 r 0.6446 f1 0.6929
max_acc 0.9267 max_p 0.7490 max_r 0.6446 max_f1 0.6929

Average max cause: max_acc 0.8820 max_p 0.6345 max_r 0.3943 max_f1 0.4864
Average max pos: max_acc 0.9267 max_p 0.7490 max_r 0.6446 max_f1 0.6929

step 10: train loss 0.3297 
cause_predict: train acc 0.9007 p 0.5909 r 0.3939 f1 0.4727
position_predict: train acc 0.9521 p 0.8125 r 0.7647 f1 0.7879
step 20: train loss 0.5292 
cause_predict: train acc 0.8796 p 0.7647 r 0.3714 f1 0.5000
position_predict: train acc 0.8981 p 0.6667 r 0.6250 f1 0.6452
step 30: train loss 0.5364 
cause_predict: train acc 0.8276 p 0.5217 r 0.3333 f1 0.4068
position_predict: train acc 0.9212 p 0.7931 r 0.6970 f1 0.7419
step 40: train loss 0.6261 
cause_predict: train acc 0.8095 p 0.6364 r 0.1795 f1 0.2800
position_predict: train acc 0.9259 p 0.8276 r 0.7273 f1 0.7742
step 50: train loss 0.4104 
cause_predict: train acc 0.9084 p 0.8636 r 0.4750 f1 0.6129
position_predict: train acc 0.9389 p 0.8636 r 0.5938 f1 0.7037
step 60: train loss 0.5415 
cause_predict: train acc 0.8649 p 0.6000 r 0.1622 f1 0.2553
position_predict: train acc 0.9112 p 0.6286 r 0.6875 f1 0.6567
step 70: train loss 0.4385 
cause_predict: train acc 0.9098 p 0.8000 r 0.4706 f1 0.5926
position_predict: train acc 0.9344 p 0.7857 r 0.6875 f1 0.7333

epoch 2: test loss 0.4763 cost time: 12.9s

cause_predict: test acc 0.8887 p 0.6349 r 0.5047 f1 0.5624
max_acc 0.8887 max_p 0.6349 max_r 0.5047 max_f1 0.5624

position_predict: test acc 0.9245 p 0.7438 r 0.6272 f1 0.6805
max_acc 0.9267 max_p 0.7490 max_r 0.6446 max_f1 0.6929

Average max cause: max_acc 0.8887 max_p 0.6349 max_r 0.5047 max_f1 0.5624
Average max pos: max_acc 0.9245 max_p 0.7438 max_r 0.6272 max_f1 0.6805

step 10: train loss 0.4448 
cause_predict: train acc 0.8785 p 0.7500 r 0.4167 f1 0.5357
position_predict: train acc 0.9206 p 0.7778 r 0.6562 f1 0.7119
step 20: train loss 0.3149 
cause_predict: train acc 0.9213 p 0.7619 r 0.4571 f1 0.5714
position_predict: train acc 0.9475 p 0.7857 r 0.6875 f1 0.7333
step 30: train loss 0.4842 
cause_predict: train acc 0.8767 p 0.8889 r 0.2286 f1 0.3636
position_predict: train acc 0.9207 p 0.7917 r 0.5938 f1 0.6786
step 40: train loss 0.5696 
cause_predict: train acc 0.8505 p 0.6923 r 0.2647 f1 0.3830
position_predict: train acc 0.9072 p 0.7333 r 0.6875 f1 0.7097
step 50: train loss 0.3850 
cause_predict: train acc 0.9100 p 0.6957 r 0.4571 f1 0.5517
position_predict: train acc 0.9446 p 0.7500 r 0.7500 f1 0.7500
step 60: train loss 0.4159 
cause_predict: train acc 0.8735 p 0.6667 r 0.3590 f1 0.4667
position_predict: train acc 0.9684 p 0.9000 r 0.8438 f1 0.8710
step 70: train loss 0.4543 
cause_predict: train acc 0.8846 p 0.7619 r 0.4571 f1 0.5714
position_predict: train acc 0.9183 p 0.7778 r 0.6562 f1 0.7119

epoch 3: test loss 0.4676 cost time: 13.1s

cause_predict: test acc 0.8937 p 0.7257 r 0.4006 f1 0.5163
max_acc 0.8887 max_p 0.6349 max_r 0.5047 max_f1 0.5624

position_predict: test acc 0.9209 p 0.7311 r 0.6063 f1 0.6629
max_acc 0.9267 max_p 0.7490 max_r 0.6446 max_f1 0.6929

Average max cause: max_acc 0.8887 max_p 0.6349 max_r 0.5047 max_f1 0.5624
Average max pos: max_acc 0.9245 max_p 0.7438 max_r 0.6272 max_f1 0.6805

step 10: train loss 0.3163 
cause_predict: train acc 0.9174 p 0.7241 r 0.6562 f1 0.6885
position_predict: train acc 0.9435 p 0.8276 r 0.7500 f1 0.7869
step 20: train loss 0.3969 
cause_predict: train acc 0.9031 p 0.7778 r 0.5676 f1 0.6562
position_predict: train acc 0.9295 p 0.7105 r 0.8438 f1 0.7714
step 30: train loss 0.4265 
cause_predict: train acc 0.8760 p 0.8333 r 0.3488 f1 0.4918
position_predict: train acc 0.9440 p 0.7647 r 0.8125 f1 0.7879
step 40: train loss 0.3602 
cause_predict: train acc 0.9158 p 0.8000 r 0.5263 f1 0.6349
position_predict: train acc 0.9377 p 0.7857 r 0.6667 f1 0.7213
step 50: train loss 0.3648 
cause_predict: train acc 0.9046 p 0.8095 r 0.4722 f1 0.5965
position_predict: train acc 0.9212 p 0.7097 r 0.6875 f1 0.6984
step 60: train loss 0.3364 
cause_predict: train acc 0.9289 p 0.8214 r 0.6389 f1 0.7187
position_predict: train acc 0.9565 p 0.8182 r 0.8438 f1 0.8308
step 70: train loss 0.3196 
cause_predict: train acc 0.9273 p 0.7586 r 0.6286 f1 0.6875
position_predict: train acc 0.9527 p 0.8276 r 0.7500 f1 0.7869

epoch 4: test loss 0.4782 cost time: 13.7s

cause_predict: test acc 0.8905 p 0.7093 r 0.3849 f1 0.4990
max_acc 0.8887 max_p 0.6349 max_r 0.5047 max_f1 0.5624

position_predict: test acc 0.9249 p 0.7196 r 0.6794 f1 0.6989
max_acc 0.9249 max_p 0.7196 max_r 0.6794 max_f1 0.6989

Average max cause: max_acc 0.8887 max_p 0.6349 max_r 0.5047 max_f1 0.5624
Average max pos: max_acc 0.9245 max_p 0.7438 max_r 0.6272 max_f1 0.6805

step 10: train loss 0.2954 
cause_predict: train acc 0.9129 p 0.7241 r 0.5526 f1 0.6269
position_predict: train acc 0.9547 p 0.7941 r 0.8182 f1 0.8060
step 20: train loss 0.2884 
cause_predict: train acc 0.9127 p 0.7143 r 0.7143 f1 0.7143
position_predict: train acc 0.9607 p 0.8966 r 0.8125 f1 0.8525
step 30: train loss 0.2002 
cause_predict: train acc 0.9412 p 0.7667 r 0.6765 f1 0.7188
position_predict: train acc 0.9771 p 0.9062 r 0.8788 f1 0.8923
step 40: train loss 0.4398 
cause_predict: train acc 0.9181 p 0.8000 r 0.7500 f1 0.7742
position_predict: train acc 0.9006 p 0.7667 r 0.6970 f1 0.7302
step 50: train loss 0.3586 
cause_predict: train acc 0.9026 p 0.6765 r 0.6053 f1 0.6389
position_predict: train acc 0.9288 p 0.7333 r 0.6667 f1 0.6984
step 60: train loss 0.3198 
cause_predict: train acc 0.9189 p 0.8065 r 0.6757 f1 0.7353
position_predict: train acc 0.9459 p 0.8125 r 0.8125 f1 0.8125
step 70: train loss 0.4391 
cause_predict: train acc 0.8828 p 0.6071 r 0.4722 f1 0.5312
position_predict: train acc 0.9062 p 0.6333 r 0.5938 f1 0.6129

epoch 5: test loss 0.4880 cost time: 13.5s

cause_predict: test acc 0.8959 p 0.6842 r 0.4921 f1 0.5725
max_acc 0.8959 max_p 0.6842 max_r 0.4921 max_f1 0.5725

position_predict: test acc 0.9218 p 0.7029 r 0.6760 f1 0.6892
max_acc 0.9249 max_p 0.7196 max_r 0.6794 max_f1 0.6989

Average max cause: max_acc 0.8959 max_p 0.6842 max_r 0.4921 max_f1 0.5725
Average max pos: max_acc 0.9218 max_p 0.7029 max_r 0.6760 max_f1 0.6892

step 10: train loss 0.2633 
cause_predict: train acc 0.9075 p 0.6667 r 0.7273 f1 0.6957
position_predict: train acc 0.9824 p 0.9394 r 0.9394 f1 0.9394
step 20: train loss 0.3190 
cause_predict: train acc 0.9079 p 0.7333 r 0.6286 f1 0.6769
position_predict: train acc 0.9518 p 0.8667 r 0.7879 f1 0.8254
step 30: train loss 0.2976 
cause_predict: train acc 0.9312 p 0.7436 r 0.8056 f1 0.7733
position_predict: train acc 0.9595 p 0.8485 r 0.8485 f1 0.8485
step 40: train loss 0.2472 
cause_predict: train acc 0.9283 p 0.7500 r 0.7059 f1 0.7273
position_predict: train acc 0.9442 p 0.7500 r 0.8438 f1 0.7941
step 50: train loss 0.2069 
cause_predict: train acc 0.9524 p 0.8710 r 0.7714 f1 0.8182
position_predict: train acc 0.9960 p 1.0000 r 0.9688 f1 0.9841
step 60: train loss 0.2812 
cause_predict: train acc 0.9658 p 0.9310 r 0.7714 f1 0.8438
position_predict: train acc 0.9418 p 0.7586 r 0.6875 f1 0.7213
step 70: train loss 0.3795 
cause_predict: train acc 0.9145 p 0.7667 r 0.6389 f1 0.6970
position_predict: train acc 0.9231 p 0.7059 r 0.7500 f1 0.7273

epoch 6: test loss 0.5286 cost time: 13.5s

cause_predict: test acc 0.8901 p 0.6437 r 0.5016 f1 0.5638
max_acc 0.8959 max_p 0.6842 max_r 0.4921 max_f1 0.5725

position_predict: test acc 0.9160 p 0.6749 r 0.6655 f1 0.6702
max_acc 0.9249 max_p 0.7196 max_r 0.6794 max_f1 0.6989

Average max cause: max_acc 0.8959 max_p 0.6842 max_r 0.4921 max_f1 0.5725
Average max pos: max_acc 0.9218 max_p 0.7029 max_r 0.6760 max_f1 0.6892

step 10: train loss 0.2360 
cause_predict: train acc 0.9416 p 0.7941 r 0.7297 f1 0.7606
position_predict: train acc 0.9656 p 0.8438 r 0.8438 f1 0.8438
step 20: train loss 0.3779 
cause_predict: train acc 0.8914 p 0.7188 r 0.6053 f1 0.6571
position_predict: train acc 0.9548 p 0.8667 r 0.8125 f1 0.8387
step 30: train loss 0.3276 
cause_predict: train acc 0.9186 p 0.8108 r 0.8108 f1 0.8108
position_predict: train acc 0.9419 p 0.8710 r 0.8182 f1 0.8438
step 40: train loss 0.2849 
cause_predict: train acc 0.9361 p 0.7647 r 0.7429 f1 0.7536
position_predict: train acc 0.9436 p 0.7647 r 0.7879 f1 0.7761
step 50: train loss 0.3185 
cause_predict: train acc 0.9148 p 0.7586 r 0.6471 f1 0.6984
position_predict: train acc 0.9552 p 0.8710 r 0.8182 f1 0.8438
step 60: train loss 0.3351 
cause_predict: train acc 0.9184 p 0.7714 r 0.6923 f1 0.7297
position_predict: train acc 0.9592 p 0.8929 r 0.7812 f1 0.8333
step 70: train loss 0.2181 
cause_predict: train acc 0.9598 p 0.8788 r 0.8529 f1 0.8657
position_predict: train acc 0.9688 p 0.8788 r 0.9062 f1 0.8923

epoch 7: test loss 0.5764 cost time: 12.4s

cause_predict: test acc 0.8928 p 0.6390 r 0.5584 f1 0.5960
max_acc 0.8928 max_p 0.6390 max_r 0.5584 max_f1 0.5960

position_predict: test acc 0.9133 p 0.6667 r 0.6481 f1 0.6572
max_acc 0.9249 max_p 0.7196 max_r 0.6794 max_f1 0.6989

Average max cause: max_acc 0.8959 max_p 0.6842 max_r 0.4921 max_f1 0.5725
Average max pos: max_acc 0.9218 max_p 0.7029 max_r 0.6760 max_f1 0.6892

step 10: train loss 0.2437 
cause_predict: train acc 0.9416 p 0.8276 r 0.6486 f1 0.7273
position_predict: train acc 0.9675 p 0.8710 r 0.8182 f1 0.8438
step 20: train loss 0.1804 
cause_predict: train acc 0.9602 p 0.8378 r 0.9118 f1 0.8732
position_predict: train acc 0.9690 p 0.9032 r 0.8750 f1 0.8889
step 30: train loss 0.1910 
cause_predict: train acc 0.9651 p 0.9143 r 0.8421 f1 0.8767
position_predict: train acc 0.9612 p 0.8235 r 0.8750 f1 0.8485
step 40: train loss 0.1509 
cause_predict: train acc 0.9653 p 0.9118 r 0.8378 f1 0.8732
position_predict: train acc 0.9807 p 0.9091 r 0.9375 f1 0.9231
step 50: train loss 0.2753 
cause_predict: train acc 0.9372 p 0.8235 r 0.7778 f1 0.8000
position_predict: train acc 0.9596 p 0.8710 r 0.8438 f1 0.8571
step 60: train loss 0.2699 
cause_predict: train acc 0.9488 p 0.8333 r 0.8108 f1 0.8219
position_predict: train acc 0.9252 p 0.6857 r 0.7500 f1 0.7164
step 70: train loss 0.2175 
cause_predict: train acc 0.9444 p 0.8235 r 0.7568 f1 0.7887
position_predict: train acc 0.9704 p 0.9032 r 0.8485 f1 0.8750

epoch 8: test loss 0.5720 cost time: 12.9s

cause_predict: test acc 0.8887 p 0.6339 r 0.5079 f1 0.5639
max_acc 0.8928 max_p 0.6390 max_r 0.5584 max_f1 0.5960

position_predict: test acc 0.9173 p 0.6771 r 0.6794 f1 0.6783
max_acc 0.9249 max_p 0.7196 max_r 0.6794 max_f1 0.6989

Average max cause: max_acc 0.8959 max_p 0.6842 max_r 0.4921 max_f1 0.5725
Average max pos: max_acc 0.9218 max_p 0.7029 max_r 0.6760 max_f1 0.6892

step 10: train loss 0.1775 
cause_predict: train acc 0.9655 p 0.8824 r 0.8824 f1 0.8824
position_predict: train acc 0.9698 p 0.9062 r 0.8788 f1 0.8923
step 20: train loss 0.1221 
cause_predict: train acc 0.9692 p 0.8684 r 0.9167 f1 0.8919
position_predict: train acc 0.9769 p 0.9333 r 0.8750 f1 0.9032
step 30: train loss 0.2836 
cause_predict: train acc 0.9390 p 0.8000 r 0.8235 f1 0.8116
position_predict: train acc 0.9624 p 0.8788 r 0.8788 f1 0.8788
step 40: train loss 0.1714 
cause_predict: train acc 0.9533 p 0.7955 r 0.9211 f1 0.8537
position_predict: train acc 0.9611 p 0.8235 r 0.8750 f1 0.8485
step 50: train loss 0.2181 
cause_predict: train acc 0.9470 p 0.8276 r 0.7273 f1 0.7742
position_predict: train acc 0.9621 p 0.8235 r 0.8750 f1 0.8485
step 60: train loss 0.1486 
cause_predict: train acc 0.9571 p 0.9062 r 0.8056 f1 0.8529
position_predict: train acc 0.9828 p 0.9394 r 0.9394 f1 0.9394
step 70: train loss 0.2896 
cause_predict: train acc 0.9212 p 0.6977 r 0.8333 f1 0.7595
position_predict: train acc 0.9544 p 0.8621 r 0.7812 f1 0.8197

epoch 9: test loss 0.5790 cost time: 12.8s

cause_predict: test acc 0.8887 p 0.6097 r 0.5962 f1 0.6029
max_acc 0.8887 max_p 0.6097 max_r 0.5962 max_f1 0.6029

position_predict: test acc 0.9191 p 0.6893 r 0.6725 f1 0.6808
max_acc 0.9249 max_p 0.7196 max_r 0.6794 max_f1 0.6989

Average max cause: max_acc 0.8887 max_p 0.6097 max_r 0.5962 max_f1 0.6029
Average max pos: max_acc 0.9191 max_p 0.6893 max_r 0.6725 max_f1 0.6808

step 10: train loss 0.2085 
cause_predict: train acc 0.9252 p 0.8571 r 0.7317 f1 0.7895
position_predict: train acc 0.9813 p 0.9394 r 0.9394 f1 0.9394
step 20: train loss 0.1413 
cause_predict: train acc 0.9672 p 0.9333 r 0.8000 f1 0.8615
position_predict: train acc 0.9781 p 0.9355 r 0.8788 f1 0.9062
step 30: train loss 0.2385 
cause_predict: train acc 0.9632 p 0.8378 r 0.8857 f1 0.8611
position_predict: train acc 0.9632 p 0.8438 r 0.8438 f1 0.8438
step 40: train loss 0.1878 
cause_predict: train acc 0.9526 p 0.8889 r 0.8421 f1 0.8649
position_predict: train acc 0.9763 p 0.9091 r 0.9375 f1 0.9231
step 50: train loss 0.2957 
cause_predict: train acc 0.9328 p 0.8333 r 0.7500 f1 0.7895
position_predict: train acc 0.9370 p 0.7931 r 0.7188 f1 0.7541
step 60: train loss 0.1889 
cause_predict: train acc 0.9562 p 0.8158 r 0.8378 f1 0.8267
position_predict: train acc 0.9798 p 0.8824 r 0.9375 f1 0.9091
step 70: train loss 0.2258 
cause_predict: train acc 0.9302 p 0.8000 r 0.6667 f1 0.7273
position_predict: train acc 0.9651 p 0.8710 r 0.8438 f1 0.8571

epoch 10: test loss 0.6316 cost time: 12.5s

cause_predict: test acc 0.8923 p 0.6367 r 0.5584 f1 0.5950
max_acc 0.8887 max_p 0.6097 max_r 0.5962 max_f1 0.6029

position_predict: test acc 0.9169 p 0.6712 r 0.6899 f1 0.6804
max_acc 0.9249 max_p 0.7196 max_r 0.6794 max_f1 0.6989

Average max cause: max_acc 0.8887 max_p 0.6097 max_r 0.5962 max_f1 0.6029
Average max pos: max_acc 0.9191 max_p 0.6893 max_r 0.6725 max_f1 0.6808

step 10: train loss 0.1505 
cause_predict: train acc 0.9757 p 0.9677 r 0.8824 f1 0.9231
position_predict: train acc 0.9806 p 0.9375 r 0.9375 f1 0.9375
step 20: train loss 0.1594 
cause_predict: train acc 0.9675 p 0.9091 r 0.8571 f1 0.8824
position_predict: train acc 0.9715 p 0.8824 r 0.9091 f1 0.8955
step 30: train loss 0.1020 
cause_predict: train acc 0.9757 p 0.9143 r 0.8889 f1 0.9014
position_predict: train acc 0.9792 p 0.9062 r 0.9062 f1 0.9062
step 40: train loss 0.1337 
cause_predict: train acc 0.9883 p 0.9444 r 0.9444 f1 0.9444
position_predict: train acc 0.9619 p 0.7714 r 0.8438 f1 0.8060
step 50: train loss 0.1502 
cause_predict: train acc 0.9706 p 0.8611 r 0.9394 f1 0.8986
position_predict: train acc 0.9706 p 0.9032 r 0.8750 f1 0.8889
step 60: train loss 0.1082 
cause_predict: train acc 0.9681 p 0.9062 r 0.8529 f1 0.8788
position_predict: train acc 0.9681 p 0.8788 r 0.8788 f1 0.8788
step 70: train loss 0.1378 
cause_predict: train acc 0.9856 p 0.9211 r 0.9722 f1 0.9459
position_predict: train acc 0.9567 p 0.8125 r 0.8125 f1 0.8125

epoch 11: test loss 0.6770 cost time: 12.6s

cause_predict: test acc 0.8740 p 0.5578 r 0.5331 f1 0.5452
max_acc 0.8887 max_p 0.6097 max_r 0.5962 max_f1 0.6029

position_predict: test acc 0.9231 p 0.7154 r 0.6655 f1 0.6895
max_acc 0.9249 max_p 0.7196 max_r 0.6794 max_f1 0.6989

Average max cause: max_acc 0.8887 max_p 0.6097 max_r 0.5962 max_f1 0.6029
Average max pos: max_acc 0.9191 max_p 0.6893 max_r 0.6725 max_f1 0.6808

step 10: train loss 0.0805 
cause_predict: train acc 0.9852 p 1.0000 r 0.8857 f1 0.9394
position_predict: train acc 0.9889 p 0.9677 r 0.9375 f1 0.9524
step 20: train loss 0.1101 
cause_predict: train acc 0.9958 p 1.0000 r 0.9744 f1 0.9870
position_predict: train acc 0.9706 p 0.9032 r 0.8750 f1 0.8889
step 30: train loss 0.1405 
cause_predict: train acc 0.9531 p 0.8750 r 0.8485 f1 0.8615
position_predict: train acc 0.9740 p 0.9375 r 0.9091 f1 0.9231
step 40: train loss 0.0627 
cause_predict: train acc 0.9932 p 0.9714 r 0.9714 f1 0.9714
position_predict: train acc 0.9932 p 0.9688 r 0.9688 f1 0.9688
step 50: train loss 0.1891 
cause_predict: train acc 0.9762 p 0.9250 r 0.9487 f1 0.9367
position_predict: train acc 0.9571 p 0.8485 r 0.8750 f1 0.8615
step 60: train loss 0.1130 
cause_predict: train acc 0.9835 p 0.9412 r 0.9412 f1 0.9412
position_predict: train acc 0.9877 p 0.9677 r 0.9375 f1 0.9524
step 70: train loss 0.2302 
cause_predict: train acc 0.9485 p 0.8049 r 0.8462 f1 0.8250
position_predict: train acc 0.9743 p 0.8788 r 0.9062 f1 0.8923

epoch 12: test loss 0.6910 cost time: 12.7s

cause_predict: test acc 0.8870 p 0.6053 r 0.5804 f1 0.5926
max_acc 0.8887 max_p 0.6097 max_r 0.5962 max_f1 0.6029

position_predict: test acc 0.9138 p 0.6780 r 0.6237 f1 0.6497
max_acc 0.9249 max_p 0.7196 max_r 0.6794 max_f1 0.6989

Average max cause: max_acc 0.8887 max_p 0.6097 max_r 0.5962 max_f1 0.6029
Average max pos: max_acc 0.9191 max_p 0.6893 max_r 0.6725 max_f1 0.6808

step 10: train loss 0.0860 
cause_predict: train acc 0.9691 p 0.9394 r 0.8378 f1 0.8857
position_predict: train acc 0.9923 p 0.9688 r 0.9688 f1 0.9688
step 20: train loss 0.0788 
cause_predict: train acc 0.9795 p 0.9118 r 0.9394 f1 0.9254
position_predict: train acc 0.9959 p 1.0000 r 0.9697 f1 0.9846
step 30: train loss 0.0740 
cause_predict: train acc 0.9828 p 0.9750 r 0.9286 f1 0.9512
position_predict: train acc 0.9914 p 0.9688 r 0.9688 f1 0.9688
step 40: train loss 0.0785 
cause_predict: train acc 0.9961 p 1.0000 r 0.9730 f1 0.9863
position_predict: train acc 0.9806 p 0.9091 r 0.9375 f1 0.9231
step 50: train loss 0.1102 
cause_predict: train acc 0.9725 p 0.9143 r 0.9412 f1 0.9275
position_predict: train acc 0.9835 p 0.9677 r 0.9375 f1 0.9524
step 60: train loss 0.2209 
cause_predict: train acc 0.9722 p 0.9091 r 0.9091 f1 0.9091
position_predict: train acc 0.9583 p 0.8710 r 0.8438 f1 0.8571
step 70: train loss 0.1663 
cause_predict: train acc 0.9748 p 0.8788 r 0.9062 f1 0.8923
position_predict: train acc 0.9532 p 0.7714 r 0.8438 f1 0.8060

epoch 13: test loss 0.6586 cost time: 12.7s

cause_predict: test acc 0.8874 p 0.6165 r 0.5426 f1 0.5772
max_acc 0.8887 max_p 0.6097 max_r 0.5962 max_f1 0.6029

position_predict: test acc 0.9173 p 0.6678 r 0.7073 f1 0.6870
max_acc 0.9249 max_p 0.7196 max_r 0.6794 max_f1 0.6989

Average max cause: max_acc 0.8887 max_p 0.6097 max_r 0.5962 max_f1 0.6029
Average max pos: max_acc 0.9191 max_p 0.6893 max_r 0.6725 max_f1 0.6808

step 10: train loss 0.1100 
cause_predict: train acc 0.9726 p 0.9143 r 0.9143 f1 0.9143
position_predict: train acc 0.9772 p 0.9655 r 0.8750 f1 0.9180
step 20: train loss 0.1448 
cause_predict: train acc 0.9724 p 0.9500 r 0.9268 f1 0.9383
position_predict: train acc 0.9890 p 0.9688 r 0.9688 f1 0.9688
step 30: train loss 0.1041 
cause_predict: train acc 0.9719 p 0.9412 r 0.8649 f1 0.9014
position_predict: train acc 0.9759 p 0.8824 r 0.9375 f1 0.9091
step 40: train loss 0.0960 
cause_predict: train acc 0.9912 p 0.9722 r 0.9722 f1 0.9722
position_predict: train acc 0.9735 p 0.9062 r 0.9062 f1 0.9062
step 50: train loss 0.1279 
cause_predict: train acc 0.9753 p 0.9444 r 0.8947 f1 0.9189
position_predict: train acc 0.9712 p 0.8788 r 0.9062 f1 0.8923
step 60: train loss 0.1543 
cause_predict: train acc 0.9803 p 0.9730 r 0.8780 f1 0.9231
position_predict: train acc 0.9704 p 0.9000 r 0.8182 f1 0.8571
step 70: train loss 0.1495 
cause_predict: train acc 0.9727 p 0.9091 r 0.9091 f1 0.9091
position_predict: train acc 0.9636 p 0.9032 r 0.8485 f1 0.8750

epoch 14: test loss 0.7233 cost time: 12.5s

cause_predict: test acc 0.8896 p 0.6346 r 0.5205 f1 0.5719
max_acc 0.8887 max_p 0.6097 max_r 0.5962 max_f1 0.6029

position_predict: test acc 0.9182 p 0.6884 r 0.6620 f1 0.6750
max_acc 0.9249 max_p 0.7196 max_r 0.6794 max_f1 0.6989

Average max cause: max_acc 0.8887 max_p 0.6097 max_r 0.5962 max_f1 0.6029
Average max pos: max_acc 0.9191 max_p 0.6893 max_r 0.6725 max_f1 0.6808

write pair_data/Ind_BiLSTM_1/fold_7_test.txt done
write pair_data/Ind_BiLSTM_1/fold_7_train.txt done
Optimization Finished!

############# fold 7 end ###############
############# fold 8 begin ###############
load data_file: data_combine_en/fold_8_train.txt
y_position.shape (2275, 75, 2)
y_cause.shape (2275, 75, 2)
x.shape (2275, 75, 30)
sen_len.shape (2275, 75)
doc_len.shape (2275,)
n_cut 107
load data done!

load data_file: data_combine_en/fold_8_test.txt
y_position.shape (284, 75, 2)
y_cause.shape (284, 75, 2)
x.shape (284, 75, 30)
sen_len.shape (284, 75)
doc_len.shape (284,)
n_cut 22
load data done!

train docs: 2275    test docs: 284
step 10: train loss 0.7514 
cause_predict: train acc 0.8721 p 0.0000 r 0.0000 f1 0.0000
position_predict: train acc 0.8760 p 0.0000 r 0.0000 f1 0.0000
step 20: train loss 0.6937 
cause_predict: train acc 0.8679 p 0.0000 r 0.0000 f1 0.0000
position_predict: train acc 0.8821 p 0.0000 r 0.0000 f1 0.0000
step 30: train loss 0.7598 
cause_predict: train acc 0.8272 p 0.0000 r 0.0000 f1 0.0000
position_predict: train acc 0.8642 p 0.0000 r 0.0000 f1 0.0000
step 40: train loss 0.5286 
cause_predict: train acc 0.8724 p 0.0000 r 0.0000 f1 0.0000
position_predict: train acc 0.9207 p 0.6800 r 0.5312 f1 0.5965
step 50: train loss 0.5593 
cause_predict: train acc 0.8634 p 1.0000 r 0.0606 f1 0.1143
position_predict: train acc 0.9031 p 0.6786 r 0.5938 f1 0.6333
step 60: train loss 0.4836 
cause_predict: train acc 0.8819 p 0.7500 r 0.1667 f1 0.2727
position_predict: train acc 0.9114 p 0.6429 r 0.5625 f1 0.6000
step 70: train loss 0.5090 
cause_predict: train acc 0.8672 p 0.4545 r 0.1429 f1 0.2174
position_predict: train acc 0.9483 p 0.9091 r 0.6250 f1 0.7407

epoch 0: test loss 0.5062 cost time: 12.8s

cause_predict: test acc 0.8852 p 0.7381 r 0.2934 f1 0.4199
max_acc 0.8852 max_p 0.7381 max_r 0.2934 max_f1 0.4199

position_predict: test acc 0.9187 p 0.7465 r 0.5540 f1 0.6360
max_acc 0.9187 max_p 0.7465 max_r 0.5540 max_f1 0.6360

Average max cause: max_acc 0.8852 max_p 0.7381 max_r 0.2934 max_f1 0.4199
Average max pos: max_acc 0.9187 max_p 0.7465 max_r 0.5540 max_f1 0.6360

step 10: train loss 0.6601 
cause_predict: train acc 0.8475 p 0.7143 r 0.1282 f1 0.2174
position_predict: train acc 0.9025 p 0.6667 r 0.5625 f1 0.6102
step 20: train loss 0.3990 
cause_predict: train acc 0.9088 p 0.6154 r 0.2424 f1 0.3478
position_predict: train acc 0.9453 p 0.6944 r 0.7812 f1 0.7353
step 30: train loss 0.5089 
cause_predict: train acc 0.8657 p 0.6000 r 0.4412 f1 0.5085
position_predict: train acc 0.9074 p 0.7241 r 0.6364 f1 0.6774
step 40: train loss 0.6556 
cause_predict: train acc 0.8229 p 0.7143 r 0.2500 f1 0.3704
position_predict: train acc 0.8906 p 0.6774 r 0.6562 f1 0.6667
step 50: train loss 0.5503 
cause_predict: train acc 0.8611 p 0.4000 r 0.1212 f1 0.1860
position_predict: train acc 0.9246 p 0.6970 r 0.7188 f1 0.7077
step 60: train loss 0.4138 
cause_predict: train acc 0.9022 p 0.6000 r 0.4167 f1 0.4918
position_predict: train acc 0.9369 p 0.7241 r 0.6364 f1 0.6774
step 70: train loss 0.4286 
cause_predict: train acc 0.8897 p 0.6842 r 0.3611 f1 0.4727
position_predict: train acc 0.9125 p 0.6552 r 0.5938 f1 0.6230

epoch 1: test loss 0.4840 cost time: 12.6s

cause_predict: test acc 0.8914 p 0.7176 r 0.3849 f1 0.5010
max_acc 0.8914 max_p 0.7176 max_r 0.3849 max_f1 0.5010

position_predict: test acc 0.9205 p 0.7121 r 0.6376 f1 0.6728
max_acc 0.9205 max_p 0.7121 max_r 0.6376 max_f1 0.6728

Average max cause: max_acc 0.8914 max_p 0.7176 max_r 0.3849 max_f1 0.5010
Average max pos: max_acc 0.9205 max_p 0.7121 max_r 0.6376 max_f1 0.6728

step 10: train loss 0.4583 
cause_predict: train acc 0.8870 p 0.7308 r 0.4872 f1 0.5846
position_predict: train acc 0.9079 p 0.6923 r 0.5625 f1 0.6207
step 20: train loss 0.3630 
cause_predict: train acc 0.9200 p 0.9231 r 0.3429 f1 0.5000
position_predict: train acc 0.9367 p 0.7600 r 0.5938 f1 0.6667
step 30: train loss 0.4216 
cause_predict: train acc 0.9254 p 0.8000 r 0.5405 f1 0.6452
position_predict: train acc 0.9390 p 0.7692 r 0.6250 f1 0.6897
step 40: train loss 0.4850 
cause_predict: train acc 0.8541 p 0.6250 r 0.4545 f1 0.5263
position_predict: train acc 0.9297 p 0.8333 r 0.7576 f1 0.7937
step 50: train loss 0.4819 
cause_predict: train acc 0.8843 p 0.7391 r 0.4722 f1 0.5763
position_predict: train acc 0.9306 p 0.7576 r 0.7812 f1 0.7692
step 60: train loss 0.5054 
cause_predict: train acc 0.8495 p 0.7059 r 0.3429 f1 0.4615
position_predict: train acc 0.9462 p 0.9000 r 0.7941 f1 0.8438
step 70: train loss 0.4847 
cause_predict: train acc 0.8648 p 0.6429 r 0.2432 f1 0.3529
position_predict: train acc 0.9385 p 0.8400 r 0.6562 f1 0.7368

epoch 2: test loss 0.4609 cost time: 13.0s

cause_predict: test acc 0.8919 p 0.7072 r 0.4038 f1 0.5141
max_acc 0.8919 max_p 0.7072 max_r 0.4038 max_f1 0.5141

position_predict: test acc 0.9236 p 0.7164 r 0.6690 f1 0.6919
max_acc 0.9236 max_p 0.7164 max_r 0.6690 max_f1 0.6919

Average max cause: max_acc 0.8919 max_p 0.7072 max_r 0.4038 max_f1 0.5141
Average max pos: max_acc 0.9236 max_p 0.7164 max_r 0.6690 max_f1 0.6919

step 10: train loss 0.4012 
cause_predict: train acc 0.9103 p 0.7500 r 0.5625 f1 0.6429
position_predict: train acc 0.9238 p 0.7353 r 0.7576 f1 0.7463
step 20: train loss 0.5026 
cause_predict: train acc 0.8735 p 0.7407 r 0.5882 f1 0.6557
position_predict: train acc 0.9036 p 0.8077 r 0.6562 f1 0.7241
step 30: train loss 0.4311 
cause_predict: train acc 0.8716 p 0.5238 r 0.3235 f1 0.4000
position_predict: train acc 0.9339 p 0.7778 r 0.6562 f1 0.7119
step 40: train loss 0.3925 
cause_predict: train acc 0.8943 p 0.6818 r 0.4412 f1 0.5357
position_predict: train acc 0.9593 p 0.8667 r 0.8125 f1 0.8387
step 50: train loss 0.4950 
cause_predict: train acc 0.8821 p 0.6842 r 0.3421 f1 0.4561
position_predict: train acc 0.9163 p 0.7200 r 0.5455 f1 0.6207
step 60: train loss 0.4055 
cause_predict: train acc 0.8955 p 0.7368 r 0.3590 f1 0.4828
position_predict: train acc 0.9477 p 0.7931 r 0.7188 f1 0.7541
step 70: train loss 0.3940 
cause_predict: train acc 0.8816 p 0.7222 r 0.3714 f1 0.4906
position_predict: train acc 0.9386 p 0.8000 r 0.7500 f1 0.7742

epoch 3: test loss 0.4632 cost time: 12.8s

cause_predict: test acc 0.8914 p 0.6927 r 0.4196 f1 0.5226
max_acc 0.8914 max_p 0.6927 max_r 0.4196 max_f1 0.5226

position_predict: test acc 0.9285 p 0.7414 r 0.6794 f1 0.7091
max_acc 0.9285 max_p 0.7414 max_r 0.6794 max_f1 0.7091

Average max cause: max_acc 0.8914 max_p 0.6927 max_r 0.4196 max_f1 0.5226
Average max pos: max_acc 0.9285 max_p 0.7414 max_r 0.6794 max_f1 0.7091

step 10: train loss 0.3731 
cause_predict: train acc 0.9075 p 0.8696 r 0.5263 f1 0.6557
position_predict: train acc 0.9559 p 0.8929 r 0.7812 f1 0.8333
step 20: train loss 0.3017 
cause_predict: train acc 0.9108 p 0.8889 r 0.4211 f1 0.5714
position_predict: train acc 0.9591 p 0.8621 r 0.7812 f1 0.8197
step 30: train loss 0.4105 
cause_predict: train acc 0.9190 p 0.8000 r 0.5714 f1 0.6667
position_predict: train acc 0.9231 p 0.7500 r 0.6364 f1 0.6885
step 40: train loss 0.3672 
cause_predict: train acc 0.9462 p 0.9259 r 0.7576 f1 0.8333
position_predict: train acc 0.9247 p 0.8214 r 0.7188 f1 0.7667
step 50: train loss 0.3480 
cause_predict: train acc 0.9061 p 0.7500 r 0.4545 f1 0.5660
position_predict: train acc 0.9633 p 0.9259 r 0.7812 f1 0.8475
step 60: train loss 0.3025 
cause_predict: train acc 0.9303 p 0.7778 r 0.7568 f1 0.7671
position_predict: train acc 0.9590 p 0.8667 r 0.8125 f1 0.8387
step 70: train loss 0.4398 
cause_predict: train acc 0.8708 p 0.6800 r 0.4250 f1 0.5231
position_predict: train acc 0.9417 p 0.8000 r 0.7500 f1 0.7742

epoch 4: test loss 0.4793 cost time: 12.6s

cause_predict: test acc 0.8870 p 0.6600 r 0.4164 f1 0.5106
max_acc 0.8914 max_p 0.6927 max_r 0.4196 max_f1 0.5226

position_predict: test acc 0.9272 p 0.7366 r 0.6725 f1 0.7031
max_acc 0.9285 max_p 0.7414 max_r 0.6794 max_f1 0.7091

Average max cause: max_acc 0.8914 max_p 0.6927 max_r 0.4196 max_f1 0.5226
Average max pos: max_acc 0.9285 max_p 0.7414 max_r 0.6794 max_f1 0.7091

step 10: train loss 0.2371 
cause_predict: train acc 0.9442 p 0.8824 r 0.8108 f1 0.8451
position_predict: train acc 0.9695 p 0.8824 r 0.9375 f1 0.9091
step 20: train loss 0.3945 
cause_predict: train acc 0.8699 p 0.5833 r 0.5526 f1 0.5676
position_predict: train acc 0.9553 p 0.8621 r 0.7812 f1 0.8197
step 30: train loss 0.2838 
cause_predict: train acc 0.9404 p 0.8966 r 0.7027 f1 0.7879
position_predict: train acc 0.9277 p 0.7667 r 0.6970 f1 0.7302
step 40: train loss 0.2470 
cause_predict: train acc 0.9510 p 0.8462 r 0.6875 f1 0.7586
position_predict: train acc 0.9580 p 0.8333 r 0.7812 f1 0.8065
step 50: train loss 0.3797 
cause_predict: train acc 0.9048 p 0.6667 r 0.5143 f1 0.5806
position_predict: train acc 0.9158 p 0.6364 r 0.6562 f1 0.6462
step 60: train loss 0.3194 
cause_predict: train acc 0.9242 p 0.7273 r 0.6667 f1 0.6957
position_predict: train acc 0.9531 p 0.8276 r 0.7500 f1 0.7869
step 70: train loss 0.3651 
cause_predict: train acc 0.8975 p 0.6667 r 0.6111 f1 0.6377
position_predict: train acc 0.9508 p 0.8621 r 0.7576 f1 0.8065

epoch 5: test loss 0.4942 cost time: 13.2s

cause_predict: test acc 0.8856 p 0.6187 r 0.5016 f1 0.5540
max_acc 0.8856 max_p 0.6187 max_r 0.5016 max_f1 0.5540

position_predict: test acc 0.9258 p 0.7216 r 0.6864 f1 0.7036
max_acc 0.9285 max_p 0.7414 max_r 0.6794 max_f1 0.7091

Average max cause: max_acc 0.8856 max_p 0.6187 max_r 0.5016 max_f1 0.5540
Average max pos: max_acc 0.9258 max_p 0.7216 max_r 0.6864 max_f1 0.7036

step 10: train loss 0.2100 
cause_predict: train acc 0.9383 p 0.8000 r 0.7273 f1 0.7619
position_predict: train acc 0.9671 p 0.8750 r 0.8750 f1 0.8750
step 20: train loss 0.2499 
cause_predict: train acc 0.9456 p 0.9032 r 0.7368 f1 0.8116
position_predict: train acc 0.9498 p 0.8846 r 0.7188 f1 0.7931
step 30: train loss 0.4636 
cause_predict: train acc 0.8708 p 0.6400 r 0.4706 f1 0.5424
position_predict: train acc 0.9474 p 0.8182 r 0.8438 f1 0.8308
step 40: train loss 0.3445 
cause_predict: train acc 0.9163 p 0.8077 r 0.6000 f1 0.6885
position_predict: train acc 0.9604 p 0.8750 r 0.8485 f1 0.8615
step 50: train loss 0.2509 
cause_predict: train acc 0.9373 p 0.9231 r 0.6154 f1 0.7385
position_predict: train acc 0.9520 p 0.8333 r 0.7576 f1 0.7937
step 60: train loss 0.3196 
cause_predict: train acc 0.9250 p 0.8519 r 0.5750 f1 0.6866
position_predict: train acc 0.9393 p 0.7419 r 0.7188 f1 0.7302
step 70: train loss 0.3233 
cause_predict: train acc 0.8987 p 0.8077 r 0.5385 f1 0.6462
position_predict: train acc 0.9736 p 0.9643 r 0.8438 f1 0.9000

epoch 6: test loss 0.5156 cost time: 12.7s

cause_predict: test acc 0.8878 p 0.6213 r 0.5331 f1 0.5739
max_acc 0.8878 max_p 0.6213 max_r 0.5331 max_f1 0.5739

position_predict: test acc 0.9236 p 0.7101 r 0.6829 f1 0.6963
max_acc 0.9285 max_p 0.7414 max_r 0.6794 max_f1 0.7091

Average max cause: max_acc 0.8878 max_p 0.6213 max_r 0.5331 max_f1 0.5739
Average max pos: max_acc 0.9236 max_p 0.7101 max_r 0.6829 max_f1 0.6963

step 10: train loss 0.1969 
cause_predict: train acc 0.9678 p 0.9643 r 0.7500 f1 0.8437
position_predict: train acc 0.9646 p 0.8387 r 0.8125 f1 0.8254
step 20: train loss 0.1935 
cause_predict: train acc 0.9485 p 0.8857 r 0.8378 f1 0.8611
position_predict: train acc 0.9691 p 0.8611 r 0.9688 f1 0.9118
step 30: train loss 0.2851 
cause_predict: train acc 0.9281 p 0.7714 r 0.6923 f1 0.7297
position_predict: train acc 0.9676 p 0.9000 r 0.8182 f1 0.8571
step 40: train loss 0.3119 
cause_predict: train acc 0.9412 p 0.8621 r 0.7143 f1 0.7813
position_predict: train acc 0.9580 p 0.8438 r 0.8438 f1 0.8438
step 50: train loss 0.1419 
cause_predict: train acc 0.9655 p 0.8788 r 0.8788 f1 0.8788
position_predict: train acc 0.9871 p 0.9394 r 0.9688 f1 0.9538
step 60: train loss 0.2926 
cause_predict: train acc 0.9412 p 0.8710 r 0.7500 f1 0.8060
position_predict: train acc 0.9276 p 0.7500 r 0.7500 f1 0.7500
step 70: train loss 0.3223 
cause_predict: train acc 0.9029 p 0.7857 r 0.6111 f1 0.6875
position_predict: train acc 0.9709 p 0.9062 r 0.9062 f1 0.9062

epoch 7: test loss 0.5766 cost time: 12.5s

cause_predict: test acc 0.8856 p 0.6309 r 0.4637 f1 0.5345
max_acc 0.8878 max_p 0.6213 max_r 0.5331 max_f1 0.5739

position_predict: test acc 0.9205 p 0.6940 r 0.6794 f1 0.6866
max_acc 0.9285 max_p 0.7414 max_r 0.6794 max_f1 0.7091

Average max cause: max_acc 0.8878 max_p 0.6213 max_r 0.5331 max_f1 0.5739
Average max pos: max_acc 0.9236 max_p 0.7101 max_r 0.6829 max_f1 0.6963

step 10: train loss 0.1315 
cause_predict: train acc 1.0000 p 1.0000 r 1.0000 f1 1.0000
position_predict: train acc 0.9628 p 0.9286 r 0.8125 f1 0.8667
step 20: train loss 0.2218 
cause_predict: train acc 0.9244 p 0.8750 r 0.6667 f1 0.7568
position_predict: train acc 0.9832 p 0.9118 r 0.9688 f1 0.9394
step 30: train loss 0.2475 
cause_predict: train acc 0.9578 p 0.8571 r 0.8571 f1 0.8571
position_predict: train acc 0.9662 p 0.8788 r 0.8788 f1 0.8788
step 40: train loss 0.1705 
cause_predict: train acc 0.9760 p 1.0000 r 0.8529 f1 0.9206
position_predict: train acc 0.9519 p 0.8667 r 0.8125 f1 0.8387
step 50: train loss 0.1923 
cause_predict: train acc 0.9519 p 0.8158 r 0.9118 f1 0.8611
position_predict: train acc 0.9663 p 0.8788 r 0.9062 f1 0.8923
step 60: train loss 0.2215 
cause_predict: train acc 0.9552 p 0.8649 r 0.8649 f1 0.8649
position_predict: train acc 0.9641 p 0.8571 r 0.9091 f1 0.8824
step 70: train loss 0.2954 
cause_predict: train acc 0.9444 p 0.8750 r 0.7778 f1 0.8235
position_predict: train acc 0.9213 p 0.7273 r 0.7500 f1 0.7385

epoch 8: test loss 0.5501 cost time: 12.6s

cause_predict: test acc 0.8856 p 0.6101 r 0.5331 f1 0.5690
max_acc 0.8878 max_p 0.6213 max_r 0.5331 max_f1 0.5739

position_predict: test acc 0.9173 p 0.6747 r 0.6864 f1 0.6805
max_acc 0.9285 max_p 0.7414 max_r 0.6794 max_f1 0.7091

Average max cause: max_acc 0.8878 max_p 0.6213 max_r 0.5331 max_f1 0.5739
Average max pos: max_acc 0.9236 max_p 0.7101 max_r 0.6829 max_f1 0.6963

step 10: train loss 0.1268 
cause_predict: train acc 0.9784 p 0.9412 r 0.9143 f1 0.9275
position_predict: train acc 0.9828 p 0.9118 r 0.9688 f1 0.9394
step 20: train loss 0.2202 
cause_predict: train acc 0.9551 p 0.8788 r 0.8056 f1 0.8406
position_predict: train acc 0.9551 p 0.8286 r 0.8529 f1 0.8406
step 30: train loss 0.2400 
cause_predict: train acc 0.9479 p 0.8824 r 0.8108 f1 0.8451
position_predict: train acc 0.9526 p 0.8438 r 0.8438 f1 0.8438
step 40: train loss 0.1737 
cause_predict: train acc 0.9586 p 0.9032 r 0.7778 f1 0.8358
position_predict: train acc 0.9737 p 0.9032 r 0.8750 f1 0.8889
step 50: train loss 0.3328 
cause_predict: train acc 0.9258 p 0.7353 r 0.7143 f1 0.7246
position_predict: train acc 0.9531 p 0.8125 r 0.8125 f1 0.8125
step 60: train loss 0.1751 
cause_predict: train acc 0.9769 p 0.9667 r 0.8529 f1 0.9062
position_predict: train acc 0.9731 p 0.9310 r 0.8438 f1 0.8852
step 70: train loss 0.2076 
cause_predict: train acc 0.9510 p 0.8286 r 0.8286 f1 0.8286
position_predict: train acc 0.9755 p 0.9062 r 0.9062 f1 0.9062

epoch 9: test loss 0.6026 cost time: 12.3s

cause_predict: test acc 0.8852 p 0.6095 r 0.5268 f1 0.5651
max_acc 0.8878 max_p 0.6213 max_r 0.5331 max_f1 0.5739

position_predict: test acc 0.9169 p 0.6850 r 0.6516 f1 0.6679
max_acc 0.9285 max_p 0.7414 max_r 0.6794 max_f1 0.7091

Average max cause: max_acc 0.8878 max_p 0.6213 max_r 0.5331 max_f1 0.5739
Average max pos: max_acc 0.9236 max_p 0.7101 max_r 0.6829 max_f1 0.6963

step 10: train loss 0.1178 
cause_predict: train acc 0.9738 p 0.9706 r 0.8462 f1 0.9041
position_predict: train acc 0.9775 p 0.9355 r 0.8788 f1 0.9062
step 20: train loss 0.1581 
cause_predict: train acc 0.9604 p 0.9091 r 0.8571 f1 0.8824
position_predict: train acc 0.9703 p 0.9643 r 0.8438 f1 0.9000
step 30: train loss 0.1468 
cause_predict: train acc 0.9465 p 0.8571 r 0.7895 f1 0.8219
position_predict: train acc 0.9877 p 0.9394 r 0.9688 f1 0.9538
step 40: train loss 0.2402 
cause_predict: train acc 0.9359 p 0.8649 r 0.7619 f1 0.8101
position_predict: train acc 0.9701 p 0.9032 r 0.8750 f1 0.8889
step 50: train loss 0.1423 
cause_predict: train acc 0.9583 p 0.9333 r 0.7778 f1 0.8485
position_predict: train acc 0.9792 p 0.9091 r 0.9375 f1 0.9231
step 60: train loss 0.2838 
cause_predict: train acc 0.9419 p 0.7941 r 0.7941 f1 0.7941
position_predict: train acc 0.9668 p 0.8750 r 0.8750 f1 0.8750
step 70: train loss 0.1446 
cause_predict: train acc 0.9770 p 0.9375 r 0.9091 f1 0.9231
position_predict: train acc 0.9908 p 0.9688 r 0.9688 f1 0.9688

epoch 10: test loss 0.6330 cost time: 12.4s

cause_predict: test acc 0.8803 p 0.5793 r 0.5647 f1 0.5719
max_acc 0.8878 max_p 0.6213 max_r 0.5331 max_f1 0.5739

position_predict: test acc 0.9142 p 0.6690 r 0.6551 f1 0.6620
max_acc 0.9285 max_p 0.7414 max_r 0.6794 max_f1 0.7091

Average max cause: max_acc 0.8878 max_p 0.6213 max_r 0.5331 max_f1 0.5739
Average max pos: max_acc 0.9236 max_p 0.7101 max_r 0.6829 max_f1 0.6963

step 10: train loss 0.1118 
cause_predict: train acc 0.9876 p 1.0000 r 0.9118 f1 0.9538
position_predict: train acc 0.9835 p 0.9667 r 0.9062 f1 0.9355
step 20: train loss 0.1267 
cause_predict: train acc 0.9682 p 0.9118 r 0.8378 f1 0.8732
position_predict: train acc 0.9859 p 0.9118 r 0.9688 f1 0.9394
step 30: train loss 0.1881 
cause_predict: train acc 0.9600 p 0.9091 r 0.8333 f1 0.8696
position_predict: train acc 0.9600 p 0.8710 r 0.8438 f1 0.8571
step 40: train loss 0.1597 
cause_predict: train acc 0.9614 p 0.8684 r 0.8919 f1 0.8800
position_predict: train acc 0.9700 p 0.8611 r 0.9394 f1 0.8986
step 50: train loss 0.1438 
cause_predict: train acc 0.9688 p 0.9677 r 0.8333 f1 0.8955
position_predict: train acc 0.9866 p 0.9394 r 0.9688 f1 0.9538
step 60: train loss 0.2244 
cause_predict: train acc 0.9810 p 0.9677 r 0.9091 f1 0.9375
position_predict: train acc 0.9573 p 0.8750 r 0.8485 f1 0.8615
step 70: train loss 0.2097 
cause_predict: train acc 0.9514 p 0.8333 r 0.7317 f1 0.7792
position_predict: train acc 0.9657 p 0.7941 r 0.8438 f1 0.8182

epoch 11: test loss 0.6887 cost time: 12.8s

cause_predict: test acc 0.8825 p 0.5978 r 0.5205 f1 0.5565
max_acc 0.8878 max_p 0.6213 max_r 0.5331 max_f1 0.5739

position_predict: test acc 0.9115 p 0.6572 r 0.6481 f1 0.6526
max_acc 0.9285 max_p 0.7414 max_r 0.6794 max_f1 0.7091

Average max cause: max_acc 0.8878 max_p 0.6213 max_r 0.5331 max_f1 0.5739
Average max pos: max_acc 0.9236 max_p 0.7101 max_r 0.6829 max_f1 0.6963

step 10: train loss 0.0831 
cause_predict: train acc 0.9761 p 0.9167 r 0.9167 f1 0.9167
position_predict: train acc 0.9960 p 0.9697 r 1.0000 f1 0.9846
step 20: train loss 0.1436 
cause_predict: train acc 0.9711 p 0.8889 r 0.8889 f1 0.8889
position_predict: train acc 0.9675 p 0.8378 r 0.9118 f1 0.8732
step 30: train loss 0.0839 
cause_predict: train acc 0.9799 p 0.9697 r 0.9143 f1 0.9412
position_predict: train acc 0.9799 p 0.9375 r 0.9375 f1 0.9375
step 40: train loss 0.1154 
cause_predict: train acc 0.9896 p 0.9487 r 1.0000 f1 0.9737
position_predict: train acc 0.9637 p 0.8788 r 0.9062 f1 0.8923
step 50: train loss 0.2130 
cause_predict: train acc 0.9615 p 0.8889 r 0.8649 f1 0.8767
position_predict: train acc 0.9786 p 0.9118 r 0.9394 f1 0.9254
step 60: train loss 0.1649 
cause_predict: train acc 0.9683 p 0.9062 r 0.8788 f1 0.8923
position_predict: train acc 0.9638 p 0.8529 r 0.9062 f1 0.8788
step 70: train loss 0.1179 
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
cause_predict: train acc 0.9774 p 0.9444 r 0.9189 f1 0.9315
position_predict: train acc 0.9774 p 0.9375 r 0.9091 f1 0.9231

epoch 12: test loss 0.7001 cost time: 12.8s

cause_predict: test acc 0.8874 p 0.6236 r 0.5174 f1 0.5655
max_acc 0.8878 max_p 0.6213 max_r 0.5331 max_f1 0.5739

position_predict: test acc 0.9155 p 0.6738 r 0.6620 f1 0.6678
max_acc 0.9285 max_p 0.7414 max_r 0.6794 max_f1 0.7091

Average max cause: max_acc 0.8878 max_p 0.6213 max_r 0.5331 max_f1 0.5739
Average max pos: max_acc 0.9236 max_p 0.7101 max_r 0.6829 max_f1 0.6963

step 10: train loss 0.0932 
cause_predict: train acc 0.9860 p 0.9444 r 0.9714 f1 0.9577
position_predict: train acc 0.9720 p 0.9333 r 0.8750 f1 0.9032
step 20: train loss 0.1495 
cause_predict: train acc 0.9712 p 0.9429 r 0.8684 f1 0.9041
position_predict: train acc 0.9794 p 0.9355 r 0.9062 f1 0.9206
step 30: train loss 0.1406 
cause_predict: train acc 0.9783 p 0.9250 r 0.9250 f1 0.9250
position_predict: train acc 0.9855 p 0.9375 r 0.9375 f1 0.9375
step 40: train loss 0.1215 
cause_predict: train acc 0.9643 p 0.9091 r 0.8108 f1 0.8571
position_predict: train acc 0.9786 p 0.9062 r 0.9062 f1 0.9062
step 50: train loss 0.1060 
cause_predict: train acc 0.9683 p 0.9143 r 0.9143 f1 0.9143
position_predict: train acc 0.9894 p 0.9697 r 0.9697 f1 0.9697
step 60: train loss 0.1945 
cause_predict: train acc 0.9708 p 0.8857 r 0.9118 f1 0.8986
position_predict: train acc 0.9542 p 0.8235 r 0.8485 f1 0.8358
step 70: train loss 0.1799 
cause_predict: train acc 0.9722 p 0.9333 r 0.8750 f1 0.9032
position_predict: train acc 0.9583 p 0.8571 r 0.8824 f1 0.8696

epoch 13: test loss 0.7151 cost time: 12.5s

cause_predict: test acc 0.8914 p 0.6402 r 0.5331 f1 0.5818
max_acc 0.8914 max_p 0.6402 max_r 0.5331 max_f1 0.5818

position_predict: test acc 0.9124 p 0.6643 r 0.6411 f1 0.6525
max_acc 0.9285 max_p 0.7414 max_r 0.6794 max_f1 0.7091

Average max cause: max_acc 0.8878 max_p 0.6213 max_r 0.5331 max_f1 0.5739
Average max pos: max_acc 0.9236 max_p 0.7101 max_r 0.6829 max_f1 0.6963

step 10: train loss 0.0665 
cause_predict: train acc 1.0000 p 1.0000 r 1.0000 f1 1.0000
position_predict: train acc 0.9817 p 0.9091 r 0.9375 f1 0.9231
step 20: train loss 0.1342 
cause_predict: train acc 0.9719 p 0.9688 r 0.8378 f1 0.8986
position_predict: train acc 0.9719 p 0.9032 r 0.8750 f1 0.8889
step 30: train loss 0.0936 
cause_predict: train acc 0.9867 p 0.9706 r 0.9429 f1 0.9565
position_predict: train acc 0.9646 p 0.9000 r 0.8438 f1 0.8710
step 40: train loss 0.1464 
cause_predict: train acc 0.9756 p 0.9394 r 0.9118 f1 0.9254
position_predict: train acc 0.9512 p 0.8710 r 0.8182 f1 0.8438
step 50: train loss 0.1712 
cause_predict: train acc 0.9733 p 0.9355 r 0.8529 f1 0.8923
position_predict: train acc 0.9656 p 0.8485 r 0.8750 f1 0.8615
step 60: train loss 0.0638 
cause_predict: train acc 0.9917 p 0.9722 r 0.9722 f1 0.9722
position_predict: train acc 0.9958 p 1.0000 r 0.9688 f1 0.9841
step 70: train loss 0.1581 
cause_predict: train acc 0.9683 p 0.9375 r 0.8333 f1 0.8824
position_predict: train acc 0.9643 p 0.8710 r 0.8438 f1 0.8571

epoch 14: test loss 0.7524 cost time: 12.5s

cause_predict: test acc 0.8861 p 0.6123 r 0.5331 f1 0.5700
max_acc 0.8914 max_p 0.6402 max_r 0.5331 max_f1 0.5818

position_predict: test acc 0.9120 p 0.6607 r 0.6446 f1 0.6526
max_acc 0.9285 max_p 0.7414 max_r 0.6794 max_f1 0.7091

Average max cause: max_acc 0.8878 max_p 0.6213 max_r 0.5331 max_f1 0.5739
Average max pos: max_acc 0.9236 max_p 0.7101 max_r 0.6829 max_f1 0.6963

write pair_data/Ind_BiLSTM_1/fold_8_test.txt done
write pair_data/Ind_BiLSTM_1/fold_8_train.txt done
Optimization Finished!

############# fold 8 end ###############
############# fold 9 begin ###############
load data_file: data_combine_en/fold_9_train.txt
y_position.shape (2275, 75, 2)
y_cause.shape (2275, 75, 2)
x.shape (2275, 75, 30)
sen_len.shape (2275, 75)
doc_len.shape (2275,)
n_cut 107
load data done!

load data_file: data_combine_en/fold_9_test.txt
y_position.shape (284, 75, 2)
y_cause.shape (284, 75, 2)
x.shape (284, 75, 30)
sen_len.shape (284, 75)
doc_len.shape (284,)
n_cut 22
load data done!

train docs: 2275    test docs: 284
step 10: train loss 0.7770 
cause_predict: train acc 0.8630 p 0.0000 r 0.0000 f1 0.0000
position_predict: train acc 0.8815 p 0.0000 r 0.0000 f1 0.0000
step 20: train loss 0.7425 
cause_predict: train acc 0.8603 p 0.0000 r 0.0000 f1 0.0000
position_predict: train acc 0.8559 p 0.0000 r 0.0000 f1 0.0000
step 30: train loss 0.7073 
cause_predict: train acc 0.8590 p 0.0000 r 0.0000 f1 0.0000
position_predict: train acc 0.8590 p 0.0000 r 0.0000 f1 0.0000
step 40: train loss 0.6185 
cause_predict: train acc 0.8496 p 0.0000 r 0.0000 f1 0.0000
position_predict: train acc 0.8759 p 0.0000 r 0.0000 f1 0.0000
step 50: train loss 0.6493 
cause_predict: train acc 0.8462 p 0.0000 r 0.0000 f1 0.0000
position_predict: train acc 0.8778 p 0.5926 r 0.5000 f1 0.5424
step 60: train loss 0.6069 
cause_predict: train acc 0.8577 p 0.8000 r 0.1000 f1 0.1778
position_predict: train acc 0.9115 p 0.7368 r 0.4375 f1 0.5490
step 70: train loss 0.6023 
cause_predict: train acc 0.8462 p 0.6667 r 0.0606 f1 0.1111
position_predict: train acc 0.8462 p 0.5263 r 0.3030 f1 0.3846

epoch 0: test loss 0.5218 cost time: 13.0s

cause_predict: test acc 0.8825 p 0.8462 r 0.2082 f1 0.3342
max_acc 0.8825 max_p 0.8462 max_r 0.2082 max_f1 0.3342

position_predict: test acc 0.9173 p 0.7217 r 0.5784 f1 0.6422
max_acc 0.9173 max_p 0.7217 max_r 0.5784 max_f1 0.6422

Average max cause: max_acc 0.8825 max_p 0.8462 max_r 0.2082 max_f1 0.3342
Average max pos: max_acc 0.9173 max_p 0.7217 max_r 0.5784 max_f1 0.6422

step 10: train loss 0.6034 
cause_predict: train acc 0.8542 p 0.6923 r 0.2250 f1 0.3396
position_predict: train acc 0.9167 p 0.7241 r 0.6364 f1 0.6774
step 20: train loss 0.4394 
cause_predict: train acc 0.9180 p 0.7895 r 0.4688 f1 0.5882
position_predict: train acc 0.9297 p 0.7500 r 0.6562 f1 0.7000
step 30: train loss 0.4786 
cause_predict: train acc 0.8650 p 0.5000 r 0.1351 f1 0.2128
position_predict: train acc 0.9234 p 0.7895 r 0.4688 f1 0.5882
step 40: train loss 0.5527 
cause_predict: train acc 0.8837 p 0.8125 r 0.3714 f1 0.5098
position_predict: train acc 0.9116 p 0.9375 r 0.4545 f1 0.6122
step 50: train loss 0.5088 
cause_predict: train acc 0.8836 p 0.7647 r 0.3171 f1 0.4483
position_predict: train acc 0.9345 p 0.7917 r 0.5938 f1 0.6786
step 60: train loss 0.3772 
cause_predict: train acc 0.9304 p 0.9412 r 0.4706 f1 0.6275
position_predict: train acc 0.9414 p 0.8077 r 0.6562 f1 0.7241
step 70: train loss 0.4744 
cause_predict: train acc 0.8603 p 0.5385 r 0.2121 f1 0.3043
position_predict: train acc 0.9127 p 0.7407 r 0.6061 f1 0.6667

epoch 1: test loss 0.4984 cost time: 12.8s

cause_predict: test acc 0.8843 p 0.8021 r 0.2429 f1 0.3729
max_acc 0.8843 max_p 0.8021 max_r 0.2429 max_f1 0.3729

position_predict: test acc 0.9236 p 0.7117 r 0.6794 f1 0.6952
max_acc 0.9236 max_p 0.7117 max_r 0.6794 max_f1 0.6952

Average max cause: max_acc 0.8843 max_p 0.8021 max_r 0.2429 max_f1 0.3729
Average max pos: max_acc 0.9236 max_p 0.7117 max_r 0.6794 max_f1 0.6952

step 10: train loss 0.5071 
cause_predict: train acc 0.8785 p 0.6500 r 0.3611 f1 0.4643
position_predict: train acc 0.9150 p 0.7143 r 0.6061 f1 0.6557
step 20: train loss 0.5792 
cause_predict: train acc 0.8869 p 0.7692 r 0.6061 f1 0.6780
position_predict: train acc 0.8988 p 0.8000 r 0.6250 f1 0.7018
step 30: train loss 0.4653 
cause_predict: train acc 0.8844 p 0.8333 r 0.4286 f1 0.5660
position_predict: train acc 0.9548 p 0.9286 r 0.7879 f1 0.8525
step 40: train loss 0.3950 
cause_predict: train acc 0.9260 p 0.8125 r 0.3714 f1 0.5098
position_predict: train acc 0.9142 p 0.5517 r 0.5000 f1 0.5246
step 50: train loss 0.4747 
cause_predict: train acc 0.8898 p 0.8667 r 0.3421 f1 0.4906
position_predict: train acc 0.9184 p 0.7308 r 0.5938 f1 0.6552
step 60: train loss 0.5741 
cause_predict: train acc 0.8484 p 0.5714 r 0.3000 f1 0.3934
position_predict: train acc 0.9180 p 0.7097 r 0.6667 f1 0.6875
step 70: train loss 0.5253 
cause_predict: train acc 0.8333 p 0.5625 r 0.2093 f1 0.3051
position_predict: train acc 0.9309 p 0.7778 r 0.6562 f1 0.7119

epoch 2: test loss 0.4718 cost time: 12.5s

cause_predict: test acc 0.8950 p 0.7808 r 0.3596 f1 0.4924
max_acc 0.8950 max_p 0.7808 max_r 0.3596 max_f1 0.4924

position_predict: test acc 0.9249 p 0.7333 r 0.6516 f1 0.6900
max_acc 0.9236 max_p 0.7117 max_r 0.6794 max_f1 0.6952

Average max cause: max_acc 0.8950 max_p 0.7808 max_r 0.3596 max_f1 0.4924
Average max pos: max_acc 0.9249 max_p 0.7333 max_r 0.6516 max_f1 0.6900

step 10: train loss 0.4159 
cause_predict: train acc 0.8872 p 0.8333 r 0.2703 f1 0.4082
position_predict: train acc 0.9572 p 0.8621 r 0.7812 f1 0.8197
step 20: train loss 0.5019 
cause_predict: train acc 0.8507 p 0.6667 r 0.3500 f1 0.4590
position_predict: train acc 0.9502 p 0.8387 r 0.8125 f1 0.8254
step 30: train loss 0.5046 
cause_predict: train acc 0.8853 p 0.7500 r 0.4865 f1 0.5902
position_predict: train acc 0.9128 p 0.7097 r 0.6875 f1 0.6984
step 40: train loss 0.4211 
cause_predict: train acc 0.8952 p 0.7391 r 0.4857 f1 0.5862
position_predict: train acc 0.9301 p 0.8077 r 0.6562 f1 0.7241
step 50: train loss 0.5493 
cause_predict: train acc 0.8770 p 0.7895 r 0.4412 f1 0.5660
position_predict: train acc 0.9091 p 0.8148 r 0.6471 f1 0.7213
step 60: train loss 0.4726 
cause_predict: train acc 0.8756 p 0.7391 r 0.4857 f1 0.5862
position_predict: train acc 0.9275 p 0.8519 r 0.6970 f1 0.7667
step 70: train loss 0.5420 
cause_predict: train acc 0.8970 p 0.8889 r 0.4211 f1 0.5714
position_predict: train acc 0.8927 p 0.6538 r 0.5152 f1 0.5763

epoch 3: test loss 0.4705 cost time: 12.5s

cause_predict: test acc 0.8959 p 0.7414 r 0.4069 f1 0.5255
max_acc 0.8959 max_p 0.7414 max_r 0.4069 max_f1 0.5255

position_predict: test acc 0.9209 p 0.7022 r 0.6655 f1 0.6834
max_acc 0.9236 max_p 0.7117 max_r 0.6794 max_f1 0.6952

Average max cause: max_acc 0.8959 max_p 0.7414 max_r 0.4069 max_f1 0.5255
Average max pos: max_acc 0.9209 max_p 0.7022 max_r 0.6655 max_f1 0.6834

step 10: train loss 0.3233 
cause_predict: train acc 0.9311 p 0.8947 r 0.4722 f1 0.6182
position_predict: train acc 0.9410 p 0.7333 r 0.6875 f1 0.7097
step 20: train loss 0.3099 
cause_predict: train acc 0.9541 p 0.8125 r 0.7647 f1 0.7879
position_predict: train acc 0.9607 p 0.8571 r 0.7500 f1 0.8000
step 30: train loss 0.3556 
cause_predict: train acc 0.9185 p 0.7500 r 0.5833 f1 0.6562
position_predict: train acc 0.9333 p 0.7419 r 0.6970 f1 0.7188
step 40: train loss 0.4046 
cause_predict: train acc 0.8921 p 0.6800 r 0.4359 f1 0.5312
position_predict: train acc 0.9388 p 0.7667 r 0.6970 f1 0.7302
step 50: train loss 0.4880 
cause_predict: train acc 0.8612 p 0.6552 r 0.5000 f1 0.5672
position_predict: train acc 0.9378 p 0.8571 r 0.7273 f1 0.7869
step 60: train loss 0.3859 
cause_predict: train acc 0.9167 p 0.8000 r 0.6250 f1 0.7018
position_predict: train acc 0.9608 p 0.9000 r 0.8438 f1 0.8710
step 70: train loss 0.4012 
cause_predict: train acc 0.8899 p 0.6800 r 0.5152 f1 0.5862
position_predict: train acc 0.9312 p 0.7931 r 0.7188 f1 0.7541

epoch 4: test loss 0.4716 cost time: 12.5s

cause_predict: test acc 0.8959 p 0.7079 r 0.4511 f1 0.5511
max_acc 0.8959 max_p 0.7079 max_r 0.4511 max_f1 0.5511

position_predict: test acc 0.9258 p 0.7373 r 0.6551 f1 0.6937
max_acc 0.9236 max_p 0.7117 max_r 0.6794 max_f1 0.6952

Average max cause: max_acc 0.8959 max_p 0.7079 max_r 0.4511 max_f1 0.5511
Average max pos: max_acc 0.9258 max_p 0.7373 max_r 0.6551 max_f1 0.6937

step 10: train loss 0.2646 
cause_predict: train acc 0.9560 p 0.8966 r 0.7429 f1 0.8125
position_predict: train acc 0.9304 p 0.7600 r 0.5938 f1 0.6667
step 20: train loss 0.3829 
cause_predict: train acc 0.8714 p 0.5897 r 0.6053 f1 0.5974
position_predict: train acc 0.9585 p 0.8235 r 0.8750 f1 0.8485
step 30: train loss 0.4410 
cause_predict: train acc 0.8933 p 0.6944 r 0.6098 f1 0.6494
position_predict: train acc 0.9209 p 0.6667 r 0.7500 f1 0.7059
step 40: train loss 0.2758 
cause_predict: train acc 0.9333 p 0.9231 r 0.6316 f1 0.7500
position_predict: train acc 0.9583 p 0.8333 r 0.8824 f1 0.8571
step 50: train loss 0.3550 
cause_predict: train acc 0.9013 p 0.7143 r 0.5882 f1 0.6452
position_predict: train acc 0.9507 p 0.8621 r 0.7812 f1 0.8197
step 60: train loss 0.3750 
cause_predict: train acc 0.9106 p 0.6923 r 0.4865 f1 0.5714
position_predict: train acc 0.9437 p 0.7419 r 0.7188 f1 0.7302
step 70: train loss 0.3212 
cause_predict: train acc 0.9321 p 0.7647 r 0.7222 f1 0.7429
position_predict: train acc 0.9358 p 0.7419 r 0.7188 f1 0.7302

epoch 5: test loss 0.4771 cost time: 12.7s

cause_predict: test acc 0.8914 p 0.6423 r 0.5268 f1 0.5789
max_acc 0.8914 max_p 0.6423 max_r 0.5268 max_f1 0.5789

position_predict: test acc 0.9258 p 0.7037 r 0.7282 f1 0.7158
max_acc 0.9258 max_p 0.7037 max_r 0.7282 max_f1 0.7158

Average max cause: max_acc 0.8914 max_p 0.6423 max_r 0.5268 max_f1 0.5789
Average max pos: max_acc 0.9258 max_p 0.7037 max_r 0.7282 max_f1 0.7158

step 10: train loss 0.3020 
cause_predict: train acc 0.9449 p 0.8387 r 0.7647 f1 0.8000
position_predict: train acc 0.9492 p 0.8333 r 0.7812 f1 0.8065
step 20: train loss 0.3043 
cause_predict: train acc 0.9174 p 0.7667 r 0.6571 f1 0.7077
position_predict: train acc 0.9739 p 0.9655 r 0.8485 f1 0.9032
step 30: train loss 0.2460 
cause_predict: train acc 0.9347 p 0.8889 r 0.6486 f1 0.7500
position_predict: train acc 0.9755 p 0.9062 r 0.9062 f1 0.9062
step 40: train loss 0.3781 
cause_predict: train acc 0.9250 p 0.8065 r 0.7353 f1 0.7692
position_predict: train acc 0.9200 p 0.7931 r 0.6970 f1 0.7419
step 50: train loss 0.2965 
cause_predict: train acc 0.9368 p 0.8000 r 0.7059 f1 0.7500
position_predict: train acc 0.9447 p 0.7812 r 0.7812 f1 0.7812
step 60: train loss 0.3430 
cause_predict: train acc 0.9130 p 0.6765 r 0.6765 f1 0.6765
position_predict: train acc 0.9447 p 0.8333 r 0.7353 f1 0.7812
step 70: train loss 0.3976 
cause_predict: train acc 0.9066 p 0.6667 r 0.6286 f1 0.6471
position_predict: train acc 0.9455 p 0.8000 r 0.7500 f1 0.7742

epoch 6: test loss 0.5079 cost time: 12.8s

cause_predict: test acc 0.8870 p 0.6119 r 0.5521 f1 0.5804
max_acc 0.8870 max_p 0.6119 max_r 0.5521 max_f1 0.5804

position_predict: test acc 0.9200 p 0.6875 r 0.6899 f1 0.6887
max_acc 0.9258 max_p 0.7037 max_r 0.7282 max_f1 0.7158

Average max cause: max_acc 0.8914 max_p 0.6423 max_r 0.5268 max_f1 0.5789
Average max pos: max_acc 0.9258 max_p 0.7037 max_r 0.7282 max_f1 0.7158

step 10: train loss 0.1962 
cause_predict: train acc 0.9692 p 1.0000 r 0.8000 f1 0.8889
position_predict: train acc 0.9780 p 0.9355 r 0.9062 f1 0.9206
step 20: train loss 0.2794 
cause_predict: train acc 0.9375 p 0.9412 r 0.7111 f1 0.8101
position_predict: train acc 0.9625 p 0.8966 r 0.8125 f1 0.8525
step 30: train loss 0.1745 
cause_predict: train acc 0.9419 p 0.8125 r 0.7429 f1 0.7761
position_predict: train acc 0.9767 p 0.8824 r 0.9375 f1 0.9091
step 40: train loss 0.2522 
cause_predict: train acc 0.9296 p 0.7429 r 0.7027 f1 0.7222
position_predict: train acc 0.9718 p 0.9062 r 0.8529 f1 0.8788
step 50: train loss 0.3422 
cause_predict: train acc 0.9286 p 0.8621 r 0.6944 f1 0.7692
position_predict: train acc 0.9429 p 0.7941 r 0.8438 f1 0.8182
step 60: train loss 0.1660 
cause_predict: train acc 0.9577 p 0.8667 r 0.7429 f1 0.8000
position_predict: train acc 0.9805 p 0.8824 r 0.9375 f1 0.9091
step 70: train loss 0.1830 
cause_predict: train acc 0.9375 p 0.8966 r 0.6842 f1 0.7761
position_predict: train acc 0.9833 p 0.9375 r 0.9375 f1 0.9375

epoch 7: test loss 0.5409 cost time: 12.8s

cause_predict: test acc 0.9008 p 0.7093 r 0.5079 f1 0.5919
max_acc 0.9008 max_p 0.7093 max_r 0.5079 max_f1 0.5919

position_predict: test acc 0.9223 p 0.6928 r 0.7073 f1 0.7000
max_acc 0.9258 max_p 0.7037 max_r 0.7282 max_f1 0.7158

Average max cause: max_acc 0.8914 max_p 0.6423 max_r 0.5268 max_f1 0.5789
Average max pos: max_acc 0.9258 max_p 0.7037 max_r 0.7282 max_f1 0.7158

step 10: train loss 0.2360 
cause_predict: train acc 0.9291 p 0.7714 r 0.7105 f1 0.7397
position_predict: train acc 0.9701 p 0.9000 r 0.8438 f1 0.8710
step 20: train loss 0.1741 
cause_predict: train acc 0.9596 p 0.9394 r 0.8378 f1 0.8857
position_predict: train acc 0.9697 p 0.9062 r 0.9062 f1 0.9062
step 30: train loss 0.2216 
cause_predict: train acc 0.9538 p 0.8485 r 0.8235 f1 0.8358
position_predict: train acc 0.9706 p 0.9062 r 0.8788 f1 0.8923
step 40: train loss 0.3216 
cause_predict: train acc 0.9398 p 0.8667 r 0.7429 f1 0.8000
position_predict: train acc 0.9352 p 0.7647 r 0.8125 f1 0.7879
step 50: train loss 0.1742 
cause_predict: train acc 0.9573 p 0.8333 r 0.8333 f1 0.8333
position_predict: train acc 0.9786 p 0.9333 r 0.8750 f1 0.9032
step 60: train loss 0.3368 
cause_predict: train acc 0.9305 p 0.8750 r 0.7568 f1 0.8116
position_predict: train acc 0.9305 p 0.8065 r 0.7812 f1 0.7937
step 70: train loss 0.2200 
cause_predict: train acc 0.9500 p 0.8421 r 0.8649 f1 0.8533
position_predict: train acc 0.9773 p 0.9655 r 0.8750 f1 0.9180

epoch 8: test loss 0.5711 cost time: 12.7s

cause_predict: test acc 0.8878 p 0.6260 r 0.5174 f1 0.5665
max_acc 0.9008 max_p 0.7093 max_r 0.5079 max_f1 0.5919

position_predict: test acc 0.9164 p 0.6825 r 0.6516 f1 0.6667
max_acc 0.9258 max_p 0.7037 max_r 0.7282 max_f1 0.7158

Average max cause: max_acc 0.8914 max_p 0.6423 max_r 0.5268 max_f1 0.5789
Average max pos: max_acc 0.9258 max_p 0.7037 max_r 0.7282 max_f1 0.7158

step 10: train loss 0.2421 
cause_predict: train acc 0.9609 p 0.8649 r 0.8889 f1 0.8767
position_predict: train acc 0.9478 p 0.8125 r 0.8125 f1 0.8125
step 20: train loss 0.1427 
cause_predict: train acc 0.9639 p 0.9211 r 0.8537 f1 0.8861
position_predict: train acc 0.9719 p 0.8788 r 0.9062 f1 0.8923
step 30: train loss 0.1678 
cause_predict: train acc 0.9591 p 0.8718 r 0.8947 f1 0.8831
position_predict: train acc 0.9818 p 0.9375 r 0.9375 f1 0.9375
step 40: train loss 0.1397 
cause_predict: train acc 0.9813 p 0.9429 r 0.9167 f1 0.9296
position_predict: train acc 0.9625 p 0.8438 r 0.8438 f1 0.8438
step 50: train loss 0.1301 
cause_predict: train acc 0.9682 p 0.9697 r 0.8421 f1 0.9014
position_predict: train acc 0.9818 p 0.9375 r 0.9375 f1 0.9375
step 60: train loss 0.1223 
cause_predict: train acc 0.9741 p 0.9429 r 0.8919 f1 0.9167
position_predict: train acc 0.9741 p 0.9091 r 0.9091 f1 0.9091
step 70: train loss 0.2026 
cause_predict: train acc 0.9612 p 0.9355 r 0.8056 f1 0.8657
position_predict: train acc 0.9569 p 0.8667 r 0.8125 f1 0.8387

epoch 9: test loss 0.6318 cost time: 13.0s

cause_predict: test acc 0.8874 p 0.6140 r 0.5521 f1 0.5814
max_acc 0.9008 max_p 0.7093 max_r 0.5079 max_f1 0.5919

position_predict: test acc 0.9182 p 0.6806 r 0.6829 f1 0.6817
max_acc 0.9258 max_p 0.7037 max_r 0.7282 max_f1 0.7158

Average max cause: max_acc 0.8914 max_p 0.6423 max_r 0.5268 max_f1 0.5789
Average max pos: max_acc 0.9258 max_p 0.7037 max_r 0.7282 max_f1 0.7158

step 10: train loss 0.1938 
cause_predict: train acc 0.9515 p 0.9062 r 0.7838 f1 0.8406
position_predict: train acc 0.9824 p 0.9667 r 0.9062 f1 0.9355
step 20: train loss 0.2138 
cause_predict: train acc 0.9540 p 0.8158 r 0.8857 f1 0.8493
position_predict: train acc 0.9665 p 0.9286 r 0.8125 f1 0.8667
step 30: train loss 0.0713 
cause_predict: train acc 0.9837 p 0.9118 r 0.9118 f1 0.9118
position_predict: train acc 0.9891 p 0.9118 r 0.9688 f1 0.9394
step 40: train loss 0.1929 
cause_predict: train acc 0.9708 p 0.9688 r 0.8857 f1 0.9254
position_predict: train acc 0.9591 p 0.8571 r 0.9375 f1 0.8955
step 50: train loss 0.2271 
cause_predict: train acc 0.9293 p 0.8158 r 0.8378 f1 0.8267
position_predict: train acc 0.9620 p 0.8378 r 0.9688 f1 0.8986
step 60: train loss 0.2669 
cause_predict: train acc 0.9327 p 0.8824 r 0.7500 f1 0.8108
position_predict: train acc 0.9471 p 0.8387 r 0.8125 f1 0.8254
step 70: train loss 0.3382 
cause_predict: train acc 0.9062 p 0.7931 r 0.6053 f1 0.6866
position_predict: train acc 0.9598 p 0.8710 r 0.8438 f1 0.8571

epoch 10: test loss 0.6373 cost time: 12.7s

cause_predict: test acc 0.8861 p 0.6131 r 0.5300 f1 0.5685
max_acc 0.9008 max_p 0.7093 max_r 0.5079 max_f1 0.5919

position_predict: test acc 0.9111 p 0.6571 r 0.6411 f1 0.6490
max_acc 0.9258 max_p 0.7037 max_r 0.7282 max_f1 0.7158

Average max cause: max_acc 0.8914 max_p 0.6423 max_r 0.5268 max_f1 0.5789
Average max pos: max_acc 0.9258 max_p 0.7037 max_r 0.7282 max_f1 0.7158

step 10: train loss 0.1198 
cause_predict: train acc 0.9806 p 0.9667 r 0.9062 f1 0.9355
position_predict: train acc 0.9903 p 0.9688 r 0.9688 f1 0.9688
step 20: train loss 0.0843 
cause_predict: train acc 0.9792 p 0.9118 r 0.8857 f1 0.8986
position_predict: train acc 0.9881 p 0.9375 r 0.9375 f1 0.9375
step 30: train loss 0.2012 
cause_predict: train acc 0.9630 p 0.8919 r 0.8684 f1 0.8800
position_predict: train acc 0.9547 p 0.8000 r 0.8750 f1 0.8358
step 40: train loss 0.1791 
cause_predict: train acc 0.9727 p 0.9706 r 0.8684 f1 0.9167
position_predict: train acc 0.9591 p 0.8750 r 0.8485 f1 0.8615
step 50: train loss 0.1978 
cause_predict: train acc 0.9593 p 0.8571 r 0.8824 f1 0.8696
position_predict: train acc 0.9638 p 0.8529 r 0.9062 f1 0.8788
step 60: train loss 0.1425 
cause_predict: train acc 0.9565 p 0.9032 r 0.8235 f1 0.8615
position_predict: train acc 0.9710 p 0.9062 r 0.9062 f1 0.9062
step 70: train loss 0.2217 
cause_predict: train acc 0.9526 p 0.9091 r 0.7895 f1 0.8451
position_predict: train acc 0.9526 p 0.8621 r 0.7812 f1 0.8197

epoch 11: test loss 0.6768 cost time: 12.8s

cause_predict: test acc 0.8968 p 0.6581 r 0.5647 f1 0.6078
max_acc 0.8968 max_p 0.6581 max_r 0.5647 max_f1 0.6078

position_predict: test acc 0.9196 p 0.7066 r 0.6376 f1 0.6703
max_acc 0.9258 max_p 0.7037 max_r 0.7282 max_f1 0.7158

Average max cause: max_acc 0.8914 max_p 0.6423 max_r 0.5268 max_f1 0.5789
Average max pos: max_acc 0.9258 max_p 0.7037 max_r 0.7282 max_f1 0.7158

step 10: train loss 0.2099 
cause_predict: train acc 0.9478 p 0.8049 r 0.8462 f1 0.8250
position_predict: train acc 0.9627 p 0.7895 r 0.9375 f1 0.8571
step 20: train loss 0.1610 
cause_predict: train acc 0.9707 p 0.9032 r 0.8750 f1 0.8889
position_predict: train acc 0.9707 p 0.8788 r 0.9062 f1 0.8923
step 30: train loss 0.1475 
cause_predict: train acc 0.9776 p 0.8974 r 0.9459 f1 0.9211
position_predict: train acc 0.9664 p 0.8710 r 0.8438 f1 0.8571
step 40: train loss 0.1437 
cause_predict: train acc 0.9585 p 0.8286 r 0.9062 f1 0.8657
position_predict: train acc 0.9816 p 0.9394 r 0.9394 f1 0.9394
step 50: train loss 0.1246 
cause_predict: train acc 0.9675 p 0.8889 r 0.8649 f1 0.8767
position_predict: train acc 0.9747 p 0.8788 r 0.9062 f1 0.8923
step 60: train loss 0.1610 
cause_predict: train acc 0.9741 p 0.8974 r 0.9459 f1 0.9211
position_predict: train acc 0.9655 p 0.8750 r 0.8750 f1 0.8750
step 70: train loss 0.1458 
cause_predict: train acc 0.9801 p 0.9062 r 0.9062 f1 0.9062
position_predict: train acc 0.9668 p 0.8438 r 0.8438 f1 0.8438

epoch 12: test loss 0.6768 cost time: 12.4s

cause_predict: test acc 0.8780 p 0.5679 r 0.5804 f1 0.5741
max_acc 0.8968 max_p 0.6581 max_r 0.5647 max_f1 0.6078

position_predict: test acc 0.9160 p 0.6645 r 0.6969 f1 0.6803
max_acc 0.9258 max_p 0.7037 max_r 0.7282 max_f1 0.7158

Average max cause: max_acc 0.8914 max_p 0.6423 max_r 0.5268 max_f1 0.5789
Average max pos: max_acc 0.9258 max_p 0.7037 max_r 0.7282 max_f1 0.7158

step 10: train loss 0.0972 
cause_predict: train acc 0.9874 p 0.9688 r 0.9394 f1 0.9538
position_predict: train acc 0.9748 p 0.9333 r 0.8750 f1 0.9032
step 20: train loss 0.1292 
cause_predict: train acc 0.9664 p 0.8750 r 0.8750 f1 0.8750
position_predict: train acc 0.9866 p 0.9375 r 0.9375 f1 0.9375
step 30: train loss 0.1163 
cause_predict: train acc 0.9754 p 0.9429 r 0.9167 f1 0.9296
position_predict: train acc 0.9803 p 0.9118 r 0.9688 f1 0.9394
step 40: train loss 0.1504 
cause_predict: train acc 0.9705 p 0.8857 r 0.9118 f1 0.8986
position_predict: train acc 0.9747 p 0.9062 r 0.9062 f1 0.9062
step 50: train loss 0.1251 
cause_predict: train acc 0.9807 p 0.9500 r 0.9500 f1 0.9500
position_predict: train acc 0.9710 p 0.9062 r 0.9062 f1 0.9062
step 60: train loss 0.0868 
cause_predict: train acc 0.9745 p 0.9091 r 0.9091 f1 0.9091
position_predict: train acc 0.9957 p 1.0000 r 0.9688 f1 0.9841
step 70: train loss 0.1001 
cause_predict: train acc 0.9841 p 0.8947 r 1.0000 f1 0.9444
position_predict: train acc 0.9762 p 0.9091 r 0.9091 f1 0.9091

epoch 13: test loss 0.7096 cost time: 12.6s

cause_predict: test acc 0.8816 p 0.5807 r 0.5899 f1 0.5853
max_acc 0.8968 max_p 0.6581 max_r 0.5647 max_f1 0.6078

position_predict: test acc 0.9178 p 0.6689 r 0.7108 f1 0.6892
max_acc 0.9258 max_p 0.7037 max_r 0.7282 max_f1 0.7158

Average max cause: max_acc 0.8914 max_p 0.6423 max_r 0.5268 max_f1 0.5789
Average max pos: max_acc 0.9258 max_p 0.7037 max_r 0.7282 max_f1 0.7158

step 10: train loss 0.0871 
cause_predict: train acc 0.9823 p 0.9737 r 0.9250 f1 0.9487
position_predict: train acc 0.9867 p 0.9677 r 0.9375 f1 0.9524
step 20: train loss 0.0663 
cause_predict: train acc 0.9859 p 0.9375 r 0.9375 f1 0.9375
position_predict: train acc 0.9894 p 0.9394 r 0.9688 f1 0.9538
step 30: train loss 0.1294 
cause_predict: train acc 0.9845 p 0.9459 r 0.9722 f1 0.9589
position_predict: train acc 0.9741 p 0.8857 r 0.9688 f1 0.9254
step 40: train loss 0.1248 
cause_predict: train acc 0.9771 p 0.9118 r 0.9118 f1 0.9118
position_predict: train acc 0.9695 p 0.8333 r 0.9375 f1 0.8824
step 50: train loss 0.1642 
cause_predict: train acc 0.9663 p 0.9394 r 0.8857 f1 0.9118
position_predict: train acc 0.9607 p 0.9355 r 0.8529 f1 0.8923
step 60: train loss 0.1565 
cause_predict: train acc 0.9649 p 0.8857 r 0.8857 f1 0.8857
position_predict: train acc 0.9781 p 0.9355 r 0.9062 f1 0.9206
step 70: train loss 0.1359 
cause_predict: train acc 0.9689 p 0.8857 r 0.8857 f1 0.8857
position_predict: train acc 0.9611 p 0.8485 r 0.8485 f1 0.8485

epoch 14: test loss 0.7143 cost time: 12.7s

cause_predict: test acc 0.8861 p 0.6047 r 0.5647 f1 0.5840
max_acc 0.8968 max_p 0.6581 max_r 0.5647 max_f1 0.6078

position_predict: test acc 0.9129 p 0.6597 r 0.6620 f1 0.6609
max_acc 0.9258 max_p 0.7037 max_r 0.7282 max_f1 0.7158

Average max cause: max_acc 0.8914 max_p 0.6423 max_r 0.5268 max_f1 0.5789
Average max pos: max_acc 0.9258 max_p 0.7037 max_r 0.7282 max_f1 0.7158

write pair_data/Ind_BiLSTM_1/fold_9_test.txt done
write pair_data/Ind_BiLSTM_1/fold_9_train.txt done
Optimization Finished!

############# fold 9 end ###############
############# fold 10 begin ###############
load data_file: data_combine_en/fold_10_train.txt
y_position.shape (2275, 75, 2)
y_cause.shape (2275, 75, 2)
x.shape (2275, 75, 30)
sen_len.shape (2275, 75)
doc_len.shape (2275,)
n_cut 107
load data done!

load data_file: data_combine_en/fold_10_test.txt
y_position.shape (284, 75, 2)
y_cause.shape (284, 75, 2)
x.shape (284, 75, 30)
sen_len.shape (284, 75)
doc_len.shape (284,)
n_cut 22
load data done!

train docs: 2275    test docs: 284
step 10: train loss 0.7269 
cause_predict: train acc 0.8841 p 0.0000 r 0.0000 f1 0.0000
position_predict: train acc 0.8907 p 0.0000 r 0.0000 f1 0.0000
step 20: train loss 0.6970 
cause_predict: train acc 0.8623 p 0.0000 r 0.0000 f1 0.0000
position_predict: train acc 0.8704 p 0.0000 r 0.0000 f1 0.0000
step 30: train loss 0.8418 
cause_predict: train acc 0.8051 p 0.0000 r 0.0000 f1 0.0000
position_predict: train acc 0.8359 p 0.0000 r 0.0000 f1 0.0000
step 40: train loss 0.5412 
cause_predict: train acc 0.8815 p 0.0000 r 0.0000 f1 0.0000
position_predict: train acc 0.8815 p 0.0000 r 0.0000 f1 0.0000
step 50: train loss 0.5550 
cause_predict: train acc 0.8577 p 1.0000 r 0.0250 f1 0.0488
position_predict: train acc 0.9088 p 0.7059 r 0.3750 f1 0.4898
step 60: train loss 0.5440 
cause_predict: train acc 0.8722 p 1.0000 r 0.0556 f1 0.1053
position_predict: train acc 0.9211 p 0.8333 r 0.4545 f1 0.5882
step 70: train loss 0.5433 
cause_predict: train acc 0.8795 p 1.0000 r 0.2059 f1 0.3415
position_predict: train acc 0.9196 p 0.8889 r 0.5000 f1 0.6400

epoch 0: test loss 0.5279 cost time: 12.9s

cause_predict: test acc 0.8749 p 0.8136 r 0.1514 f1 0.2553
max_acc 0.8749 max_p 0.8136 max_r 0.1514 max_f1 0.2553

position_predict: test acc 0.9138 p 0.6958 r 0.5819 f1 0.6338
max_acc 0.9138 max_p 0.6958 max_r 0.5819 max_f1 0.6338

Average max cause: max_acc 0.8749 max_p 0.8136 max_r 0.1514 max_f1 0.2553
Average max pos: max_acc 0.9138 max_p 0.6958 max_r 0.5819 max_f1 0.6338

step 10: train loss 0.5564 
cause_predict: train acc 0.8500 p 0.7500 r 0.2308 f1 0.3529
position_predict: train acc 0.9136 p 0.7097 r 0.6875 f1 0.6984
step 20: train loss 0.4347 
cause_predict: train acc 0.8825 p 0.3571 r 0.1429 f1 0.2041
position_predict: train acc 0.9367 p 0.6897 r 0.6250 f1 0.6557
step 30: train loss 0.5392 
cause_predict: train acc 0.8241 p 0.3333 r 0.0294 f1 0.0541
position_predict: train acc 0.9196 p 0.7576 r 0.7576 f1 0.7576
step 40: train loss 0.6036 
cause_predict: train acc 0.8645 p 0.6190 r 0.3824 f1 0.4727
position_predict: train acc 0.8972 p 0.6786 r 0.5938 f1 0.6333
step 50: train loss 0.4297 
cause_predict: train acc 0.8961 p 0.6471 r 0.3235 f1 0.4314
position_predict: train acc 0.9211 p 0.6774 r 0.6364 f1 0.6562
step 60: train loss 0.6603 
cause_predict: train acc 0.8400 p 0.7222 r 0.2955 f1 0.4194
position_predict: train acc 0.9289 p 0.8214 r 0.6765 f1 0.7419
step 70: train loss 0.4055 
cause_predict: train acc 0.9063 p 0.6667 r 0.3684 f1 0.4746
position_predict: train acc 0.9275 p 0.6333 r 0.5938 f1 0.6129

epoch 1: test loss 0.4806 cost time: 12.8s

cause_predict: test acc 0.8937 p 0.6965 r 0.4416 f1 0.5405
max_acc 0.8937 max_p 0.6965 max_r 0.4416 max_f1 0.5405

position_predict: test acc 0.9218 p 0.7029 r 0.6760 f1 0.6892
max_acc 0.9218 max_p 0.7029 max_r 0.6760 max_f1 0.6892

Average max cause: max_acc 0.8937 max_p 0.6965 max_r 0.4416 max_f1 0.5405
Average max pos: max_acc 0.9218 max_p 0.7029 max_r 0.6760 max_f1 0.6892

step 10: train loss 0.4271 
cause_predict: train acc 0.8901 p 0.6500 r 0.3514 f1 0.4561
position_predict: train acc 0.9326 p 0.7407 r 0.6250 f1 0.6780
step 20: train loss 0.4923 
cause_predict: train acc 0.8856 p 0.7391 r 0.4474 f1 0.5574
position_predict: train acc 0.9322 p 0.8333 r 0.6250 f1 0.7143
step 30: train loss 0.4342 
cause_predict: train acc 0.9087 p 0.7200 r 0.5294 f1 0.6102
position_predict: train acc 0.9048 p 0.6364 r 0.6364 f1 0.6364
step 40: train loss 0.5301 
cause_predict: train acc 0.8651 p 0.5278 r 0.5278 f1 0.5278
position_predict: train acc 0.9206 p 0.7241 r 0.6364 f1 0.6774
step 50: train loss 0.4449 
cause_predict: train acc 0.8955 p 0.9286 r 0.3250 f1 0.4815
position_predict: train acc 0.9328 p 0.7333 r 0.6875 f1 0.7097
step 60: train loss 0.4433 
cause_predict: train acc 0.8901 p 0.8182 r 0.5143 f1 0.6316
position_predict: train acc 0.9372 p 0.8125 r 0.8125 f1 0.8125
step 70: train loss 0.4601 
cause_predict: train acc 0.8696 p 0.6875 r 0.3333 f1 0.4490
position_predict: train acc 0.9469 p 0.8182 r 0.8438 f1 0.8308

epoch 2: test loss 0.4741 cost time: 12.5s

cause_predict: test acc 0.8865 p 0.7442 r 0.3028 f1 0.4305
max_acc 0.8937 max_p 0.6965 max_r 0.4416 max_f1 0.5405

position_predict: test acc 0.9263 p 0.7500 r 0.6376 f1 0.6893
max_acc 0.9263 max_p 0.7500 max_r 0.6376 max_f1 0.6893

Average max cause: max_acc 0.8937 max_p 0.6965 max_r 0.4416 max_f1 0.5405
Average max pos: max_acc 0.9218 max_p 0.7029 max_r 0.6760 max_f1 0.6892

step 10: train loss 0.3653 
cause_predict: train acc 0.9103 p 0.7826 r 0.5294 f1 0.6316
position_predict: train acc 0.9402 p 0.8214 r 0.7188 f1 0.7667
step 20: train loss 0.3715 
cause_predict: train acc 0.9052 p 0.8000 r 0.4706 f1 0.5926
position_predict: train acc 0.9655 p 1.0000 r 0.7500 f1 0.8571
step 30: train loss 0.3795 
cause_predict: train acc 0.9098 p 0.6786 r 0.5758 f1 0.6230
position_predict: train acc 0.9294 p 0.7419 r 0.6970 f1 0.7188
step 40: train loss 0.3005 
cause_predict: train acc 0.9298 p 0.8077 r 0.6364 f1 0.7119
position_predict: train acc 0.9628 p 0.8710 r 0.8438 f1 0.8571
step 50: train loss 0.4224 
cause_predict: train acc 0.9055 p 0.7500 r 0.4167 f1 0.5357
position_predict: train acc 0.9382 p 0.8000 r 0.6250 f1 0.7018
step 60: train loss 0.3954 
cause_predict: train acc 0.8933 p 0.6818 r 0.4286 f1 0.5263
position_predict: train acc 0.9209 p 0.6875 r 0.6875 f1 0.6875
step 70: train loss 0.4925 
cause_predict: train acc 0.8869 p 0.8667 r 0.3611 f1 0.5098
position_predict: train acc 0.9095 p 0.7308 r 0.5938 f1 0.6552

epoch 3: test loss 0.4753 cost time: 12.4s

cause_predict: test acc 0.8932 p 0.7321 r 0.3880 f1 0.5072
max_acc 0.8937 max_p 0.6965 max_r 0.4416 max_f1 0.5405

position_predict: test acc 0.9218 p 0.7044 r 0.6725 f1 0.6881
max_acc 0.9263 max_p 0.7500 max_r 0.6376 max_f1 0.6893

Average max cause: max_acc 0.8937 max_p 0.6965 max_r 0.4416 max_f1 0.5405
Average max pos: max_acc 0.9218 max_p 0.7029 max_r 0.6760 max_f1 0.6892

step 10: train loss 0.3339 
cause_predict: train acc 0.9184 p 0.7778 r 0.6000 f1 0.6774
position_predict: train acc 0.9469 p 0.8276 r 0.7500 f1 0.7869
step 20: train loss 0.3826 
cause_predict: train acc 0.8973 p 0.6071 r 0.5152 f1 0.5574
position_predict: train acc 0.9544 p 0.8333 r 0.7812 f1 0.8065
step 30: train loss 0.3092 
cause_predict: train acc 0.9048 p 0.6061 r 0.5714 f1 0.5882
position_predict: train acc 0.9592 p 0.8125 r 0.8125 f1 0.8125
step 40: train loss 0.3380 
cause_predict: train acc 0.9249 p 0.8214 r 0.6216 f1 0.7077
position_predict: train acc 0.9447 p 0.8000 r 0.7500 f1 0.7742
step 50: train loss 0.3727 
cause_predict: train acc 0.9134 p 0.7083 r 0.5000 f1 0.5862
position_predict: train acc 0.9278 p 0.6875 r 0.6875 f1 0.6875
step 60: train loss 0.3427 
cause_predict: train acc 0.9102 p 0.7407 r 0.5714 f1 0.6452
position_predict: train acc 0.9592 p 0.8929 r 0.7812 f1 0.8333
step 70: train loss 0.4240 
cause_predict: train acc 0.8939 p 0.7241 r 0.6176 f1 0.6667
position_predict: train acc 0.9141 p 0.7143 r 0.7812 f1 0.7463

epoch 4: test loss 0.5063 cost time: 12.3s

cause_predict: test acc 0.8914 p 0.6927 r 0.4196 f1 0.5226
max_acc 0.8937 max_p 0.6965 max_r 0.4416 max_f1 0.5405

position_predict: test acc 0.9227 p 0.6939 r 0.7108 f1 0.7022
max_acc 0.9227 max_p 0.6939 max_r 0.7108 max_f1 0.7022

Average max cause: max_acc 0.8937 max_p 0.6965 max_r 0.4416 max_f1 0.5405
Average max pos: max_acc 0.9218 max_p 0.7029 max_r 0.6760 max_f1 0.6892

step 10: train loss 0.3367 
cause_predict: train acc 0.9118 p 0.8000 r 0.6061 f1 0.6897
position_predict: train acc 0.9412 p 0.8846 r 0.7188 f1 0.7931
step 20: train loss 0.3158 
cause_predict: train acc 0.9224 p 0.9091 r 0.5556 f1 0.6897
position_predict: train acc 0.9569 p 0.8438 r 0.8438 f1 0.8438
step 30: train loss 0.4519 
cause_predict: train acc 0.9048 p 0.8333 r 0.3947 f1 0.5357
position_predict: train acc 0.9231 p 0.6875 r 0.6667 f1 0.6769
step 40: train loss 0.3957 
cause_predict: train acc 0.8893 p 0.6400 r 0.4324 f1 0.5161
position_predict: train acc 0.9410 p 0.7931 r 0.6970 f1 0.7419
step 50: train loss 0.2917 
cause_predict: train acc 0.9202 p 0.8261 r 0.5588 f1 0.6667
position_predict: train acc 0.9370 p 0.7742 r 0.7500 f1 0.7619
step 60: train loss 0.4016 
cause_predict: train acc 0.8927 p 0.7826 r 0.4390 f1 0.5625
position_predict: train acc 0.9310 p 0.7333 r 0.6875 f1 0.7097
step 70: train loss 0.4615 
cause_predict: train acc 0.9109 p 0.8333 r 0.5882 f1 0.6897
position_predict: train acc 0.9109 p 0.7273 r 0.7273 f1 0.7273

epoch 5: test loss 0.5048 cost time: 12.7s

cause_predict: test acc 0.8865 p 0.6413 r 0.4511 f1 0.5296
max_acc 0.8937 max_p 0.6965 max_r 0.4416 max_f1 0.5405

position_predict: test acc 0.9205 p 0.6764 r 0.7282 f1 0.7013
max_acc 0.9227 max_p 0.6939 max_r 0.7108 max_f1 0.7022

Average max cause: max_acc 0.8865 max_p 0.6413 max_r 0.4511 max_f1 0.5296
Average max pos: max_acc 0.9205 max_p 0.6764 max_r 0.7282 max_f1 0.7013

step 10: train loss 0.2366 
cause_predict: train acc 0.9495 p 0.8333 r 0.8571 f1 0.8451
position_predict: train acc 0.9679 p 0.8788 r 0.9062 f1 0.8923
step 20: train loss 0.3340 
cause_predict: train acc 0.9221 p 0.8000 r 0.6061 f1 0.6897
position_predict: train acc 0.9524 p 0.8889 r 0.7500 f1 0.8136
step 30: train loss 0.2400 
cause_predict: train acc 0.9530 p 0.8462 r 0.6667 f1 0.7458
position_predict: train acc 0.9718 p 0.8710 r 0.8438 f1 0.8571
step 40: train loss 0.2283 
cause_predict: train acc 0.9121 p 0.7778 r 0.5385 f1 0.6364
position_predict: train acc 0.9744 p 0.9310 r 0.8438 f1 0.8852
step 50: train loss 0.3227 
cause_predict: train acc 0.9351 p 0.9231 r 0.6486 f1 0.7619
position_predict: train acc 0.9351 p 0.8148 r 0.6875 f1 0.7458
step 60: train loss 0.2905 
cause_predict: train acc 0.9316 p 0.7857 r 0.6471 f1 0.7097
position_predict: train acc 0.9430 p 0.7576 r 0.7812 f1 0.7692
step 70: train loss 0.3058 
cause_predict: train acc 0.9268 p 0.7667 r 0.6765 f1 0.7188
position_predict: train acc 0.9512 p 0.8125 r 0.8125 f1 0.8125

epoch 6: test loss 0.5434 cost time: 12.5s

cause_predict: test acc 0.8785 p 0.5983 r 0.4322 f1 0.5018
max_acc 0.8937 max_p 0.6965 max_r 0.4416 max_f1 0.5405

position_predict: test acc 0.9169 p 0.6724 r 0.6864 f1 0.6793
max_acc 0.9227 max_p 0.6939 max_r 0.7108 max_f1 0.7022

Average max cause: max_acc 0.8865 max_p 0.6413 max_r 0.4511 max_f1 0.5296
Average max pos: max_acc 0.9205 max_p 0.6764 max_r 0.7282 max_f1 0.7013

step 10: train loss 0.1695 
cause_predict: train acc 0.9740 p 0.9412 r 0.8649 f1 0.9014
position_predict: train acc 0.9740 p 0.9032 r 0.8750 f1 0.8889
step 20: train loss 0.2007 
cause_predict: train acc 0.9537 p 0.8611 r 0.8611 f1 0.8611
position_predict: train acc 0.9583 p 0.9259 r 0.7812 f1 0.8475
step 30: train loss 0.2488 
cause_predict: train acc 0.9500 p 0.8529 r 0.8529 f1 0.8529
position_predict: train acc 0.9550 p 0.8710 r 0.8438 f1 0.8571
step 40: train loss 0.1721 
cause_predict: train acc 0.9594 p 0.9375 r 0.8333 f1 0.8824
position_predict: train acc 0.9898 p 0.9688 r 0.9688 f1 0.9688
step 50: train loss 0.2190 
cause_predict: train acc 0.9547 p 0.8788 r 0.8056 f1 0.8406
position_predict: train acc 0.9630 p 0.8485 r 0.8750 f1 0.8615
step 60: train loss 0.2876 
cause_predict: train acc 0.9252 p 0.7436 r 0.7632 f1 0.7532
position_predict: train acc 0.9488 p 0.8065 r 0.7812 f1 0.7937
step 70: train loss 0.3222 
cause_predict: train acc 0.9212 p 0.8571 r 0.6154 f1 0.7164
position_predict: train acc 0.9585 p 0.8966 r 0.7879 f1 0.8387

epoch 7: test loss 0.5532 cost time: 12.8s

cause_predict: test acc 0.8727 p 0.5506 r 0.5489 f1 0.5498
max_acc 0.8727 max_p 0.5506 max_r 0.5489 max_f1 0.5498

position_predict: test acc 0.9169 p 0.6935 r 0.6307 f1 0.6606
max_acc 0.9227 max_p 0.6939 max_r 0.7108 max_f1 0.7022

Average max cause: max_acc 0.8865 max_p 0.6413 max_r 0.4511 max_f1 0.5296
Average max pos: max_acc 0.9205 max_p 0.6764 max_r 0.7282 max_f1 0.7013

step 10: train loss 0.2345 
cause_predict: train acc 0.9259 p 0.8214 r 0.6389 f1 0.7187
position_predict: train acc 0.9753 p 0.9062 r 0.9062 f1 0.9062
step 20: train loss 0.2408 
cause_predict: train acc 0.9417 p 0.8966 r 0.7222 f1 0.8000
position_predict: train acc 0.9686 p 0.9032 r 0.8750 f1 0.8889
step 30: train loss 0.1690 
cause_predict: train acc 0.9609 p 0.8788 r 0.8529 f1 0.8657
position_predict: train acc 0.9783 p 0.9355 r 0.9062 f1 0.9206
step 40: train loss 0.2347 
cause_predict: train acc 0.9286 p 0.7838 r 0.7838 f1 0.7838
position_predict: train acc 0.9598 p 0.8485 r 0.8750 f1 0.8615
step 50: train loss 0.3314 
cause_predict: train acc 0.9247 p 0.8056 r 0.8056 f1 0.8056
position_predict: train acc 0.9570 p 0.8333 r 0.9375 f1 0.8824
step 60: train loss 0.2863 
cause_predict: train acc 0.9294 p 0.8485 r 0.8000 f1 0.8235
position_predict: train acc 0.9647 p 0.8611 r 0.9688 f1 0.9118
step 70: train loss 0.2321 
cause_predict: train acc 0.9295 p 0.8621 r 0.6757 f1 0.7576
position_predict: train acc 0.9648 p 0.8529 r 0.9062 f1 0.8788

epoch 8: test loss 0.6034 cost time: 12.8s

cause_predict: test acc 0.8856 p 0.6206 r 0.4953 f1 0.5509
max_acc 0.8856 max_p 0.6206 max_r 0.4953 max_f1 0.5509

position_predict: test acc 0.9191 p 0.6978 r 0.6516 f1 0.6739
max_acc 0.9227 max_p 0.6939 max_r 0.7108 max_f1 0.7022

Average max cause: max_acc 0.8865 max_p 0.6413 max_r 0.4511 max_f1 0.5296
Average max pos: max_acc 0.9205 max_p 0.6764 max_r 0.7282 max_f1 0.7013

step 10: train loss 0.1361 
cause_predict: train acc 0.9688 p 0.9091 r 0.8824 f1 0.8955
position_predict: train acc 0.9911 p 0.9697 r 0.9697 f1 0.9697
step 20: train loss 0.1682 
cause_predict: train acc 0.9518 p 0.7907 r 0.9189 f1 0.8500
position_predict: train acc 0.9639 p 0.8710 r 0.8438 f1 0.8571
step 30: train loss 0.1602 
cause_predict: train acc 0.9553 p 0.7907 r 0.8718 f1 0.8293
position_predict: train acc 0.9840 p 0.9355 r 0.9062 f1 0.9206
step 40: train loss 0.1676 
cause_predict: train acc 0.9610 p 0.8788 r 0.8788 f1 0.8788
position_predict: train acc 0.9756 p 0.9355 r 0.9062 f1 0.9206
step 50: train loss 0.1735 
cause_predict: train acc 0.9531 p 0.8788 r 0.8286 f1 0.8529
position_predict: train acc 0.9765 p 0.9375 r 0.9091 f1 0.9231
step 60: train loss 0.2171 
cause_predict: train acc 0.9588 p 0.8485 r 0.8485 f1 0.8485
position_predict: train acc 0.9465 p 0.8065 r 0.7812 f1 0.7937
step 70: train loss 0.1622 
cause_predict: train acc 0.9739 p 0.9394 r 0.8857 f1 0.9118
position_predict: train acc 0.9565 p 0.8485 r 0.8485 f1 0.8485

epoch 9: test loss 0.6525 cost time: 12.9s

cause_predict: test acc 0.8727 p 0.5497 r 0.5584 f1 0.5540
max_acc 0.8727 max_p 0.5497 max_r 0.5584 max_f1 0.5540

position_predict: test acc 0.9178 p 0.6859 r 0.6620 f1 0.6738
max_acc 0.9227 max_p 0.6939 max_r 0.7108 max_f1 0.7022

Average max cause: max_acc 0.8865 max_p 0.6413 max_r 0.4511 max_f1 0.5296
Average max pos: max_acc 0.9205 max_p 0.6764 max_r 0.7282 max_f1 0.7013

step 10: train loss 0.1399 
cause_predict: train acc 0.9688 p 0.9211 r 0.9211 f1 0.9211
position_predict: train acc 0.9740 p 0.9355 r 0.9062 f1 0.9206
step 20: train loss 0.1702 
cause_predict: train acc 0.9520 p 0.8293 r 0.8718 f1 0.8500
position_predict: train acc 0.9800 p 0.9355 r 0.9062 f1 0.9206
step 30: train loss 0.1360 
cause_predict: train acc 0.9630 p 0.8718 r 0.8947 f1 0.8831
position_predict: train acc 0.9753 p 0.9062 r 0.9062 f1 0.9062
step 40: train loss 0.1675 
cause_predict: train acc 0.9688 p 0.8788 r 0.9062 f1 0.8923
position_predict: train acc 0.9688 p 0.8788 r 0.9062 f1 0.8923
step 50: train loss 0.2467 
cause_predict: train acc 0.9447 p 0.8438 r 0.7500 f1 0.7941
position_predict: train acc 0.9605 p 0.8667 r 0.8125 f1 0.8387
step 60: train loss 0.2085 
cause_predict: train acc 0.9537 p 0.8571 r 0.7895 f1 0.8219
position_predict: train acc 0.9644 p 0.8438 r 0.8438 f1 0.8438
step 70: train loss 0.2163 
cause_predict: train acc 0.9541 p 0.8611 r 0.8611 f1 0.8611
position_predict: train acc 0.9725 p 0.9062 r 0.9062 f1 0.9062

epoch 10: test loss 0.6805 cost time: 13.0s

cause_predict: test acc 0.8713 p 0.5547 r 0.4637 f1 0.5052
max_acc 0.8727 max_p 0.5497 max_r 0.5584 max_f1 0.5540

position_predict: test acc 0.9151 p 0.6764 r 0.6481 f1 0.6619
max_acc 0.9227 max_p 0.6939 max_r 0.7108 max_f1 0.7022

Average max cause: max_acc 0.8865 max_p 0.6413 max_r 0.4511 max_f1 0.5296
Average max pos: max_acc 0.9205 max_p 0.6764 max_r 0.7282 max_f1 0.7013

step 10: train loss 0.0656 
cause_predict: train acc 0.9884 p 0.9714 r 0.9444 f1 0.9577
position_predict: train acc 0.9961 p 1.0000 r 0.9688 f1 0.9841
step 20: train loss 0.1382 
cause_predict: train acc 0.9732 p 0.8889 r 0.8889 f1 0.8889
position_predict: train acc 0.9766 p 0.9333 r 0.8485 f1 0.8889
step 30: train loss 0.1779 
cause_predict: train acc 0.9614 p 0.9688 r 0.8158 f1 0.8857
position_predict: train acc 0.9807 p 0.9375 r 0.9375 f1 0.9375
step 40: train loss 0.1705 
cause_predict: train acc 0.9604 p 0.9412 r 0.8421 f1 0.8889
position_predict: train acc 0.9554 p 0.8108 r 0.9375 f1 0.8696
step 50: train loss 0.1209 
cause_predict: train acc 0.9720 p 0.9062 r 0.8788 f1 0.8923
position_predict: train acc 0.9800 p 0.8889 r 0.9697 f1 0.9275
step 60: train loss 0.0942 
cause_predict: train acc 0.9857 p 0.9394 r 0.9394 f1 0.9394
position_predict: train acc 0.9928 p 0.9688 r 0.9688 f1 0.9688
step 70: train loss 0.2731 
cause_predict: train acc 0.9227 p 0.7778 r 0.7778 f1 0.7778
position_predict: train acc 0.9565 p 0.8485 r 0.8750 f1 0.8615

epoch 11: test loss 0.7272 cost time: 12.8s

cause_predict: test acc 0.8852 p 0.6145 r 0.5079 f1 0.5561
max_acc 0.8852 max_p 0.6145 max_r 0.5079 max_f1 0.5561

position_predict: test acc 0.9142 p 0.6715 r 0.6481 f1 0.6596
max_acc 0.9227 max_p 0.6939 max_r 0.7108 max_f1 0.7022

Average max cause: max_acc 0.8865 max_p 0.6413 max_r 0.4511 max_f1 0.5296
Average max pos: max_acc 0.9205 max_p 0.6764 max_r 0.7282 max_f1 0.7013

step 10: train loss 0.1051 
cause_predict: train acc 0.9846 p 0.9231 r 0.9730 f1 0.9474
position_predict: train acc 0.9807 p 0.9655 r 0.8750 f1 0.9180
step 20: train loss 0.1280 
cause_predict: train acc 0.9859 p 0.9722 r 0.9211 f1 0.9459
position_predict: train acc 0.9647 p 0.8286 r 0.8788 f1 0.8529
step 30: train loss 0.1001 
cause_predict: train acc 0.9797 p 0.8919 r 0.9429 f1 0.9167
position_predict: train acc 0.9831 p 0.9118 r 0.9394 f1 0.9254
step 40: train loss 0.1481 
cause_predict: train acc 0.9737 p 0.8529 r 0.9062 f1 0.8788
position_predict: train acc 0.9638 p 0.8621 r 0.7812 f1 0.8197
step 50: train loss 0.1229 
cause_predict: train acc 0.9716 p 0.9143 r 0.8649 f1 0.8889
position_predict: train acc 0.9858 p 0.9394 r 0.9394 f1 0.9394
step 60: train loss 0.1598 
cause_predict: train acc 0.9681 p 0.9000 r 0.9000 f1 0.9000
position_predict: train acc 0.9721 p 0.8571 r 0.9375 f1 0.8955
step 70: train loss 0.1206 
cause_predict: train acc 0.9761 p 0.9643 r 0.8438 f1 0.9000
position_predict: train acc 0.9880 p 0.9688 r 0.9394 f1 0.9538

epoch 12: test loss 0.7154 cost time: 12.4s

cause_predict: test acc 0.8767 p 0.5686 r 0.5363 f1 0.5519
max_acc 0.8852 max_p 0.6145 max_r 0.5079 max_f1 0.5561

position_predict: test acc 0.9196 p 0.6974 r 0.6585 f1 0.6774
max_acc 0.9227 max_p 0.6939 max_r 0.7108 max_f1 0.7022

Average max cause: max_acc 0.8865 max_p 0.6413 max_r 0.4511 max_f1 0.5296
Average max pos: max_acc 0.9205 max_p 0.6764 max_r 0.7282 max_f1 0.7013

step 10: train loss 0.1179 
cause_predict: train acc 0.9733 p 0.9677 r 0.8571 f1 0.9091
position_predict: train acc 0.9822 p 0.9394 r 0.9394 f1 0.9394
step 20: train loss 0.1364 
cause_predict: train acc 0.9769 p 0.8500 r 0.9714 f1 0.9067
position_predict: train acc 0.9769 p 0.8824 r 0.9091 f1 0.8955
step 30: train loss 0.1387 
cause_predict: train acc 0.9635 p 0.9394 r 0.8611 f1 0.8986
position_predict: train acc 0.9740 p 0.9118 r 0.9394 f1 0.9254
step 40: train loss 0.0706 
cause_predict: train acc 0.9857 p 0.9189 r 0.9714 f1 0.9444
position_predict: train acc 0.9857 p 0.9394 r 0.9394 f1 0.9394
step 50: train loss 0.1137 
cause_predict: train acc 0.9857 p 1.0000 r 0.9167 f1 0.9565
position_predict: train acc 0.9857 p 0.9394 r 0.9688 f1 0.9538
step 60: train loss 0.0897 
cause_predict: train acc 0.9865 p 0.9444 r 0.9444 f1 0.9444
position_predict: train acc 0.9966 p 1.0000 r 0.9688 f1 0.9841
step 70: train loss 0.1699 
cause_predict: train acc 0.9588 p 0.9167 r 0.8684 f1 0.8919
position_predict: train acc 0.9691 p 0.9062 r 0.9062 f1 0.9062

epoch 13: test loss 0.7478 cost time: 12.4s

cause_predict: test acc 0.8771 p 0.5734 r 0.5174 f1 0.5439
max_acc 0.8852 max_p 0.6145 max_r 0.5079 max_f1 0.5561

position_predict: test acc 0.9178 p 0.6900 r 0.6516 f1 0.6703
max_acc 0.9227 max_p 0.6939 max_r 0.7108 max_f1 0.7022

Average max cause: max_acc 0.8865 max_p 0.6413 max_r 0.4511 max_f1 0.5296
Average max pos: max_acc 0.9205 max_p 0.6764 max_r 0.7282 max_f1 0.7013

step 10: train loss 0.1164 
cause_predict: train acc 0.9877 p 0.9118 r 0.9688 f1 0.9394
position_predict: train acc 0.9631 p 0.8333 r 0.7812 f1 0.8065
step 20: train loss 0.0605 
cause_predict: train acc 0.9952 p 0.9714 r 1.0000 f1 0.9855
position_predict: train acc 0.9857 p 0.9677 r 0.9375 f1 0.9524
step 30: train loss 0.1501 
cause_predict: train acc 0.9549 p 0.8537 r 0.8537 f1 0.8537
position_predict: train acc 0.9812 p 0.9091 r 0.9375 f1 0.9231
step 40: train loss 0.1637 
cause_predict: train acc 0.9550 p 0.8919 r 0.8462 f1 0.8684
position_predict: train acc 0.9820 p 0.9375 r 0.9375 f1 0.9375
step 50: train loss 0.1541 
cause_predict: train acc 0.9552 p 0.8235 r 0.8750 f1 0.8485
position_predict: train acc 0.9776 p 0.8857 r 0.9688 f1 0.9254
step 60: train loss 0.1190 
cause_predict: train acc 0.9798 p 0.9459 r 0.9459 f1 0.9459
position_predict: train acc 0.9596 p 0.8750 r 0.8750 f1 0.8750
step 70: train loss 0.0710 
cause_predict: train acc 0.9841 p 0.9459 r 0.9459 f1 0.9459
position_predict: train acc 1.0000 p 1.0000 r 1.0000 f1 1.0000

epoch 14: test loss 0.7628 cost time: 12.6s

cause_predict: test acc 0.8865 p 0.6245 r 0.4984 f1 0.5544
max_acc 0.8852 max_p 0.6145 max_r 0.5079 max_f1 0.5561

position_predict: test acc 0.9147 p 0.6600 r 0.6899 f1 0.6746
max_acc 0.9227 max_p 0.6939 max_r 0.7108 max_f1 0.7022

Average max cause: max_acc 0.8865 max_p 0.6413 max_r 0.4511 max_f1 0.5296
Average max pos: max_acc 0.9205 max_p 0.6764 max_r 0.7282 max_f1 0.7013

write pair_data/Ind_BiLSTM_1/fold_10_test.txt done
write pair_data/Ind_BiLSTM_1/fold_10_train.txt done
Optimization Finished!

############# fold 10 end ###############


>>>>>>>>>>>>>>>>>>>>TRAINING INFO:

batch-32, lr-0.005, kb1-0.8, kb2-1.0, l2_reg-1e-05
training_iter-15, scope-Ind_BiLSTM_1


cause_predict: test f1 in 10 fold: [[0.5698324 ]
 [0.59173554]
 [0.57876712]
 [0.56834532]
 [0.56179775]
 [0.58727569]
 [0.60287081]
 [0.57385399]
 [0.57885615]
 [0.52962963]]
average : acc 0.8906 p 0.6425 r 0.5227 f1 0.5743

position_predict: test f1 in 10 fold: [[0.72443674]
 [0.70547945]
 [0.70181818]
 [0.68821293]
 [0.70054446]
 [0.67346939]
 [0.68077601]
 [0.69626998]
 [0.71575342]
 [0.70134228]]
average : acc 0.9235 p 0.7074 r 0.6923 f1 0.6988


----------2024-07-08 00:31:33----------

----------2024-07-08 00:31:34----------

load embedding...
w2v_file: data_en/w2v_200.txt
all_words: 14316 hit_words: 10987
embedding.shape: (14317, 200) embedding_pos.shape: (201, 50)
load embedding done!

build model...
build model done!



>>>>>>>>>>>>>>>>>>>>TRAINING INFO:

batch-32, lr-0.005, kb1-0.8, kb2-1.0, l2_reg-1e-05
training_iter-15, scope-Ind_BiLSTM_2

############# fold 1 begin ###############
load data_file: data_combine_en/fold_1_train.txt
y_position.shape (2275, 75, 2)
y_cause.shape (2275, 75, 2)
x.shape (2275, 75, 30)
sen_len.shape (2275, 75)
doc_len.shape (2275,)
n_cut 107
load data done!

load data_file: data_combine_en/fold_1_test.txt
y_position.shape (284, 75, 2)
y_cause.shape (284, 75, 2)
x.shape (284, 75, 30)
sen_len.shape (284, 75)
doc_len.shape (284,)
n_cut 22
load data done!

train docs: 2275    test docs: 284
step 10: train loss 0.8519 
cause_predict: train acc 0.8325 p 0.0000 r 0.0000 f1 0.0000
position_predict: train acc 0.8374 p 0.0000 r 0.0000 f1 0.0000
step 20: train loss 0.6986 
cause_predict: train acc 0.8622 p 0.0000 r 0.0000 f1 0.0000
position_predict: train acc 0.8740 p 0.0000 r 0.0000 f1 0.0000
step 30: train loss 0.6497 
cause_predict: train acc 0.8546 p 1.0000 r 0.0294 f1 0.0571
position_predict: train acc 0.8590 p 0.5000 r 0.0625 f1 0.1111
step 40: train loss 0.5928 
cause_predict: train acc 0.8583 p 0.0000 r 0.0000 f1 0.0000
position_predict: train acc 0.8792 p 0.5882 r 0.3125 f1 0.4082
step 50: train loss 0.5562 
cause_predict: train acc 0.8647 p 1.0000 r 0.0526 f1 0.1000
position_predict: train acc 0.9060 p 0.6061 r 0.6250 f1 0.6154
step 60: train loss 0.5262 
cause_predict: train acc 0.8889 p 1.0000 r 0.0833 f1 0.1538
position_predict: train acc 0.9259 p 0.7273 r 0.5000 f1 0.5926
step 70: train loss 0.6557 
cause_predict: train acc 0.8379 p 0.5000 r 0.1220 f1 0.1961
position_predict: train acc 0.9091 p 0.7083 r 0.5152 f1 0.5965

epoch 0: test loss 0.5143 cost time: 14.5s

cause_predict: test acc 0.8852 p 0.7055 r 0.3249 f1 0.4449
max_acc 0.8852 max_p 0.7055 max_r 0.3249 max_f1 0.4449

position_predict: test acc 0.9164 p 0.6825 r 0.6516 f1 0.6667
max_acc 0.9164 max_p 0.6825 max_r 0.6516 max_f1 0.6667

Average max cause: max_acc 0.8852 max_p 0.7055 max_r 0.3249 max_f1 0.4449
Average max pos: max_acc 0.9164 max_p 0.6825 max_r 0.6516 max_f1 0.6667

step 10: train loss 0.5913 
cause_predict: train acc 0.8449 p 0.6000 r 0.2195 f1 0.3214
position_predict: train acc 0.8857 p 0.5769 r 0.4688 f1 0.5172
step 20: train loss 0.5388 
cause_predict: train acc 0.8831 p 0.6400 r 0.4706 f1 0.5424
position_predict: train acc 0.9177 p 0.6970 r 0.7188 f1 0.7077
step 30: train loss 0.4729 
cause_predict: train acc 0.8784 p 0.7143 r 0.3030 f1 0.4255
position_predict: train acc 0.9234 p 0.7586 r 0.6875 f1 0.7213
step 40: train loss 0.5273 
cause_predict: train acc 0.8675 p 0.5882 r 0.2941 f1 0.3922
position_predict: train acc 0.9188 p 0.8095 r 0.5312 f1 0.6415
step 50: train loss 0.5022 
cause_predict: train acc 0.8638 p 0.7143 r 0.2632 f1 0.3846
position_predict: train acc 0.9064 p 0.7083 r 0.5312 f1 0.6071
step 60: train loss 0.4205 
cause_predict: train acc 0.8869 p 0.8571 r 0.3429 f1 0.4898
position_predict: train acc 0.9457 p 0.8846 r 0.7188 f1 0.7931
step 70: train loss 0.5655 
cause_predict: train acc 0.8780 p 0.7143 r 0.2703 f1 0.3922
position_predict: train acc 0.9094 p 0.6800 r 0.5312 f1 0.5965

epoch 1: test loss 0.4938 cost time: 12.5s

cause_predict: test acc 0.8919 p 0.7246 r 0.3817 f1 0.5000
max_acc 0.8919 max_p 0.7246 max_r 0.3817 max_f1 0.5000

position_predict: test acc 0.9155 p 0.7008 r 0.5958 f1 0.6441
max_acc 0.9164 max_p 0.6825 max_r 0.6516 max_f1 0.6667

Average max cause: max_acc 0.8919 max_p 0.7246 max_r 0.3817 max_f1 0.5000
Average max pos: max_acc 0.9155 max_p 0.7008 max_r 0.5958 max_f1 0.6441

step 10: train loss 0.5291 
cause_predict: train acc 0.8816 p 0.6667 r 0.3889 f1 0.4912
position_predict: train acc 0.9102 p 0.6923 r 0.5625 f1 0.6207
step 20: train loss 0.4439 
cause_predict: train acc 0.8901 p 0.6923 r 0.2571 f1 0.3750
position_predict: train acc 0.9377 p 0.7778 r 0.6562 f1 0.7119
step 30: train loss 0.4689 
cause_predict: train acc 0.8803 p 0.5909 r 0.3421 f1 0.4333
position_predict: train acc 0.9331 p 0.7826 r 0.5625 f1 0.6545
step 40: train loss 0.4622 
cause_predict: train acc 0.8707 p 0.6667 r 0.4211 f1 0.5161
position_predict: train acc 0.9483 p 1.0000 r 0.6250 f1 0.7692
step 50: train loss 0.4752 
cause_predict: train acc 0.8984 p 0.7000 r 0.4118 f1 0.5185
position_predict: train acc 0.9180 p 0.6774 r 0.6562 f1 0.6667
step 60: train loss 0.4627 
cause_predict: train acc 0.8889 p 0.7619 r 0.4571 f1 0.5714
position_predict: train acc 0.9306 p 0.7812 r 0.7576 f1 0.7692
step 70: train loss 0.4850 
cause_predict: train acc 0.8787 p 0.6923 r 0.2368 f1 0.3529
position_predict: train acc 0.9081 p 0.6061 r 0.6250 f1 0.6154

epoch 2: test loss 0.4715 cost time: 12.6s

cause_predict: test acc 0.8950 p 0.7595 r 0.3785 f1 0.5053
max_acc 0.8950 max_p 0.7595 max_r 0.3785 max_f1 0.5053

position_predict: test acc 0.9240 p 0.7448 r 0.6202 f1 0.6768
max_acc 0.9240 max_p 0.7448 max_r 0.6202 max_f1 0.6768

Average max cause: max_acc 0.8950 max_p 0.7595 max_r 0.3785 max_f1 0.5053
Average max pos: max_acc 0.9240 max_p 0.7448 max_r 0.6202 max_f1 0.6768

step 10: train loss 0.3844 
cause_predict: train acc 0.9161 p 0.7143 r 0.4412 f1 0.5455
position_predict: train acc 0.9430 p 0.7586 r 0.6875 f1 0.7213
step 20: train loss 0.4837 
cause_predict: train acc 0.8788 p 0.6765 r 0.6389 f1 0.6571
position_predict: train acc 0.9192 p 0.8148 r 0.6667 f1 0.7333
step 30: train loss 0.4865 
cause_predict: train acc 0.8656 p 0.7200 r 0.4000 f1 0.5143
position_predict: train acc 0.9486 p 0.7879 r 0.8125 f1 0.8000
step 40: train loss 0.5141 
cause_predict: train acc 0.8658 p 0.6296 r 0.4474 f1 0.5231
position_predict: train acc 0.9307 p 0.7500 r 0.7500 f1 0.7500
step 50: train loss 0.4006 
cause_predict: train acc 0.8798 p 0.8571 r 0.3429 f1 0.4898
position_predict: train acc 0.9471 p 0.8889 r 0.7500 f1 0.8136
step 60: train loss 0.4971 
cause_predict: train acc 0.8699 p 0.5500 r 0.2750 f1 0.3667
position_predict: train acc 0.9315 p 0.7143 r 0.6250 f1 0.6667
step 70: train loss 0.4662 
cause_predict: train acc 0.8632 p 0.6087 r 0.4118 f1 0.4912
position_predict: train acc 0.9292 p 0.7931 r 0.7188 f1 0.7541

epoch 3: test loss 0.4837 cost time: 12.4s

cause_predict: test acc 0.8892 p 0.7091 r 0.3691 f1 0.4855
max_acc 0.8950 max_p 0.7595 max_r 0.3785 max_f1 0.5053

position_predict: test acc 0.9249 p 0.7429 r 0.6341 f1 0.6842
max_acc 0.9249 max_p 0.7429 max_r 0.6341 max_f1 0.6842

Average max cause: max_acc 0.8950 max_p 0.7595 max_r 0.3785 max_f1 0.5053
Average max pos: max_acc 0.9240 max_p 0.7448 max_r 0.6202 max_f1 0.6768

step 10: train loss 0.3088 
cause_predict: train acc 0.9273 p 0.8000 r 0.7059 f1 0.7500
position_predict: train acc 0.9455 p 0.8621 r 0.7576 f1 0.8065
step 20: train loss 0.2682 
cause_predict: train acc 0.9455 p 0.9200 r 0.6970 f1 0.7931
position_predict: train acc 0.9682 p 0.9310 r 0.8438 f1 0.8852
step 30: train loss 0.4766 
cause_predict: train acc 0.8725 p 0.6250 r 0.3333 f1 0.4348
position_predict: train acc 0.9608 p 0.8333 r 0.7812 f1 0.8065
step 40: train loss 0.2975 
cause_predict: train acc 0.9500 p 0.9600 r 0.6857 f1 0.8000
position_predict: train acc 0.9500 p 0.8333 r 0.7812 f1 0.8065
step 50: train loss 0.4079 
cause_predict: train acc 0.8879 p 0.8000 r 0.4444 f1 0.5714
position_predict: train acc 0.9252 p 0.7500 r 0.7500 f1 0.7500
step 60: train loss 0.4217 
cause_predict: train acc 0.9212 p 0.8333 r 0.5714 f1 0.6780
position_predict: train acc 0.9544 p 0.9600 r 0.7059 f1 0.8136
step 70: train loss 0.3313 
cause_predict: train acc 0.8986 p 0.9091 r 0.5000 f1 0.6452
position_predict: train acc 0.9724 p 0.8824 r 0.9375 f1 0.9091

epoch 4: test loss 0.4766 cost time: 12.5s

cause_predict: test acc 0.8919 p 0.7119 r 0.3975 f1 0.5101
max_acc 0.8919 max_p 0.7119 max_r 0.3975 max_f1 0.5101

position_predict: test acc 0.9285 p 0.7244 r 0.7143 f1 0.7193
max_acc 0.9285 max_p 0.7244 max_r 0.7143 max_f1 0.7193

Average max cause: max_acc 0.8919 max_p 0.7119 max_r 0.3975 max_f1 0.5101
Average max pos: max_acc 0.9285 max_p 0.7244 max_r 0.7143 max_f1 0.7193

step 10: train loss 0.3598 
cause_predict: train acc 0.9107 p 0.7778 r 0.6000 f1 0.6774
position_predict: train acc 0.9554 p 0.8929 r 0.7812 f1 0.8333
step 20: train loss 0.3277 
cause_predict: train acc 0.9266 p 0.8333 r 0.5714 f1 0.6780
position_predict: train acc 0.9498 p 0.8333 r 0.7576 f1 0.7937
step 30: train loss 0.3125 
cause_predict: train acc 0.9237 p 0.7931 r 0.6216 f1 0.6970
position_predict: train acc 0.9542 p 0.7778 r 0.8750 f1 0.8235
step 40: train loss 0.3037 
cause_predict: train acc 0.9364 p 0.8929 r 0.6944 f1 0.7812
position_predict: train acc 0.9318 p 0.8000 r 0.7273 f1 0.7619
step 50: train loss 0.3965 
cause_predict: train acc 0.8819 p 0.7222 r 0.3611 f1 0.4815
position_predict: train acc 0.9494 p 0.8333 r 0.7812 f1 0.8065
step 60: train loss 0.3013 
cause_predict: train acc 0.9176 p 0.7586 r 0.5946 f1 0.6667
position_predict: train acc 0.9551 p 0.8571 r 0.7500 f1 0.8000
step 70: train loss 0.4513 
cause_predict: train acc 0.8475 p 0.6250 r 0.4545 f1 0.5263
position_predict: train acc 0.9237 p 0.7419 r 0.6970 f1 0.7188

epoch 5: test loss 0.4927 cost time: 12.5s

cause_predict: test acc 0.8896 p 0.6411 r 0.5016 f1 0.5628
max_acc 0.8896 max_p 0.6411 max_r 0.5016 max_f1 0.5628

position_predict: test acc 0.9254 p 0.7344 r 0.6551 f1 0.6924
max_acc 0.9285 max_p 0.7244 max_r 0.7143 max_f1 0.7193

Average max cause: max_acc 0.8896 max_p 0.6411 max_r 0.5016 max_f1 0.5628
Average max pos: max_acc 0.9254 max_p 0.7344 max_r 0.6551 max_f1 0.6924

step 10: train loss 0.2613 
cause_predict: train acc 0.9269 p 0.7586 r 0.6471 f1 0.6984
position_predict: train acc 0.9615 p 0.8667 r 0.8125 f1 0.8387
step 20: train loss 0.2595 
cause_predict: train acc 0.9431 p 0.8276 r 0.7273 f1 0.7742
position_predict: train acc 0.9593 p 0.8667 r 0.8125 f1 0.8387
step 30: train loss 0.3002 
cause_predict: train acc 0.9212 p 0.7647 r 0.7647 f1 0.7647
position_predict: train acc 0.9360 p 0.8065 r 0.7812 f1 0.7937
step 40: train loss 0.3002 
cause_predict: train acc 0.9377 p 0.8276 r 0.6857 f1 0.7500
position_predict: train acc 0.9416 p 0.8000 r 0.7273 f1 0.7619
step 50: train loss 0.3122 
cause_predict: train acc 0.9385 p 0.8000 r 0.7059 f1 0.7500
position_predict: train acc 0.9462 p 0.8065 r 0.7576 f1 0.7812
step 60: train loss 0.3376 
cause_predict: train acc 0.9000 p 0.7097 r 0.5500 f1 0.6197
position_predict: train acc 0.9444 p 0.7647 r 0.7879 f1 0.7761
step 70: train loss 0.3911 
cause_predict: train acc 0.9018 p 0.7647 r 0.6500 f1 0.7027
position_predict: train acc 0.9420 p 0.7879 r 0.8125 f1 0.8000

epoch 6: test loss 0.5152 cost time: 12.4s

cause_predict: test acc 0.8829 p 0.6022 r 0.5110 f1 0.5529
max_acc 0.8896 max_p 0.6411 max_r 0.5016 max_f1 0.5628

position_predict: test acc 0.9223 p 0.7100 r 0.6655 f1 0.6871
max_acc 0.9285 max_p 0.7244 max_r 0.7143 max_f1 0.7193

Average max cause: max_acc 0.8896 max_p 0.6411 max_r 0.5016 max_f1 0.5628
Average max pos: max_acc 0.9254 max_p 0.7344 max_r 0.6551 max_f1 0.6924

step 10: train loss 0.2335 
cause_predict: train acc 0.9544 p 0.9000 r 0.7714 f1 0.8308
position_predict: train acc 0.9544 p 0.8182 r 0.8438 f1 0.8308
step 20: train loss 0.2389 
cause_predict: train acc 0.9514 p 0.8611 r 0.8857 f1 0.8732
position_predict: train acc 0.9514 p 0.8966 r 0.8125 f1 0.8525
step 30: train loss 0.2744 
cause_predict: train acc 0.9453 p 0.8235 r 0.7568 f1 0.7887
position_predict: train acc 0.9672 p 0.8710 r 0.8438 f1 0.8571
step 40: train loss 0.3071 
cause_predict: train acc 0.9603 p 0.8966 r 0.7647 f1 0.8254
position_predict: train acc 0.9458 p 0.8750 r 0.6364 f1 0.7368
step 50: train loss 0.2309 
cause_predict: train acc 0.9441 p 0.8636 r 0.5758 f1 0.6909
position_predict: train acc 0.9737 p 0.8750 r 0.8750 f1 0.8750
step 60: train loss 0.2165 
cause_predict: train acc 0.9574 p 0.8485 r 0.8235 f1 0.8358
position_predict: train acc 0.9651 p 0.9000 r 0.8182 f1 0.8571
step 70: train loss 0.3236 
cause_predict: train acc 0.9367 p 0.8000 r 0.7778 f1 0.7887
position_predict: train acc 0.9409 p 0.7647 r 0.8125 f1 0.7879

epoch 7: test loss 0.5409 cost time: 12.3s

cause_predict: test acc 0.8892 p 0.6375 r 0.5047 f1 0.5634
max_acc 0.8892 max_p 0.6375 max_r 0.5047 max_f1 0.5634

position_predict: test acc 0.9187 p 0.6804 r 0.6899 f1 0.6851
max_acc 0.9285 max_p 0.7244 max_r 0.7143 max_f1 0.7193

Average max cause: max_acc 0.8896 max_p 0.6411 max_r 0.5016 max_f1 0.5628
Average max pos: max_acc 0.9254 max_p 0.7344 max_r 0.6551 max_f1 0.6924

step 10: train loss 0.3076 
cause_predict: train acc 0.9115 p 0.7609 r 0.8537 f1 0.8046
position_predict: train acc 0.9688 p 0.9062 r 0.9062 f1 0.9062
step 20: train loss 0.2044 
cause_predict: train acc 0.9278 p 0.8333 r 0.7353 f1 0.7812
position_predict: train acc 0.9794 p 0.9394 r 0.9394 f1 0.9394
step 30: train loss 0.2187 
cause_predict: train acc 0.9668 p 0.9189 r 0.8718 f1 0.8947
position_predict: train acc 0.9544 p 0.8387 r 0.8125 f1 0.8254
step 40: train loss 0.2360 
cause_predict: train acc 0.9544 p 0.9032 r 0.7568 f1 0.8235
position_predict: train acc 0.9582 p 0.8438 r 0.8182 f1 0.8308
step 50: train loss 0.3045 
cause_predict: train acc 0.9391 p 0.9000 r 0.7105 f1 0.7941
position_predict: train acc 0.9478 p 0.8333 r 0.7812 f1 0.8065
step 60: train loss 0.3233 
cause_predict: train acc 0.9262 p 0.7500 r 0.7059 f1 0.7273
position_predict: train acc 0.9467 p 0.8125 r 0.7879 f1 0.8000
step 70: train loss 0.2643 
cause_predict: train acc 0.9442 p 0.8421 r 0.8205 f1 0.8312
position_predict: train acc 0.9657 p 0.9310 r 0.8182 f1 0.8710

epoch 8: test loss 0.5655 cost time: 12.2s

cause_predict: test acc 0.8780 p 0.5724 r 0.5489 f1 0.5604
max_acc 0.8892 max_p 0.6375 max_r 0.5047 max_f1 0.5634

position_predict: test acc 0.9223 p 0.6996 r 0.6899 f1 0.6947
max_acc 0.9285 max_p 0.7244 max_r 0.7143 max_f1 0.7193

Average max cause: max_acc 0.8896 max_p 0.6411 max_r 0.5016 max_f1 0.5628
Average max pos: max_acc 0.9254 max_p 0.7344 max_r 0.6551 max_f1 0.6924

step 10: train loss 0.1791 
cause_predict: train acc 0.9689 p 0.8750 r 0.8750 f1 0.8750
position_predict: train acc 0.9650 p 0.8710 r 0.8438 f1 0.8571
step 20: train loss 0.1965 
cause_predict: train acc 0.9420 p 0.9091 r 0.7692 f1 0.8333
position_predict: train acc 0.9758 p 0.9655 r 0.8750 f1 0.9180
step 30: train loss 0.1985 
cause_predict: train acc 0.9828 p 0.9167 r 0.9706 f1 0.9429
position_predict: train acc 0.9614 p 0.8485 r 0.8750 f1 0.8615
step 40: train loss 0.2118 
cause_predict: train acc 0.9414 p 0.7941 r 0.7714 f1 0.7826
position_predict: train acc 0.9727 p 0.9062 r 0.8788 f1 0.8923
step 50: train loss 0.1485 
cause_predict: train acc 0.9747 p 0.9412 r 0.8649 f1 0.9014
position_predict: train acc 0.9711 p 0.8333 r 0.9375 f1 0.8824
step 60: train loss 0.1789 
cause_predict: train acc 0.9729 p 0.8710 r 0.8438 f1 0.8571
position_predict: train acc 0.9608 p 0.8065 r 0.7812 f1 0.7937
step 70: train loss 0.2126 
cause_predict: train acc 0.9410 p 0.7879 r 0.7027 f1 0.7429
position_predict: train acc 0.9705 p 0.8529 r 0.8788 f1 0.8657

epoch 9: test loss 0.6365 cost time: 12.7s

cause_predict: test acc 0.8731 p 0.5514 r 0.5584 f1 0.5549
max_acc 0.8892 max_p 0.6375 max_r 0.5047 max_f1 0.5634

position_predict: test acc 0.9138 p 0.6691 r 0.6481 f1 0.6584
max_acc 0.9285 max_p 0.7244 max_r 0.7143 max_f1 0.7193

Average max cause: max_acc 0.8896 max_p 0.6411 max_r 0.5016 max_f1 0.5628
Average max pos: max_acc 0.9254 max_p 0.7344 max_r 0.6551 max_f1 0.6924

step 10: train loss 0.1489 
cause_predict: train acc 0.9614 p 0.8846 r 0.6970 f1 0.7797
position_predict: train acc 0.9674 p 0.8621 r 0.7812 f1 0.8197
step 20: train loss 0.2174 
cause_predict: train acc 0.9553 p 0.8333 r 0.8571 f1 0.8451
position_predict: train acc 0.9634 p 0.8485 r 0.8750 f1 0.8615
step 30: train loss 0.1304 
cause_predict: train acc 0.9836 p 1.0000 r 0.9167 f1 0.9565
position_predict: train acc 0.9836 p 0.9677 r 0.9375 f1 0.9524
step 40: train loss 0.1584 
cause_predict: train acc 0.9607 p 0.8889 r 0.8205 f1 0.8533
position_predict: train acc 0.9750 p 0.8571 r 0.9375 f1 0.8955
step 50: train loss 0.1527 
cause_predict: train acc 0.9706 p 0.8718 r 0.9444 f1 0.9067
position_predict: train acc 0.9664 p 0.9355 r 0.8286 f1 0.8788
step 60: train loss 0.1884 
cause_predict: train acc 0.9638 p 0.8824 r 0.8824 f1 0.8824
position_predict: train acc 0.9638 p 0.9032 r 0.8485 f1 0.8750
step 70: train loss 0.2286 
cause_predict: train acc 0.9655 p 0.9091 r 0.8824 f1 0.8955
position_predict: train acc 0.9606 p 0.8750 r 0.8750 f1 0.8750

epoch 10: test loss 0.6629 cost time: 12.0s

cause_predict: test acc 0.8820 p 0.5943 r 0.5268 f1 0.5585
max_acc 0.8892 max_p 0.6375 max_r 0.5047 max_f1 0.5634

position_predict: test acc 0.9124 p 0.6542 r 0.6725 f1 0.6632
max_acc 0.9285 max_p 0.7244 max_r 0.7143 max_f1 0.7193

Average max cause: max_acc 0.8896 max_p 0.6411 max_r 0.5016 max_f1 0.5628
Average max pos: max_acc 0.9254 max_p 0.7344 max_r 0.6551 max_f1 0.6924

step 10: train loss 0.0750 
cause_predict: train acc 0.9874 p 0.9730 r 0.9474 f1 0.9600
position_predict: train acc 1.0000 p 1.0000 r 1.0000 f1 1.0000
step 20: train loss 0.0950 
cause_predict: train acc 0.9783 p 0.9677 r 0.8824 f1 0.9231
position_predict: train acc 0.9913 p 0.9412 r 1.0000 f1 0.9697
step 30: train loss 0.1983 
cause_predict: train acc 0.9693 p 0.8810 r 0.9487 f1 0.9136
position_predict: train acc 0.9649 p 0.8750 r 0.8750 f1 0.8750
step 40: train loss 0.1790 
cause_predict: train acc 0.9655 p 0.8889 r 0.9143 f1 0.9014
position_predict: train acc 0.9655 p 0.9062 r 0.8788 f1 0.8923
step 50: train loss 0.1156 
cause_predict: train acc 0.9740 p 0.9091 r 0.8824 f1 0.8955
position_predict: train acc 0.9777 p 0.9062 r 0.9062 f1 0.9062
step 60: train loss 0.2383 
cause_predict: train acc 0.9742 p 0.9318 r 0.9535 f1 0.9425
position_predict: train acc 0.9330 p 0.8387 r 0.7647 f1 0.8000
step 70: train loss 0.1641 
cause_predict: train acc 0.9423 p 0.8125 r 0.8125 f1 0.8125
position_predict: train acc 0.9712 p 0.9062 r 0.9062 f1 0.9062

epoch 11: test loss 0.7037 cost time: 12.4s

cause_predict: test acc 0.8816 p 0.5956 r 0.5110 f1 0.5501
max_acc 0.8892 max_p 0.6375 max_r 0.5047 max_f1 0.5634

position_predict: test acc 0.9147 p 0.6655 r 0.6725 f1 0.6690
max_acc 0.9285 max_p 0.7244 max_r 0.7143 max_f1 0.7193

Average max cause: max_acc 0.8896 max_p 0.6411 max_r 0.5016 max_f1 0.5628
Average max pos: max_acc 0.9254 max_p 0.7344 max_r 0.6551 max_f1 0.6924

step 10: train loss 0.1073 
cause_predict: train acc 0.9823 p 0.9189 r 0.9714 f1 0.9444
position_predict: train acc 0.9646 p 0.8788 r 0.8788 f1 0.8788
step 20: train loss 0.2072 
cause_predict: train acc 0.9696 p 0.8649 r 0.8889 f1 0.8767
position_predict: train acc 0.9628 p 0.8000 r 0.8750 f1 0.8358
step 30: train loss 0.0811 
cause_predict: train acc 0.9840 p 0.9688 r 0.9118 f1 0.9394
position_predict: train acc 0.9800 p 0.9355 r 0.9062 f1 0.9206
step 40: train loss 0.2194 
cause_predict: train acc 0.9510 p 0.8056 r 0.8529 f1 0.8286
position_predict: train acc 0.9673 p 0.8529 r 0.9062 f1 0.8788
step 50: train loss 0.1316 
cause_predict: train acc 0.9823 p 0.9189 r 0.9444 f1 0.9315
position_predict: train acc 0.9645 p 0.8710 r 0.8182 f1 0.8438
step 60: train loss 0.1162 
cause_predict: train acc 0.9742 p 0.9268 r 0.9500 f1 0.9383
position_predict: train acc 0.9897 p 0.9688 r 0.9688 f1 0.9688
step 70: train loss 0.1139 
cause_predict: train acc 0.9796 p 0.9211 r 0.9459 f1 0.9333
position_predict: train acc 0.9714 p 0.8788 r 0.9062 f1 0.8923

epoch 12: test loss 0.7419 cost time: 12.3s

cause_predict: test acc 0.8883 p 0.6227 r 0.5363 f1 0.5763
max_acc 0.8883 max_p 0.6227 max_r 0.5363 max_f1 0.5763

position_predict: test acc 0.9097 p 0.6512 r 0.6376 f1 0.6444
max_acc 0.9285 max_p 0.7244 max_r 0.7143 max_f1 0.7193

Average max cause: max_acc 0.8896 max_p 0.6411 max_r 0.5016 max_f1 0.5628
Average max pos: max_acc 0.9254 max_p 0.7344 max_r 0.6551 max_f1 0.6924

step 10: train loss 0.0912 
cause_predict: train acc 0.9923 p 0.9688 r 0.9688 f1 0.9688
position_predict: train acc 0.9732 p 0.9032 r 0.8750 f1 0.8889
step 20: train loss 0.1169 
cause_predict: train acc 0.9723 p 1.0000 r 0.7941 f1 0.8852
position_predict: train acc 0.9881 p 0.9394 r 0.9688 f1 0.9538
step 30: train loss 0.0497 
cause_predict: train acc 0.9866 p 0.9429 r 0.9429 f1 0.9429
position_predict: train acc 0.9899 p 0.9394 r 0.9688 f1 0.9538
step 40: train loss 0.1019 
cause_predict: train acc 0.9722 p 0.8718 r 0.9189 f1 0.8947
position_predict: train acc 0.9826 p 0.9355 r 0.9062 f1 0.9206
step 50: train loss 0.2627 
cause_predict: train acc 0.9160 p 0.7576 r 0.6757 f1 0.7143
position_predict: train acc 0.9580 p 0.8108 r 0.9091 f1 0.8571
step 60: train loss 0.2046 
cause_predict: train acc 0.9533 p 0.8529 r 0.8529 f1 0.8529
position_predict: train acc 0.9533 p 0.8438 r 0.8438 f1 0.8438
step 70: train loss 0.1726 
cause_predict: train acc 0.9833 p 0.9500 r 0.9500 f1 0.9500
position_predict: train acc 0.9665 p 0.9000 r 0.8438 f1 0.8710

epoch 13: test loss 0.7737 cost time: 12.3s

cause_predict: test acc 0.8807 p 0.5762 r 0.5962 f1 0.5860
max_acc 0.8807 max_p 0.5762 max_r 0.5962 max_f1 0.5860

position_predict: test acc 0.9164 p 0.6799 r 0.6585 f1 0.6690
max_acc 0.9285 max_p 0.7244 max_r 0.7143 max_f1 0.7193

Average max cause: max_acc 0.8896 max_p 0.6411 max_r 0.5016 max_f1 0.5628
Average max pos: max_acc 0.9254 max_p 0.7344 max_r 0.6551 max_f1 0.6924

step 10: train loss 0.1419 
cause_predict: train acc 0.9738 p 0.9706 r 0.8684 f1 0.9167
position_predict: train acc 0.9738 p 0.9333 r 0.8750 f1 0.9032
step 20: train loss 0.1037 
cause_predict: train acc 0.9782 p 0.9167 r 0.9429 f1 0.9296
position_predict: train acc 0.9825 p 0.9394 r 0.9394 f1 0.9394
step 30: train loss 0.1015 
cause_predict: train acc 0.9842 p 0.9412 r 0.9412 f1 0.9412
position_predict: train acc 0.9763 p 0.9062 r 0.9062 f1 0.9062
step 40: train loss 0.1226 
cause_predict: train acc 0.9789 p 0.9394 r 0.9118 f1 0.9254
position_predict: train acc 0.9789 p 0.9091 r 0.9375 f1 0.9231
step 50: train loss 0.0912 
cause_predict: train acc 0.9918 p 1.0000 r 0.9500 f1 0.9744
position_predict: train acc 0.9714 p 0.8788 r 0.9062 f1 0.8923
step 60: train loss 0.1715 
cause_predict: train acc 0.9798 p 0.9167 r 0.9167 f1 0.9167
position_predict: train acc 0.9529 p 0.8214 r 0.7188 f1 0.7667
step 70: train loss 0.1795 
cause_predict: train acc 0.9694 p 0.9189 r 0.9189 f1 0.9189
position_predict: train acc 0.9694 p 0.8824 r 0.9375 f1 0.9091

epoch 14: test loss 0.7724 cost time: 12.4s

cause_predict: test acc 0.8762 p 0.5645 r 0.5521 f1 0.5582
max_acc 0.8807 max_p 0.5762 max_r 0.5962 max_f1 0.5860

position_predict: test acc 0.9196 p 0.6838 r 0.6934 f1 0.6886
max_acc 0.9285 max_p 0.7244 max_r 0.7143 max_f1 0.7193

Average max cause: max_acc 0.8896 max_p 0.6411 max_r 0.5016 max_f1 0.5628
Average max pos: max_acc 0.9254 max_p 0.7344 max_r 0.6551 max_f1 0.6924

write pair_data/Ind_BiLSTM_2/fold_1_test.txt done
write pair_data/Ind_BiLSTM_2/fold_1_train.txt done
Optimization Finished!

############# fold 1 end ###############
############# fold 2 begin ###############
load data_file: data_combine_en/fold_2_train.txt
y_position.shape (2275, 75, 2)
y_cause.shape (2275, 75, 2)
x.shape (2275, 75, 30)
sen_len.shape (2275, 75)
doc_len.shape (2275,)
n_cut 107
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/code/ECPE-master/utils/tf_funcs.py:181: UserWarning: `tf.nn.rnn_cell.LSTMCell` is deprecated and will be removed in a future version. This class is equivalent as `tf.keras.layers.LSTMCell`, and will be replaced by that in Tensorflow 2.0.
  cell_fw=tf.nn.rnn_cell.LSTMCell(n_hidden),
/home/oycj/code/ECPE-master/utils/tf_funcs.py:182: UserWarning: `tf.nn.rnn_cell.LSTMCell` is deprecated and will be removed in a future version. This class is equivalent as `tf.keras.layers.LSTMCell`, and will be replaced by that in Tensorflow 2.0.
  cell_bw=tf.nn.rnn_cell.LSTMCell(n_hidden),
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/keras/layers/legacy_rnn/rnn_cell_impl.py:984: UserWarning: `layer.add_variable` is deprecated and will be removed in a future version. Please use `layer.add_weight` method instead.
  self._kernel = self.add_variable(
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/keras/layers/legacy_rnn/rnn_cell_impl.py:993: UserWarning: `layer.add_variable` is deprecated and will be removed in a future version. Please use `layer.add_weight` method instead.
  self._bias = self.add_variable(
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
load data done!

load data_file: data_combine_en/fold_2_test.txt
y_position.shape (284, 75, 2)
y_cause.shape (284, 75, 2)
x.shape (284, 75, 30)
sen_len.shape (284, 75)
doc_len.shape (284,)
n_cut 22
load data done!

train docs: 2275    test docs: 284
step 10: train loss 0.7847 
cause_predict: train acc 0.8517 p 0.0000 r 0.0000 f1 0.0000
position_predict: train acc 0.8602 p 0.0000 r 0.0000 f1 0.0000
step 20: train loss 0.7594 
cause_predict: train acc 0.8442 p 0.0000 r 0.0000 f1 0.0000
position_predict: train acc 0.8571 p 0.0000 r 0.0000 f1 0.0000
step 30: train loss 0.7259 
cause_predict: train acc 0.8224 p 0.0000 r 0.0000 f1 0.0000
position_predict: train acc 0.8505 p 0.0000 r 0.0000 f1 0.0000
step 40: train loss 0.6185 
cause_predict: train acc 0.8465 p 1.0000 r 0.0294 f1 0.0571
position_predict: train acc 0.8884 p 0.6667 r 0.5000 f1 0.5714
step 50: train loss 0.7071 
cause_predict: train acc 0.8454 p 1.0000 r 0.0909 f1 0.1667
position_predict: train acc 0.8660 p 0.6250 r 0.4688 f1 0.5357
step 60: train loss 0.6480 
cause_predict: train acc 0.8439 p 1.0000 r 0.1190 f1 0.2128
position_predict: train acc 0.9072 p 0.7778 r 0.4375 f1 0.5600
step 70: train loss 0.5721 
cause_predict: train acc 0.8714 p 0.8000 r 0.1905 f1 0.3077
position_predict: train acc 0.9179 p 0.6452 r 0.6250 f1 0.6349

epoch 0: test loss 0.5230 cost time: 12.3s

cause_predict: test acc 0.8843 p 0.8625 r 0.2177 f1 0.3476
max_acc 0.8843 max_p 0.8625 max_r 0.2177 max_f1 0.3476

position_predict: test acc 0.9093 p 0.6469 r 0.6446 f1 0.6457
max_acc 0.9093 max_p 0.6469 max_r 0.6446 max_f1 0.6457

Average max cause: max_acc 0.8843 max_p 0.8625 max_r 0.2177 max_f1 0.3476
Average max pos: max_acc 0.9093 max_p 0.6469 max_r 0.6446 max_f1 0.6457

step 10: train loss 0.4424 
cause_predict: train acc 0.8942 p 0.7000 r 0.6176 f1 0.6562
position_predict: train acc 0.9231 p 0.7353 r 0.7812 f1 0.7576
step 20: train loss 0.5963 
cause_predict: train acc 0.8640 p 1.0000 r 0.2250 f1 0.3673
position_predict: train acc 0.9123 p 0.7143 r 0.6250 f1 0.6667
step 30: train loss 0.5410 
cause_predict: train acc 0.8496 p 0.5769 r 0.3947 f1 0.4688
position_predict: train acc 0.9204 p 0.7917 r 0.5938 f1 0.6786
step 40: train loss 0.5419 
cause_predict: train acc 0.8646 p 0.8889 r 0.2105 f1 0.3404
position_predict: train acc 0.9258 p 0.8261 r 0.5938 f1 0.6909
step 50: train loss 0.5412 
cause_predict: train acc 0.8761 p 0.6875 r 0.3333 f1 0.4490
position_predict: train acc 0.8670 p 0.5625 r 0.5455 f1 0.5538
step 60: train loss 0.6558 
cause_predict: train acc 0.8391 p 0.5000 r 0.1351 f1 0.2128
position_predict: train acc 0.8826 p 0.6154 r 0.4848 f1 0.5424
step 70: train loss 0.5252 
cause_predict: train acc 0.8565 p 0.6364 r 0.1892 f1 0.2917
position_predict: train acc 0.9198 p 0.7600 r 0.5938 f1 0.6667

epoch 1: test loss 0.4777 cost time: 12.3s

cause_predict: test acc 0.8816 p 0.6831 r 0.3060 f1 0.4227
max_acc 0.8816 max_p 0.6831 max_r 0.3060 max_f1 0.4227

position_predict: test acc 0.9240 p 0.7489 r 0.6132 f1 0.6743
max_acc 0.9240 max_p 0.7489 max_r 0.6132 max_f1 0.6743

Average max cause: max_acc 0.8816 max_p 0.6831 max_r 0.3060 max_f1 0.4227
Average max pos: max_acc 0.9240 max_p 0.7489 max_r 0.6132 max_f1 0.6743

step 10: train loss 0.4555 
cause_predict: train acc 0.8870 p 0.5882 r 0.2778 f1 0.3774
position_predict: train acc 0.9144 p 0.6207 r 0.5625 f1 0.5902
step 20: train loss 0.5679 
cause_predict: train acc 0.8514 p 0.6316 r 0.3158 f1 0.4211
position_predict: train acc 0.9234 p 0.7778 r 0.6562 f1 0.7119
step 30: train loss 0.4886 
cause_predict: train acc 0.8578 p 0.6111 r 0.3143 f1 0.4151
position_predict: train acc 0.9358 p 0.8750 r 0.6562 f1 0.7500
step 40: train loss 0.4781 
cause_predict: train acc 0.8725 p 0.7273 r 0.4444 f1 0.5517
position_predict: train acc 0.9461 p 0.8889 r 0.7500 f1 0.8136
step 50: train loss 0.5807 
cause_predict: train acc 0.8899 p 0.8500 r 0.4474 f1 0.5862
position_predict: train acc 0.9174 p 0.7778 r 0.6364 f1 0.7000
step 60: train loss 0.5016 
cause_predict: train acc 0.8908 p 0.6667 r 0.5294 f1 0.5902
position_predict: train acc 0.8908 p 0.6452 r 0.5882 f1 0.6154
step 70: train loss 0.4743 
cause_predict: train acc 0.8839 p 0.5556 r 0.2632 f1 0.3571
position_predict: train acc 0.9484 p 0.8400 r 0.6364 f1 0.7241

epoch 2: test loss 0.4736 cost time: 12.4s

cause_predict: test acc 0.8856 p 0.6459 r 0.4259 f1 0.5133
max_acc 0.8856 max_p 0.6459 max_r 0.4259 max_f1 0.5133

position_predict: test acc 0.9209 p 0.6871 r 0.7038 f1 0.6954
max_acc 0.9209 max_p 0.6871 max_r 0.7038 max_f1 0.6954

Average max cause: max_acc 0.8856 max_p 0.6459 max_r 0.4259 max_f1 0.5133
Average max pos: max_acc 0.9209 max_p 0.6871 max_r 0.7038 max_f1 0.6954

step 10: train loss 0.4953 
cause_predict: train acc 0.8607 p 0.8182 r 0.4286 f1 0.5625
position_predict: train acc 0.9204 p 0.7857 r 0.6875 f1 0.7333
step 20: train loss 0.4907 
cause_predict: train acc 0.8971 p 0.7917 r 0.5429 f1 0.6441
position_predict: train acc 0.9216 p 0.7857 r 0.6875 f1 0.7333
step 30: train loss 0.4332 
cause_predict: train acc 0.8926 p 0.7222 r 0.3824 f1 0.5000
position_predict: train acc 0.9298 p 0.7273 r 0.7500 f1 0.7385
step 40: train loss 0.4253 
cause_predict: train acc 0.8977 p 0.5926 r 0.4444 f1 0.5079
position_predict: train acc 0.9505 p 0.8148 r 0.6875 f1 0.7458
step 50: train loss 0.4588 
cause_predict: train acc 0.8678 p 0.6667 r 0.3784 f1 0.4828
position_predict: train acc 0.9471 p 0.8333 r 0.7812 f1 0.8065
step 60: train loss 0.4470 
cause_predict: train acc 0.8792 p 0.5294 r 0.2432 f1 0.3333
position_predict: train acc 0.9396 p 0.7333 r 0.6875 f1 0.7097
step 70: train loss 0.3426 
cause_predict: train acc 0.9211 p 0.7600 r 0.5429 f1 0.6333
position_predict: train acc 0.9391 p 0.7273 r 0.7500 f1 0.7385

epoch 3: test loss 0.4519 cost time: 12.1s

cause_predict: test acc 0.8910 p 0.6763 r 0.4416 f1 0.5344
max_acc 0.8910 max_p 0.6763 max_r 0.4416 max_f1 0.5344

position_predict: test acc 0.9249 p 0.7352 r 0.6481 f1 0.6889
max_acc 0.9209 max_p 0.6871 max_r 0.7038 max_f1 0.6954

Average max cause: max_acc 0.8910 max_p 0.6763 max_r 0.4416 max_f1 0.5344
Average max pos: max_acc 0.9249 max_p 0.7352 max_r 0.6481 max_f1 0.6889

step 10: train loss 0.4048 
cause_predict: train acc 0.9113 p 0.7647 r 0.3824 f1 0.5098
position_predict: train acc 0.9433 p 0.8077 r 0.6562 f1 0.7241
step 20: train loss 0.2965 
cause_predict: train acc 0.9563 p 0.8438 r 0.8438 f1 0.8438
position_predict: train acc 0.9389 p 0.8000 r 0.7500 f1 0.7742
step 30: train loss 0.3226 
cause_predict: train acc 0.9323 p 0.8846 r 0.6216 f1 0.7302
position_predict: train acc 0.9482 p 0.8276 r 0.7500 f1 0.7869
step 40: train loss 0.4511 
cause_predict: train acc 0.8962 p 0.8750 r 0.3590 f1 0.5091
position_predict: train acc 0.9423 p 0.7931 r 0.7188 f1 0.7541
step 50: train loss 0.3953 
cause_predict: train acc 0.8980 p 0.7273 r 0.4571 f1 0.5614
position_predict: train acc 0.9469 p 0.8519 r 0.7188 f1 0.7797
step 60: train loss 0.3719 
cause_predict: train acc 0.9109 p 0.8500 r 0.4722 f1 0.6071
position_predict: train acc 0.9595 p 0.9259 r 0.7576 f1 0.8333
step 70: train loss 0.3771 
cause_predict: train acc 0.9286 p 0.8636 r 0.5758 f1 0.6909
position_predict: train acc 0.9328 p 0.8148 r 0.6667 f1 0.7333

epoch 4: test loss 0.4779 cost time: 12.6s

cause_predict: test acc 0.8919 p 0.6812 r 0.4448 f1 0.5382
max_acc 0.8919 max_p 0.6812 max_r 0.4448 max_f1 0.5382

position_predict: test acc 0.9263 p 0.7194 r 0.6969 f1 0.7080
max_acc 0.9263 max_p 0.7194 max_r 0.6969 max_f1 0.7080

Average max cause: max_acc 0.8919 max_p 0.6812 max_r 0.4448 max_f1 0.5382
Average max pos: max_acc 0.9263 max_p 0.7194 max_r 0.6969 max_f1 0.7080

step 10: train loss 0.3301 
cause_predict: train acc 0.9161 p 0.8148 r 0.5500 f1 0.6567
position_predict: train acc 0.9599 p 0.8667 r 0.7879 f1 0.8254
step 20: train loss 0.2907 
cause_predict: train acc 0.9372 p 0.8519 r 0.6970 f1 0.7667
position_predict: train acc 0.9552 p 0.8438 r 0.8438 f1 0.8438
step 30: train loss 0.3935 
cause_predict: train acc 0.8925 p 0.7143 r 0.4688 f1 0.5660
position_predict: train acc 0.9393 p 0.8182 r 0.7941 f1 0.8060
step 40: train loss 0.4075 
cause_predict: train acc 0.9067 p 0.8000 r 0.6154 f1 0.6957
position_predict: train acc 0.9378 p 0.7812 r 0.7812 f1 0.7812
step 50: train loss 0.3621 
cause_predict: train acc 0.9215 p 0.7931 r 0.6389 f1 0.7077
position_predict: train acc 0.9380 p 0.8000 r 0.7273 f1 0.7619
step 60: train loss 0.3818 
cause_predict: train acc 0.9027 p 0.6897 r 0.6061 f1 0.6452
position_predict: train acc 0.9469 p 0.8387 r 0.7879 f1 0.8125
step 70: train loss 0.3503 
cause_predict: train acc 0.9037 p 0.7333 r 0.6286 f1 0.6769
position_predict: train acc 0.9404 p 0.8065 r 0.7812 f1 0.7937

epoch 5: test loss 0.4872 cost time: 12.5s

cause_predict: test acc 0.8870 p 0.6524 r 0.4322 f1 0.5199
max_acc 0.8919 max_p 0.6812 max_r 0.4448 max_f1 0.5382

position_predict: test acc 0.9276 p 0.7240 r 0.7038 f1 0.7138
max_acc 0.9276 max_p 0.7240 max_r 0.7038 max_f1 0.7138

Average max cause: max_acc 0.8919 max_p 0.6812 max_r 0.4448 max_f1 0.5382
Average max pos: max_acc 0.9263 max_p 0.7194 max_r 0.6969 max_f1 0.7080

step 10: train loss 0.3160 
cause_predict: train acc 0.9013 p 0.7333 r 0.6111 f1 0.6667
position_predict: train acc 0.9417 p 0.8276 r 0.7500 f1 0.7869
step 20: train loss 0.2964 
cause_predict: train acc 0.8992 p 0.7200 r 0.5000 f1 0.5902
position_predict: train acc 0.9758 p 0.9355 r 0.8788 f1 0.9062
step 30: train loss 0.2859 
cause_predict: train acc 0.9409 p 0.8125 r 0.7647 f1 0.7879
position_predict: train acc 0.9536 p 0.8056 r 0.8788 f1 0.8406
step 40: train loss 0.3096 
cause_predict: train acc 0.9237 p 0.8519 r 0.6053 f1 0.7077
position_predict: train acc 0.9357 p 0.7353 r 0.7812 f1 0.7576
step 50: train loss 0.3185 
cause_predict: train acc 0.9082 p 0.6842 r 0.7879 f1 0.7324
position_predict: train acc 0.9614 p 0.8750 r 0.8750 f1 0.8750
step 60: train loss 0.3407 
cause_predict: train acc 0.9248 p 0.7500 r 0.7714 f1 0.7606
position_predict: train acc 0.9071 p 0.6571 r 0.7188 f1 0.6866
step 70: train loss 0.2913 
cause_predict: train acc 0.9163 p 0.7188 r 0.6765 f1 0.6970
position_predict: train acc 0.9623 p 0.9259 r 0.7812 f1 0.8475

epoch 6: test loss 0.4927 cost time: 12.4s

cause_predict: test acc 0.8919 p 0.6374 r 0.5489 f1 0.5898
max_acc 0.8919 max_p 0.6374 max_r 0.5489 max_f1 0.5898

position_predict: test acc 0.9187 p 0.6868 r 0.6725 f1 0.6796
max_acc 0.9276 max_p 0.7240 max_r 0.7038 max_f1 0.7138

Average max cause: max_acc 0.8919 max_p 0.6374 max_r 0.5489 max_f1 0.5898
Average max pos: max_acc 0.9187 max_p 0.6868 max_r 0.6725 max_f1 0.6796

step 10: train loss 0.1821 
cause_predict: train acc 0.9572 p 0.8929 r 0.7576 f1 0.8197
position_predict: train acc 0.9767 p 0.9655 r 0.8485 f1 0.9032
step 20: train loss 0.3360 
cause_predict: train acc 0.9161 p 0.6875 r 0.6111 f1 0.6471
position_predict: train acc 0.9441 p 0.7500 r 0.7500 f1 0.7500
step 30: train loss 0.2124 
cause_predict: train acc 0.9375 p 0.8276 r 0.7059 f1 0.7619
position_predict: train acc 0.9667 p 0.8529 r 0.9062 f1 0.8788
step 40: train loss 0.2832 
cause_predict: train acc 0.9213 p 0.7273 r 0.6667 f1 0.6957
position_predict: train acc 0.9401 p 0.7742 r 0.7273 f1 0.7500
step 50: train loss 0.3198 
cause_predict: train acc 0.9561 p 0.8537 r 0.8974 f1 0.8750
position_predict: train acc 0.9386 p 0.8000 r 0.7500 f1 0.7742
step 60: train loss 0.3604 
cause_predict: train acc 0.9502 p 0.9000 r 0.7941 f1 0.8438
position_predict: train acc 0.9502 p 0.8438 r 0.8438 f1 0.8438
step 70: train loss 0.3200 
cause_predict: train acc 0.9375 p 0.9583 r 0.6216 f1 0.7541
position_predict: train acc 0.9292 p 0.7419 r 0.7188 f1 0.7302

epoch 7: test loss 0.5370 cost time: 12.5s

cause_predict: test acc 0.8865 p 0.6207 r 0.5110 f1 0.5606
max_acc 0.8919 max_p 0.6374 max_r 0.5489 max_f1 0.5898

position_predict: test acc 0.9200 p 0.6915 r 0.6794 f1 0.6854
max_acc 0.9276 max_p 0.7240 max_r 0.7038 max_f1 0.7138

Average max cause: max_acc 0.8919 max_p 0.6374 max_r 0.5489 max_f1 0.5898
Average max pos: max_acc 0.9187 max_p 0.6868 max_r 0.6725 max_f1 0.6796

step 10: train loss 0.1450 
cause_predict: train acc 0.9803 p 0.9375 r 0.9375 f1 0.9375
position_predict: train acc 0.9655 p 0.8788 r 0.9062 f1 0.8923
step 20: train loss 0.2201 
cause_predict: train acc 0.9463 p 0.8529 r 0.8286 f1 0.8406
position_predict: train acc 0.9610 p 0.9032 r 0.8485 f1 0.8750
step 30: train loss 0.1656 
cause_predict: train acc 0.9560 p 0.8966 r 0.7647 f1 0.8254
position_predict: train acc 0.9600 p 0.8929 r 0.7812 f1 0.8333
step 40: train loss 0.2103 
cause_predict: train acc 0.9764 p 0.9688 r 0.8611 f1 0.9118
position_predict: train acc 0.9488 p 0.7941 r 0.8182 f1 0.8060
step 50: train loss 0.2263 
cause_predict: train acc 0.9474 p 0.8611 r 0.7949 f1 0.8267
position_predict: train acc 0.9798 p 0.9355 r 0.9062 f1 0.9206
step 60: train loss 0.3040 
cause_predict: train acc 0.9398 p 0.8438 r 0.7714 f1 0.8060
position_predict: train acc 0.9259 p 0.7742 r 0.7273 f1 0.7500
step 70: train loss 0.1861 
cause_predict: train acc 0.9557 p 0.8529 r 0.8056 f1 0.8286
position_predict: train acc 0.9742 p 0.8788 r 0.9062 f1 0.8923

epoch 8: test loss 0.5766 cost time: 12.4s

cause_predict: test acc 0.8968 p 0.6693 r 0.5363 f1 0.5954
max_acc 0.8968 max_p 0.6693 max_r 0.5363 max_f1 0.5954

position_predict: test acc 0.9200 p 0.7015 r 0.6551 f1 0.6775
max_acc 0.9276 max_p 0.7240 max_r 0.7038 max_f1 0.7138

Average max cause: max_acc 0.8968 max_p 0.6693 max_r 0.5363 max_f1 0.5954
Average max pos: max_acc 0.9200 max_p 0.7015 max_r 0.6551 max_f1 0.6775

step 10: train loss 0.1215 
cause_predict: train acc 0.9597 p 0.9062 r 0.8056 f1 0.8529
position_predict: train acc 0.9839 p 0.8889 r 1.0000 f1 0.9412
step 20: train loss 0.2346 
cause_predict: train acc 0.9491 p 0.8750 r 0.8000 f1 0.8358
position_predict: train acc 0.9722 p 0.8824 r 0.9375 f1 0.9091
step 30: train loss 0.1742 
cause_predict: train acc 0.9646 p 0.9375 r 0.8108 f1 0.8696
position_predict: train acc 0.9724 p 0.9032 r 0.8750 f1 0.8889
step 40: train loss 0.2219 
cause_predict: train acc 0.9421 p 0.7812 r 0.7812 f1 0.7812
position_predict: train acc 0.9752 p 0.8824 r 0.9375 f1 0.9091
step 50: train loss 0.1926 
cause_predict: train acc 0.9421 p 0.8235 r 0.8485 f1 0.8358
position_predict: train acc 0.9842 p 0.9677 r 0.9375 f1 0.9524
step 60: train loss 0.2312 
cause_predict: train acc 0.9561 p 0.8462 r 0.8250 f1 0.8354
position_predict: train acc 0.9595 p 0.8387 r 0.7879 f1 0.8125
step 70: train loss 0.2443 
cause_predict: train acc 0.9520 p 0.8966 r 0.7647 f1 0.8254
position_predict: train acc 0.9607 p 0.8710 r 0.8438 f1 0.8571

epoch 9: test loss 0.6309 cost time: 12.5s

cause_predict: test acc 0.8963 p 0.6667 r 0.5363 f1 0.5944
max_acc 0.8968 max_p 0.6693 max_r 0.5363 max_f1 0.5954

position_predict: test acc 0.9164 p 0.6613 r 0.7143 f1 0.6868
max_acc 0.9276 max_p 0.7240 max_r 0.7038 max_f1 0.7138

Average max cause: max_acc 0.8963 max_p 0.6667 max_r 0.5363 max_f1 0.5944
Average max pos: max_acc 0.9164 max_p 0.6613 max_r 0.7143 max_f1 0.6868

step 10: train loss 0.2213 
cause_predict: train acc 0.9659 p 0.8824 r 0.9091 f1 0.8955
position_predict: train acc 0.9610 p 0.8788 r 0.8788 f1 0.8788
step 20: train loss 0.1528 
cause_predict: train acc 0.9600 p 0.8108 r 0.9375 f1 0.8696
position_predict: train acc 0.9911 p 1.0000 r 0.9394 f1 0.9688
step 30: train loss 0.1837 
cause_predict: train acc 0.9615 p 0.8919 r 0.8919 f1 0.8919
position_predict: train acc 0.9519 p 0.8667 r 0.8125 f1 0.8387
step 40: train loss 0.1023 
cause_predict: train acc 0.9723 p 0.8857 r 0.9118 f1 0.8986
position_predict: train acc 0.9842 p 0.9688 r 0.9118 f1 0.9394
step 50: train loss 0.2995 
cause_predict: train acc 0.9036 p 0.7143 r 0.6410 f1 0.6757
position_predict: train acc 0.9759 p 0.9062 r 0.9062 f1 0.9062
step 60: train loss 0.1558 
cause_predict: train acc 0.9647 p 0.8500 r 0.9189 f1 0.8831
position_predict: train acc 0.9647 p 0.8485 r 0.8750 f1 0.8615
step 70: train loss 0.1727 
cause_predict: train acc 0.9540 p 0.8529 r 0.8286 f1 0.8406
position_predict: train acc 0.9665 p 0.8788 r 0.8788 f1 0.8788

epoch 10: test loss 0.6744 cost time: 12.3s

cause_predict: test acc 0.8811 p 0.5859 r 0.5489 f1 0.5668
max_acc 0.8968 max_p 0.6693 max_r 0.5363 max_f1 0.5954

position_predict: test acc 0.9182 p 0.6871 r 0.6655 f1 0.6761
max_acc 0.9276 max_p 0.7240 max_r 0.7038 max_f1 0.7138

Average max cause: max_acc 0.8963 max_p 0.6667 max_r 0.5363 max_f1 0.5944
Average max pos: max_acc 0.9164 max_p 0.6613 max_r 0.7143 max_f1 0.6868

step 10: train loss 0.0826 
cause_predict: train acc 0.9738 p 0.9062 r 0.9062 f1 0.9062
position_predict: train acc 0.9956 p 1.0000 r 0.9688 f1 0.9841
step 20: train loss 0.0933 
cause_predict: train acc 0.9674 p 0.9722 r 0.8537 f1 0.9091
position_predict: train acc 0.9953 p 0.9697 r 1.0000 f1 0.9846
step 30: train loss 0.1111 
cause_predict: train acc 0.9761 p 1.0000 r 0.8611 f1 0.9254
position_predict: train acc 0.9904 p 0.9697 r 0.9697 f1 0.9697
step 40: train loss 0.1161 
cause_predict: train acc 0.9923 p 0.9744 r 0.9744 f1 0.9744
position_predict: train acc 0.9730 p 0.9062 r 0.8788 f1 0.8923
step 50: train loss 0.1172 
cause_predict: train acc 0.9685 p 0.8974 r 0.8537 f1 0.8750
position_predict: train acc 0.9811 p 0.8824 r 0.9375 f1 0.9091
step 60: train loss 0.2255 
cause_predict: train acc 0.9476 p 0.8182 r 0.7941 f1 0.8060
position_predict: train acc 0.9597 p 0.9231 r 0.7500 f1 0.8276
step 70: train loss 0.1653 
cause_predict: train acc 0.9469 p 0.8286 r 0.8286 f1 0.8286
position_predict: train acc 0.9823 p 0.9375 r 0.9375 f1 0.9375

epoch 11: test loss 0.6721 cost time: 12.3s

cause_predict: test acc 0.8896 p 0.6277 r 0.5426 f1 0.5821
max_acc 0.8968 max_p 0.6693 max_r 0.5363 max_f1 0.5954

position_predict: test acc 0.9223 p 0.7040 r 0.6794 f1 0.6915
max_acc 0.9276 max_p 0.7240 max_r 0.7038 max_f1 0.7138

Average max cause: max_acc 0.8963 max_p 0.6667 max_r 0.5363 max_f1 0.5944
Average max pos: max_acc 0.9164 max_p 0.6613 max_r 0.7143 max_f1 0.6868

step 10: train loss 0.0953 
cause_predict: train acc 0.9861 p 0.9250 r 0.9737 f1 0.9487
position_predict: train acc 0.9792 p 0.8824 r 0.9375 f1 0.9091
step 20: train loss 0.1276 
cause_predict: train acc 0.9748 p 0.9167 r 0.9167 f1 0.9167
position_predict: train acc 0.9874 p 0.9677 r 0.9375 f1 0.9524
step 30: train loss 0.1461 
cause_predict: train acc 0.9832 p 0.9722 r 0.9459 f1 0.9589
position_predict: train acc 0.9777 p 0.9375 r 0.9375 f1 0.9375
step 40: train loss 0.1617 
cause_predict: train acc 0.9813 p 0.9429 r 0.9167 f1 0.9296
position_predict: train acc 0.9625 p 0.8438 r 0.8438 f1 0.8438
step 50: train loss 0.1285 
cause_predict: train acc 0.9681 p 0.8857 r 0.8611 f1 0.8732
position_predict: train acc 0.9752 p 0.9062 r 0.8788 f1 0.8923
step 60: train loss 0.1694 
cause_predict: train acc 0.9479 p 0.8611 r 0.8378 f1 0.8493
position_predict: train acc 0.9668 p 0.8611 r 0.9394 f1 0.8986
step 70: train loss 0.1091 
cause_predict: train acc 0.9908 p 0.9714 r 0.9714 f1 0.9714
position_predict: train acc 0.9816 p 0.9375 r 0.9375 f1 0.9375

epoch 12: test loss 0.6996 cost time: 12.3s

cause_predict: test acc 0.8901 p 0.6203 r 0.5773 f1 0.5980
max_acc 0.8901 max_p 0.6203 max_r 0.5773 max_f1 0.5980

position_predict: test acc 0.9142 p 0.6621 r 0.6760 f1 0.6690
max_acc 0.9276 max_p 0.7240 max_r 0.7038 max_f1 0.7138

Average max cause: max_acc 0.8963 max_p 0.6667 max_r 0.5363 max_f1 0.5944
Average max pos: max_acc 0.9164 max_p 0.6613 max_r 0.7143 max_f1 0.6868

step 10: train loss 0.1026 
cause_predict: train acc 0.9784 p 0.9231 r 0.9730 f1 0.9474
position_predict: train acc 0.9838 p 0.9429 r 0.9706 f1 0.9565
step 20: train loss 0.1210 
cause_predict: train acc 0.9707 p 0.8378 r 0.9394 f1 0.8857
position_predict: train acc 0.9707 p 0.8333 r 0.9375 f1 0.8824
step 30: train loss 0.1731 
cause_predict: train acc 0.9633 p 0.8947 r 0.8718 f1 0.8831
position_predict: train acc 0.9592 p 0.8485 r 0.8485 f1 0.8485
step 40: train loss 0.1329 
cause_predict: train acc 0.9722 p 0.8611 r 0.9394 f1 0.8986
position_predict: train acc 0.9563 p 0.8387 r 0.8125 f1 0.8254
step 50: train loss 0.1214 
cause_predict: train acc 0.9774 p 0.9211 r 0.9459 f1 0.9333
position_predict: train acc 0.9819 p 0.9118 r 0.9688 f1 0.9394
step 60: train loss 0.1028 
cause_predict: train acc 0.9816 p 0.9677 r 0.8824 f1 0.9231
position_predict: train acc 0.9743 p 0.9310 r 0.8438 f1 0.8852
step 70: train loss 0.1096 
cause_predict: train acc 0.9739 p 0.9459 r 0.8750 f1 0.9091
position_predict: train acc 0.9776 p 0.8824 r 0.9375 f1 0.9091

epoch 13: test loss 0.7166 cost time: 12.1s

cause_predict: test acc 0.8870 p 0.6081 r 0.5678 f1 0.5873
max_acc 0.8901 max_p 0.6203 max_r 0.5773 max_f1 0.5980

position_predict: test acc 0.9205 p 0.7011 r 0.6620 f1 0.6810
max_acc 0.9276 max_p 0.7240 max_r 0.7038 max_f1 0.7138

Average max cause: max_acc 0.8963 max_p 0.6667 max_r 0.5363 max_f1 0.5944
Average max pos: max_acc 0.9164 max_p 0.6613 max_r 0.7143 max_f1 0.6868

step 10: train loss 0.1372 
cause_predict: train acc 0.9734 p 0.9167 r 0.9429 f1 0.9296
position_predict: train acc 0.9681 p 0.8611 r 0.9688 f1 0.9118
step 20: train loss 0.0469 
cause_predict: train acc 0.9963 p 0.9730 r 1.0000 f1 0.9863
position_predict: train acc 0.9926 p 0.9697 r 0.9697 f1 0.9697
step 30: train loss 0.0820 
cause_predict: train acc 0.9790 p 0.9167 r 0.8919 f1 0.9041
position_predict: train acc 0.9850 p 0.9091 r 0.9375 f1 0.9231
step 40: train loss 0.1866 
cause_predict: train acc 0.9522 p 0.7838 r 0.8529 f1 0.8169
position_predict: train acc 0.9632 p 0.8710 r 0.8182 f1 0.8438
step 50: train loss 0.1494 
cause_predict: train acc 0.9619 p 0.8974 r 0.8974 f1 0.8974
position_predict: train acc 0.9810 p 0.9394 r 0.9394 f1 0.9394
step 60: train loss 0.1603 
cause_predict: train acc 0.9660 p 0.8889 r 0.8205 f1 0.8533
position_predict: train acc 0.9784 p 0.8788 r 0.9062 f1 0.8923
step 70: train loss 0.1291 
cause_predict: train acc 0.9921 p 0.9730 r 0.9730 f1 0.9730
position_predict: train acc 0.9486 p 0.8333 r 0.7576 f1 0.7937

epoch 14: test loss 0.7340 cost time: 12.4s

cause_predict: test acc 0.8919 p 0.6263 r 0.5868 f1 0.6059
max_acc 0.8919 max_p 0.6263 max_r 0.5868 max_f1 0.6059

position_predict: test acc 0.9164 p 0.6736 r 0.6760 f1 0.6748
max_acc 0.9276 max_p 0.7240 max_r 0.7038 max_f1 0.7138

Average max cause: max_acc 0.8963 max_p 0.6667 max_r 0.5363 max_f1 0.5944
Average max pos: max_acc 0.9164 max_p 0.6613 max_r 0.7143 max_f1 0.6868

write pair_data/Ind_BiLSTM_2/fold_2_test.txt done
write pair_data/Ind_BiLSTM_2/fold_2_train.txt done
Optimization Finished!

############# fold 2 end ###############
############# fold 3 begin ###############
load data_file: data_combine_en/fold_3_train.txt
y_position.shape (2275, 75, 2)
y_cause.shape (2275, 75, 2)
x.shape (2275, 75, 30)
sen_len.shape (2275, 75)
doc_len.shape (2275,)
n_cut 107
load data done!

load data_file: data_combine_en/fold_3_test.txt
y_position.shape (284, 75, 2)
y_cause.shape (284, 75, 2)
x.shape (284, 75, 30)
sen_len.shape (284, 75)
doc_len.shape (284,)
n_cut 22
load data done!

train docs: 2275    test docs: 284
step 10: train loss 0.8005 
cause_predict: train acc 0.8657 p 0.0000 r 0.0000 f1 0.0000
position_predict: train acc 0.8869 p 0.0000 r 0.0000 f1 0.0000
step 20: train loss 0.6910 
cause_predict: train acc 0.8750 p 0.0000 r 0.0000 f1 0.0000
position_predict: train acc 0.8750 p 0.0000 r 0.0000 f1 0.0000
step 30: train loss 0.7152 
cause_predict: train acc 0.8596 p 0.0000 r 0.0000 f1 0.0000
position_predict: train acc 0.8553 p 0.0000 r 0.0000 f1 0.0000
step 40: train loss 0.5533 
cause_predict: train acc 0.8712 p 0.0000 r 0.0000 f1 0.0000
position_predict: train acc 0.8915 p 1.0000 r 0.0303 f1 0.0588
step 50: train loss 0.7120 
cause_predict: train acc 0.8263 p 0.0000 r 0.0000 f1 0.0000
position_predict: train acc 0.8545 p 0.5714 r 0.1250 f1 0.2051
step 60: train loss 0.6780 
cause_predict: train acc 0.8218 p 0.0000 r 0.0000 f1 0.0000
position_predict: train acc 0.8663 p 0.8571 r 0.1875 f1 0.3077
step 70: train loss 0.4998 
cause_predict: train acc 0.8727 p 1.0000 r 0.0286 f1 0.0556
position_predict: train acc 0.9101 p 0.7143 r 0.4545 f1 0.5556

epoch 0: test loss 0.5271 cost time: 12.2s

cause_predict: test acc 0.8753 p 0.9130 r 0.1325 f1 0.2314
max_acc 0.8753 max_p 0.9130 max_r 0.1325 max_f1 0.2314

position_predict: test acc 0.9187 p 0.7419 r 0.5610 f1 0.6389
max_acc 0.9187 max_p 0.7419 max_r 0.5610 max_f1 0.6389

Average max cause: max_acc 0.8753 max_p 0.9130 max_r 0.1325 max_f1 0.2314
Average max pos: max_acc 0.9187 max_p 0.7419 max_r 0.5610 max_f1 0.6389

step 10: train loss 0.4665 
cause_predict: train acc 0.8790 p 0.6250 r 0.1389 f1 0.2273
position_predict: train acc 0.9395 p 0.7586 r 0.6875 f1 0.7213
step 20: train loss 0.5412 
cause_predict: train acc 0.8768 p 0.7143 r 0.3125 f1 0.4348
position_predict: train acc 0.8957 p 0.7037 r 0.5758 f1 0.6333
step 30: train loss 0.6211 
cause_predict: train acc 0.8232 p 0.5000 r 0.2000 f1 0.2857
position_predict: train acc 0.9192 p 0.8077 r 0.6562 f1 0.7241
step 40: train loss 0.5904 
cause_predict: train acc 0.8652 p 0.8889 r 0.2105 f1 0.3404
position_predict: train acc 0.9174 p 0.7826 r 0.5625 f1 0.6545
step 50: train loss 0.6106 
cause_predict: train acc 0.8850 p 0.8235 r 0.4118 f1 0.5490
position_predict: train acc 0.8700 p 0.6000 r 0.5625 f1 0.5806
step 60: train loss 0.5414 
cause_predict: train acc 0.8713 p 0.6667 r 0.1579 f1 0.2553
position_predict: train acc 0.8971 p 0.5769 r 0.4688 f1 0.5172
step 70: train loss 0.5474 
cause_predict: train acc 0.8715 p 0.7692 r 0.2564 f1 0.3846
position_predict: train acc 0.8956 p 0.6071 r 0.5312 f1 0.5667

epoch 1: test loss 0.4825 cost time: 12.3s

cause_predict: test acc 0.8852 p 0.6685 r 0.3754 f1 0.4808
max_acc 0.8852 max_p 0.6685 max_r 0.3754 max_f1 0.4808

position_predict: test acc 0.9281 p 0.7582 r 0.6446 f1 0.6968
max_acc 0.9281 max_p 0.7582 max_r 0.6446 max_f1 0.6968

Average max cause: max_acc 0.8852 max_p 0.6685 max_r 0.3754 max_f1 0.4808
Average max pos: max_acc 0.9281 max_p 0.7582 max_r 0.6446 max_f1 0.6968

step 10: train loss 0.4567 
cause_predict: train acc 0.8595 p 0.4286 r 0.1463 f1 0.2182
position_predict: train acc 0.9379 p 0.7407 r 0.6250 f1 0.6780
step 20: train loss 0.5149 
cause_predict: train acc 0.8540 p 0.6842 r 0.3250 f1 0.4407
position_predict: train acc 0.9381 p 0.8214 r 0.7188 f1 0.7667
step 30: train loss 0.4187 
cause_predict: train acc 0.8718 p 0.7059 r 0.3243 f1 0.4444
position_predict: train acc 0.9444 p 0.7941 r 0.8182 f1 0.8060
step 40: train loss 0.4487 
cause_predict: train acc 0.9000 p 0.8667 r 0.3824 f1 0.5306
position_predict: train acc 0.9391 p 0.8750 r 0.6562 f1 0.7500
step 50: train loss 0.5550 
cause_predict: train acc 0.8674 p 1.0000 r 0.3514 f1 0.5200
position_predict: train acc 0.9227 p 0.8065 r 0.7576 f1 0.7812
step 60: train loss 0.4597 
cause_predict: train acc 0.8755 p 0.5556 r 0.2857 f1 0.3774
position_predict: train acc 0.9208 p 0.6774 r 0.6562 f1 0.6667
step 70: train loss 0.3501 
cause_predict: train acc 0.9240 p 0.8636 r 0.5278 f1 0.6552
position_predict: train acc 0.9658 p 0.8710 r 0.8438 f1 0.8571

epoch 2: test loss 0.4734 cost time: 12.1s

cause_predict: test acc 0.8928 p 0.7175 r 0.4006 f1 0.5142
max_acc 0.8928 max_p 0.7175 max_r 0.4006 max_f1 0.5142

position_predict: test acc 0.9254 p 0.7190 r 0.6864 f1 0.7023
max_acc 0.9254 max_p 0.7190 max_r 0.6864 max_f1 0.7023

Average max cause: max_acc 0.8928 max_p 0.7175 max_r 0.4006 max_f1 0.5142
Average max pos: max_acc 0.9254 max_p 0.7190 max_r 0.6864 max_f1 0.7023

step 10: train loss 0.3614 
cause_predict: train acc 0.9007 p 0.7500 r 0.3947 f1 0.5172
position_predict: train acc 0.9574 p 0.8125 r 0.8125 f1 0.8125
step 20: train loss 0.4724 
cause_predict: train acc 0.8690 p 0.7200 r 0.4390 f1 0.5455
position_predict: train acc 0.9345 p 0.7576 r 0.7812 f1 0.7692
step 30: train loss 0.4688 
cause_predict: train acc 0.9080 p 0.7600 r 0.5278 f1 0.6230
position_predict: train acc 0.9160 p 0.7097 r 0.6471 f1 0.6769
step 40: train loss 0.4491 
cause_predict: train acc 0.8658 p 0.5217 r 0.3750 f1 0.4364
position_predict: train acc 0.9177 p 0.6970 r 0.7188 f1 0.7077
step 50: train loss 0.4729 
cause_predict: train acc 0.8565 p 0.6000 r 0.3158 f1 0.4138
position_predict: train acc 0.9451 p 0.8276 r 0.7500 f1 0.7869
step 60: train loss 0.4966 
cause_predict: train acc 0.8764 p 0.7391 r 0.3953 f1 0.5152
position_predict: train acc 0.9151 p 0.6897 r 0.6061 f1 0.6452
step 70: train loss 0.4640 
cause_predict: train acc 0.8848 p 0.5556 r 0.3030 f1 0.3922
position_predict: train acc 0.9145 p 0.6552 r 0.5938 f1 0.6230

epoch 3: test loss 0.4710 cost time: 12.3s

cause_predict: test acc 0.8892 p 0.6845 r 0.4038 f1 0.5079
max_acc 0.8928 max_p 0.7175 max_r 0.4006 max_f1 0.5142

position_predict: test acc 0.9249 p 0.7262 r 0.6655 f1 0.6945
max_acc 0.9254 max_p 0.7190 max_r 0.6864 max_f1 0.7023

Average max cause: max_acc 0.8928 max_p 0.7175 max_r 0.4006 max_f1 0.5142
Average max pos: max_acc 0.9254 max_p 0.7190 max_r 0.6864 max_f1 0.7023

step 10: train loss 0.4134 
cause_predict: train acc 0.8874 p 0.7727 r 0.4474 f1 0.5667
position_predict: train acc 0.9394 p 0.8000 r 0.7500 f1 0.7742
step 20: train loss 0.4266 
cause_predict: train acc 0.9003 p 0.6667 r 0.4211 f1 0.5161
position_predict: train acc 0.9402 p 0.7419 r 0.6970 f1 0.7188
step 30: train loss 0.3765 
cause_predict: train acc 0.8950 p 0.7000 r 0.4242 f1 0.5283
position_predict: train acc 0.9664 p 0.9032 r 0.8485 f1 0.8750
step 40: train loss 0.3679 
cause_predict: train acc 0.9255 p 0.8636 r 0.5429 f1 0.6667
position_predict: train acc 0.9451 p 0.8519 r 0.6970 f1 0.7667
step 50: train loss 0.4968 
cause_predict: train acc 0.8365 p 0.5926 r 0.4103 f1 0.4848
position_predict: train acc 0.9375 p 0.7941 r 0.8182 f1 0.8060
step 60: train loss 0.3102 
cause_predict: train acc 0.9071 p 0.6471 r 0.6111 f1 0.6286
position_predict: train acc 0.9679 p 0.8966 r 0.8125 f1 0.8525
step 70: train loss 0.3798 
cause_predict: train acc 0.8925 p 0.7333 r 0.6471 f1 0.6875
position_predict: train acc 0.9462 p 0.8667 r 0.8125 f1 0.8387

epoch 4: test loss 0.4877 cost time: 12.5s

cause_predict: test acc 0.8865 p 0.6226 r 0.5047 f1 0.5575
max_acc 0.8865 max_p 0.6226 max_r 0.5047 max_f1 0.5575

position_predict: test acc 0.9191 p 0.6803 r 0.6969 f1 0.6885
max_acc 0.9254 max_p 0.7190 max_r 0.6864 max_f1 0.7023

Average max cause: max_acc 0.8865 max_p 0.6226 max_r 0.5047 max_f1 0.5575
Average max pos: max_acc 0.9191 max_p 0.6803 max_r 0.6969 max_f1 0.6885

step 10: train loss 0.3897 
cause_predict: train acc 0.9128 p 0.7353 r 0.7576 f1 0.7463
position_predict: train acc 0.9487 p 0.8667 r 0.8125 f1 0.8387
step 20: train loss 0.3523 
cause_predict: train acc 0.9220 p 0.8846 r 0.6389 f1 0.7419
position_predict: train acc 0.9561 p 0.8485 r 0.8750 f1 0.8615
step 30: train loss 0.3088 
cause_predict: train acc 0.9129 p 0.8276 r 0.6000 f1 0.6957
position_predict: train acc 0.9751 p 0.9333 r 0.8750 f1 0.9032
step 40: train loss 0.3090 
cause_predict: train acc 0.9266 p 0.7500 r 0.6857 f1 0.7164
position_predict: train acc 0.9421 p 0.7742 r 0.7500 f1 0.7619
step 50: train loss 0.3460 
cause_predict: train acc 0.9277 p 0.8929 r 0.7353 f1 0.8065
position_predict: train acc 0.9337 p 0.8438 r 0.8182 f1 0.8308
step 60: train loss 0.3126 
cause_predict: train acc 0.9130 p 0.8462 r 0.5238 f1 0.6471
position_predict: train acc 0.9601 p 0.8387 r 0.8125 f1 0.8254
step 70: train loss 0.2990 
cause_predict: train acc 0.9170 p 0.6875 r 0.6667 f1 0.6769
position_predict: train acc 0.9605 p 0.8485 r 0.8485 f1 0.8485

epoch 5: test loss 0.5107 cost time: 12.4s

cause_predict: test acc 0.8914 p 0.6850 r 0.4322 f1 0.5300
max_acc 0.8865 max_p 0.6226 max_r 0.5047 max_f1 0.5575

position_predict: test acc 0.9227 p 0.7007 r 0.6934 f1 0.6970
max_acc 0.9254 max_p 0.7190 max_r 0.6864 max_f1 0.7023

Average max cause: max_acc 0.8865 max_p 0.6226 max_r 0.5047 max_f1 0.5575
Average max pos: max_acc 0.9191 max_p 0.6803 max_r 0.6969 max_f1 0.6885

step 10: train loss 0.2838 
cause_predict: train acc 0.9133 p 0.8438 r 0.7297 f1 0.7826
position_predict: train acc 0.9711 p 0.9667 r 0.8788 f1 0.9206
step 20: train loss 0.3591 
cause_predict: train acc 0.9522 p 0.8966 r 0.7879 f1 0.8387
position_predict: train acc 0.9139 p 0.7333 r 0.6875 f1 0.7097
step 30: train loss 0.2818 
cause_predict: train acc 0.9280 p 0.8387 r 0.6667 f1 0.7429
position_predict: train acc 0.9680 p 0.8750 r 0.8750 f1 0.8750
step 40: train loss 0.4078 
cause_predict: train acc 0.9000 p 0.6667 r 0.5405 f1 0.5970
position_predict: train acc 0.9370 p 0.7419 r 0.7188 f1 0.7302
step 50: train loss 0.3312 
cause_predict: train acc 0.8884 p 0.6250 r 0.5882 f1 0.6061
position_predict: train acc 0.9485 p 0.7941 r 0.8438 f1 0.8182
step 60: train loss 0.2390 
cause_predict: train acc 0.9514 p 0.8235 r 0.8235 f1 0.8235
position_predict: train acc 0.9798 p 0.9091 r 0.9375 f1 0.9231
step 70: train loss 0.3605 
cause_predict: train acc 0.9333 p 0.8000 r 0.7273 f1 0.7619
position_predict: train acc 0.9600 p 0.8485 r 0.8750 f1 0.8615

epoch 6: test loss 0.5094 cost time: 12.3s

cause_predict: test acc 0.8843 p 0.6098 r 0.5079 f1 0.5542
max_acc 0.8865 max_p 0.6226 max_r 0.5047 max_f1 0.5575

position_predict: test acc 0.9227 p 0.7080 r 0.6760 f1 0.6916
max_acc 0.9254 max_p 0.7190 max_r 0.6864 max_f1 0.7023

Average max cause: max_acc 0.8865 max_p 0.6226 max_r 0.5047 max_f1 0.5575
Average max pos: max_acc 0.9191 max_p 0.6803 max_r 0.6969 max_f1 0.6885

step 10: train loss 0.2198 
cause_predict: train acc 0.9354 p 0.8065 r 0.6944 f1 0.7463
position_predict: train acc 0.9620 p 0.8667 r 0.8125 f1 0.8387
step 20: train loss 0.1961 
cause_predict: train acc 0.9714 p 0.8649 r 0.8889 f1 0.8767
position_predict: train acc 0.9524 p 0.8000 r 0.7273 f1 0.7619
step 30: train loss 0.2182 
cause_predict: train acc 0.9524 p 0.9310 r 0.7714 f1 0.8438
position_predict: train acc 0.9714 p 0.9333 r 0.8750 f1 0.9032
step 40: train loss 0.1780 
cause_predict: train acc 0.9526 p 0.8788 r 0.7632 f1 0.8169
position_predict: train acc 0.9708 p 0.8529 r 0.9062 f1 0.8788
step 50: train loss 0.2130 
cause_predict: train acc 0.9595 p 0.9000 r 0.8780 f1 0.8889
position_predict: train acc 0.9640 p 0.9000 r 0.8438 f1 0.8710
step 60: train loss 0.2639 
cause_predict: train acc 0.9564 p 0.8929 r 0.7353 f1 0.8065
position_predict: train acc 0.9164 p 0.6562 r 0.6364 f1 0.6462
step 70: train loss 0.1989 
cause_predict: train acc 0.9662 p 0.9394 r 0.8611 f1 0.8986
position_predict: train acc 0.9662 p 0.8824 r 0.9091 f1 0.8955

epoch 7: test loss 0.5560 cost time: 12.2s

cause_predict: test acc 0.8874 p 0.6265 r 0.5079 f1 0.5610
max_acc 0.8874 max_p 0.6265 max_r 0.5079 max_f1 0.5610

position_predict: test acc 0.9209 p 0.6950 r 0.6829 f1 0.6889
max_acc 0.9254 max_p 0.7190 max_r 0.6864 max_f1 0.7023

Average max cause: max_acc 0.8874 max_p 0.6265 max_r 0.5079 max_f1 0.5610
Average max pos: max_acc 0.9209 max_p 0.6950 max_r 0.6829 max_f1 0.6889

step 10: train loss 0.1862 
cause_predict: train acc 0.9686 p 0.9375 r 0.8571 f1 0.8955
position_predict: train acc 0.9596 p 0.9259 r 0.7812 f1 0.8475
step 20: train loss 0.1881 
cause_predict: train acc 0.9663 p 0.9412 r 0.8205 f1 0.8767
position_predict: train acc 0.9775 p 0.9333 r 0.8750 f1 0.9032
step 30: train loss 0.1862 
cause_predict: train acc 0.9669 p 0.9630 r 0.7429 f1 0.8387
position_predict: train acc 0.9570 p 0.8276 r 0.7500 f1 0.7869
step 40: train loss 0.2413 
cause_predict: train acc 0.9258 p 0.7576 r 0.7353 f1 0.7463
position_predict: train acc 0.9782 p 0.9355 r 0.9062 f1 0.9206
step 50: train loss 0.2220 
cause_predict: train acc 0.9509 p 0.8649 r 0.8421 f1 0.8533
position_predict: train acc 0.9732 p 0.8824 r 0.9375 f1 0.9091
step 60: train loss 0.1761 
cause_predict: train acc 0.9732 p 0.9167 r 0.9167 f1 0.9167
position_predict: train acc 0.9732 p 0.9333 r 0.8750 f1 0.9032
step 70: train loss 0.2516 
cause_predict: train acc 0.9424 p 0.8056 r 0.8056 f1 0.8056
position_predict: train acc 0.9671 p 0.9032 r 0.8485 f1 0.8750

epoch 8: test loss 0.6164 cost time: 12.4s

cause_predict: test acc 0.8829 p 0.5993 r 0.5237 f1 0.5589
max_acc 0.8874 max_p 0.6265 max_r 0.5079 max_f1 0.5610

position_predict: test acc 0.9182 p 0.7016 r 0.6307 f1 0.6642
max_acc 0.9254 max_p 0.7190 max_r 0.6864 max_f1 0.7023

Average max cause: max_acc 0.8874 max_p 0.6265 max_r 0.5079 max_f1 0.5610
Average max pos: max_acc 0.9209 max_p 0.6950 max_r 0.6829 max_f1 0.6889

step 10: train loss 0.1954 
cause_predict: train acc 0.9591 p 0.9268 r 0.8636 f1 0.8941
position_predict: train acc 0.9545 p 0.8235 r 0.8750 f1 0.8485
step 20: train loss 0.2281 
cause_predict: train acc 0.9552 p 0.8947 r 0.8500 f1 0.8718
position_predict: train acc 0.9552 p 0.8438 r 0.8438 f1 0.8438
step 30: train loss 0.1363 
cause_predict: train acc 0.9796 p 0.9118 r 0.9394 f1 0.9254
position_predict: train acc 0.9755 p 0.9355 r 0.8788 f1 0.9062
step 40: train loss 0.1785 
cause_predict: train acc 0.9593 p 0.8485 r 0.8485 f1 0.8485
position_predict: train acc 0.9715 p 0.9032 r 0.8750 f1 0.8889
step 50: train loss 0.1815 
cause_predict: train acc 0.9696 p 0.9167 r 0.8684 f1 0.8919
position_predict: train acc 0.9582 p 0.8438 r 0.8182 f1 0.8308
step 60: train loss 0.2220 
cause_predict: train acc 0.9424 p 0.7568 r 0.7778 f1 0.7671
position_predict: train acc 0.9695 p 0.8485 r 0.8750 f1 0.8615
step 70: train loss 0.2938 
cause_predict: train acc 0.9267 p 0.7647 r 0.6842 f1 0.7222
position_predict: train acc 0.9707 p 0.8750 r 0.8750 f1 0.8750

epoch 9: test loss 0.6157 cost time: 12.2s

cause_predict: test acc 0.8794 p 0.5819 r 0.5268 f1 0.5530
max_acc 0.8874 max_p 0.6265 max_r 0.5079 max_f1 0.5610

position_predict: test acc 0.9102 p 0.6387 r 0.6899 f1 0.6633
max_acc 0.9254 max_p 0.7190 max_r 0.6864 max_f1 0.7023

Average max cause: max_acc 0.8874 max_p 0.6265 max_r 0.5079 max_f1 0.5610
Average max pos: max_acc 0.9209 max_p 0.6950 max_r 0.6829 max_f1 0.6889

step 10: train loss 0.2126 
cause_predict: train acc 0.9636 p 0.9032 r 0.8235 f1 0.8615
position_predict: train acc 0.9555 p 0.8621 r 0.7812 f1 0.8197
step 20: train loss 0.1378 
cause_predict: train acc 0.9715 p 0.9394 r 0.8611 f1 0.8986
position_predict: train acc 0.9756 p 0.9062 r 0.9062 f1 0.9062
step 30: train loss 0.1308 
cause_predict: train acc 0.9954 p 0.9744 r 1.0000 f1 0.9870
position_predict: train acc 0.9676 p 0.8788 r 0.9062 f1 0.8923
step 40: train loss 0.1093 
cause_predict: train acc 0.9694 p 0.9688 r 0.8378 f1 0.8986
position_predict: train acc 0.9869 p 0.9677 r 0.9375 f1 0.9524
step 50: train loss 0.1154 
cause_predict: train acc 0.9811 p 0.9474 r 0.9231 f1 0.9351
position_predict: train acc 0.9735 p 0.8611 r 0.9394 f1 0.8986
step 60: train loss 0.1986 
cause_predict: train acc 0.9648 p 0.9062 r 0.8529 f1 0.8788
position_predict: train acc 0.9471 p 0.8000 r 0.8485 f1 0.8235
step 70: train loss 0.1443 
cause_predict: train acc 0.9588 p 0.8140 r 0.9211 f1 0.8642
position_predict: train acc 0.9700 p 0.9000 r 0.8438 f1 0.8710

epoch 10: test loss 0.6809 cost time: 12.3s

cause_predict: test acc 0.8767 p 0.5704 r 0.5237 f1 0.5461
max_acc 0.8874 max_p 0.6265 max_r 0.5079 max_f1 0.5610

position_predict: test acc 0.9223 p 0.7148 r 0.6551 f1 0.6836
max_acc 0.9254 max_p 0.7190 max_r 0.6864 max_f1 0.7023

Average max cause: max_acc 0.8874 max_p 0.6265 max_r 0.5079 max_f1 0.5610
Average max pos: max_acc 0.9209 max_p 0.6950 max_r 0.6829 max_f1 0.6889

step 10: train loss 0.1107 
cause_predict: train acc 0.9844 p 1.0000 r 0.8974 f1 0.9459
position_predict: train acc 0.9689 p 0.8824 r 0.8824 f1 0.8824
step 20: train loss 0.1594 
cause_predict: train acc 0.9621 p 0.8889 r 0.8421 f1 0.8649
position_predict: train acc 0.9735 p 0.9091 r 0.8824 f1 0.8955
step 30: train loss 0.1328 
cause_predict: train acc 0.9585 p 0.8974 r 0.8974 f1 0.8974
position_predict: train acc 0.9845 p 0.9394 r 0.9688 f1 0.9538
step 40: train loss 0.1307 
cause_predict: train acc 0.9843 p 0.9474 r 0.9474 f1 0.9474
position_predict: train acc 0.9685 p 0.8571 r 0.9091 f1 0.8824
step 50: train loss 0.2376 
cause_predict: train acc 0.9685 p 0.8857 r 0.8857 f1 0.8857
position_predict: train acc 0.9488 p 0.7879 r 0.8125 f1 0.8000
step 60: train loss 0.2405 
cause_predict: train acc 0.9540 p 0.7838 r 0.8788 f1 0.8286
position_predict: train acc 0.9540 p 0.8182 r 0.8182 f1 0.8182
step 70: train loss 0.2672 
cause_predict: train acc 0.9319 p 0.8000 r 0.7059 f1 0.7500
position_predict: train acc 0.9660 p 0.9000 r 0.8438 f1 0.8710

epoch 11: test loss 0.7128 cost time: 12.5s

cause_predict: test acc 0.8753 p 0.5621 r 0.5426 f1 0.5522
max_acc 0.8874 max_p 0.6265 max_r 0.5079 max_f1 0.5610

position_predict: test acc 0.9209 p 0.6964 r 0.6794 f1 0.6878
max_acc 0.9254 max_p 0.7190 max_r 0.6864 max_f1 0.7023

Average max cause: max_acc 0.8874 max_p 0.6265 max_r 0.5079 max_f1 0.5610
Average max pos: max_acc 0.9209 max_p 0.6950 max_r 0.6829 max_f1 0.6889

step 10: train loss 0.0929 
cause_predict: train acc 0.9827 p 0.9730 r 0.9231 f1 0.9474
position_predict: train acc 0.9827 p 0.9118 r 0.9688 f1 0.9394
step 20: train loss 0.1391 
cause_predict: train acc 0.9728 p 0.8571 r 0.9375 f1 0.8955
position_predict: train acc 0.9689 p 0.8824 r 0.8824 f1 0.8824
step 30: train loss 0.1195 
cause_predict: train acc 0.9847 p 0.9167 r 0.9706 f1 0.9429
position_predict: train acc 0.9579 p 0.8387 r 0.8125 f1 0.8254
step 40: train loss 0.1301 
cause_predict: train acc 0.9779 p 0.9412 r 0.8889 f1 0.9143
position_predict: train acc 0.9779 p 0.9333 r 0.8750 f1 0.9032
step 50: train loss 0.1057 
cause_predict: train acc 0.9863 p 0.9512 r 0.9512 f1 0.9512
position_predict: train acc 0.9658 p 0.8667 r 0.8125 f1 0.8387
step 60: train loss 0.0786 
cause_predict: train acc 0.9821 p 0.9706 r 0.9167 f1 0.9429
position_predict: train acc 0.9955 p 0.9697 r 1.0000 f1 0.9846
step 70: train loss 0.1630 
cause_predict: train acc 0.9691 p 0.8974 r 0.8750 f1 0.8861
position_predict: train acc 0.9725 p 0.8529 r 0.9062 f1 0.8788

epoch 12: test loss 0.7415 cost time: 12.5s

cause_predict: test acc 0.8932 p 0.6413 r 0.5584 f1 0.5970
max_acc 0.8932 max_p 0.6413 max_r 0.5584 max_f1 0.5970

position_predict: test acc 0.9120 p 0.6510 r 0.6760 f1 0.6632
max_acc 0.9254 max_p 0.7190 max_r 0.6864 max_f1 0.7023

Average max cause: max_acc 0.8932 max_p 0.6413 max_r 0.5584 max_f1 0.5970
Average max pos: max_acc 0.9120 max_p 0.6510 max_r 0.6760 max_f1 0.6632

step 10: train loss 0.1268 
cause_predict: train acc 0.9643 p 0.9118 r 0.8611 f1 0.8857
position_predict: train acc 0.9911 p 0.9412 r 1.0000 f1 0.9697
step 20: train loss 0.0623 
cause_predict: train acc 0.9966 p 1.0000 r 0.9697 f1 0.9846
position_predict: train acc 0.9795 p 0.9062 r 0.9062 f1 0.9062
step 30: train loss 0.0853 
cause_predict: train acc 0.9929 p 0.9722 r 0.9722 f1 0.9722
position_predict: train acc 0.9645 p 0.8929 r 0.7812 f1 0.8333
step 40: train loss 0.0525 
cause_predict: train acc 0.9846 p 0.9412 r 0.9412 f1 0.9412
position_predict: train acc 0.9923 p 0.9697 r 0.9697 f1 0.9697
step 50: train loss 0.2825 
cause_predict: train acc 0.9449 p 0.8056 r 0.8286 f1 0.8169
position_predict: train acc 0.9280 p 0.7273 r 0.7500 f1 0.7385
step 60: train loss 0.1155 
cause_predict: train acc 0.9774 p 0.9118 r 0.9394 f1 0.9254
position_predict: train acc 0.9683 p 0.9032 r 0.8750 f1 0.8889
step 70: train loss 0.1001 
cause_predict: train acc 0.9868 p 0.9412 r 0.9412 f1 0.9412
position_predict: train acc 0.9703 p 0.8485 r 0.8750 f1 0.8615

epoch 13: test loss 0.7181 cost time: 12.3s

cause_predict: test acc 0.8843 p 0.5993 r 0.5521 f1 0.5747
max_acc 0.8932 max_p 0.6413 max_r 0.5584 max_f1 0.5970

position_predict: test acc 0.9169 p 0.6712 r 0.6899 f1 0.6804
max_acc 0.9254 max_p 0.7190 max_r 0.6864 max_f1 0.7023

Average max cause: max_acc 0.8932 max_p 0.6413 max_r 0.5584 max_f1 0.5970
Average max pos: max_acc 0.9120 max_p 0.6510 max_r 0.6760 max_f1 0.6632

step 10: train loss 0.0771 
cause_predict: train acc 0.9833 p 0.9767 r 0.9333 f1 0.9545
position_predict: train acc 0.9833 p 0.9412 r 0.9412 f1 0.9412
step 20: train loss 0.1209 
cause_predict: train acc 0.9803 p 0.9167 r 0.9429 f1 0.9296
position_predict: train acc 0.9685 p 0.8750 r 0.8750 f1 0.8750
step 30: train loss 0.0971 
cause_predict: train acc 0.9827 p 0.9394 r 0.9394 f1 0.9394
position_predict: train acc 0.9697 p 0.9062 r 0.8788 f1 0.8923
step 40: train loss 0.1122 
cause_predict: train acc 0.9922 p 0.9459 r 1.0000 f1 0.9722
position_predict: train acc 0.9609 p 0.8438 r 0.8438 f1 0.8438
step 50: train loss 0.1041 
cause_predict: train acc 0.9876 p 0.9231 r 0.9730 f1 0.9474
position_predict: train acc 0.9752 p 0.8750 r 0.8750 f1 0.8750
step 60: train loss 0.1599 
cause_predict: train acc 0.9594 p 0.9143 r 0.8649 f1 0.8889
position_predict: train acc 0.9645 p 0.9062 r 0.8788 f1 0.8923
step 70: train loss 0.0999 
cause_predict: train acc 0.9776 p 0.9167 r 0.9429 f1 0.9296
position_predict: train acc 0.9865 p 0.9677 r 0.9375 f1 0.9524

epoch 14: test loss 0.8021 cost time: 12.3s

cause_predict: test acc 0.8762 p 0.5667 r 0.5363 f1 0.5511
max_acc 0.8932 max_p 0.6413 max_r 0.5584 max_f1 0.5970

position_predict: test acc 0.9173 p 0.6783 r 0.6760 f1 0.6771
max_acc 0.9254 max_p 0.7190 max_r 0.6864 max_f1 0.7023

Average max cause: max_acc 0.8932 max_p 0.6413 max_r 0.5584 max_f1 0.5970
Average max pos: max_acc 0.9120 max_p 0.6510 max_r 0.6760 max_f1 0.6632

write pair_data/Ind_BiLSTM_2/fold_3_test.txt done
write pair_data/Ind_BiLSTM_2/fold_3_train.txt done
Optimization Finished!

############# fold 3 end ###############
############# fold 4 begin ###############
load data_file: data_combine_en/fold_4_train.txt
y_position.shape (2275, 75, 2)
y_cause.shape (2275, 75, 2)
x.shape (2275, 75, 30)
sen_len.shape (2275, 75)
doc_len.shape (2275,)
n_cut 107
load data done!

load data_file: data_combine_en/fold_4_test.txt
y_position.shape (284, 75, 2)
y_cause.shape (284, 75, 2)
x.shape (284, 75, 30)
sen_len.shape (284, 75)
doc_len.shape (284,)
n_cut 22
load data done!

train docs: 2275    test docs: 284
step 10: train loss 0.7851 
cause_predict: train acc 0.8754 p 0.0000 r 0.0000 f1 0.0000
position_predict: train acc 0.8893 p 0.0000 r 0.0000 f1 0.0000
step 20: train loss 0.8640 
cause_predict: train acc 0.8143 p 0.0000 r 0.0000 f1 0.0000
position_predict: train acc 0.8476 p 0.0000 r 0.0000 f1 0.0000
step 30: train loss 0.6140 
cause_predict: train acc 0.8849 p 0.0000 r 0.0000 f1 0.0000
position_predict: train acc 0.8947 p 0.0000 r 0.0000 f1 0.0000
step 40: train loss 0.6017 
cause_predict: train acc 0.8642 p 0.0000 r 0.0000 f1 0.0000
position_predict: train acc 0.8683 p 0.0000 r 0.0000 f1 0.0000
step 50: train loss 0.5791 
cause_predict: train acc 0.8492 p 0.0000 r 0.0000 f1 0.0000
position_predict: train acc 0.9127 p 0.6923 r 0.5625 f1 0.6207
step 60: train loss 0.5532 
cause_predict: train acc 0.8700 p 0.0000 r 0.0000 f1 0.0000
position_predict: train acc 0.9025 p 0.6087 r 0.4375 f1 0.5091
step 70: train loss 0.5225 
cause_predict: train acc 0.8722 p 0.0000 r 0.0000 f1 0.0000
position_predict: train acc 0.9098 p 0.8235 r 0.4000 f1 0.5385

epoch 0: test loss 0.5364 cost time: 12.3s

cause_predict: test acc 0.8592 p 1.0000 r 0.0063 f1 0.0125
max_acc 0.8592 max_p 1.0000 max_r 0.0063 max_f1 0.0125

position_predict: test acc 0.9133 p 0.7268 r 0.5192 f1 0.6057
max_acc 0.9133 max_p 0.7268 max_r 0.5192 max_f1 0.6057

Average max cause: max_acc 0.8592 max_p 1.0000 max_r 0.0063 max_f1 0.0125
Average max pos: max_acc 0.9133 max_p 0.7268 max_r 0.5192 max_f1 0.6057

step 10: train loss 0.5576 
cause_predict: train acc 0.8478 p 1.0000 r 0.0278 f1 0.0541
position_predict: train acc 0.8870 p 0.6207 r 0.5455 f1 0.5806
step 20: train loss 0.4836 
cause_predict: train acc 0.8881 p 0.8750 r 0.1842 f1 0.3043
position_predict: train acc 0.9301 p 0.7826 r 0.5455 f1 0.6429
step 30: train loss 0.4757 
cause_predict: train acc 0.8621 p 0.8333 r 0.1389 f1 0.2381
position_predict: train acc 0.9397 p 0.8065 r 0.7576 f1 0.7812
step 40: train loss 0.5761 
cause_predict: train acc 0.8590 p 0.6667 r 0.3077 f1 0.4211
position_predict: train acc 0.8803 p 0.5714 r 0.5000 f1 0.5333
step 50: train loss 0.4525 
cause_predict: train acc 0.8902 p 0.8333 r 0.2778 f1 0.4167
position_predict: train acc 0.9255 p 0.7692 r 0.6061 f1 0.6780
step 60: train loss 0.4842 
cause_predict: train acc 0.8802 p 0.7333 r 0.3333 f1 0.4583
position_predict: train acc 0.9078 p 0.7600 r 0.5758 f1 0.6552
step 70: train loss 0.4711 
cause_predict: train acc 0.8881 p 0.8750 r 0.1944 f1 0.3182
position_predict: train acc 0.9179 p 0.6667 r 0.6250 f1 0.6452

epoch 1: test loss 0.4957 cost time: 12.4s

cause_predict: test acc 0.8856 p 0.7607 r 0.2808 f1 0.4101
max_acc 0.8856 max_p 0.7607 max_r 0.2808 max_f1 0.4101

position_predict: test acc 0.9218 p 0.8011 r 0.5192 f1 0.6300
max_acc 0.9218 max_p 0.8011 max_r 0.5192 max_f1 0.6300

Average max cause: max_acc 0.8856 max_p 0.7607 max_r 0.2808 max_f1 0.4101
Average max pos: max_acc 0.9218 max_p 0.8011 max_r 0.5192 max_f1 0.6300

step 10: train loss 0.4559 
cause_predict: train acc 0.8940 p 0.6400 r 0.4324 f1 0.5161
position_predict: train acc 0.9152 p 0.6818 r 0.4688 f1 0.5556
step 20: train loss 0.4657 
cause_predict: train acc 0.8598 p 0.7727 r 0.4857 f1 0.5965
position_predict: train acc 0.9390 p 0.8438 r 0.8438 f1 0.8438
step 30: train loss 0.3704 
cause_predict: train acc 0.8976 p 0.7857 r 0.2895 f1 0.4231
position_predict: train acc 0.9454 p 0.7353 r 0.7812 f1 0.7576
step 40: train loss 0.3714 
cause_predict: train acc 0.8953 p 0.6875 r 0.3143 f1 0.4314
position_predict: train acc 0.9675 p 0.8485 r 0.8750 f1 0.8615
step 50: train loss 0.5855 
cause_predict: train acc 0.8458 p 0.6667 r 0.2927 f1 0.4068
position_predict: train acc 0.9295 p 0.7931 r 0.6970 f1 0.7419
step 60: train loss 0.4722 
cause_predict: train acc 0.8830 p 0.6667 r 0.2162 f1 0.3265
position_predict: train acc 0.9220 p 0.6786 r 0.5938 f1 0.6333
step 70: train loss 0.4810 
cause_predict: train acc 0.8740 p 0.5833 r 0.2059 f1 0.3043
position_predict: train acc 0.9213 p 0.7500 r 0.5625 f1 0.6429

epoch 2: test loss 0.4685 cost time: 12.7s

cause_predict: test acc 0.8870 p 0.6538 r 0.4290 f1 0.5181
max_acc 0.8870 max_p 0.6538 max_r 0.4290 max_f1 0.5181

position_predict: test acc 0.9254 p 0.7362 r 0.6516 f1 0.6913
max_acc 0.9254 max_p 0.7362 max_r 0.6516 max_f1 0.6913

Average max cause: max_acc 0.8870 max_p 0.6538 max_r 0.4290 max_f1 0.5181
Average max pos: max_acc 0.9254 max_p 0.7362 max_r 0.6516 max_f1 0.6913

step 10: train loss 0.4324 
cause_predict: train acc 0.8945 p 0.7368 r 0.3684 f1 0.4912
position_predict: train acc 0.9309 p 0.7600 r 0.5938 f1 0.6667
step 20: train loss 0.4300 
cause_predict: train acc 0.9125 p 0.8095 r 0.4722 f1 0.5965
position_predict: train acc 0.9202 p 0.6875 r 0.6667 f1 0.6769
step 30: train loss 0.4396 
cause_predict: train acc 0.8851 p 0.8235 r 0.3684 f1 0.5091
position_predict: train acc 0.9404 p 0.8750 r 0.6562 f1 0.7500
step 40: train loss 0.4103 
cause_predict: train acc 0.8824 p 0.6522 r 0.4286 f1 0.5172
position_predict: train acc 0.9370 p 0.8148 r 0.6875 f1 0.7458
step 50: train loss 0.4848 
cause_predict: train acc 0.8739 p 0.7647 r 0.3421 f1 0.4727
position_predict: train acc 0.9174 p 0.7241 r 0.6562 f1 0.6885
step 60: train loss 0.4164 
cause_predict: train acc 0.8849 p 0.6500 r 0.3714 f1 0.4727
position_predict: train acc 0.9325 p 0.7667 r 0.6970 f1 0.7302
step 70: train loss 0.4149 
cause_predict: train acc 0.8912 p 0.5909 r 0.3714 f1 0.4561
position_predict: train acc 0.9298 p 0.7097 r 0.6667 f1 0.6875

epoch 3: test loss 0.4718 cost time: 12.8s

cause_predict: test acc 0.8941 p 0.7105 r 0.4259 f1 0.5325
max_acc 0.8941 max_p 0.7105 max_r 0.4259 max_f1 0.5325

position_predict: test acc 0.9249 p 0.7297 r 0.6585 f1 0.6923
max_acc 0.9249 max_p 0.7297 max_r 0.6585 max_f1 0.6923

Average max cause: max_acc 0.8941 max_p 0.7105 max_r 0.4259 max_f1 0.5325
Average max pos: max_acc 0.9249 max_p 0.7297 max_r 0.6585 max_f1 0.6923

step 10: train loss 0.3322 
cause_predict: train acc 0.9151 p 0.8500 r 0.4595 f1 0.5965
position_predict: train acc 0.9557 p 0.7632 r 0.9062 f1 0.8286
step 20: train loss 0.2798 
cause_predict: train acc 0.9127 p 0.7200 r 0.5143 f1 0.6000
position_predict: train acc 0.9745 p 0.9062 r 0.8788 f1 0.8923
step 30: train loss 0.4836 
cause_predict: train acc 0.8945 p 0.8421 r 0.4706 f1 0.6038
position_predict: train acc 0.9045 p 0.7500 r 0.6364 f1 0.6885
step 40: train loss 0.3797 
cause_predict: train acc 0.9056 p 0.7200 r 0.5455 f1 0.6207
position_predict: train acc 0.9399 p 0.8000 r 0.7500 f1 0.7742
step 50: train loss 0.4285 
cause_predict: train acc 0.9031 p 0.8333 r 0.4412 f1 0.5769
position_predict: train acc 0.9163 p 0.7407 r 0.6250 f1 0.6780
step 60: train loss 0.4353 
cause_predict: train acc 0.8914 p 0.6190 r 0.3421 f1 0.4407
position_predict: train acc 0.9375 p 0.7241 r 0.6562 f1 0.6885
step 70: train loss 0.4057 
cause_predict: train acc 0.9000 p 0.8421 r 0.4324 f1 0.5714
position_predict: train acc 0.9250 p 0.7059 r 0.7500 f1 0.7273

epoch 4: test loss 0.4816 cost time: 12.4s

cause_predict: test acc 0.8865 p 0.6780 r 0.3785 f1 0.4858
max_acc 0.8941 max_p 0.7105 max_r 0.4259 max_f1 0.5325

position_predict: test acc 0.9223 p 0.7025 r 0.6829 f1 0.6926
max_acc 0.9223 max_p 0.7025 max_r 0.6829 max_f1 0.6926

Average max cause: max_acc 0.8941 max_p 0.7105 max_r 0.4259 max_f1 0.5325
Average max pos: max_acc 0.9249 max_p 0.7297 max_r 0.6585 max_f1 0.6923

step 10: train loss 0.2692 
cause_predict: train acc 0.9432 p 0.8438 r 0.7297 f1 0.7826
position_predict: train acc 0.9583 p 0.8889 r 0.7500 f1 0.8136
step 20: train loss 0.2612 
cause_predict: train acc 0.9366 p 0.7333 r 0.5946 f1 0.6567
position_predict: train acc 0.9559 p 0.7857 r 0.6875 f1 0.7333
step 30: train loss 0.3931 
cause_predict: train acc 0.8967 p 0.6667 r 0.5641 f1 0.6111
position_predict: train acc 0.9520 p 0.7568 r 0.8750 f1 0.8116
step 40: train loss 0.2178 
cause_predict: train acc 0.9419 p 0.7879 r 0.7647 f1 0.7761
position_predict: train acc 0.9922 p 0.9688 r 0.9688 f1 0.9688
step 50: train loss 0.3975 
cause_predict: train acc 0.9100 p 0.8148 r 0.6111 f1 0.6984
position_predict: train acc 0.9242 p 0.7222 r 0.8125 f1 0.7647
step 60: train loss 0.3455 
cause_predict: train acc 0.9315 p 0.7568 r 0.8235 f1 0.7887
position_predict: train acc 0.9452 p 0.8387 r 0.7879 f1 0.8125
step 70: train loss 0.3418 
cause_predict: train acc 0.8937 p 0.6471 r 0.5946 f1 0.6197
position_predict: train acc 0.9409 p 0.7742 r 0.7500 f1 0.7619

epoch 5: test loss 0.5105 cost time: 12.3s

cause_predict: test acc 0.8892 p 0.6667 r 0.4353 f1 0.5267
max_acc 0.8941 max_p 0.7105 max_r 0.4259 max_f1 0.5325

position_predict: test acc 0.9263 p 0.7276 r 0.6794 f1 0.7027
max_acc 0.9263 max_p 0.7276 max_r 0.6794 max_f1 0.7027

Average max cause: max_acc 0.8892 max_p 0.6667 max_r 0.4353 max_f1 0.5267
Average max pos: max_acc 0.9263 max_p 0.7276 max_r 0.6794 max_f1 0.7027

step 10: train loss 0.2175 
cause_predict: train acc 0.9426 p 0.8800 r 0.6667 f1 0.7586
position_predict: train acc 0.9713 p 0.9310 r 0.8438 f1 0.8852
step 20: train loss 0.2030 
cause_predict: train acc 0.9548 p 0.8462 r 0.8919 f1 0.8684
position_predict: train acc 0.9593 p 0.8966 r 0.8125 f1 0.8525
step 30: train loss 0.3563 
cause_predict: train acc 0.9070 p 0.6857 r 0.6486 f1 0.6667
position_predict: train acc 0.9341 p 0.7667 r 0.6970 f1 0.7302
step 40: train loss 0.2166 
cause_predict: train acc 0.9545 p 0.8929 r 0.7812 f1 0.8333
position_predict: train acc 0.9682 p 0.8788 r 0.9062 f1 0.8923
step 50: train loss 0.3547 
cause_predict: train acc 0.9237 p 0.7429 r 0.7429 f1 0.7429
position_predict: train acc 0.9364 p 0.7812 r 0.7576 f1 0.7692
step 60: train loss 0.2325 
cause_predict: train acc 0.9302 p 0.8148 r 0.5789 f1 0.6769
position_predict: train acc 0.9734 p 0.9000 r 0.8438 f1 0.8710
step 70: train loss 0.2837 
cause_predict: train acc 0.9466 p 0.9091 r 0.7317 f1 0.8108
position_predict: train acc 0.9504 p 0.8065 r 0.7812 f1 0.7937

epoch 6: test loss 0.5128 cost time: 12.4s

cause_predict: test acc 0.8856 p 0.6266 r 0.4763 f1 0.5412
max_acc 0.8856 max_p 0.6266 max_r 0.4763 max_f1 0.5412

position_predict: test acc 0.9249 p 0.7133 r 0.6934 f1 0.7032
max_acc 0.9249 max_p 0.7133 max_r 0.6934 max_f1 0.7032

Average max cause: max_acc 0.8856 max_p 0.6266 max_r 0.4763 max_f1 0.5412
Average max pos: max_acc 0.9249 max_p 0.7133 max_r 0.6934 max_f1 0.7032

step 10: train loss 0.2297 
cause_predict: train acc 0.9378 p 0.8519 r 0.6970 f1 0.7667
position_predict: train acc 0.9600 p 0.8485 r 0.8750 f1 0.8615
step 20: train loss 0.3085 
cause_predict: train acc 0.9385 p 0.8929 r 0.6757 f1 0.7692
position_predict: train acc 0.9590 p 0.8929 r 0.7812 f1 0.8333
step 30: train loss 0.2254 
cause_predict: train acc 0.9510 p 0.8966 r 0.7879 f1 0.8387
position_predict: train acc 0.9559 p 0.8710 r 0.8438 f1 0.8571
step 40: train loss 0.2503 
cause_predict: train acc 0.9419 p 0.8077 r 0.6176 f1 0.7000
position_predict: train acc 0.9581 p 0.7568 r 0.8750 f1 0.8116
step 50: train loss 0.3637 
cause_predict: train acc 0.9069 p 0.6970 r 0.6389 f1 0.6667
position_predict: train acc 0.9474 p 0.7941 r 0.8182 f1 0.8060
step 60: train loss 0.2162 
cause_predict: train acc 0.9459 p 0.8667 r 0.7647 f1 0.8125
position_predict: train acc 0.9640 p 0.8750 r 0.8750 f1 0.8750
step 70: train loss 0.3469 
cause_predict: train acc 0.9130 p 0.6571 r 0.6571 f1 0.6571
position_predict: train acc 0.9529 p 0.8333 r 0.7576 f1 0.7937

epoch 7: test loss 0.5518 cost time: 12.3s

cause_predict: test acc 0.8892 p 0.6228 r 0.5521 f1 0.5853
max_acc 0.8892 max_p 0.6228 max_r 0.5521 max_f1 0.5853

position_predict: test acc 0.9245 p 0.7138 r 0.6864 f1 0.6998
max_acc 0.9249 max_p 0.7133 max_r 0.6934 max_f1 0.7032

Average max cause: max_acc 0.8892 max_p 0.6228 max_r 0.5521 max_f1 0.5853
Average max pos: max_acc 0.9245 max_p 0.7138 max_r 0.6864 max_f1 0.6998

step 10: train loss 0.1380 
cause_predict: train acc 0.9700 p 0.9118 r 0.8611 f1 0.8857
position_predict: train acc 0.9813 p 0.9118 r 0.9394 f1 0.9254
step 20: train loss 0.1791 
cause_predict: train acc 0.9619 p 0.8571 r 0.8333 f1 0.8451
position_predict: train acc 0.9619 p 0.8182 r 0.8438 f1 0.8308
step 30: train loss 0.1513 
cause_predict: train acc 0.9681 p 0.8974 r 0.8974 f1 0.8974
position_predict: train acc 0.9801 p 0.9091 r 0.9375 f1 0.9231
step 40: train loss 0.1505 
cause_predict: train acc 0.9672 p 0.8824 r 0.8824 f1 0.8824
position_predict: train acc 0.9795 p 0.9677 r 0.8824 f1 0.9231
step 50: train loss 0.2031 
cause_predict: train acc 0.9513 p 0.8387 r 0.8125 f1 0.8254
position_predict: train acc 0.9646 p 0.8750 r 0.8750 f1 0.8750
step 60: train loss 0.2229 
cause_predict: train acc 0.9383 p 0.7941 r 0.7714 f1 0.7826
position_predict: train acc 0.9506 p 0.8333 r 0.7812 f1 0.8065
step 70: train loss 0.2771 
cause_predict: train acc 0.9347 p 0.8235 r 0.8000 f1 0.8116
position_predict: train acc 0.9497 p 0.8438 r 0.8438 f1 0.8438

epoch 8: test loss 0.5700 cost time: 12.3s

cause_predict: test acc 0.8901 p 0.6498 r 0.4858 f1 0.5560
max_acc 0.8892 max_p 0.6228 max_r 0.5521 max_f1 0.5853

position_predict: test acc 0.9240 p 0.7143 r 0.6794 f1 0.6964
max_acc 0.9249 max_p 0.7133 max_r 0.6934 max_f1 0.7032

Average max cause: max_acc 0.8892 max_p 0.6228 max_r 0.5521 max_f1 0.5853
Average max pos: max_acc 0.9245 max_p 0.7138 max_r 0.6864 max_f1 0.6998

step 10: train loss 0.2109 
cause_predict: train acc 0.9545 p 0.9706 r 0.7857 f1 0.8684
position_predict: train acc 0.9636 p 0.9000 r 0.8438 f1 0.8710
step 20: train loss 0.2385 
cause_predict: train acc 0.9515 p 0.8529 r 0.8286 f1 0.8406
position_predict: train acc 0.9780 p 0.9375 r 0.9091 f1 0.9231
step 30: train loss 0.1566 
cause_predict: train acc 0.9540 p 0.9394 r 0.7561 f1 0.8378
position_predict: train acc 0.9808 p 0.8857 r 0.9688 f1 0.9254
step 40: train loss 0.2133 
cause_predict: train acc 0.9561 p 0.9062 r 0.8056 f1 0.8529
position_predict: train acc 0.9561 p 0.8710 r 0.8182 f1 0.8438
step 50: train loss 0.2397 
cause_predict: train acc 0.9395 p 0.8333 r 0.7576 f1 0.7937
position_predict: train acc 0.9395 p 0.8519 r 0.7188 f1 0.7797
step 60: train loss 0.2228 
cause_predict: train acc 0.9630 p 0.8750 r 0.8485 f1 0.8615
position_predict: train acc 0.9630 p 0.8485 r 0.8750 f1 0.8615
step 70: train loss 0.1693 
cause_predict: train acc 0.9786 p 0.9688 r 0.8611 f1 0.9118
position_predict: train acc 0.9680 p 0.8485 r 0.8750 f1 0.8615

epoch 9: test loss 0.6003 cost time: 12.7s

cause_predict: test acc 0.8852 p 0.6136 r 0.5110 f1 0.5577
max_acc 0.8892 max_p 0.6228 max_r 0.5521 max_f1 0.5853

position_predict: test acc 0.9218 p 0.6818 r 0.7317 f1 0.7059
max_acc 0.9218 max_p 0.6818 max_r 0.7317 max_f1 0.7059

Average max cause: max_acc 0.8892 max_p 0.6228 max_r 0.5521 max_f1 0.5853
Average max pos: max_acc 0.9245 max_p 0.7138 max_r 0.6864 max_f1 0.6998

step 10: train loss 0.1762 
cause_predict: train acc 0.9709 p 0.9655 r 0.8485 f1 0.9032
position_predict: train acc 0.9757 p 0.9655 r 0.8750 f1 0.9180
step 20: train loss 0.1881 
cause_predict: train acc 0.9839 p 0.9412 r 0.9412 f1 0.9412
position_predict: train acc 0.9355 p 0.7353 r 0.7812 f1 0.7576
step 30: train loss 0.2607 
cause_predict: train acc 0.9672 p 0.8889 r 0.8889 f1 0.8889
position_predict: train acc 0.9508 p 0.8621 r 0.7576 f1 0.8065
step 40: train loss 0.1199 
cause_predict: train acc 0.9668 p 0.8788 r 0.8529 f1 0.8657
position_predict: train acc 0.9889 p 0.9677 r 0.9375 f1 0.9524
step 50: train loss 0.1659 
cause_predict: train acc 0.9703 p 0.8857 r 0.9118 f1 0.8986
position_predict: train acc 0.9703 p 0.8788 r 0.9062 f1 0.8923
step 60: train loss 0.2349 
cause_predict: train acc 0.9464 p 0.7838 r 0.7632 f1 0.7733
position_predict: train acc 0.9527 p 0.8065 r 0.7353 f1 0.7692
step 70: train loss 0.1755 
cause_predict: train acc 0.9773 p 1.0000 r 0.8529 f1 0.9206
position_predict: train acc 0.9727 p 0.9062 r 0.9062 f1 0.9062

epoch 10: test loss 0.6813 cost time: 12.7s

cause_predict: test acc 0.8861 p 0.6165 r 0.5174 f1 0.5626
max_acc 0.8892 max_p 0.6228 max_r 0.5521 max_f1 0.5853

position_predict: test acc 0.9182 p 0.6818 r 0.6794 f1 0.6806
max_acc 0.9218 max_p 0.6818 max_r 0.7317 max_f1 0.7059

Average max cause: max_acc 0.8892 max_p 0.6228 max_r 0.5521 max_f1 0.5853
Average max pos: max_acc 0.9245 max_p 0.7138 max_r 0.6864 max_f1 0.6998

step 10: train loss 0.1765 
cause_predict: train acc 0.9639 p 0.8919 r 0.9429 f1 0.9167
position_predict: train acc 0.9759 p 0.8889 r 1.0000 f1 0.9412
step 20: train loss 0.1305 
cause_predict: train acc 0.9719 p 0.8824 r 0.8571 f1 0.8696
position_predict: train acc 0.9719 p 0.8529 r 0.8788 f1 0.8657
step 30: train loss 0.1752 
cause_predict: train acc 0.9578 p 0.8378 r 0.8857 f1 0.8611
position_predict: train acc 0.9662 p 0.8750 r 0.8750 f1 0.8750
step 40: train loss 0.1108 
cause_predict: train acc 0.9856 p 1.0000 r 0.9231 f1 0.9600
position_predict: train acc 0.9809 p 0.9375 r 0.9375 f1 0.9375
step 50: train loss 0.1783 
cause_predict: train acc 0.9590 p 0.9000 r 0.7941 f1 0.8438
position_predict: train acc 0.9631 p 0.8710 r 0.8438 f1 0.8571
step 60: train loss 0.1978 
cause_predict: train acc 0.9736 p 0.9459 r 0.8974 f1 0.9211
position_predict: train acc 0.9780 p 0.9091 r 0.9375 f1 0.9231
step 70: train loss 0.1886 
cause_predict: train acc 0.9529 p 0.8293 r 0.9444 f1 0.8831
position_predict: train acc 0.9738 p 0.9091 r 0.9375 f1 0.9231

epoch 11: test loss 0.6603 cost time: 12.1s

cause_predict: test acc 0.8834 p 0.6014 r 0.5237 f1 0.5599
max_acc 0.8892 max_p 0.6228 max_r 0.5521 max_f1 0.5853

position_predict: test acc 0.9191 p 0.6906 r 0.6690 f1 0.6796
max_acc 0.9218 max_p 0.6818 max_r 0.7317 max_f1 0.7059

Average max cause: max_acc 0.8892 max_p 0.6228 max_r 0.5521 max_f1 0.5853
Average max pos: max_acc 0.9245 max_p 0.7138 max_r 0.6864 max_f1 0.6998

step 10: train loss 0.0962 
cause_predict: train acc 0.9755 p 0.8824 r 0.9091 f1 0.8955
position_predict: train acc 0.9825 p 0.9355 r 0.9062 f1 0.9206
step 20: train loss 0.1355 
cause_predict: train acc 0.9697 p 0.9118 r 0.9118 f1 0.9118
position_predict: train acc 0.9697 p 0.8824 r 0.9375 f1 0.9091
step 30: train loss 0.0937 
cause_predict: train acc 0.9961 p 1.0000 r 0.9730 f1 0.9863
position_predict: train acc 0.9803 p 0.9091 r 0.9375 f1 0.9231
step 40: train loss 0.1474 
cause_predict: train acc 0.9701 p 0.9375 r 0.8333 f1 0.8824
position_predict: train acc 0.9701 p 0.8529 r 0.9062 f1 0.8788
step 50: train loss 0.1672 
cause_predict: train acc 0.9741 p 0.9412 r 0.8889 f1 0.9143
position_predict: train acc 0.9612 p 0.8710 r 0.8438 f1 0.8571
step 60: train loss 0.2389 
cause_predict: train acc 0.9610 p 0.9143 r 0.8649 f1 0.8889
position_predict: train acc 0.9463 p 0.8438 r 0.8182 f1 0.8308
step 70: train loss 0.1619 
cause_predict: train acc 0.9725 p 0.9459 r 0.8750 f1 0.9091
position_predict: train acc 0.9725 p 0.9032 r 0.8750 f1 0.8889

epoch 12: test loss 0.6961 cost time: 12.0s

cause_predict: test acc 0.8825 p 0.5882 r 0.5678 f1 0.5778
max_acc 0.8892 max_p 0.6228 max_r 0.5521 max_f1 0.5853

position_predict: test acc 0.9182 p 0.6818 r 0.6794 f1 0.6806
max_acc 0.9218 max_p 0.6818 max_r 0.7317 max_f1 0.7059

Average max cause: max_acc 0.8892 max_p 0.6228 max_r 0.5521 max_f1 0.5853
Average max pos: max_acc 0.9245 max_p 0.7138 max_r 0.6864 max_f1 0.6998

step 10: train loss 0.0897 
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
cause_predict: train acc 0.9823 p 0.9143 r 0.9697 f1 0.9412
position_predict: train acc 0.9779 p 0.9355 r 0.9062 f1 0.9206
step 20: train loss 0.1257 
cause_predict: train acc 0.9701 p 0.9394 r 0.8611 f1 0.8986
position_predict: train acc 0.9786 p 0.9394 r 0.9118 f1 0.9254
step 30: train loss 0.1120 
cause_predict: train acc 0.9665 p 0.9091 r 0.8824 f1 0.8955
position_predict: train acc 0.9952 p 0.9697 r 1.0000 f1 0.9846
step 40: train loss 0.1051 
cause_predict: train acc 0.9758 p 0.8919 r 0.9167 f1 0.9041
position_predict: train acc 0.9758 p 0.9032 r 0.8750 f1 0.8889
step 50: train loss 0.1115 
cause_predict: train acc 0.9696 p 0.8649 r 0.9412 f1 0.9014
position_predict: train acc 0.9739 p 0.8649 r 0.9697 f1 0.9143
step 60: train loss 0.1048 
cause_predict: train acc 0.9862 p 0.9444 r 0.9714 f1 0.9577
position_predict: train acc 0.9816 p 0.9375 r 0.9375 f1 0.9375
step 70: train loss 0.1525 
cause_predict: train acc 0.9810 p 0.9459 r 0.9459 f1 0.9459
position_predict: train acc 0.9763 p 0.9355 r 0.9062 f1 0.9206

epoch 13: test loss 0.7252 cost time: 12.3s

cause_predict: test acc 0.8829 p 0.5972 r 0.5331 f1 0.5633
max_acc 0.8892 max_p 0.6228 max_r 0.5521 max_f1 0.5853

position_predict: test acc 0.9133 p 0.6679 r 0.6446 f1 0.6560
max_acc 0.9218 max_p 0.6818 max_r 0.7317 max_f1 0.7059

Average max cause: max_acc 0.8892 max_p 0.6228 max_r 0.5521 max_f1 0.5853
Average max pos: max_acc 0.9245 max_p 0.7138 max_r 0.6864 max_f1 0.6998

step 10: train loss 0.1205 
cause_predict: train acc 0.9805 p 0.9459 r 0.9459 f1 0.9459
position_predict: train acc 0.9854 p 0.9688 r 0.9394 f1 0.9538
step 20: train loss 0.0796 
cause_predict: train acc 0.9805 p 0.8974 r 0.9459 f1 0.9211
position_predict: train acc 0.9837 p 0.8857 r 0.9688 f1 0.9254
step 30: train loss 0.1018 
cause_predict: train acc 0.9841 p 0.9429 r 0.9429 f1 0.9429
position_predict: train acc 0.9841 p 0.9375 r 0.9375 f1 0.9375
step 40: train loss 0.0758 
cause_predict: train acc 0.9850 p 0.9722 r 0.9211 f1 0.9459
position_predict: train acc 0.9850 p 0.9118 r 0.9688 f1 0.9394
step 50: train loss 0.0854 
cause_predict: train acc 0.9907 p 0.9706 r 0.9706 f1 0.9706
position_predict: train acc 0.9861 p 0.9412 r 0.9697 f1 0.9552
step 60: train loss 0.1258 
cause_predict: train acc 0.9828 p 0.9394 r 0.9118 f1 0.9254
position_predict: train acc 0.9724 p 0.8788 r 0.8788 f1 0.8788
step 70: train loss 0.1015 
cause_predict: train acc 0.9954 p 0.9714 r 1.0000 f1 0.9855
position_predict: train acc 0.9771 p 1.0000 r 0.8438 f1 0.9153

epoch 14: test loss 0.7417 cost time: 12.4s

cause_predict: test acc 0.8865 p 0.6235 r 0.5016 f1 0.5559
max_acc 0.8892 max_p 0.6228 max_r 0.5521 max_f1 0.5853

position_predict: test acc 0.9142 p 0.6644 r 0.6690 f1 0.6667
max_acc 0.9218 max_p 0.6818 max_r 0.7317 max_f1 0.7059

Average max cause: max_acc 0.8892 max_p 0.6228 max_r 0.5521 max_f1 0.5853
Average max pos: max_acc 0.9245 max_p 0.7138 max_r 0.6864 max_f1 0.6998

write pair_data/Ind_BiLSTM_2/fold_4_test.txt done
write pair_data/Ind_BiLSTM_2/fold_4_train.txt done
Optimization Finished!

############# fold 4 end ###############
############# fold 5 begin ###############
load data_file: data_combine_en/fold_5_train.txt
y_position.shape (2275, 75, 2)
y_cause.shape (2275, 75, 2)
x.shape (2275, 75, 30)
sen_len.shape (2275, 75)
doc_len.shape (2275,)
n_cut 107
load data done!

load data_file: data_combine_en/fold_5_test.txt
y_position.shape (284, 75, 2)
y_cause.shape (284, 75, 2)
x.shape (284, 75, 30)
sen_len.shape (284, 75)
doc_len.shape (284,)
n_cut 22
load data done!

train docs: 2275    test docs: 284
step 10: train loss 0.8549 
cause_predict: train acc 0.8496 p 0.0000 r 0.0000 f1 0.0000
position_predict: train acc 0.8584 p 0.0000 r 0.0000 f1 0.0000
step 20: train loss 0.6360 
cause_predict: train acc 0.8856 p 0.0000 r 0.0000 f1 0.0000
position_predict: train acc 0.8922 p 0.0000 r 0.0000 f1 0.0000
step 30: train loss 0.6951 
cause_predict: train acc 0.8462 p 0.0000 r 0.0000 f1 0.0000
position_predict: train acc 0.8632 p 0.0000 r 0.0000 f1 0.0000
step 40: train loss 0.6254 
cause_predict: train acc 0.8536 p 0.0000 r 0.0000 f1 0.0000
position_predict: train acc 0.8787 p 0.5625 r 0.5455 f1 0.5538
step 50: train loss 0.5437 
cause_predict: train acc 0.8588 p 0.0000 r 0.0000 f1 0.0000
position_predict: train acc 0.9373 p 0.7857 r 0.6875 f1 0.7333
step 60: train loss 0.6034 
cause_predict: train acc 0.8498 p 0.0000 r 0.0000 f1 0.0000
position_predict: train acc 0.9130 p 0.7037 r 0.5758 f1 0.6333
step 70: train loss 0.5526 
cause_predict: train acc 0.8618 p 0.6667 r 0.1250 f1 0.2105
position_predict: train acc 0.9124 p 0.7407 r 0.6250 f1 0.6780

epoch 0: test loss 0.5173 cost time: 12.0s

cause_predict: test acc 0.8771 p 0.8387 r 0.1640 f1 0.2744
max_acc 0.8771 max_p 0.8387 max_r 0.1640 max_f1 0.2744

position_predict: test acc 0.9218 p 0.7692 r 0.5575 f1 0.6465
max_acc 0.9218 max_p 0.7692 max_r 0.5575 max_f1 0.6465

Average max cause: max_acc 0.8771 max_p 0.8387 max_r 0.1640 max_f1 0.2744
Average max pos: max_acc 0.9218 max_p 0.7692 max_r 0.5575 max_f1 0.6465

step 10: train loss 0.4515 
cause_predict: train acc 0.8953 p 0.6429 r 0.2727 f1 0.3830
position_predict: train acc 0.9386 p 0.8400 r 0.6176 f1 0.7119
step 20: train loss 0.4251 
cause_predict: train acc 0.9027 p 1.0000 r 0.1081 f1 0.1951
position_predict: train acc 0.9351 p 0.7083 r 0.5312 f1 0.6071
step 30: train loss 0.3965 
cause_predict: train acc 0.8833 p 0.6667 r 0.2857 f1 0.4000
position_predict: train acc 0.9339 p 0.7419 r 0.7188 f1 0.7302
step 40: train loss 0.5093 
cause_predict: train acc 0.8571 p 1.0000 r 0.1111 f1 0.2000
position_predict: train acc 0.9196 p 0.7500 r 0.6562 f1 0.7000
step 50: train loss 0.5061 
cause_predict: train acc 0.8690 p 0.6667 r 0.3077 f1 0.4211
position_predict: train acc 0.9286 p 0.7917 r 0.5938 f1 0.6786
step 60: train loss 0.5299 
cause_predict: train acc 0.8717 p 0.6667 r 0.3429 f1 0.4528
position_predict: train acc 0.9292 p 0.7500 r 0.7500 f1 0.7500
step 70: train loss 0.5636 
cause_predict: train acc 0.8731 p 0.5263 r 0.2857 f1 0.3704
position_predict: train acc 0.9104 p 0.6333 r 0.5938 f1 0.6129

epoch 1: test loss 0.4861 cost time: 12.0s

cause_predict: test acc 0.8856 p 0.7293 r 0.3060 f1 0.4311
max_acc 0.8856 max_p 0.7293 max_r 0.3060 max_f1 0.4311

position_predict: test acc 0.9223 p 0.7306 r 0.6237 f1 0.6729
max_acc 0.9223 max_p 0.7306 max_r 0.6237 max_f1 0.6729

Average max cause: max_acc 0.8856 max_p 0.7293 max_r 0.3060 max_f1 0.4311
Average max pos: max_acc 0.9223 max_p 0.7306 max_r 0.6237 max_f1 0.6729

step 10: train loss 0.3885 
cause_predict: train acc 0.9117 p 0.7083 r 0.4857 f1 0.5763
position_predict: train acc 0.9399 p 0.8333 r 0.6061 f1 0.7018
step 20: train loss 0.4500 
cause_predict: train acc 0.9044 p 1.0000 r 0.3684 f1 0.5385
position_predict: train acc 0.9323 p 0.7586 r 0.6875 f1 0.7213
step 30: train loss 0.5177 
cause_predict: train acc 0.8609 p 0.6875 r 0.2895 f1 0.4074
position_predict: train acc 0.9478 p 0.8571 r 0.7500 f1 0.8000
step 40: train loss 0.3875 
cause_predict: train acc 0.9114 p 0.6957 r 0.4848 f1 0.5714
position_predict: train acc 0.9299 p 0.7097 r 0.6875 f1 0.6984
step 50: train loss 0.5061 
cause_predict: train acc 0.8538 p 0.5143 r 0.4737 f1 0.4932
position_predict: train acc 0.9209 p 0.7600 r 0.5758 f1 0.6552
step 60: train loss 0.5891 
cause_predict: train acc 0.8475 p 0.5294 r 0.2432 f1 0.3333
position_predict: train acc 0.9110 p 0.6897 r 0.6250 f1 0.6557
step 70: train loss 0.5631 
cause_predict: train acc 0.8557 p 0.6667 r 0.4324 f1 0.5246
position_predict: train acc 0.9154 p 0.7586 r 0.6875 f1 0.7213

epoch 2: test loss 0.4667 cost time: 12.2s

cause_predict: test acc 0.8923 p 0.6845 r 0.4448 f1 0.5392
max_acc 0.8923 max_p 0.6845 max_r 0.4448 max_f1 0.5392

position_predict: test acc 0.9240 p 0.7349 r 0.6376 f1 0.6828
max_acc 0.9240 max_p 0.7349 max_r 0.6376 max_f1 0.6828

Average max cause: max_acc 0.8923 max_p 0.6845 max_r 0.4448 max_f1 0.5392
Average max pos: max_acc 0.9240 max_p 0.7349 max_r 0.6376 max_f1 0.6828

step 10: train loss 0.3678 
cause_predict: train acc 0.8969 p 0.7333 r 0.3235 f1 0.4490
position_predict: train acc 0.9542 p 0.8125 r 0.8125 f1 0.8125
step 20: train loss 0.3848 
cause_predict: train acc 0.8947 p 0.7500 r 0.5000 f1 0.6000
position_predict: train acc 0.9649 p 0.9615 r 0.7812 f1 0.8621
step 30: train loss 0.4366 
cause_predict: train acc 0.9079 p 0.8824 r 0.4286 f1 0.5769
position_predict: train acc 0.9372 p 0.8148 r 0.6875 f1 0.7458
step 40: train loss 0.3511 
cause_predict: train acc 0.9412 p 0.9048 r 0.5938 f1 0.7170
position_predict: train acc 0.9373 p 0.7857 r 0.6875 f1 0.7333
step 50: train loss 0.4824 
cause_predict: train acc 0.8855 p 0.5926 r 0.4571 f1 0.5161
position_predict: train acc 0.9046 p 0.6129 r 0.5938 f1 0.6032
step 60: train loss 0.5111 
cause_predict: train acc 0.8763 p 0.7000 r 0.3111 f1 0.4308
position_predict: train acc 0.9097 p 0.5882 r 0.6061 f1 0.5970
step 70: train loss 0.4289 
cause_predict: train acc 0.8930 p 0.9375 r 0.3488 f1 0.5085
position_predict: train acc 0.9557 p 0.8571 r 0.7500 f1 0.8000

epoch 3: test loss 0.4722 cost time: 12.6s

cause_predict: test acc 0.8892 p 0.6865 r 0.4006 f1 0.5060
max_acc 0.8923 max_p 0.6845 max_r 0.4448 max_f1 0.5392

position_predict: test acc 0.9231 p 0.7220 r 0.6516 f1 0.6850
max_acc 0.9231 max_p 0.7220 max_r 0.6516 max_f1 0.6850

Average max cause: max_acc 0.8923 max_p 0.6845 max_r 0.4448 max_f1 0.5392
Average max pos: max_acc 0.9240 max_p 0.7349 max_r 0.6376 max_f1 0.6828

step 10: train loss 0.3388 
cause_predict: train acc 0.9312 p 0.8214 r 0.6970 f1 0.7541
position_predict: train acc 0.9404 p 0.8333 r 0.7576 f1 0.7937
step 20: train loss 0.3485 
cause_predict: train acc 0.9059 p 0.8333 r 0.4167 f1 0.5556
position_predict: train acc 0.9608 p 0.8485 r 0.8485 f1 0.8485
step 30: train loss 0.3504 
cause_predict: train acc 0.9121 p 0.8889 r 0.4211 f1 0.5714
position_predict: train acc 0.9634 p 0.8710 r 0.8182 f1 0.8438
step 40: train loss 0.4135 
cause_predict: train acc 0.8991 p 0.8148 r 0.5641 f1 0.6667
position_predict: train acc 0.9541 p 0.8710 r 0.8182 f1 0.8438
step 50: train loss 0.5407 
cause_predict: train acc 0.8713 p 0.6250 r 0.5882 f1 0.6061
position_predict: train acc 0.9059 p 0.7143 r 0.7353 f1 0.7246
step 60: train loss 0.3529 
cause_predict: train acc 0.9088 p 0.8636 r 0.4524 f1 0.5938
position_predict: train acc 0.9509 p 0.8462 r 0.6875 f1 0.7586
step 70: train loss 0.4956 
cause_predict: train acc 0.8846 p 0.7273 r 0.4706 f1 0.5714
position_predict: train acc 0.9135 p 0.7188 r 0.7188 f1 0.7188

epoch 4: test loss 0.4841 cost time: 12.5s

cause_predict: test acc 0.8820 p 0.6345 r 0.3943 f1 0.4864
max_acc 0.8923 max_p 0.6845 max_r 0.4448 max_f1 0.5392

position_predict: test acc 0.9312 p 0.7529 r 0.6899 f1 0.7200
max_acc 0.9312 max_p 0.7529 max_r 0.6899 max_f1 0.7200

Average max cause: max_acc 0.8923 max_p 0.6845 max_r 0.4448 max_f1 0.5392
Average max pos: max_acc 0.9240 max_p 0.7349 max_r 0.6376 max_f1 0.6828

step 10: train loss 0.3187 
cause_predict: train acc 0.9366 p 0.8276 r 0.6667 f1 0.7385
position_predict: train acc 0.9403 p 0.7222 r 0.8125 f1 0.7647
step 20: train loss 0.3734 
cause_predict: train acc 0.8738 p 0.8077 r 0.5000 f1 0.6176
position_predict: train acc 0.9806 p 0.9677 r 0.9091 f1 0.9375
step 30: train loss 0.2261 
cause_predict: train acc 0.9406 p 0.7778 r 0.6364 f1 0.7000
position_predict: train acc 0.9703 p 0.9032 r 0.8235 f1 0.8615
step 40: train loss 0.2554 
cause_predict: train acc 0.9494 p 0.9630 r 0.6842 f1 0.8000
position_predict: train acc 0.9611 p 0.8929 r 0.7812 f1 0.8333
step 50: train loss 0.3577 
cause_predict: train acc 0.8853 p 0.7143 r 0.4412 f1 0.5455
position_predict: train acc 0.9450 p 0.8182 r 0.8182 f1 0.8182
step 60: train loss 0.4069 
cause_predict: train acc 0.8942 p 0.7143 r 0.6250 f1 0.6667
position_predict: train acc 0.9524 p 0.9000 r 0.8182 f1 0.8571
step 70: train loss 0.3299 
cause_predict: train acc 0.9141 p 0.7000 r 0.6176 f1 0.6562
position_predict: train acc 0.9375 p 0.7742 r 0.7273 f1 0.7500

epoch 5: test loss 0.5076 cost time: 12.4s

cause_predict: test acc 0.8834 p 0.6207 r 0.4543 f1 0.5246
max_acc 0.8923 max_p 0.6845 max_r 0.4448 max_f1 0.5392

position_predict: test acc 0.9209 p 0.6950 r 0.6829 f1 0.6889
max_acc 0.9312 max_p 0.7529 max_r 0.6899 max_f1 0.7200

Average max cause: max_acc 0.8923 max_p 0.6845 max_r 0.4448 max_f1 0.5392
Average max pos: max_acc 0.9240 max_p 0.7349 max_r 0.6376 max_f1 0.6828

step 10: train loss 0.1778 
cause_predict: train acc 0.9506 p 0.8387 r 0.7647 f1 0.8000
position_predict: train acc 0.9848 p 1.0000 r 0.8788 f1 0.9355
step 20: train loss 0.3267 
cause_predict: train acc 0.9019 p 0.7000 r 0.6364 f1 0.6667
position_predict: train acc 0.9579 p 0.8966 r 0.8125 f1 0.8525
step 30: train loss 0.2351 
cause_predict: train acc 0.9472 p 0.9062 r 0.7073 f1 0.7945
position_predict: train acc 0.9613 p 0.8387 r 0.8125 f1 0.8254
step 40: train loss 0.3517 
cause_predict: train acc 0.9251 p 0.8214 r 0.6571 f1 0.7302
position_predict: train acc 0.9207 p 0.7188 r 0.7188 f1 0.7188
step 50: train loss 0.3735 
cause_predict: train acc 0.9044 p 0.7273 r 0.4706 f1 0.5714
position_predict: train acc 0.9283 p 0.7188 r 0.7188 f1 0.7188
step 60: train loss 0.4492 
cause_predict: train acc 0.8720 p 0.6129 r 0.4872 f1 0.5429
position_predict: train acc 0.9480 p 0.7879 r 0.8125 f1 0.8000
step 70: train loss 0.4748 
cause_predict: train acc 0.9171 p 0.7857 r 0.6471 f1 0.7097
position_predict: train acc 0.8848 p 0.6061 r 0.6250 f1 0.6154

epoch 6: test loss 0.5287 cost time: 12.5s

cause_predict: test acc 0.8811 p 0.6269 r 0.3975 f1 0.4865
max_acc 0.8923 max_p 0.6845 max_r 0.4448 max_f1 0.5392

position_predict: test acc 0.9249 p 0.7148 r 0.6899 f1 0.7021
max_acc 0.9312 max_p 0.7529 max_r 0.6899 max_f1 0.7200

Average max cause: max_acc 0.8923 max_p 0.6845 max_r 0.4448 max_f1 0.5392
Average max pos: max_acc 0.9240 max_p 0.7349 max_r 0.6376 max_f1 0.6828

step 10: train loss 0.1840 
cause_predict: train acc 0.9455 p 0.8065 r 0.7353 f1 0.7692
position_predict: train acc 0.9745 p 0.9310 r 0.8438 f1 0.8852
step 20: train loss 0.2990 
cause_predict: train acc 0.9459 p 0.8485 r 0.7568 f1 0.8000
position_predict: train acc 0.9459 p 0.8125 r 0.7647 f1 0.7879
step 30: train loss 0.2397 
cause_predict: train acc 0.9547 p 0.9062 r 0.7838 f1 0.8406
position_predict: train acc 0.9465 p 0.7879 r 0.8125 f1 0.8000
step 40: train loss 0.2251 
cause_predict: train acc 0.9603 p 0.8485 r 0.8000 f1 0.8235
position_predict: train acc 0.9536 p 0.7879 r 0.7879 f1 0.7879
step 50: train loss 0.3438 
cause_predict: train acc 0.9355 p 0.8125 r 0.7222 f1 0.7647
position_predict: train acc 0.9315 p 0.7500 r 0.7273 f1 0.7385
step 60: train loss 0.2571 
cause_predict: train acc 0.9388 p 0.7931 r 0.6765 f1 0.7302
position_predict: train acc 0.9604 p 0.8438 r 0.8182 f1 0.8308
step 70: train loss 0.3416 
cause_predict: train acc 0.9124 p 0.6970 r 0.6216 f1 0.6571
position_predict: train acc 0.9234 p 0.6875 r 0.6667 f1 0.6769

epoch 7: test loss 0.5616 cost time: 12.4s

cause_predict: test acc 0.8695 p 0.5405 r 0.5268 f1 0.5335
max_acc 0.8923 max_p 0.6845 max_r 0.4448 max_f1 0.5392

position_predict: test acc 0.9249 p 0.7073 r 0.7073 f1 0.7073
max_acc 0.9312 max_p 0.7529 max_r 0.6899 max_f1 0.7200

Average max cause: max_acc 0.8695 max_p 0.5405 max_r 0.5268 max_f1 0.5335
Average max pos: max_acc 0.9249 max_p 0.7073 max_r 0.7073 max_f1 0.7073

step 10: train loss 0.1847 
cause_predict: train acc 0.9565 p 0.9394 r 0.7949 f1 0.8611
position_predict: train acc 0.9783 p 0.9355 r 0.9062 f1 0.9206
step 20: train loss 0.2441 
cause_predict: train acc 0.9350 p 0.8788 r 0.7632 f1 0.8169
position_predict: train acc 0.9700 p 0.9062 r 0.9062 f1 0.9062
step 30: train loss 0.2033 
cause_predict: train acc 0.9648 p 0.9118 r 0.8857 f1 0.8986
position_predict: train acc 0.9648 p 0.8788 r 0.9062 f1 0.8923
step 40: train loss 0.1300 
cause_predict: train acc 0.9867 p 0.9412 r 0.9412 f1 0.9412
position_predict: train acc 0.9601 p 0.8182 r 0.8182 f1 0.8182
step 50: train loss 0.2031 
cause_predict: train acc 0.9579 p 0.7778 r 0.8485 f1 0.8116
position_predict: train acc 0.9547 p 0.7812 r 0.7812 f1 0.7812
step 60: train loss 0.2037 
cause_predict: train acc 0.9697 p 0.8788 r 0.8529 f1 0.8657
position_predict: train acc 0.9630 p 0.8235 r 0.8485 f1 0.8358
step 70: train loss 0.3023 
cause_predict: train acc 0.9297 p 0.7812 r 0.6944 f1 0.7353
position_predict: train acc 0.9492 p 0.7879 r 0.8125 f1 0.8000

epoch 8: test loss 0.6049 cost time: 12.5s

cause_predict: test acc 0.8794 p 0.5855 r 0.5079 f1 0.5439
max_acc 0.8794 max_p 0.5855 max_r 0.5079 max_f1 0.5439

position_predict: test acc 0.9249 p 0.7148 r 0.6899 f1 0.7021
max_acc 0.9312 max_p 0.7529 max_r 0.6899 max_f1 0.7200

Average max cause: max_acc 0.8794 max_p 0.5855 max_r 0.5079 max_f1 0.5439
Average max pos: max_acc 0.9249 max_p 0.7148 max_r 0.6899 max_f1 0.7021

step 10: train loss 0.1918 
cause_predict: train acc 0.9460 p 0.9000 r 0.6923 f1 0.7826
position_predict: train acc 0.9820 p 0.9355 r 0.9062 f1 0.9206
step 20: train loss 0.3206 
cause_predict: train acc 0.9211 p 0.8276 r 0.7059 f1 0.7619
position_predict: train acc 0.9421 p 0.8667 r 0.7879 f1 0.8254
step 30: train loss 0.3459 
cause_predict: train acc 0.9202 p 0.8529 r 0.7073 f1 0.7733
position_predict: train acc 0.9390 p 0.8065 r 0.7812 f1 0.7937
step 40: train loss 0.2361 
cause_predict: train acc 0.9511 p 0.8571 r 0.8333 f1 0.8451
position_predict: train acc 0.9778 p 0.9143 r 0.9412 f1 0.9275
step 50: train loss 0.1186 
cause_predict: train acc 0.9739 p 0.9394 r 0.8378 f1 0.8857
position_predict: train acc 0.9837 p 0.9091 r 0.9375 f1 0.9231
step 60: train loss 0.2263 
cause_predict: train acc 0.9503 p 0.7778 r 0.8000 f1 0.7887
position_predict: train acc 0.9470 p 0.7742 r 0.7273 f1 0.7500
step 70: train loss 0.1571 
cause_predict: train acc 0.9519 p 0.8889 r 0.7059 f1 0.7869
position_predict: train acc 0.9852 p 0.9375 r 0.9375 f1 0.9375

epoch 9: test loss 0.6444 cost time: 12.5s

cause_predict: test acc 0.8789 p 0.5935 r 0.4606 f1 0.5187
max_acc 0.8794 max_p 0.5855 max_r 0.5079 max_f1 0.5439

position_predict: test acc 0.9205 p 0.6953 r 0.6760 f1 0.6855
max_acc 0.9312 max_p 0.7529 max_r 0.6899 max_f1 0.7200

Average max cause: max_acc 0.8794 max_p 0.5855 max_r 0.5079 max_f1 0.5439
Average max pos: max_acc 0.9249 max_p 0.7148 max_r 0.6899 max_f1 0.7021

step 10: train loss 0.1671 
cause_predict: train acc 0.9604 p 0.9000 r 0.8182 f1 0.8571
position_predict: train acc 0.9780 p 0.9375 r 0.9091 f1 0.9231
step 20: train loss 0.1911 
cause_predict: train acc 0.9736 p 0.9189 r 0.9189 f1 0.9189
position_predict: train acc 0.9604 p 0.8710 r 0.8438 f1 0.8571
step 30: train loss 0.1702 
cause_predict: train acc 0.9664 p 0.9000 r 0.8182 f1 0.8571
position_predict: train acc 0.9701 p 0.8750 r 0.8750 f1 0.8750
step 40: train loss 0.2556 
cause_predict: train acc 0.9655 p 0.8684 r 0.8919 f1 0.8800
position_predict: train acc 0.9349 p 0.7273 r 0.7500 f1 0.7385
step 50: train loss 0.1923 
cause_predict: train acc 0.9721 p 0.9697 r 0.8421 f1 0.9014
position_predict: train acc 0.9442 p 0.7812 r 0.7812 f1 0.7812
step 60: train loss 0.1513 
cause_predict: train acc 0.9908 p 0.9429 r 1.0000 f1 0.9706
position_predict: train acc 0.9539 p 0.8667 r 0.8125 f1 0.8387
step 70: train loss 0.2067 
cause_predict: train acc 0.9655 p 0.9474 r 0.8571 f1 0.9000
position_predict: train acc 0.9741 p 0.8824 r 0.9375 f1 0.9091

epoch 10: test loss 0.6683 cost time: 12.1s

cause_predict: test acc 0.8704 p 0.5491 r 0.4763 f1 0.5101
max_acc 0.8794 max_p 0.5855 max_r 0.5079 max_f1 0.5439

position_predict: test acc 0.9200 p 0.6888 r 0.6864 f1 0.6876
max_acc 0.9312 max_p 0.7529 max_r 0.6899 max_f1 0.7200

Average max cause: max_acc 0.8794 max_p 0.5855 max_r 0.5079 max_f1 0.5439
Average max pos: max_acc 0.9249 max_p 0.7148 max_r 0.6899 max_f1 0.7021

step 10: train loss 0.1981 
cause_predict: train acc 0.9656 p 0.9444 r 0.8293 f1 0.8831
position_predict: train acc 0.9695 p 0.9000 r 0.8438 f1 0.8710
step 20: train loss 0.1434 
cause_predict: train acc 0.9828 p 0.9429 r 0.9429 f1 0.9429
position_predict: train acc 0.9784 p 0.9355 r 0.9062 f1 0.9206
step 30: train loss 0.0828 
cause_predict: train acc 0.9791 p 0.9412 r 0.8889 f1 0.9143
position_predict: train acc 0.9895 p 0.9412 r 0.9697 f1 0.9552
step 40: train loss 0.1531 
cause_predict: train acc 0.9744 p 0.9333 r 0.8750 f1 0.9032
position_predict: train acc 0.9658 p 0.8788 r 0.8788 f1 0.8788
step 50: train loss 0.1765 
cause_predict: train acc 0.9581 p 0.8788 r 0.8529 f1 0.8657
position_predict: train acc 0.9674 p 0.8788 r 0.9062 f1 0.8923
step 60: train loss 0.1850 
cause_predict: train acc 0.9548 p 0.8974 r 0.8750 f1 0.8861
position_predict: train acc 0.9648 p 0.8788 r 0.9062 f1 0.8923
step 70: train loss 0.0895 
cause_predict: train acc 0.9821 p 0.9268 r 0.9744 f1 0.9500
position_predict: train acc 0.9866 p 0.9394 r 0.9688 f1 0.9538

epoch 11: test loss 0.7046 cost time: 12.5s

cause_predict: test acc 0.8673 p 0.5311 r 0.5394 f1 0.5352
max_acc 0.8794 max_p 0.5855 max_r 0.5079 max_f1 0.5439

position_predict: test acc 0.9182 p 0.6940 r 0.6481 f1 0.6703
max_acc 0.9312 max_p 0.7529 max_r 0.6899 max_f1 0.7200

Average max cause: max_acc 0.8794 max_p 0.5855 max_r 0.5079 max_f1 0.5439
Average max pos: max_acc 0.9249 max_p 0.7148 max_r 0.6899 max_f1 0.7021

step 10: train loss 0.1146 
cause_predict: train acc 0.9688 p 0.9677 r 0.8108 f1 0.8824
position_predict: train acc 0.9883 p 0.9394 r 0.9688 f1 0.9538
step 20: train loss 0.2038 
cause_predict: train acc 0.9691 p 0.8684 r 0.8919 f1 0.8800
position_predict: train acc 0.9656 p 0.8710 r 0.8182 f1 0.8438
step 30: train loss 0.1383 
cause_predict: train acc 0.9724 p 0.9697 r 0.8649 f1 0.9143
position_predict: train acc 0.9677 p 0.8788 r 0.9062 f1 0.8923
step 40: train loss 0.1760 
cause_predict: train acc 0.9755 p 0.8889 r 0.9143 f1 0.9014
position_predict: train acc 0.9650 p 0.8438 r 0.8438 f1 0.8438
step 50: train loss 0.1117 
cause_predict: train acc 0.9856 p 0.9348 r 1.0000 f1 0.9663
position_predict: train acc 0.9761 p 0.9355 r 0.9062 f1 0.9206
step 60: train loss 0.0825 
cause_predict: train acc 0.9812 p 0.9394 r 0.9118 f1 0.9254
position_predict: train acc 0.9812 p 0.9355 r 0.9062 f1 0.9206
step 70: train loss 0.2221 
cause_predict: train acc 0.9490 p 0.8286 r 0.8788 f1 0.8529
position_predict: train acc 0.9541 p 0.8529 r 0.8788 f1 0.8657

epoch 12: test loss 0.7899 cost time: 12.3s

cause_predict: test acc 0.8735 p 0.5680 r 0.4479 f1 0.5009
max_acc 0.8794 max_p 0.5855 max_r 0.5079 max_f1 0.5439

position_predict: test acc 0.9133 p 0.6768 r 0.6202 f1 0.6473
max_acc 0.9312 max_p 0.7529 max_r 0.6899 max_f1 0.7200

Average max cause: max_acc 0.8794 max_p 0.5855 max_r 0.5079 max_f1 0.5439
Average max pos: max_acc 0.9249 max_p 0.7148 max_r 0.6899 max_f1 0.7021

step 10: train loss 0.1168 
cause_predict: train acc 1.0000 p 1.0000 r 1.0000 f1 1.0000
position_predict: train acc 0.9630 p 0.9062 r 0.8529 f1 0.8788
step 20: train loss 0.2389 
cause_predict: train acc 0.9561 p 0.9118 r 0.8378 f1 0.8732
position_predict: train acc 0.9561 p 0.8710 r 0.8438 f1 0.8571
step 30: train loss 0.1433 
cause_predict: train acc 0.9765 p 0.9429 r 0.8919 f1 0.9167
position_predict: train acc 0.9686 p 0.8611 r 0.9118 f1 0.8857
step 40: train loss 0.1262 
cause_predict: train acc 0.9799 p 0.9429 r 0.9429 f1 0.9429
position_predict: train acc 0.9648 p 0.8788 r 0.9062 f1 0.8923
step 50: train loss 0.0779 
cause_predict: train acc 0.9888 p 1.0000 r 0.9211 f1 0.9589
position_predict: train acc 0.9925 p 0.9688 r 0.9688 f1 0.9688
step 60: train loss 0.1396 
cause_predict: train acc 0.9738 p 1.0000 r 0.8182 f1 0.9000
position_predict: train acc 0.9607 p 0.8485 r 0.8750 f1 0.8615
step 70: train loss 0.2137 
cause_predict: train acc 0.9664 p 0.8649 r 0.9143 f1 0.8889
position_predict: train acc 0.9580 p 0.8438 r 0.8438 f1 0.8438

epoch 13: test loss 0.7630 cost time: 12.3s

cause_predict: test acc 0.8731 p 0.5548 r 0.5268 f1 0.5405
max_acc 0.8794 max_p 0.5855 max_r 0.5079 max_f1 0.5439

position_predict: test acc 0.9200 p 0.7015 r 0.6551 f1 0.6775
max_acc 0.9312 max_p 0.7529 max_r 0.6899 max_f1 0.7200

Average max cause: max_acc 0.8794 max_p 0.5855 max_r 0.5079 max_f1 0.5439
Average max pos: max_acc 0.9249 max_p 0.7148 max_r 0.6899 max_f1 0.7021

step 10: train loss 0.1071 
cause_predict: train acc 0.9749 p 0.9091 r 0.8571 f1 0.8824
position_predict: train acc 0.9781 p 0.9032 r 0.8750 f1 0.8889
step 20: train loss 0.0983 
cause_predict: train acc 0.9911 p 1.0000 r 0.9394 f1 0.9688
position_predict: train acc 0.9733 p 0.9091 r 0.9091 f1 0.9091
step 30: train loss 0.1370 
cause_predict: train acc 0.9752 p 0.9459 r 0.9211 f1 0.9333
position_predict: train acc 0.9653 p 0.9310 r 0.8438 f1 0.8852
step 40: train loss 0.1342 
cause_predict: train acc 0.9889 p 0.9706 r 0.9706 f1 0.9706
position_predict: train acc 0.9556 p 0.9000 r 0.8438 f1 0.8710
step 50: train loss 0.0956 
cause_predict: train acc 0.9884 p 0.9487 r 0.9737 f1 0.9610
position_predict: train acc 0.9690 p 0.8750 r 0.8750 f1 0.8750
step 60: train loss 0.1303 
cause_predict: train acc 0.9732 p 0.8857 r 0.8857 f1 0.8857
position_predict: train acc 0.9666 p 0.8710 r 0.8182 f1 0.8438
step 70: train loss 0.0991 
cause_predict: train acc 0.9784 p 0.8919 r 0.9429 f1 0.9167
position_predict: train acc 0.9820 p 0.9375 r 0.9091 f1 0.9231

epoch 14: test loss 0.7776 cost time: 12.3s

cause_predict: test acc 0.8682 p 0.5348 r 0.5331 f1 0.5340
max_acc 0.8794 max_p 0.5855 max_r 0.5079 max_f1 0.5439

position_predict: test acc 0.9142 p 0.6678 r 0.6585 f1 0.6632
max_acc 0.9312 max_p 0.7529 max_r 0.6899 max_f1 0.7200

Average max cause: max_acc 0.8794 max_p 0.5855 max_r 0.5079 max_f1 0.5439
Average max pos: max_acc 0.9249 max_p 0.7148 max_r 0.6899 max_f1 0.7021

write pair_data/Ind_BiLSTM_2/fold_5_test.txt done
write pair_data/Ind_BiLSTM_2/fold_5_train.txt done
Optimization Finished!

############# fold 5 end ###############
############# fold 6 begin ###############
load data_file: data_combine_en/fold_6_train.txt
y_position.shape (2275, 75, 2)
y_cause.shape (2275, 75, 2)
x.shape (2275, 75, 30)
sen_len.shape (2275, 75)
doc_len.shape (2275,)
n_cut 107
load data done!

load data_file: data_combine_en/fold_6_test.txt
y_position.shape (284, 75, 2)
y_cause.shape (284, 75, 2)
x.shape (284, 75, 30)
sen_len.shape (284, 75)
doc_len.shape (284,)
n_cut 22
load data done!

train docs: 2275    test docs: 284
step 10: train loss 0.8411 
cause_predict: train acc 0.8320 p 0.0000 r 0.0000 f1 0.0000
position_predict: train acc 0.8720 p 0.0000 r 0.0000 f1 0.0000
step 20: train loss 0.7557 
cause_predict: train acc 0.8402 p 0.0000 r 0.0000 f1 0.0000
position_predict: train acc 0.8539 p 0.0000 r 0.0000 f1 0.0000
step 30: train loss 0.6115 
cause_predict: train acc 0.8649 p 0.0000 r 0.0000 f1 0.0000
position_predict: train acc 0.8764 p 0.0000 r 0.0000 f1 0.0000
step 40: train loss 0.6149 
cause_predict: train acc 0.8745 p 1.0000 r 0.0303 f1 0.0588
position_predict: train acc 0.8627 p 0.4375 r 0.2121 f1 0.2857
step 50: train loss 0.7047 
cause_predict: train acc 0.8473 p 0.7778 r 0.1944 f1 0.3111
position_predict: train acc 0.8571 p 0.5652 r 0.4062 f1 0.4727
step 60: train loss 0.5662 
cause_predict: train acc 0.8776 p 0.8333 r 0.1471 f1 0.2500
position_predict: train acc 0.8939 p 0.6296 r 0.5152 f1 0.5667
step 70: train loss 0.6169 
cause_predict: train acc 0.8411 p 0.3750 r 0.0938 f1 0.1500
position_predict: train acc 0.8785 p 0.6154 r 0.5000 f1 0.5517

epoch 0: test loss 0.5182 cost time: 12.3s

cause_predict: test acc 0.8771 p 0.8182 r 0.1703 f1 0.2820
max_acc 0.8771 max_p 0.8182 max_r 0.1703 max_f1 0.2820

position_predict: test acc 0.9191 p 0.7190 r 0.6063 f1 0.6578
max_acc 0.9191 max_p 0.7190 max_r 0.6063 max_f1 0.6578

Average max cause: max_acc 0.8771 max_p 0.8182 max_r 0.1703 max_f1 0.2820
Average max pos: max_acc 0.9191 max_p 0.7190 max_r 0.6063 max_f1 0.6578

step 10: train loss 0.5033 
cause_predict: train acc 0.8851 p 0.8421 r 0.4848 f1 0.6154
position_predict: train acc 0.9023 p 0.7273 r 0.7500 f1 0.7385
step 20: train loss 0.5199 
cause_predict: train acc 0.8672 p 0.7500 r 0.2368 f1 0.3600
position_predict: train acc 0.9129 p 0.7037 r 0.5938 f1 0.6441
step 30: train loss 0.4759 
cause_predict: train acc 0.8857 p 0.9091 r 0.2703 f1 0.4167
position_predict: train acc 0.9469 p 0.9524 r 0.6250 f1 0.7547
step 40: train loss 0.4405 
cause_predict: train acc 0.9088 p 0.8750 r 0.2000 f1 0.3256
position_predict: train acc 0.9371 p 0.8000 r 0.5000 f1 0.6154
step 50: train loss 0.4651 
cause_predict: train acc 0.8771 p 0.6429 r 0.4865 f1 0.5538
position_predict: train acc 0.9195 p 0.7241 r 0.6562 f1 0.6885
step 60: train loss 0.4512 
cause_predict: train acc 0.8765 p 0.8889 r 0.2105 f1 0.3404
position_predict: train acc 0.9562 p 0.8889 r 0.7500 f1 0.8136
step 70: train loss 0.5068 
cause_predict: train acc 0.8462 p 0.4286 r 0.2432 f1 0.3103
position_predict: train acc 0.9231 p 0.7143 r 0.6250 f1 0.6667

epoch 1: test loss 0.4741 cost time: 12.3s

cause_predict: test acc 0.8932 p 0.7120 r 0.4132 f1 0.5230
max_acc 0.8932 max_p 0.7120 max_r 0.4132 max_f1 0.5230

position_predict: test acc 0.9155 p 0.6701 r 0.6725 f1 0.6713
max_acc 0.9155 max_p 0.6701 max_r 0.6725 max_f1 0.6713

Average max cause: max_acc 0.8932 max_p 0.7120 max_r 0.4132 max_f1 0.5230
Average max pos: max_acc 0.9155 max_p 0.6701 max_r 0.6725 max_f1 0.6713

step 10: train loss 0.4570 
cause_predict: train acc 0.8803 p 0.7333 r 0.3143 f1 0.4400
position_predict: train acc 0.9188 p 0.7097 r 0.6875 f1 0.6984
step 20: train loss 0.4702 
cause_predict: train acc 0.9018 p 0.6897 r 0.6061 f1 0.6452
position_predict: train acc 0.9018 p 0.6786 r 0.5938 f1 0.6333
step 30: train loss 0.5435 
cause_predict: train acc 0.8696 p 0.7692 r 0.2941 f1 0.4255
position_predict: train acc 0.8937 p 0.6667 r 0.6250 f1 0.6452
step 40: train loss 0.4151 
cause_predict: train acc 0.9025 p 0.6875 r 0.3333 f1 0.4490
position_predict: train acc 0.9350 p 0.8000 r 0.6061 f1 0.6897
step 50: train loss 0.4808 
cause_predict: train acc 0.8750 p 0.6842 r 0.3824 f1 0.4906
position_predict: train acc 0.9120 p 0.7692 r 0.6061 f1 0.6780
step 60: train loss 0.3316 
cause_predict: train acc 0.9153 p 0.6667 r 0.3750 f1 0.4800
position_predict: train acc 0.9349 p 0.7600 r 0.5758 f1 0.6552
step 70: train loss 0.5853 
cause_predict: train acc 0.8362 p 0.5000 r 0.2632 f1 0.3448
position_predict: train acc 0.8922 p 0.6129 r 0.5938 f1 0.6032

epoch 2: test loss 0.4842 cost time: 12.1s

cause_predict: test acc 0.8870 p 0.7353 r 0.3155 f1 0.4415
max_acc 0.8932 max_p 0.7120 max_r 0.4132 max_f1 0.5230

position_predict: test acc 0.9236 p 0.7180 r 0.6655 f1 0.6908
max_acc 0.9236 max_p 0.7180 max_r 0.6655 max_f1 0.6908

Average max cause: max_acc 0.8932 max_p 0.7120 max_r 0.4132 max_f1 0.5230
Average max pos: max_acc 0.9155 max_p 0.6701 max_r 0.6725 max_f1 0.6713

step 10: train loss 0.3910 
cause_predict: train acc 0.8985 p 0.6552 r 0.5278 f1 0.5846
position_predict: train acc 0.9323 p 0.7333 r 0.6875 f1 0.7097
step 20: train loss 0.4770 
cause_predict: train acc 0.8776 p 0.6522 r 0.4167 f1 0.5085
position_predict: train acc 0.9156 p 0.7143 r 0.6250 f1 0.6667
step 30: train loss 0.2982 
cause_predict: train acc 0.9396 p 0.8636 r 0.5938 f1 0.7037
position_predict: train acc 0.9698 p 0.8750 r 0.8750 f1 0.8750
step 40: train loss 0.4770 
cause_predict: train acc 0.8636 p 0.5417 r 0.3421 f1 0.4194
position_predict: train acc 0.8977 p 0.6071 r 0.5152 f1 0.5574
step 50: train loss 0.4441 
cause_predict: train acc 0.8860 p 0.6154 r 0.4324 f1 0.5079
position_predict: train acc 0.9375 p 0.7586 r 0.6875 f1 0.7213
step 60: train loss 0.2936 
cause_predict: train acc 0.9394 p 0.8333 r 0.5882 f1 0.6897
position_predict: train acc 0.9596 p 0.8571 r 0.7500 f1 0.8000
step 70: train loss 0.4350 
cause_predict: train acc 0.8905 p 0.5588 r 0.5429 f1 0.5507
position_predict: train acc 0.9258 p 0.7200 r 0.5625 f1 0.6316

epoch 3: test loss 0.4853 cost time: 12.4s

cause_predict: test acc 0.8771 p 0.5827 r 0.4669 f1 0.5184
max_acc 0.8932 max_p 0.7120 max_r 0.4132 max_f1 0.5230

position_predict: test acc 0.9267 p 0.7450 r 0.6516 f1 0.6952
max_acc 0.9267 max_p 0.7450 max_r 0.6516 max_f1 0.6952

Average max cause: max_acc 0.8771 max_p 0.5827 max_r 0.4669 max_f1 0.5184
Average max pos: max_acc 0.9267 max_p 0.7450 max_r 0.6516 max_f1 0.6952

step 10: train loss 0.5255 
cause_predict: train acc 0.8476 p 0.6667 r 0.3590 f1 0.4667
position_predict: train acc 0.9429 p 0.8333 r 0.7812 f1 0.8065
step 20: train loss 0.3717 
cause_predict: train acc 0.8848 p 0.7308 r 0.5135 f1 0.6032
position_predict: train acc 0.9355 p 0.8462 r 0.6875 f1 0.7586
step 30: train loss 0.5027 
cause_predict: train acc 0.8874 p 0.7692 r 0.5128 f1 0.6154
position_predict: train acc 0.8919 p 0.6552 r 0.5758 f1 0.6129
step 40: train loss 0.3253 
cause_predict: train acc 0.9348 p 0.8519 r 0.6765 f1 0.7541
position_predict: train acc 0.9261 p 0.7419 r 0.7188 f1 0.7302
step 50: train loss 0.3922 
cause_predict: train acc 0.9146 p 0.7308 r 0.5278 f1 0.6129
position_predict: train acc 0.9395 p 0.7586 r 0.6875 f1 0.7213
step 60: train loss 0.3541 
cause_predict: train acc 0.9233 p 0.7500 r 0.5294 f1 0.6207
position_predict: train acc 0.9408 p 0.7778 r 0.6562 f1 0.7119
step 70: train loss 0.3838 
cause_predict: train acc 0.9167 p 0.8400 r 0.5833 f1 0.6885
position_predict: train acc 0.9254 p 0.7353 r 0.7576 f1 0.7463

epoch 4: test loss 0.4882 cost time: 12.5s

cause_predict: test acc 0.8919 p 0.6556 r 0.4984 f1 0.5663
max_acc 0.8919 max_p 0.6556 max_r 0.4984 max_f1 0.5663

position_predict: test acc 0.9254 p 0.7143 r 0.6969 f1 0.7055
max_acc 0.9254 max_p 0.7143 max_r 0.6969 max_f1 0.7055

Average max cause: max_acc 0.8919 max_p 0.6556 max_r 0.4984 max_f1 0.5663
Average max pos: max_acc 0.9254 max_p 0.7143 max_r 0.6969 max_f1 0.7055

step 10: train loss 0.3014 
cause_predict: train acc 0.9200 p 0.7105 r 0.6750 f1 0.6923
position_predict: train acc 0.9467 p 0.7500 r 0.7500 f1 0.7500
step 20: train loss 0.3315 
cause_predict: train acc 0.9097 p 0.6571 r 0.6389 f1 0.6479
position_predict: train acc 0.9495 p 0.7500 r 0.8438 f1 0.7941
step 30: train loss 0.3483 
cause_predict: train acc 0.9269 p 0.7857 r 0.6875 f1 0.7333
position_predict: train acc 0.9498 p 0.8667 r 0.7879 f1 0.8254
step 40: train loss 0.3223 
cause_predict: train acc 0.9203 p 0.7027 r 0.7027 f1 0.7027
position_predict: train acc 0.9529 p 0.8065 r 0.7812 f1 0.7937
step 50: train loss 0.3612 
cause_predict: train acc 0.9046 p 0.7200 r 0.4500 f1 0.5538
position_predict: train acc 0.9474 p 0.7500 r 0.7500 f1 0.7500
step 60: train loss 0.3320 
cause_predict: train acc 0.9225 p 0.7500 r 0.6667 f1 0.7059
position_predict: train acc 0.9457 p 0.7812 r 0.7812 f1 0.7812
step 70: train loss 0.3671 
cause_predict: train acc 0.9132 p 0.7200 r 0.5625 f1 0.6316
position_predict: train acc 0.9380 p 0.8148 r 0.6875 f1 0.7458

epoch 5: test loss 0.4931 cost time: 12.4s

cause_predict: test acc 0.8847 p 0.6175 r 0.4890 f1 0.5458
max_acc 0.8919 max_p 0.6556 max_r 0.4984 max_f1 0.5663

position_predict: test acc 0.9258 p 0.7300 r 0.6690 f1 0.6982
max_acc 0.9254 max_p 0.7143 max_r 0.6969 max_f1 0.7055

Average max cause: max_acc 0.8919 max_p 0.6556 max_r 0.4984 max_f1 0.5663
Average max pos: max_acc 0.9254 max_p 0.7143 max_r 0.6969 max_f1 0.7055

step 10: train loss 0.3285 
cause_predict: train acc 0.9073 p 0.8000 r 0.5714 f1 0.6667
position_predict: train acc 0.9575 p 0.8621 r 0.7812 f1 0.8197
step 20: train loss 0.2883 
cause_predict: train acc 0.9310 p 0.8750 r 0.6176 f1 0.7241
position_predict: train acc 0.9655 p 0.8750 r 0.8750 f1 0.8750
step 30: train loss 0.3938 
cause_predict: train acc 0.9009 p 0.7308 r 0.5758 f1 0.6441
position_predict: train acc 0.9340 p 0.8571 r 0.7059 f1 0.7742
step 40: train loss 0.3412 
cause_predict: train acc 0.9157 p 0.7812 r 0.6250 f1 0.6944
position_predict: train acc 0.9617 p 0.9615 r 0.7353 f1 0.8333
step 50: train loss 0.3198 
cause_predict: train acc 0.9283 p 0.7812 r 0.6579 f1 0.7143
position_predict: train acc 0.9498 p 0.8065 r 0.7576 f1 0.7812
step 60: train loss 0.2837 
cause_predict: train acc 0.9434 p 0.7576 r 0.7812 f1 0.7692
position_predict: train acc 0.9434 p 0.7576 r 0.7812 f1 0.7692
step 70: train loss 0.2183 
cause_predict: train acc 0.9414 p 0.8333 r 0.7143 f1 0.7692
position_predict: train acc 0.9648 p 0.8710 r 0.8438 f1 0.8571

epoch 6: test loss 0.5239 cost time: 12.3s

cause_predict: test acc 0.8901 p 0.6403 r 0.5110 f1 0.5684
max_acc 0.8901 max_p 0.6403 max_r 0.5110 max_f1 0.5684

position_predict: test acc 0.9227 p 0.6966 r 0.7038 f1 0.7002
max_acc 0.9254 max_p 0.7143 max_r 0.6969 max_f1 0.7055

Average max cause: max_acc 0.8919 max_p 0.6556 max_r 0.4984 max_f1 0.5663
Average max pos: max_acc 0.9254 max_p 0.7143 max_r 0.6969 max_f1 0.7055

step 10: train loss 0.2644 
cause_predict: train acc 0.9415 p 0.8710 r 0.7714 f1 0.8182
position_predict: train acc 0.9463 p 0.8387 r 0.8125 f1 0.8254
step 20: train loss 0.3146 
cause_predict: train acc 0.9294 p 0.8929 r 0.6250 f1 0.7353
position_predict: train acc 0.9529 p 0.8125 r 0.8125 f1 0.8125
step 30: train loss 0.2461 
cause_predict: train acc 0.9600 p 0.9615 r 0.6757 f1 0.7937
position_predict: train acc 0.9477 p 0.7857 r 0.6667 f1 0.7213
step 40: train loss 0.4415 
cause_predict: train acc 0.9061 p 0.7222 r 0.7222 f1 0.7222
position_predict: train acc 0.9202 p 0.7419 r 0.7188 f1 0.7302
step 50: train loss 0.2680 
cause_predict: train acc 0.9429 p 0.8333 r 0.7895 f1 0.8108
position_predict: train acc 0.9429 p 0.8214 r 0.7188 f1 0.7667
step 60: train loss 0.2843 
cause_predict: train acc 0.9315 p 0.7931 r 0.6765 f1 0.7302
position_predict: train acc 0.9677 p 0.8750 r 0.8750 f1 0.8750
step 70: train loss 0.3063 
cause_predict: train acc 0.9302 p 0.9118 r 0.7750 f1 0.8378
position_predict: train acc 0.9767 p 0.9118 r 0.9688 f1 0.9394

epoch 7: test loss 0.5960 cost time: 12.3s

cause_predict: test acc 0.8816 p 0.5929 r 0.5237 f1 0.5561
max_acc 0.8901 max_p 0.6403 max_r 0.5110 max_f1 0.5684

position_predict: test acc 0.9214 p 0.6961 r 0.6864 f1 0.6912
max_acc 0.9254 max_p 0.7143 max_r 0.6969 max_f1 0.7055

Average max cause: max_acc 0.8919 max_p 0.6556 max_r 0.4984 max_f1 0.5663
Average max pos: max_acc 0.9254 max_p 0.7143 max_r 0.6969 max_f1 0.7055

step 10: train loss 0.1971 
cause_predict: train acc 0.9412 p 0.8621 r 0.7143 f1 0.7813
position_predict: train acc 0.9706 p 0.9310 r 0.8438 f1 0.8852
step 20: train loss 0.2795 
cause_predict: train acc 0.9588 p 0.8611 r 0.8611 f1 0.8611
position_predict: train acc 0.9177 p 0.6667 r 0.7500 f1 0.7059
step 30: train loss 0.2587 
cause_predict: train acc 0.9420 p 0.7368 r 0.8235 f1 0.7778
position_predict: train acc 0.9384 p 0.7273 r 0.7500 f1 0.7385
step 40: train loss 0.2674 
cause_predict: train acc 0.9443 p 0.7429 r 0.7879 f1 0.7647
position_predict: train acc 0.9686 p 0.8485 r 0.8750 f1 0.8615
step 50: train loss 0.2623 
cause_predict: train acc 0.9681 p 0.9143 r 0.9143 f1 0.9143
position_predict: train acc 0.9468 p 0.8438 r 0.8438 f1 0.8438
step 60: train loss 0.2549 
cause_predict: train acc 0.9467 p 0.8378 r 0.8378 f1 0.8378
position_predict: train acc 0.9511 p 0.8182 r 0.8438 f1 0.8308
step 70: train loss 0.1888 
cause_predict: train acc 0.9655 p 0.8857 r 0.8857 f1 0.8857
position_predict: train acc 0.9612 p 0.9333 r 0.8000 f1 0.8615

epoch 8: test loss 0.6301 cost time: 12.4s

cause_predict: test acc 0.8735 p 0.5644 r 0.4700 f1 0.5129
max_acc 0.8901 max_p 0.6403 max_r 0.5110 max_f1 0.5684

position_predict: test acc 0.9191 p 0.6815 r 0.6934 f1 0.6874
max_acc 0.9254 max_p 0.7143 max_r 0.6969 max_f1 0.7055

Average max cause: max_acc 0.8919 max_p 0.6556 max_r 0.4984 max_f1 0.5663
Average max pos: max_acc 0.9254 max_p 0.7143 max_r 0.6969 max_f1 0.7055

step 10: train loss 0.2212 
cause_predict: train acc 0.9611 p 0.8571 r 0.8571 f1 0.8571
position_predict: train acc 0.9494 p 0.8065 r 0.7812 f1 0.7937
step 20: train loss 0.2128 
cause_predict: train acc 0.9586 p 0.8621 r 0.7576 f1 0.8065
position_predict: train acc 0.9586 p 0.8333 r 0.7812 f1 0.8065
step 30: train loss 0.1503 
cause_predict: train acc 0.9569 p 0.9394 r 0.8158 f1 0.8732
position_predict: train acc 0.9713 p 0.9062 r 0.9062 f1 0.9062
step 40: train loss 0.1786 
cause_predict: train acc 0.9830 p 0.9697 r 0.9143 f1 0.9412
position_predict: train acc 0.9574 p 0.8235 r 0.8750 f1 0.8485
step 50: train loss 0.1824 
cause_predict: train acc 0.9755 p 0.9459 r 0.9211 f1 0.9333
position_predict: train acc 0.9559 p 0.8485 r 0.8750 f1 0.8615
step 60: train loss 0.2069 
cause_predict: train acc 0.9397 p 0.8333 r 0.7895 f1 0.8108
position_predict: train acc 0.9828 p 0.9667 r 0.9062 f1 0.9355
step 70: train loss 0.1794 
cause_predict: train acc 0.9700 p 0.9394 r 0.7750 f1 0.8493
position_predict: train acc 0.9809 p 0.8788 r 0.9062 f1 0.8923

epoch 9: test loss 0.6806 cost time: 12.2s

cause_predict: test acc 0.8762 p 0.5746 r 0.4858 f1 0.5265
max_acc 0.8901 max_p 0.6403 max_r 0.5110 max_f1 0.5684

position_predict: test acc 0.9129 p 0.6565 r 0.6725 f1 0.6644
max_acc 0.9254 max_p 0.7143 max_r 0.6969 max_f1 0.7055

Average max cause: max_acc 0.8919 max_p 0.6556 max_r 0.4984 max_f1 0.5663
Average max pos: max_acc 0.9254 max_p 0.7143 max_r 0.6969 max_f1 0.7055

step 10: train loss 0.2046 
cause_predict: train acc 0.9663 p 0.8889 r 0.8649 f1 0.8767
position_predict: train acc 0.9738 p 0.9032 r 0.8750 f1 0.8889
step 20: train loss 0.1391 
cause_predict: train acc 0.9729 p 0.9429 r 0.8919 f1 0.9167
position_predict: train acc 0.9819 p 0.9118 r 0.9688 f1 0.9394
step 30: train loss 0.1591 
cause_predict: train acc 0.9702 p 0.9167 r 0.8919 f1 0.9041
position_predict: train acc 0.9702 p 0.9032 r 0.8750 f1 0.8889
step 40: train loss 0.2012 
cause_predict: train acc 0.9514 p 0.8750 r 0.7778 f1 0.8235
position_predict: train acc 0.9676 p 0.8529 r 0.9062 f1 0.8788
step 50: train loss 0.1580 
cause_predict: train acc 0.9713 p 0.9375 r 0.8571 f1 0.8955
position_predict: train acc 0.9795 p 0.9355 r 0.9062 f1 0.9206
step 60: train loss 0.1919 
cause_predict: train acc 0.9551 p 0.9062 r 0.8529 f1 0.8788
position_predict: train acc 0.9719 p 0.9355 r 0.9062 f1 0.9206
step 70: train loss 0.1680 
cause_predict: train acc 0.9676 p 0.9091 r 0.8824 f1 0.8955
position_predict: train acc 0.9722 p 0.9091 r 0.9091 f1 0.9091

epoch 10: test loss 0.6880 cost time: 12.5s

cause_predict: test acc 0.8825 p 0.5985 r 0.5174 f1 0.5550
max_acc 0.8901 max_p 0.6403 max_r 0.5110 max_f1 0.5684

position_predict: test acc 0.9164 p 0.6667 r 0.6969 f1 0.6814
max_acc 0.9254 max_p 0.7143 max_r 0.6969 max_f1 0.7055

Average max cause: max_acc 0.8919 max_p 0.6556 max_r 0.4984 max_f1 0.5663
Average max pos: max_acc 0.9254 max_p 0.7143 max_r 0.6969 max_f1 0.7055

step 10: train loss 0.1490 
cause_predict: train acc 0.9799 p 0.9250 r 0.9737 f1 0.9487
position_predict: train acc 0.9749 p 0.9394 r 0.9118 f1 0.9254
step 20: train loss 0.1080 
cause_predict: train acc 0.9928 p 0.9688 r 0.9688 f1 0.9688
position_predict: train acc 0.9640 p 0.8438 r 0.8438 f1 0.8438
step 30: train loss 0.1369 
cause_predict: train acc 0.9753 p 0.8947 r 0.9189 f1 0.9067
position_predict: train acc 0.9859 p 0.9667 r 0.9062 f1 0.9355
step 40: train loss 0.2307 
cause_predict: train acc 0.9565 p 0.9091 r 0.8824 f1 0.8955
position_predict: train acc 0.9441 p 0.8750 r 0.8485 f1 0.8615
step 50: train loss 0.0771 
cause_predict: train acc 0.9915 p 0.9714 r 0.9714 f1 0.9714
position_predict: train acc 0.9702 p 0.8571 r 0.9375 f1 0.8955
step 60: train loss 0.2328 
cause_predict: train acc 0.9708 p 0.9118 r 0.8857 f1 0.8986
position_predict: train acc 0.9333 p 0.7857 r 0.6875 f1 0.7333
step 70: train loss 0.2040 
cause_predict: train acc 0.9714 p 0.9412 r 0.8649 f1 0.9014
position_predict: train acc 0.9510 p 0.8387 r 0.7879 f1 0.8125

epoch 11: test loss 0.7157 cost time: 12.1s

cause_predict: test acc 0.8834 p 0.6077 r 0.4984 f1 0.5477
max_acc 0.8901 max_p 0.6403 max_r 0.5110 max_f1 0.5684

position_predict: test acc 0.9142 p 0.6753 r 0.6376 f1 0.6559
max_acc 0.9254 max_p 0.7143 max_r 0.6969 max_f1 0.7055

Average max cause: max_acc 0.8919 max_p 0.6556 max_r 0.4984 max_f1 0.5663
Average max pos: max_acc 0.9254 max_p 0.7143 max_r 0.6969 max_f1 0.7055

step 10: train loss 0.1512 
cause_predict: train acc 0.9909 p 0.9500 r 1.0000 f1 0.9744
position_predict: train acc 0.9500 p 0.8056 r 0.8788 f1 0.8406
step 20: train loss 0.1282 
cause_predict: train acc 0.9721 p 0.9688 r 0.8611 f1 0.9118
position_predict: train acc 0.9814 p 0.9677 r 0.9091 f1 0.9375
step 30: train loss 0.1866 
cause_predict: train acc 0.9714 p 0.9118 r 0.8857 f1 0.8986
position_predict: train acc 0.9592 p 0.8438 r 0.8438 f1 0.8438
step 40: train loss 0.0970 
cause_predict: train acc 0.9841 p 0.9487 r 0.9487 f1 0.9487
position_predict: train acc 0.9801 p 0.9091 r 0.9375 f1 0.9231
step 50: train loss 0.1161 
cause_predict: train acc 0.9831 p 0.9412 r 0.9412 f1 0.9412
position_predict: train acc 0.9746 p 0.9062 r 0.9062 f1 0.9062
step 60: train loss 0.1286 
cause_predict: train acc 0.9679 p 0.8788 r 0.8788 f1 0.8788
position_predict: train acc 0.9679 p 0.8788 r 0.8788 f1 0.8788
step 70: train loss 0.1190 
cause_predict: train acc 0.9776 p 0.9375 r 0.8824 f1 0.9091
position_predict: train acc 0.9627 p 0.8438 r 0.8438 f1 0.8438

epoch 12: test loss 0.7440 cost time: 12.3s

cause_predict: test acc 0.8816 p 0.6016 r 0.4858 f1 0.5375
max_acc 0.8901 max_p 0.6403 max_r 0.5110 max_f1 0.5684

position_predict: test acc 0.9138 p 0.6556 r 0.6899 f1 0.6723
max_acc 0.9254 max_p 0.7143 max_r 0.6969 max_f1 0.7055

Average max cause: max_acc 0.8919 max_p 0.6556 max_r 0.4984 max_f1 0.5663
Average max pos: max_acc 0.9254 max_p 0.7143 max_r 0.6969 max_f1 0.7055

step 10: train loss 0.1070 
cause_predict: train acc 0.9850 p 0.9714 r 0.9189 f1 0.9444
position_predict: train acc 0.9774 p 0.9062 r 0.9062 f1 0.9062
step 20: train loss 0.1248 
cause_predict: train acc 0.9697 p 0.8857 r 0.8857 f1 0.8857
position_predict: train acc 0.9735 p 0.8788 r 0.9062 f1 0.8923
step 30: train loss 0.0990 
cause_predict: train acc 0.9869 p 0.9697 r 0.9143 f1 0.9412
position_predict: train acc 0.9705 p 0.8750 r 0.8485 f1 0.8615
step 40: train loss 0.1569 
cause_predict: train acc 0.9623 p 0.9394 r 0.8158 f1 0.8732
position_predict: train acc 0.9791 p 0.9355 r 0.9062 f1 0.9206
step 50: train loss 0.1194 
cause_predict: train acc 0.9830 p 0.9412 r 0.9412 f1 0.9412
position_predict: train acc 0.9447 p 0.8065 r 0.7812 f1 0.7937
step 60: train loss 0.2153 
cause_predict: train acc 0.9578 p 0.8485 r 0.8485 f1 0.8485
position_predict: train acc 0.9536 p 0.8387 r 0.8125 f1 0.8254
step 70: train loss 0.1275 
cause_predict: train acc 0.9793 p 0.9412 r 0.9143 f1 0.9275
position_predict: train acc 0.9711 p 0.8788 r 0.9062 f1 0.8923

epoch 13: test loss 0.7331 cost time: 12.1s

cause_predict: test acc 0.8776 p 0.5719 r 0.5394 f1 0.5552
max_acc 0.8901 max_p 0.6403 max_r 0.5110 max_f1 0.5684

position_predict: test acc 0.9129 p 0.6643 r 0.6481 f1 0.6561
max_acc 0.9254 max_p 0.7143 max_r 0.6969 max_f1 0.7055

Average max cause: max_acc 0.8919 max_p 0.6556 max_r 0.4984 max_f1 0.5663
Average max pos: max_acc 0.9254 max_p 0.7143 max_r 0.6969 max_f1 0.7055

step 10: train loss 0.0834 
cause_predict: train acc 0.9798 p 0.9697 r 0.8889 f1 0.9275
position_predict: train acc 0.9798 p 0.9091 r 0.9375 f1 0.9231
step 20: train loss 0.1671 
cause_predict: train acc 0.9707 p 0.9032 r 0.8750 f1 0.8889
position_predict: train acc 0.9540 p 0.8182 r 0.8438 f1 0.8308
step 30: train loss 0.0535 
cause_predict: train acc 1.0000 p 1.0000 r 1.0000 f1 1.0000
position_predict: train acc 0.9901 p 0.9677 r 0.9375 f1 0.9524
step 40: train loss 0.1238 
cause_predict: train acc 0.9783 p 0.9444 r 0.9189 f1 0.9315
position_predict: train acc 0.9739 p 0.9333 r 0.8750 f1 0.9032
step 50: train loss 0.0972 
cause_predict: train acc 0.9808 p 0.9688 r 0.8857 f1 0.9254
position_predict: train acc 0.9847 p 0.9394 r 0.9394 f1 0.9394
step 60: train loss 0.1038 
cause_predict: train acc 0.9858 p 0.9500 r 0.9744 f1 0.9620
position_predict: train acc 0.9906 p 0.9697 r 0.9697 f1 0.9697
step 70: train loss 0.0772 
cause_predict: train acc 0.9797 p 0.9737 r 0.8810 f1 0.9250
position_predict: train acc 0.9831 p 0.9091 r 0.9375 f1 0.9231

epoch 14: test loss 0.8145 cost time: 12.4s

cause_predict: test acc 0.8735 p 0.5563 r 0.5300 f1 0.5428
max_acc 0.8901 max_p 0.6403 max_r 0.5110 max_f1 0.5684

position_predict: test acc 0.9129 p 0.6575 r 0.6690 f1 0.6632
max_acc 0.9254 max_p 0.7143 max_r 0.6969 max_f1 0.7055

Average max cause: max_acc 0.8919 max_p 0.6556 max_r 0.4984 max_f1 0.5663
Average max pos: max_acc 0.9254 max_p 0.7143 max_r 0.6969 max_f1 0.7055

write pair_data/Ind_BiLSTM_2/fold_6_test.txt done
write pair_data/Ind_BiLSTM_2/fold_6_train.txt done
Optimization Finished!

############# fold 6 end ###############
############# fold 7 begin ###############
load data_file: data_combine_en/fold_7_train.txt
y_position.shape (2275, 75, 2)
y_cause.shape (2275, 75, 2)
x.shape (2275, 75, 30)
sen_len.shape (2275, 75)
doc_len.shape (2275,)
n_cut 107
load data done!

load data_file: data_combine_en/fold_7_test.txt
y_position.shape (284, 75, 2)
y_cause.shape (284, 75, 2)
x.shape (284, 75, 30)
sen_len.shape (284, 75)
doc_len.shape (284,)
n_cut 22
load data done!

train docs: 2275    test docs: 284
step 10: train loss 0.7845 
cause_predict: train acc 0.8778 p 0.0000 r 0.0000 f1 0.0000
position_predict: train acc 0.8741 p 0.0000 r 0.0000 f1 0.0000
step 20: train loss 0.7119 
cause_predict: train acc 0.8680 p 0.0000 r 0.0000 f1 0.0000
position_predict: train acc 0.8680 p 0.0000 r 0.0000 f1 0.0000
step 30: train loss 0.6568 
cause_predict: train acc 0.8688 p 0.0000 r 0.0000 f1 0.0000
position_predict: train acc 0.8830 p 0.0000 r 0.0000 f1 0.0000
step 40: train loss 0.6240 
cause_predict: train acc 0.8566 p 0.0000 r 0.0000 f1 0.0000
position_predict: train acc 0.8689 p 0.0000 r 0.0000 f1 0.0000
step 50: train loss 0.6396 
cause_predict: train acc 0.8366 p 0.0000 r 0.0000 f1 0.0000
position_predict: train acc 0.8564 p 0.5882 r 0.3125 f1 0.4082
step 60: train loss 0.6670 
cause_predict: train acc 0.8527 p 0.8000 r 0.0976 f1 0.1739
position_predict: train acc 0.8682 p 0.4762 r 0.3030 f1 0.3704
step 70: train loss 0.5951 
cause_predict: train acc 0.8469 p 1.0000 r 0.1111 f1 0.2000
position_predict: train acc 0.8947 p 0.9167 r 0.3438 f1 0.5000

epoch 0: test loss 0.5345 cost time: 12.3s

cause_predict: test acc 0.8762 p 0.8704 r 0.1483 f1 0.2534
max_acc 0.8762 max_p 0.8704 max_r 0.1483 max_f1 0.2534

position_predict: test acc 0.9053 p 0.7143 r 0.4355 f1 0.5411
max_acc 0.9053 max_p 0.7143 max_r 0.4355 max_f1 0.5411

Average max cause: max_acc 0.8762 max_p 0.8704 max_r 0.1483 max_f1 0.2534
Average max pos: max_acc 0.9053 max_p 0.7143 max_r 0.4355 max_f1 0.5411

step 10: train loss 0.5603 
cause_predict: train acc 0.8588 p 0.6000 r 0.1579 f1 0.2500
position_predict: train acc 0.9059 p 0.6333 r 0.5938 f1 0.6129
step 20: train loss 0.5077 
cause_predict: train acc 0.8740 p 0.6000 r 0.2647 f1 0.3673
position_predict: train acc 0.9065 p 0.6562 r 0.6364 f1 0.6462
step 30: train loss 0.4435 
cause_predict: train acc 0.9076 p 0.7895 r 0.4412 f1 0.5660
position_predict: train acc 0.9197 p 0.6875 r 0.6875 f1 0.6875
step 40: train loss 0.5005 
cause_predict: train acc 0.8451 p 0.5000 r 0.3143 f1 0.3860
position_predict: train acc 0.9204 p 0.7333 r 0.6875 f1 0.7097
step 50: train loss 0.5725 
cause_predict: train acc 0.8716 p 0.6800 r 0.4595 f1 0.5484
position_predict: train acc 0.9174 p 0.7917 r 0.5938 f1 0.6786
step 60: train loss 0.4422 
cause_predict: train acc 0.9025 p 0.8571 r 0.1875 f1 0.3077
position_predict: train acc 0.9134 p 0.6923 r 0.5294 f1 0.6000
step 70: train loss 0.4654 
cause_predict: train acc 0.8826 p 0.8182 r 0.2647 f1 0.4000
position_predict: train acc 0.9348 p 0.9048 r 0.5938 f1 0.7170

epoch 1: test loss 0.4856 cost time: 12.4s

cause_predict: test acc 0.8874 p 0.7211 r 0.3344 f1 0.4569
max_acc 0.8874 max_p 0.7211 max_r 0.3344 max_f1 0.4569

position_predict: test acc 0.9164 p 0.7525 r 0.5192 f1 0.6144
max_acc 0.9164 max_p 0.7525 max_r 0.5192 max_f1 0.6144

Average max cause: max_acc 0.8874 max_p 0.7211 max_r 0.3344 max_f1 0.4569
Average max pos: max_acc 0.9164 max_p 0.7525 max_r 0.5192 max_f1 0.6144

step 10: train loss 0.5013 
cause_predict: train acc 0.8493 p 0.5556 r 0.2857 f1 0.3774
position_predict: train acc 0.9087 p 0.7500 r 0.5625 f1 0.6429
step 20: train loss 0.3838 
cause_predict: train acc 0.8962 p 0.7143 r 0.2778 f1 0.4000
position_predict: train acc 0.9343 p 0.7097 r 0.6875 f1 0.6984
step 30: train loss 0.4307 
cause_predict: train acc 0.8824 p 0.6471 r 0.3143 f1 0.4231
position_predict: train acc 0.9373 p 0.7812 r 0.7353 f1 0.7576
step 40: train loss 0.4647 
cause_predict: train acc 0.8739 p 0.6786 r 0.5000 f1 0.5758
position_predict: train acc 0.9505 p 0.8621 r 0.7812 f1 0.8197
step 50: train loss 0.4542 
cause_predict: train acc 0.8893 p 0.8235 r 0.3500 f1 0.4912
position_predict: train acc 0.9389 p 0.8333 r 0.6250 f1 0.7143
step 60: train loss 0.4614 
cause_predict: train acc 0.8935 p 0.7500 r 0.3947 f1 0.5172
position_predict: train acc 0.9392 p 0.8636 r 0.5938 f1 0.7037
step 70: train loss 0.3943 
cause_predict: train acc 0.8949 p 0.7143 r 0.4167 f1 0.5263
position_predict: train acc 0.9494 p 0.8276 r 0.7500 f1 0.7869

epoch 2: test loss 0.4746 cost time: 11.9s

cause_predict: test acc 0.8816 p 0.7063 r 0.2808 f1 0.4018
max_acc 0.8874 max_p 0.7211 max_r 0.3344 max_f1 0.4569

position_predict: test acc 0.9227 p 0.7227 r 0.6446 f1 0.6814
max_acc 0.9227 max_p 0.7227 max_r 0.6446 max_f1 0.6814

Average max cause: max_acc 0.8816 max_p 0.7063 max_r 0.2808 max_f1 0.4018
Average max pos: max_acc 0.9227 max_p 0.7227 max_r 0.6446 max_f1 0.6814

step 10: train loss 0.3731 
cause_predict: train acc 0.9177 p 0.8947 r 0.4857 f1 0.6296
position_predict: train acc 0.9218 p 0.6970 r 0.7188 f1 0.7077
step 20: train loss 0.3763 
cause_predict: train acc 0.8920 p 0.6250 r 0.4545 f1 0.5263
position_predict: train acc 0.9600 p 0.8667 r 0.8125 f1 0.8387
step 30: train loss 0.5195 
cause_predict: train acc 0.8415 p 0.4667 r 0.1707 f1 0.2500
position_predict: train acc 0.9208 p 0.6774 r 0.6562 f1 0.6667
step 40: train loss 0.3341 
cause_predict: train acc 0.9340 p 0.7143 r 0.6061 f1 0.6557
position_predict: train acc 0.9308 p 0.6786 r 0.5938 f1 0.6333
step 50: train loss 0.4435 
cause_predict: train acc 0.8916 p 0.6667 r 0.4571 f1 0.5424
position_predict: train acc 0.9277 p 0.8000 r 0.6061 f1 0.6897
step 60: train loss 0.4020 
cause_predict: train acc 0.9130 p 0.7917 r 0.5588 f1 0.6552
position_predict: train acc 0.9087 p 0.6897 r 0.6250 f1 0.6557
step 70: train loss 0.3646 
cause_predict: train acc 0.9101 p 0.8636 r 0.4634 f1 0.6032
position_predict: train acc 0.9460 p 0.7879 r 0.7647 f1 0.7761

epoch 3: test loss 0.4784 cost time: 12.3s

cause_predict: test acc 0.8892 p 0.6716 r 0.4259 f1 0.5212
max_acc 0.8892 max_p 0.6716 max_r 0.4259 max_f1 0.5212

position_predict: test acc 0.9187 p 0.6842 r 0.6794 f1 0.6818
max_acc 0.9187 max_p 0.6842 max_r 0.6794 max_f1 0.6818

Average max cause: max_acc 0.8892 max_p 0.6716 max_r 0.4259 max_f1 0.5212
Average max pos: max_acc 0.9187 max_p 0.6842 max_r 0.6794 max_f1 0.6818

step 10: train loss 0.3369 
cause_predict: train acc 0.9117 p 0.7500 r 0.5385 f1 0.6269
position_predict: train acc 0.9647 p 0.8929 r 0.7812 f1 0.8333
step 20: train loss 0.3663 
cause_predict: train acc 0.8949 p 0.6364 r 0.3784 f1 0.4746
position_predict: train acc 0.9458 p 0.7353 r 0.7812 f1 0.7576
step 30: train loss 0.4752 
cause_predict: train acc 0.8790 p 0.6364 r 0.5385 f1 0.5833
position_predict: train acc 0.9355 p 0.8077 r 0.6562 f1 0.7241
step 40: train loss 0.2729 
cause_predict: train acc 0.9286 p 0.7500 r 0.6176 f1 0.6774
position_predict: train acc 0.9500 p 0.8214 r 0.7188 f1 0.7667
step 50: train loss 0.4005 
cause_predict: train acc 0.9095 p 0.7500 r 0.6923 f1 0.7200
position_predict: train acc 0.9655 p 0.8750 r 0.8750 f1 0.8750
step 60: train loss 0.3614 
cause_predict: train acc 0.9070 p 0.7407 r 0.5405 f1 0.6250
position_predict: train acc 0.9574 p 0.8621 r 0.7812 f1 0.8197
step 70: train loss 0.4808 
cause_predict: train acc 0.8821 p 0.6667 r 0.4571 f1 0.5424
position_predict: train acc 0.9039 p 0.6562 r 0.6562 f1 0.6562

epoch 4: test loss 0.4887 cost time: 12.3s

cause_predict: test acc 0.8838 p 0.6223 r 0.4574 f1 0.5273
max_acc 0.8838 max_p 0.6223 max_r 0.4574 max_f1 0.5273

position_predict: test acc 0.9254 p 0.7128 r 0.7003 f1 0.7065
max_acc 0.9254 max_p 0.7128 max_r 0.7003 max_f1 0.7065

Average max cause: max_acc 0.8838 max_p 0.6223 max_r 0.4574 max_f1 0.5273
Average max pos: max_acc 0.9254 max_p 0.7128 max_r 0.7003 max_f1 0.7065

step 10: train loss 0.2817 
cause_predict: train acc 0.9227 p 0.8333 r 0.6579 f1 0.7353
position_predict: train acc 0.9399 p 0.8000 r 0.7500 f1 0.7742
step 20: train loss 0.2855 
cause_predict: train acc 0.9147 p 0.8750 r 0.5250 f1 0.6563
position_predict: train acc 0.9690 p 0.9286 r 0.8125 f1 0.8667
step 30: train loss 0.3809 
cause_predict: train acc 0.9107 p 0.8333 r 0.7143 f1 0.7692
position_predict: train acc 0.9524 p 0.8529 r 0.9062 f1 0.8788
step 40: train loss 0.4274 
cause_predict: train acc 0.9062 p 0.7667 r 0.6765 f1 0.7188
position_predict: train acc 0.9375 p 0.8333 r 0.7812 f1 0.8065
step 50: train loss 0.2330 
cause_predict: train acc 0.9494 p 0.8929 r 0.7353 f1 0.8065
position_predict: train acc 0.9747 p 0.9062 r 0.9062 f1 0.9062
step 60: train loss 0.3400 
cause_predict: train acc 0.9147 p 0.8077 r 0.5526 f1 0.6563
position_predict: train acc 0.9457 p 0.7812 r 0.7812 f1 0.7812
step 70: train loss 0.3484 
cause_predict: train acc 0.9125 p 0.7097 r 0.6471 f1 0.6769
position_predict: train acc 0.9333 p 0.7857 r 0.6875 f1 0.7333

epoch 5: test loss 0.4922 cost time: 12.5s

cause_predict: test acc 0.8870 p 0.6633 r 0.4101 f1 0.5068
max_acc 0.8838 max_p 0.6223 max_r 0.4574 max_f1 0.5273

position_predict: test acc 0.9245 p 0.7034 r 0.7108 f1 0.7071
max_acc 0.9245 max_p 0.7034 max_r 0.7108 max_f1 0.7071

Average max cause: max_acc 0.8838 max_p 0.6223 max_r 0.4574 max_f1 0.5273
Average max pos: max_acc 0.9254 max_p 0.7128 max_r 0.7003 max_f1 0.7065

step 10: train loss 0.2366 
cause_predict: train acc 0.9378 p 0.7949 r 0.8158 f1 0.8052
position_predict: train acc 0.9751 p 0.9091 r 0.9091 f1 0.9091
step 20: train loss 0.2697 
cause_predict: train acc 0.9263 p 0.8182 r 0.7297 f1 0.7714
position_predict: train acc 0.9585 p 0.8966 r 0.8125 f1 0.8525
step 30: train loss 0.2185 
cause_predict: train acc 0.9461 p 0.9333 r 0.7179 f1 0.8116
position_predict: train acc 0.9710 p 0.8788 r 0.9062 f1 0.8923
step 40: train loss 0.4069 
cause_predict: train acc 0.9221 p 0.8000 r 0.5882 f1 0.6780
position_predict: train acc 0.9385 p 0.7931 r 0.7188 f1 0.7541
step 50: train loss 0.3331 
cause_predict: train acc 0.9170 p 0.7812 r 0.6579 f1 0.7143
position_predict: train acc 0.9461 p 0.7879 r 0.8125 f1 0.8000
step 60: train loss 0.3407 
cause_predict: train acc 0.9147 p 0.7857 r 0.5789 f1 0.6667
position_predict: train acc 0.9496 p 0.8333 r 0.7576 f1 0.7937
step 70: train loss 0.2668 
cause_predict: train acc 0.9360 p 0.7647 r 0.7647 f1 0.7647
position_predict: train acc 0.9440 p 0.7812 r 0.7812 f1 0.7812

epoch 6: test loss 0.5199 cost time: 12.5s

cause_predict: test acc 0.8803 p 0.5842 r 0.5363 f1 0.5592
max_acc 0.8803 max_p 0.5842 max_r 0.5363 max_f1 0.5592

position_predict: test acc 0.9231 p 0.7220 r 0.6516 f1 0.6850
max_acc 0.9245 max_p 0.7034 max_r 0.7108 max_f1 0.7071

Average max cause: max_acc 0.8803 max_p 0.5842 max_r 0.5363 max_f1 0.5592
Average max pos: max_acc 0.9231 max_p 0.7220 max_r 0.6516 max_f1 0.6850

step 10: train loss 0.2142 
cause_predict: train acc 0.9458 p 0.9355 r 0.7250 f1 0.8169
position_predict: train acc 0.9625 p 0.9000 r 0.8182 f1 0.8571
step 20: train loss 0.2031 
cause_predict: train acc 0.9498 p 0.9615 r 0.6757 f1 0.7937
position_predict: train acc 0.9691 p 0.8750 r 0.8750 f1 0.8750
step 30: train loss 0.2264 
cause_predict: train acc 0.9426 p 0.8286 r 0.8286 f1 0.8286
position_predict: train acc 0.9522 p 0.8667 r 0.8125 f1 0.8387
step 40: train loss 0.2808 
cause_predict: train acc 0.9283 p 0.9310 r 0.6279 f1 0.7500
position_predict: train acc 0.9442 p 0.7778 r 0.8235 f1 0.8000
step 50: train loss 0.1759 
cause_predict: train acc 0.9510 p 0.8889 r 0.8421 f1 0.8649
position_predict: train acc 0.9804 p 0.9677 r 0.9091 f1 0.9375
step 60: train loss 0.1751 
cause_predict: train acc 0.9417 p 0.8182 r 0.7714 f1 0.7941
position_predict: train acc 0.9792 p 0.9355 r 0.9062 f1 0.9206
step 70: train loss 0.2763 
cause_predict: train acc 0.9068 p 0.7353 r 0.6579 f1 0.6944
position_predict: train acc 0.9661 p 0.8750 r 0.8750 f1 0.8750

epoch 7: test loss 0.5847 cost time: 12.3s

cause_predict: test acc 0.8834 p 0.5979 r 0.5394 f1 0.5672
max_acc 0.8834 max_p 0.5979 max_r 0.5394 max_f1 0.5672

position_predict: test acc 0.9164 p 0.6712 r 0.6829 f1 0.6770
max_acc 0.9245 max_p 0.7034 max_r 0.7108 max_f1 0.7071

Average max cause: max_acc 0.8834 max_p 0.5979 max_r 0.5394 max_f1 0.5672
Average max pos: max_acc 0.9164 max_p 0.6712 max_r 0.6829 max_f1 0.6770

step 10: train loss 0.1070 
cause_predict: train acc 0.9818 p 0.9118 r 0.9394 f1 0.9254
position_predict: train acc 0.9782 p 0.9355 r 0.8788 f1 0.9062
step 20: train loss 0.2374 
cause_predict: train acc 0.9466 p 0.9189 r 0.8095 f1 0.8608
position_predict: train acc 0.9612 p 0.8788 r 0.8788 f1 0.8788
step 30: train loss 0.1407 
cause_predict: train acc 0.9711 p 0.8529 r 0.8529 f1 0.8529
position_predict: train acc 0.9769 p 0.8750 r 0.8750 f1 0.8750
step 40: train loss 0.1802 
cause_predict: train acc 0.9650 p 0.8485 r 0.8235 f1 0.8358
position_predict: train acc 0.9650 p 0.8387 r 0.8125 f1 0.8254
step 50: train loss 0.2931 
cause_predict: train acc 0.9496 p 0.8333 r 0.8333 f1 0.8333
position_predict: train acc 0.9454 p 0.8065 r 0.7812 f1 0.7937
step 60: train loss 0.2352 
cause_predict: train acc 0.9493 p 0.8056 r 0.8056 f1 0.8056
position_predict: train acc 0.9493 p 0.8065 r 0.7576 f1 0.7812
step 70: train loss 0.2437 
cause_predict: train acc 0.9415 p 0.8529 r 0.8056 f1 0.8286
position_predict: train acc 0.9805 p 0.9667 r 0.9062 f1 0.9355

epoch 8: test loss 0.5815 cost time: 12.5s

cause_predict: test acc 0.8794 p 0.5887 r 0.4921 f1 0.5361
max_acc 0.8834 max_p 0.5979 max_r 0.5394 max_f1 0.5672

position_predict: test acc 0.9178 p 0.6722 r 0.7003 f1 0.6860
max_acc 0.9245 max_p 0.7034 max_r 0.7108 max_f1 0.7071

Average max cause: max_acc 0.8834 max_p 0.5979 max_r 0.5394 max_f1 0.5672
Average max pos: max_acc 0.9164 max_p 0.6712 max_r 0.6829 max_f1 0.6770

step 10: train loss 0.1799 
cause_predict: train acc 0.9675 p 0.8333 r 0.8824 f1 0.8571
position_predict: train acc 0.9545 p 0.8214 r 0.7188 f1 0.7667
step 20: train loss 0.1858 
cause_predict: train acc 0.9387 p 0.8824 r 0.7692 f1 0.8219
position_predict: train acc 0.9764 p 0.9355 r 0.9062 f1 0.9206
step 30: train loss 0.2207 
cause_predict: train acc 0.9517 p 0.7895 r 0.8571 f1 0.8219
position_predict: train acc 0.9554 p 0.7778 r 0.8750 f1 0.8235
step 40: train loss 0.1513 
cause_predict: train acc 0.9608 p 0.8250 r 0.8684 f1 0.8462
position_predict: train acc 0.9771 p 0.8788 r 0.9062 f1 0.8923
step 50: train loss 0.2104 
cause_predict: train acc 0.9533 p 0.8857 r 0.8378 f1 0.8611
position_predict: train acc 0.9626 p 0.9000 r 0.8438 f1 0.8710
step 60: train loss 0.1679 
cause_predict: train acc 0.9689 p 0.9143 r 0.8421 f1 0.8767
position_predict: train acc 0.9481 p 0.7576 r 0.7812 f1 0.7692
step 70: train loss 0.2618 
cause_predict: train acc 0.9171 p 0.7500 r 0.6562 f1 0.7000
position_predict: train acc 0.9539 p 0.8438 r 0.8438 f1 0.8438

epoch 9: test loss 0.6472 cost time: 12.3s

cause_predict: test acc 0.8901 p 0.6403 r 0.5110 f1 0.5684
max_acc 0.8901 max_p 0.6403 max_r 0.5110 max_f1 0.5684

position_predict: test acc 0.9133 p 0.6716 r 0.6341 f1 0.6523
max_acc 0.9245 max_p 0.7034 max_r 0.7108 max_f1 0.7071

Average max cause: max_acc 0.8834 max_p 0.5979 max_r 0.5394 max_f1 0.5672
Average max pos: max_acc 0.9164 max_p 0.6712 max_r 0.6829 max_f1 0.6770

step 10: train loss 0.2633 
cause_predict: train acc 0.9471 p 0.8611 r 0.8158 f1 0.8378
position_predict: train acc 0.9559 p 0.8667 r 0.8125 f1 0.8387
step 20: train loss 0.1261 
cause_predict: train acc 1.0000 p 1.0000 r 1.0000 f1 1.0000
position_predict: train acc 0.9578 p 0.8235 r 0.8750 f1 0.8485
step 30: train loss 0.1950 
cause_predict: train acc 0.9595 p 0.8421 r 0.8889 f1 0.8649
position_predict: train acc 0.9676 p 0.8750 r 0.8750 f1 0.8750
step 40: train loss 0.1419 
cause_predict: train acc 0.9733 p 0.9143 r 0.9143 f1 0.9143
position_predict: train acc 0.9689 p 0.9032 r 0.8750 f1 0.8889
step 50: train loss 0.1445 
cause_predict: train acc 0.9718 p 0.9429 r 0.8684 f1 0.9041
position_predict: train acc 0.9637 p 0.8710 r 0.8438 f1 0.8571
step 60: train loss 0.1696 
cause_predict: train acc 0.9595 p 0.8485 r 0.8750 f1 0.8615
position_predict: train acc 0.9730 p 0.9062 r 0.9062 f1 0.9062
step 70: train loss 0.2055 
cause_predict: train acc 0.9714 p 0.9412 r 0.8649 f1 0.9014
position_predict: train acc 0.9592 p 0.8235 r 0.8750 f1 0.8485

epoch 10: test loss 0.6752 cost time: 12.0s

cause_predict: test acc 0.8758 p 0.5619 r 0.5584 f1 0.5601
max_acc 0.8901 max_p 0.6403 max_r 0.5110 max_f1 0.5684

/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
position_predict: test acc 0.9120 p 0.6541 r 0.6655 f1 0.6598
max_acc 0.9245 max_p 0.7034 max_r 0.7108 max_f1 0.7071

Average max cause: max_acc 0.8834 max_p 0.5979 max_r 0.5394 max_f1 0.5672
Average max pos: max_acc 0.9164 max_p 0.6712 max_r 0.6829 max_f1 0.6770

step 10: train loss 0.0795 
cause_predict: train acc 0.9769 p 0.9429 r 0.8919 f1 0.9167
position_predict: train acc 0.9846 p 0.9667 r 0.9062 f1 0.9355
step 20: train loss 0.1608 
cause_predict: train acc 0.9773 p 0.9167 r 0.9429 f1 0.9296
position_predict: train acc 0.9636 p 0.8571 r 0.9091 f1 0.8824
step 30: train loss 0.0739 
cause_predict: train acc 0.9839 p 0.9143 r 0.9697 f1 0.9412
position_predict: train acc 0.9839 p 0.9375 r 0.9375 f1 0.9375
step 40: train loss 0.1493 
cause_predict: train acc 0.9718 p 0.8947 r 0.9189 f1 0.9067
position_predict: train acc 0.9758 p 0.9091 r 0.9091 f1 0.9091
step 50: train loss 0.1538 
cause_predict: train acc 0.9672 p 0.8333 r 0.9459 f1 0.8861
position_predict: train acc 0.9818 p 0.9355 r 0.9062 f1 0.9206
step 60: train loss 0.1201 
cause_predict: train acc 0.9664 p 0.8947 r 0.8718 f1 0.8831
position_predict: train acc 0.9776 p 0.9333 r 0.8750 f1 0.9032
step 70: train loss 0.1421 
cause_predict: train acc 0.9686 p 0.9412 r 0.8649 f1 0.9014
position_predict: train acc 0.9821 p 0.9375 r 0.9375 f1 0.9375

epoch 11: test loss 0.7148 cost time: 12.2s

cause_predict: test acc 0.8682 p 0.5367 r 0.5079 f1 0.5219
max_acc 0.8901 max_p 0.6403 max_r 0.5110 max_f1 0.5684

position_predict: test acc 0.9138 p 0.6822 r 0.6132 f1 0.6459
max_acc 0.9245 max_p 0.7034 max_r 0.7108 max_f1 0.7071

Average max cause: max_acc 0.8834 max_p 0.5979 max_r 0.5394 max_f1 0.5672
Average max pos: max_acc 0.9164 max_p 0.6712 max_r 0.6829 max_f1 0.6770

step 10: train loss 0.0877 
cause_predict: train acc 0.9854 p 0.9697 r 0.9412 f1 0.9552
position_predict: train acc 0.9854 p 0.9394 r 0.9688 f1 0.9538
step 20: train loss 0.0708 
cause_predict: train acc 0.9808 p 0.9211 r 0.9459 f1 0.9333
position_predict: train acc 0.9847 p 0.9394 r 0.9394 f1 0.9394
step 30: train loss 0.0886 
cause_predict: train acc 0.9824 p 0.9143 r 0.9412 f1 0.9275
position_predict: train acc 0.9824 p 0.8857 r 0.9688 f1 0.9254
step 40: train loss 0.1824 
cause_predict: train acc 0.9425 p 0.8378 r 0.8158 f1 0.8267
position_predict: train acc 0.9690 p 0.9062 r 0.8788 f1 0.8923
step 50: train loss 0.0775 
cause_predict: train acc 0.9916 p 0.9730 r 0.9730 f1 0.9730
position_predict: train acc 0.9833 p 0.9394 r 0.9394 f1 0.9394
step 60: train loss 0.1302 
cause_predict: train acc 0.9802 p 0.9189 r 0.9444 f1 0.9315
position_predict: train acc 0.9723 p 0.8824 r 0.9091 f1 0.8955
step 70: train loss 0.0752 
cause_predict: train acc 0.9896 p 0.9714 r 0.9714 f1 0.9714
position_predict: train acc 0.9896 p 0.9688 r 0.9688 f1 0.9688

epoch 12: test loss 0.7206 cost time: 12.4s

cause_predict: test acc 0.8878 p 0.6130 r 0.5647 f1 0.5878
max_acc 0.8878 max_p 0.6130 max_r 0.5647 max_f1 0.5878

position_predict: test acc 0.9138 p 0.6794 r 0.6202 f1 0.6485
max_acc 0.9245 max_p 0.7034 max_r 0.7108 max_f1 0.7071

Average max cause: max_acc 0.8834 max_p 0.5979 max_r 0.5394 max_f1 0.5672
Average max pos: max_acc 0.9164 max_p 0.6712 max_r 0.6829 max_f1 0.6770

step 10: train loss 0.1286 
cause_predict: train acc 0.9770 p 0.9444 r 0.9189 f1 0.9315
position_predict: train acc 0.9770 p 0.9118 r 0.9394 f1 0.9254
step 20: train loss 0.0573 
cause_predict: train acc 0.9924 p 0.9756 r 0.9756 f1 0.9756
position_predict: train acc 0.9924 p 1.0000 r 0.9375 f1 0.9677
step 30: train loss 0.0888 
cause_predict: train acc 0.9854 p 0.9429 r 0.9429 f1 0.9429
position_predict: train acc 0.9818 p 0.9091 r 0.9375 f1 0.9231
step 40: train loss 0.1047 
cause_predict: train acc 0.9730 p 0.8919 r 0.9167 f1 0.9041
position_predict: train acc 0.9807 p 0.8857 r 0.9688 f1 0.9254
step 50: train loss 0.0909 
cause_predict: train acc 0.9798 p 0.9412 r 0.9412 f1 0.9412
position_predict: train acc 1.0000 p 1.0000 r 1.0000 f1 1.0000
step 60: train loss 0.0926 
cause_predict: train acc 0.9763 p 0.9697 r 0.8649 f1 0.9143
position_predict: train acc 0.9881 p 0.9688 r 0.9394 f1 0.9538
step 70: train loss 0.0932 
cause_predict: train acc 0.9743 p 0.8947 r 0.9189 f1 0.9067
position_predict: train acc 0.9926 p 1.0000 r 0.9412 f1 0.9697

epoch 13: test loss 0.7410 cost time: 12.5s

cause_predict: test acc 0.8807 p 0.5833 r 0.5521 f1 0.5673
max_acc 0.8878 max_p 0.6130 max_r 0.5647 max_f1 0.5878

position_predict: test acc 0.9138 p 0.6567 r 0.6864 f1 0.6712
max_acc 0.9245 max_p 0.7034 max_r 0.7108 max_f1 0.7071

Average max cause: max_acc 0.8834 max_p 0.5979 max_r 0.5394 max_f1 0.5672
Average max pos: max_acc 0.9164 max_p 0.6712 max_r 0.6829 max_f1 0.6770

step 10: train loss 0.0460 
cause_predict: train acc 0.9959 p 0.9722 r 1.0000 f1 0.9859
position_predict: train acc 0.9918 p 0.9688 r 0.9688 f1 0.9688
step 20: train loss 0.1079 
cause_predict: train acc 0.9874 p 0.9444 r 0.9714 f1 0.9577
position_predict: train acc 0.9707 p 0.9032 r 0.8750 f1 0.8889
step 30: train loss 0.0585 
cause_predict: train acc 0.9926 p 0.9688 r 0.9688 f1 0.9688
position_predict: train acc 0.9853 p 0.9118 r 0.9688 f1 0.9394
step 40: train loss 0.0758 
cause_predict: train acc 0.9928 p 0.9459 r 1.0000 f1 0.9722
position_predict: train acc 0.9855 p 0.9394 r 0.9394 f1 0.9394
step 50: train loss 0.0898 
cause_predict: train acc 0.9821 p 0.9444 r 0.9444 f1 0.9444
position_predict: train acc 0.9866 p 0.9394 r 0.9688 f1 0.9538
step 60: train loss 0.1652 
cause_predict: train acc 0.9664 p 0.8857 r 0.8611 f1 0.8732
position_predict: train acc 0.9701 p 0.8529 r 0.9062 f1 0.8788
step 70: train loss 0.0883 
cause_predict: train acc 0.9868 p 0.9474 r 0.9730 f1 0.9600
position_predict: train acc 0.9781 p 0.9355 r 0.9062 f1 0.9206

epoch 14: test loss 0.7724 cost time: 12.6s

cause_predict: test acc 0.8834 p 0.5946 r 0.5552 f1 0.5742
max_acc 0.8878 max_p 0.6130 max_r 0.5647 max_f1 0.5878

position_predict: test acc 0.9147 p 0.6727 r 0.6516 f1 0.6619
max_acc 0.9245 max_p 0.7034 max_r 0.7108 max_f1 0.7071

Average max cause: max_acc 0.8834 max_p 0.5979 max_r 0.5394 max_f1 0.5672
Average max pos: max_acc 0.9164 max_p 0.6712 max_r 0.6829 max_f1 0.6770

write pair_data/Ind_BiLSTM_2/fold_7_test.txt done
write pair_data/Ind_BiLSTM_2/fold_7_train.txt done
Optimization Finished!

############# fold 7 end ###############
############# fold 8 begin ###############
load data_file: data_combine_en/fold_8_train.txt
y_position.shape (2275, 75, 2)
y_cause.shape (2275, 75, 2)
x.shape (2275, 75, 30)
sen_len.shape (2275, 75)
doc_len.shape (2275,)
n_cut 107
load data done!

load data_file: data_combine_en/fold_8_test.txt
y_position.shape (284, 75, 2)
y_cause.shape (284, 75, 2)
x.shape (284, 75, 30)
sen_len.shape (284, 75)
doc_len.shape (284,)
n_cut 22
load data done!

train docs: 2275    test docs: 284
step 10: train loss 0.8490 
cause_predict: train acc 0.8372 p 0.0000 r 0.0000 f1 0.0000
position_predict: train acc 0.8512 p 0.0000 r 0.0000 f1 0.0000
step 20: train loss 0.6645 
cause_predict: train acc 0.8840 p 0.0000 r 0.0000 f1 0.0000
position_predict: train acc 0.8874 p 0.0000 r 0.0000 f1 0.0000
step 30: train loss 0.7607 
cause_predict: train acc 0.8316 p 0.0000 r 0.0000 f1 0.0000
position_predict: train acc 0.8316 p 0.0000 r 0.0000 f1 0.0000
step 40: train loss 0.6265 
cause_predict: train acc 0.8618 p 0.0000 r 0.0000 f1 0.0000
position_predict: train acc 0.8577 p 0.4583 r 0.3333 f1 0.3860
step 50: train loss 0.6917 
cause_predict: train acc 0.8362 p 0.0000 r 0.0000 f1 0.0000
position_predict: train acc 0.8966 p 0.6667 r 0.5000 f1 0.5714
step 60: train loss 0.4874 
cause_predict: train acc 0.8759 p 0.0000 r 0.0000 f1 0.0000
position_predict: train acc 0.8985 p 0.5862 r 0.5312 f1 0.5574
step 70: train loss 0.5056 
cause_predict: train acc 0.8776 p 0.6667 r 0.0541 f1 0.1000
position_predict: train acc 0.9014 p 0.5652 r 0.4062 f1 0.4727

epoch 0: test loss 0.5221 cost time: 12.2s

cause_predict: test acc 0.8686 p 0.9259 r 0.0789 f1 0.1453
max_acc 0.8686 max_p 0.9259 max_r 0.0789 max_f1 0.1453

position_predict: test acc 0.9160 p 0.7162 r 0.5714 f1 0.6357
max_acc 0.9160 max_p 0.7162 max_r 0.5714 max_f1 0.6357

Average max cause: max_acc 0.8686 max_p 0.9259 max_r 0.0789 max_f1 0.1453
Average max pos: max_acc 0.9160 max_p 0.7162 max_r 0.5714 max_f1 0.6357

step 10: train loss 0.5740 
cause_predict: train acc 0.8558 p 0.6667 r 0.2286 f1 0.3404
position_predict: train acc 0.9023 p 0.6897 r 0.6250 f1 0.6557
step 20: train loss 0.4550 
cause_predict: train acc 0.8876 p 0.7500 r 0.2500 f1 0.3750
position_predict: train acc 0.9513 p 0.8571 r 0.7273 f1 0.7869
step 30: train loss 0.5283 
cause_predict: train acc 0.8679 p 0.6923 r 0.2727 f1 0.3913
position_predict: train acc 0.9198 p 0.8261 r 0.5938 f1 0.6909
step 40: train loss 0.5126 
cause_predict: train acc 0.8631 p 0.6000 r 0.3243 f1 0.4211
position_predict: train acc 0.9295 p 0.7778 r 0.6562 f1 0.7119
step 50: train loss 0.5301 
cause_predict: train acc 0.8630 p 0.7778 r 0.2000 f1 0.3182
position_predict: train acc 0.8858 p 0.6061 r 0.6250 f1 0.6154
step 60: train loss 0.5755 
cause_predict: train acc 0.8571 p 0.6667 r 0.2703 f1 0.3846
position_predict: train acc 0.9062 p 0.6875 r 0.6667 f1 0.6769
step 70: train loss 0.5385 
cause_predict: train acc 0.8525 p 0.7000 r 0.4000 f1 0.5091
position_predict: train acc 0.9508 p 0.8966 r 0.8125 f1 0.8525

epoch 1: test loss 0.4913 cost time: 12.3s

cause_predict: test acc 0.8829 p 0.8667 r 0.2050 f1 0.3316
max_acc 0.8829 max_p 0.8667 max_r 0.2050 max_f1 0.3316

position_predict: test acc 0.9290 p 0.7759 r 0.6272 f1 0.6936
max_acc 0.9290 max_p 0.7759 max_r 0.6272 max_f1 0.6936

Average max cause: max_acc 0.8829 max_p 0.8667 max_r 0.2050 max_f1 0.3316
Average max pos: max_acc 0.9290 max_p 0.7759 max_r 0.6272 max_f1 0.6936

step 10: train loss 0.4761 
cause_predict: train acc 0.8779 p 0.7308 r 0.5000 f1 0.5937
position_predict: train acc 0.9108 p 0.7241 r 0.6562 f1 0.6885
step 20: train loss 0.4418 
cause_predict: train acc 0.9046 p 0.8667 r 0.3824 f1 0.5306
position_predict: train acc 0.9212 p 0.7188 r 0.6970 f1 0.7077
step 30: train loss 0.5437 
cause_predict: train acc 0.8596 p 0.6250 r 0.2778 f1 0.3846
position_predict: train acc 0.9342 p 0.8148 r 0.6875 f1 0.7458
step 40: train loss 0.4297 
cause_predict: train acc 0.8917 p 0.7059 r 0.3636 f1 0.4800
position_predict: train acc 0.9458 p 0.8276 r 0.7500 f1 0.7869
step 50: train loss 0.3342 
cause_predict: train acc 0.9077 p 0.6667 r 0.4375 f1 0.5283
position_predict: train acc 0.9631 p 0.9259 r 0.7576 f1 0.8333
step 60: train loss 0.6450 
cause_predict: train acc 0.8265 p 0.6538 r 0.3696 f1 0.4722
position_predict: train acc 0.9361 p 0.8462 r 0.6875 f1 0.7586
step 70: train loss 0.5508 
cause_predict: train acc 0.8631 p 0.8750 r 0.1795 f1 0.2979
position_predict: train acc 0.9544 p 0.9200 r 0.7188 f1 0.8070

epoch 2: test loss 0.4791 cost time: 12.5s

cause_predict: test acc 0.8870 p 0.6975 r 0.3565 f1 0.4718
max_acc 0.8870 max_p 0.6975 max_r 0.3565 max_f1 0.4718

position_predict: test acc 0.9240 p 0.7349 r 0.6376 f1 0.6828
max_acc 0.9290 max_p 0.7759 max_r 0.6272 max_f1 0.6936

Average max cause: max_acc 0.8870 max_p 0.6975 max_r 0.3565 max_f1 0.4718
Average max pos: max_acc 0.9240 max_p 0.7349 max_r 0.6376 max_f1 0.6828

step 10: train loss 0.5374 
cause_predict: train acc 0.8636 p 0.6667 r 0.4571 f1 0.5424
position_predict: train acc 0.9040 p 0.8095 r 0.5312 f1 0.6415
step 20: train loss 0.4463 
cause_predict: train acc 0.8671 p 0.5625 r 0.2250 f1 0.3214
position_predict: train acc 0.9476 p 0.8214 r 0.6970 f1 0.7541
step 30: train loss 0.4167 
cause_predict: train acc 0.8760 p 0.6316 r 0.3429 f1 0.4444
position_predict: train acc 0.9421 p 0.7812 r 0.7812 f1 0.7812
step 40: train loss 0.4449 
cause_predict: train acc 0.8667 p 0.5909 r 0.3250 f1 0.4194
position_predict: train acc 0.9556 p 0.8333 r 0.7812 f1 0.8065
step 50: train loss 0.3779 
cause_predict: train acc 0.9145 p 0.8095 r 0.5152 f1 0.6296
position_predict: train acc 0.9359 p 0.7742 r 0.7500 f1 0.7619
step 60: train loss 0.4922 
cause_predict: train acc 0.8750 p 0.7222 r 0.3714 f1 0.4906
position_predict: train acc 0.8981 p 0.6774 r 0.6364 f1 0.6562
step 70: train loss 0.3782 
cause_predict: train acc 0.9114 p 0.7917 r 0.5429 f1 0.6441
position_predict: train acc 0.9578 p 0.8438 r 0.8438 f1 0.8438

epoch 3: test loss 0.4802 cost time: 12.5s

cause_predict: test acc 0.8910 p 0.7186 r 0.3785 f1 0.4959
max_acc 0.8910 max_p 0.7186 max_r 0.3785 max_f1 0.4959

position_predict: test acc 0.9294 p 0.7416 r 0.6899 f1 0.7148
max_acc 0.9294 max_p 0.7416 max_r 0.6899 max_f1 0.7148

Average max cause: max_acc 0.8910 max_p 0.7186 max_r 0.3785 max_f1 0.4959
Average max pos: max_acc 0.9294 max_p 0.7416 max_r 0.6899 max_f1 0.7148

step 10: train loss 0.3790 
cause_predict: train acc 0.8889 p 0.7143 r 0.5128 f1 0.5970
position_predict: train acc 0.9630 p 0.8966 r 0.8125 f1 0.8525
step 20: train loss 0.2972 
cause_predict: train acc 0.9302 p 0.8000 r 0.4444 f1 0.5714
position_predict: train acc 0.9448 p 0.7188 r 0.6970 f1 0.7077
step 30: train loss 0.4275 
cause_predict: train acc 0.9094 p 0.8667 r 0.3714 f1 0.5200
position_predict: train acc 0.9283 p 0.7600 r 0.5938 f1 0.6667
step 40: train loss 0.4387 
cause_predict: train acc 0.8795 p 0.6207 r 0.5294 f1 0.5714
position_predict: train acc 0.9241 p 0.7586 r 0.6875 f1 0.7213
step 50: train loss 0.3064 
cause_predict: train acc 0.8844 p 0.6471 r 0.6111 f1 0.6286
position_predict: train acc 0.9911 p 0.9688 r 0.9688 f1 0.9688
step 60: train loss 0.3236 
cause_predict: train acc 0.9360 p 0.8800 r 0.6286 f1 0.7333
position_predict: train acc 0.9400 p 0.8750 r 0.6364 f1 0.7368
step 70: train loss 0.4097 
cause_predict: train acc 0.9014 p 0.7333 r 0.6286 f1 0.6769
position_predict: train acc 0.9202 p 0.7419 r 0.7188 f1 0.7302

epoch 4: test loss 0.4863 cost time: 12.4s

cause_predict: test acc 0.8816 p 0.6008 r 0.4890 f1 0.5391
max_acc 0.8816 max_p 0.6008 max_r 0.4890 max_f1 0.5391

position_predict: test acc 0.9249 p 0.7148 r 0.6899 f1 0.7021
max_acc 0.9294 max_p 0.7416 max_r 0.6899 max_f1 0.7148

Average max cause: max_acc 0.8816 max_p 0.6008 max_r 0.4890 max_f1 0.5391
Average max pos: max_acc 0.9249 max_p 0.7148 max_r 0.6899 max_f1 0.7021

step 10: train loss 0.2444 
cause_predict: train acc 0.9478 p 0.8276 r 0.7273 f1 0.7742
position_predict: train acc 0.9440 p 0.7429 r 0.8125 f1 0.7761
step 20: train loss 0.3294 
cause_predict: train acc 0.9273 p 0.7917 r 0.5429 f1 0.6441
position_predict: train acc 0.9654 p 0.8667 r 0.8125 f1 0.8387
step 30: train loss 0.3746 
cause_predict: train acc 0.9118 p 0.8571 r 0.5854 f1 0.6957
position_predict: train acc 0.9370 p 0.7931 r 0.7188 f1 0.7541
step 40: train loss 0.3335 
cause_predict: train acc 0.9076 p 0.7188 r 0.6216 f1 0.6667
position_predict: train acc 0.9679 p 0.9000 r 0.8438 f1 0.8710
step 50: train loss 0.3886 
cause_predict: train acc 0.9239 p 0.7857 r 0.5946 f1 0.6769
position_predict: train acc 0.9203 p 0.6786 r 0.5938 f1 0.6333
step 60: train loss 0.3277 
cause_predict: train acc 0.9176 p 0.6944 r 0.6944 f1 0.6944
position_predict: train acc 0.9363 p 0.7500 r 0.7273 f1 0.7385
step 70: train loss 0.2913 
cause_predict: train acc 0.9375 p 0.8846 r 0.6571 f1 0.7541
position_predict: train acc 0.9625 p 0.8966 r 0.8125 f1 0.8525

epoch 5: test loss 0.4858 cost time: 12.4s

cause_predict: test acc 0.8914 p 0.6516 r 0.5016 f1 0.5668
max_acc 0.8914 max_p 0.6516 max_r 0.5016 max_f1 0.5668

position_predict: test acc 0.9281 p 0.7266 r 0.7038 f1 0.7150
max_acc 0.9281 max_p 0.7266 max_r 0.7038 max_f1 0.7150

Average max cause: max_acc 0.8914 max_p 0.6516 max_r 0.5016 max_f1 0.5668
Average max pos: max_acc 0.9281 max_p 0.7266 max_r 0.7038 max_f1 0.7150

step 10: train loss 0.2326 
cause_predict: train acc 0.9299 p 0.8182 r 0.7500 f1 0.7826
position_predict: train acc 0.9813 p 0.9375 r 0.9375 f1 0.9375
step 20: train loss 0.2128 
cause_predict: train acc 0.9527 p 0.8438 r 0.7500 f1 0.7941
position_predict: train acc 0.9628 p 0.8387 r 0.8125 f1 0.8254
step 30: train loss 0.2159 
cause_predict: train acc 0.9455 p 0.7812 r 0.7576 f1 0.7692
position_predict: train acc 0.9600 p 0.8438 r 0.8182 f1 0.8308
step 40: train loss 0.3048 
cause_predict: train acc 0.9298 p 0.9200 r 0.6216 f1 0.7419
position_predict: train acc 0.9518 p 0.8387 r 0.8125 f1 0.8254
step 50: train loss 0.3742 
cause_predict: train acc 0.9390 p 0.8621 r 0.6944 f1 0.7692
position_predict: train acc 0.9228 p 0.7059 r 0.7273 f1 0.7164
step 60: train loss 0.2648 
cause_predict: train acc 0.9367 p 0.9167 r 0.5500 f1 0.6875
position_predict: train acc 0.9430 p 0.7353 r 0.7353 f1 0.7353
step 70: train loss 0.2549 
cause_predict: train acc 0.9331 p 0.7879 r 0.7429 f1 0.7647
position_predict: train acc 0.9833 p 1.0000 r 0.8750 f1 0.9333

epoch 6: test loss 0.5670 cost time: 12.3s

cause_predict: test acc 0.8914 p 0.6568 r 0.4890 f1 0.5606
max_acc 0.8914 max_p 0.6516 max_r 0.5016 max_f1 0.5668

position_predict: test acc 0.9191 p 0.6866 r 0.6794 f1 0.6830
max_acc 0.9281 max_p 0.7266 max_r 0.7038 max_f1 0.7150

Average max cause: max_acc 0.8914 max_p 0.6516 max_r 0.5016 max_f1 0.5668
Average max pos: max_acc 0.9281 max_p 0.7266 max_r 0.7038 max_f1 0.7150

step 10: train loss 0.2625 
cause_predict: train acc 0.9617 p 0.8235 r 0.8485 f1 0.8358
position_predict: train acc 0.9617 p 0.8438 r 0.8182 f1 0.8308
step 20: train loss 0.2058 
cause_predict: train acc 0.9436 p 0.8571 r 0.8333 f1 0.8451
position_predict: train acc 0.9897 p 1.0000 r 0.9375 f1 0.9677
step 30: train loss 0.2905 
cause_predict: train acc 0.9333 p 0.7812 r 0.7353 f1 0.7576
position_predict: train acc 0.9500 p 0.8000 r 0.8485 f1 0.8235
step 40: train loss 0.3050 
cause_predict: train acc 0.9425 p 0.9231 r 0.6857 f1 0.7869
position_predict: train acc 0.9381 p 0.7812 r 0.7812 f1 0.7812
step 50: train loss 0.3664 
cause_predict: train acc 0.9296 p 0.8182 r 0.6750 f1 0.7397
position_predict: train acc 0.9370 p 0.7586 r 0.6875 f1 0.7213
step 60: train loss 0.2313 
cause_predict: train acc 0.9557 p 0.8788 r 0.8529 f1 0.8657
position_predict: train acc 0.9704 p 0.9355 r 0.8788 f1 0.9062
step 70: train loss 0.2891 
cause_predict: train acc 0.9036 p 0.7586 r 0.6471 f1 0.6984
position_predict: train acc 0.9695 p 0.9062 r 0.9062 f1 0.9062

epoch 7: test loss 0.5769 cost time: 12.0s

cause_predict: test acc 0.8771 p 0.5802 r 0.4795 f1 0.5250
max_acc 0.8914 max_p 0.6516 max_r 0.5016 max_f1 0.5668

position_predict: test acc 0.9245 p 0.7235 r 0.6655 f1 0.6933
max_acc 0.9281 max_p 0.7266 max_r 0.7038 max_f1 0.7150

Average max cause: max_acc 0.8914 max_p 0.6516 max_r 0.5016 max_f1 0.5668
Average max pos: max_acc 0.9281 max_p 0.7266 max_r 0.7038 max_f1 0.7150

step 10: train loss 0.1833 
cause_predict: train acc 0.9521 p 0.8857 r 0.8611 f1 0.8732
position_predict: train acc 0.9734 p 0.9375 r 0.9091 f1 0.9231
step 20: train loss 0.1755 
cause_predict: train acc 0.9568 p 0.9630 r 0.7027 f1 0.8125
position_predict: train acc 0.9892 p 0.9688 r 0.9394 f1 0.9538
step 30: train loss 0.2509 
cause_predict: train acc 0.9531 p 0.8857 r 0.7750 f1 0.8267
position_predict: train acc 0.9603 p 0.8182 r 0.8438 f1 0.8308
step 40: train loss 0.1914 
cause_predict: train acc 0.9531 p 0.8529 r 0.8529 f1 0.8529
position_predict: train acc 0.9671 p 0.9032 r 0.8750 f1 0.8889
step 50: train loss 0.2225 
cause_predict: train acc 0.9505 p 0.9091 r 0.7895 f1 0.8451
position_predict: train acc 0.9730 p 0.9062 r 0.9062 f1 0.9062
step 60: train loss 0.2697 
cause_predict: train acc 0.9309 p 0.8125 r 0.7429 f1 0.7761
position_predict: train acc 0.9631 p 0.9000 r 0.8438 f1 0.8710
step 70: train loss 0.2012 
cause_predict: train acc 0.9528 p 0.9259 r 0.7143 f1 0.8065
position_predict: train acc 0.9724 p 0.8788 r 0.9062 f1 0.8923

epoch 8: test loss 0.6355 cost time: 12.1s

cause_predict: test acc 0.8771 p 0.5745 r 0.5110 f1 0.5409
max_acc 0.8914 max_p 0.6516 max_r 0.5016 max_f1 0.5668

position_predict: test acc 0.9218 p 0.6905 r 0.7073 f1 0.6988
max_acc 0.9281 max_p 0.7266 max_r 0.7038 max_f1 0.7150

Average max cause: max_acc 0.8914 max_p 0.6516 max_r 0.5016 max_f1 0.5668
Average max pos: max_acc 0.9281 max_p 0.7266 max_r 0.7038 max_f1 0.7150

step 10: train loss 0.1784 
cause_predict: train acc 0.9429 p 0.8824 r 0.7895 f1 0.8333
position_predict: train acc 0.9810 p 0.9375 r 0.9375 f1 0.9375
step 20: train loss 0.1963 
cause_predict: train acc 0.9393 p 0.7838 r 0.8056 f1 0.7945
position_predict: train acc 0.9757 p 0.8824 r 0.9375 f1 0.9091
step 30: train loss 0.1751 
cause_predict: train acc 0.9496 p 0.8235 r 0.8235 f1 0.8235
position_predict: train acc 0.9790 p 0.9355 r 0.9062 f1 0.9206
step 40: train loss 0.2015 
cause_predict: train acc 0.9424 p 0.8788 r 0.7436 f1 0.8056
position_predict: train acc 0.9712 p 0.8788 r 0.9062 f1 0.8923
step 50: train loss 0.2374 
cause_predict: train acc 0.9339 p 0.7632 r 0.8056 f1 0.7838
position_predict: train acc 0.9711 p 0.9032 r 0.8750 f1 0.8889
step 60: train loss 0.1997 
cause_predict: train acc 0.9589 p 0.9355 r 0.8056 f1 0.8657
position_predict: train acc 0.9635 p 0.9032 r 0.8485 f1 0.8750
step 70: train loss 0.2167 
cause_predict: train acc 0.9693 p 0.9062 r 0.8286 f1 0.8657
position_predict: train acc 0.9522 p 0.8750 r 0.6562 f1 0.7500

epoch 9: test loss 0.6671 cost time: 12.2s

cause_predict: test acc 0.8856 p 0.6160 r 0.5110 f1 0.5586
max_acc 0.8914 max_p 0.6516 max_r 0.5016 max_f1 0.5668

position_predict: test acc 0.9227 p 0.7209 r 0.6481 f1 0.6826
max_acc 0.9281 max_p 0.7266 max_r 0.7038 max_f1 0.7150

Average max cause: max_acc 0.8914 max_p 0.6516 max_r 0.5016 max_f1 0.5668
Average max pos: max_acc 0.9281 max_p 0.7266 max_r 0.7038 max_f1 0.7150

step 10: train loss 0.1583 
cause_predict: train acc 0.9620 p 0.8571 r 0.9231 f1 0.8889
position_predict: train acc 0.9705 p 0.8824 r 0.9091 f1 0.8955
step 20: train loss 0.1449 
cause_predict: train acc 0.9797 p 1.0000 r 0.8718 f1 0.9315
position_predict: train acc 0.9675 p 0.9286 r 0.8125 f1 0.8667
step 30: train loss 0.1533 
cause_predict: train acc 0.9574 p 0.8529 r 0.8056 f1 0.8286
position_predict: train acc 0.9716 p 0.8333 r 0.9375 f1 0.8824
step 40: train loss 0.1462 
cause_predict: train acc 0.9625 p 0.9167 r 0.8462 f1 0.8800
position_predict: train acc 0.9875 p 0.9677 r 0.9375 f1 0.9524
step 50: train loss 0.1612 
cause_predict: train acc 0.9555 p 0.8788 r 0.8056 f1 0.8406
position_predict: train acc 0.9757 p 0.9062 r 0.9062 f1 0.9062
step 60: train loss 0.1756 
cause_predict: train acc 0.9585 p 0.8158 r 0.8378 f1 0.8267
position_predict: train acc 0.9649 p 0.8667 r 0.7879 f1 0.8254
step 70: train loss 0.2749 
cause_predict: train acc 0.9469 p 0.7879 r 0.8125 f1 0.8000
position_predict: train acc 0.9388 p 0.7742 r 0.7500 f1 0.7619

epoch 10: test loss 0.6487 cost time: 12.1s

cause_predict: test acc 0.8740 p 0.5526 r 0.5804 f1 0.5662
max_acc 0.8914 max_p 0.6516 max_r 0.5016 max_f1 0.5668

position_predict: test acc 0.9254 p 0.7128 r 0.7003 f1 0.7065
max_acc 0.9281 max_p 0.7266 max_r 0.7038 max_f1 0.7150

Average max cause: max_acc 0.8914 max_p 0.6516 max_r 0.5016 max_f1 0.5668
Average max pos: max_acc 0.9281 max_p 0.7266 max_r 0.7038 max_f1 0.7150

step 10: train loss 0.1200 
cause_predict: train acc 0.9868 p 0.9412 r 0.9697 f1 0.9552
position_predict: train acc 0.9692 p 0.9310 r 0.8438 f1 0.8852
step 20: train loss 0.1070 
cause_predict: train acc 0.9698 p 0.9062 r 0.8286 f1 0.8657
position_predict: train acc 0.9799 p 0.9091 r 0.9091 f1 0.9091
step 30: train loss 0.0753 
cause_predict: train acc 0.9843 p 0.9375 r 0.9375 f1 0.9375
position_predict: train acc 0.9843 p 0.9394 r 0.9394 f1 0.9394
step 40: train loss 0.1117 
cause_predict: train acc 0.9709 p 0.9412 r 0.9143 f1 0.9275
position_predict: train acc 0.9826 p 0.9677 r 0.9375 f1 0.9524
step 50: train loss 0.1374 
cause_predict: train acc 0.9706 p 0.8571 r 0.8824 f1 0.8696
position_predict: train acc 0.9739 p 0.8529 r 0.9062 f1 0.8788
step 60: train loss 0.2337 
cause_predict: train acc 0.9556 p 0.8824 r 0.8333 f1 0.8571
position_predict: train acc 0.9644 p 0.8788 r 0.8788 f1 0.8788
step 70: train loss 0.1315 
cause_predict: train acc 0.9745 p 0.9394 r 0.8611 f1 0.8986
position_predict: train acc 0.9781 p 0.9333 r 0.8750 f1 0.9032

epoch 11: test loss 0.7145 cost time: 12.0s

cause_predict: test acc 0.8816 p 0.6032 r 0.4795 f1 0.5343
max_acc 0.8914 max_p 0.6516 max_r 0.5016 max_f1 0.5668

position_predict: test acc 0.9173 p 0.6796 r 0.6725 f1 0.6760
max_acc 0.9281 max_p 0.7266 max_r 0.7038 max_f1 0.7150

Average max cause: max_acc 0.8914 max_p 0.6516 max_r 0.5016 max_f1 0.5668
Average max pos: max_acc 0.9281 max_p 0.7266 max_r 0.7038 max_f1 0.7150

step 10: train loss 0.1360 
cause_predict: train acc 0.9711 p 0.9231 r 0.8780 f1 0.9000
position_predict: train acc 0.9747 p 0.8788 r 0.9062 f1 0.8923
step 20: train loss 0.2187 
cause_predict: train acc 0.9553 p 0.8571 r 0.8333 f1 0.8451
position_predict: train acc 0.9512 p 0.7895 r 0.8824 f1 0.8333
step 30: train loss 0.1151 
cause_predict: train acc 0.9786 p 0.9412 r 0.9143 f1 0.9275
position_predict: train acc 0.9744 p 0.9062 r 0.9062 f1 0.9062
step 40: train loss 0.1256 
cause_predict: train acc 0.9831 p 0.9394 r 0.9394 f1 0.9394
position_predict: train acc 0.9705 p 0.9062 r 0.8788 f1 0.8923
step 50: train loss 0.1996 
cause_predict: train acc 0.9554 p 0.8788 r 0.8286 f1 0.8529
position_predict: train acc 0.9598 p 0.8710 r 0.8438 f1 0.8571
step 60: train loss 0.1300 
cause_predict: train acc 0.9767 p 0.9697 r 0.8649 f1 0.9143
position_predict: train acc 0.9805 p 0.9143 r 0.9412 f1 0.9275
step 70: train loss 0.0629 
cause_predict: train acc 0.9956 p 0.9697 r 1.0000 f1 0.9846
position_predict: train acc 1.0000 p 1.0000 r 1.0000 f1 1.0000

epoch 12: test loss 0.6846 cost time: 12.6s

cause_predict: test acc 0.8847 p 0.6081 r 0.5237 f1 0.5627
max_acc 0.8914 max_p 0.6516 max_r 0.5016 max_f1 0.5668

position_predict: test acc 0.9223 p 0.7148 r 0.6551 f1 0.6836
max_acc 0.9281 max_p 0.7266 max_r 0.7038 max_f1 0.7150

Average max cause: max_acc 0.8914 max_p 0.6516 max_r 0.5016 max_f1 0.5668
Average max pos: max_acc 0.9281 max_p 0.7266 max_r 0.7038 max_f1 0.7150

step 10: train loss 0.0708 
cause_predict: train acc 0.9956 p 1.0000 r 0.9737 f1 0.9867
position_predict: train acc 0.9867 p 0.9677 r 0.9375 f1 0.9524
step 20: train loss 0.1417 
cause_predict: train acc 0.9529 p 0.8462 r 0.8462 f1 0.8462
position_predict: train acc 0.9686 p 0.8571 r 0.9091 f1 0.8824
step 30: train loss 0.1448 
cause_predict: train acc 0.9640 p 0.8824 r 0.8824 f1 0.8824
position_predict: train acc 0.9730 p 0.9062 r 0.9062 f1 0.9062
step 40: train loss 0.1095 
cause_predict: train acc 0.9911 p 0.9722 r 0.9722 f1 0.9722
position_predict: train acc 0.9732 p 0.8824 r 0.9375 f1 0.9091
step 50: train loss 0.1521 
cause_predict: train acc 0.9765 p 0.9688 r 0.8857 f1 0.9254
position_predict: train acc 0.9765 p 0.9091 r 0.9375 f1 0.9231
step 60: train loss 0.1687 
cause_predict: train acc 0.9683 p 0.9091 r 0.8571 f1 0.8824
position_predict: train acc 0.9683 p 0.9000 r 0.8438 f1 0.8710
step 70: train loss 0.1279 
cause_predict: train acc 0.9722 p 0.9091 r 0.8333 f1 0.8696
position_predict: train acc 0.9722 p 0.8485 r 0.8750 f1 0.8615

epoch 13: test loss 0.7442 cost time: 12.1s

cause_predict: test acc 0.8870 p 0.6176 r 0.5300 f1 0.5705
max_acc 0.8870 max_p 0.6176 max_r 0.5300 max_f1 0.5705

position_predict: test acc 0.9187 p 0.6855 r 0.6760 f1 0.6807
max_acc 0.9281 max_p 0.7266 max_r 0.7038 max_f1 0.7150

Average max cause: max_acc 0.8914 max_p 0.6516 max_r 0.5016 max_f1 0.5668
Average max pos: max_acc 0.9281 max_p 0.7266 max_r 0.7038 max_f1 0.7150

step 10: train loss 0.0742 
cause_predict: train acc 0.9811 p 0.9091 r 0.9375 f1 0.9231
position_predict: train acc 0.9925 p 0.9688 r 0.9688 f1 0.9688
step 20: train loss 0.1179 
cause_predict: train acc 0.9818 p 0.9189 r 0.9714 f1 0.9444
position_predict: train acc 0.9818 p 0.9118 r 0.9688 f1 0.9394
step 30: train loss 0.1479 
cause_predict: train acc 0.9725 p 0.8824 r 0.9375 f1 0.9091
position_predict: train acc 0.9679 p 0.9032 r 0.8750 f1 0.8889
step 40: train loss 0.0867 
cause_predict: train acc 0.9862 p 0.9412 r 0.9697 f1 0.9552
position_predict: train acc 0.9816 p 0.9375 r 0.9375 f1 0.9375
step 50: train loss 0.1295 
cause_predict: train acc 0.9785 p 0.9211 r 0.9722 f1 0.9459
position_predict: train acc 0.9677 p 0.9062 r 0.9062 f1 0.9062
step 60: train loss 0.0821 
cause_predict: train acc 0.9921 p 0.9714 r 0.9714 f1 0.9714
position_predict: train acc 0.9763 p 0.9062 r 0.9062 f1 0.9062
step 70: train loss 0.2852 
cause_predict: train acc 0.9436 p 0.8387 r 0.8125 f1 0.8254
position_predict: train acc 0.9282 p 0.7812 r 0.7812 f1 0.7812

epoch 14: test loss 0.7602 cost time: 12.1s

cause_predict: test acc 0.8834 p 0.5940 r 0.5584 f1 0.5756
max_acc 0.8834 max_p 0.5940 max_r 0.5584 max_f1 0.5756

position_predict: test acc 0.9133 p 0.6515 r 0.6969 f1 0.6734
max_acc 0.9281 max_p 0.7266 max_r 0.7038 max_f1 0.7150

Average max cause: max_acc 0.8914 max_p 0.6516 max_r 0.5016 max_f1 0.5668
Average max pos: max_acc 0.9281 max_p 0.7266 max_r 0.7038 max_f1 0.7150

write pair_data/Ind_BiLSTM_2/fold_8_test.txt done
write pair_data/Ind_BiLSTM_2/fold_8_train.txt done
Optimization Finished!

############# fold 8 end ###############
############# fold 9 begin ###############
load data_file: data_combine_en/fold_9_train.txt
y_position.shape (2275, 75, 2)
y_cause.shape (2275, 75, 2)
x.shape (2275, 75, 30)
sen_len.shape (2275, 75)
doc_len.shape (2275,)
n_cut 107
load data done!

load data_file: data_combine_en/fold_9_test.txt
y_position.shape (284, 75, 2)
y_cause.shape (284, 75, 2)
x.shape (284, 75, 30)
sen_len.shape (284, 75)
doc_len.shape (284,)
n_cut 22
load data done!

train docs: 2275    test docs: 284
step 10: train loss 0.8287 
cause_predict: train acc 0.8458 p 0.0000 r 0.0000 f1 0.0000
position_predict: train acc 0.8590 p 0.0000 r 0.0000 f1 0.0000
step 20: train loss 0.8503 
cause_predict: train acc 0.7989 p 0.0000 r 0.0000 f1 0.0000
position_predict: train acc 0.8161 p 0.0000 r 0.0000 f1 0.0000
step 30: train loss 0.6146 
cause_predict: train acc 0.8653 p 0.0000 r 0.0000 f1 0.0000
position_predict: train acc 0.8694 p 0.0000 r 0.0000 f1 0.0000
step 40: train loss 0.5532 
cause_predict: train acc 0.8800 p 0.0000 r 0.0000 f1 0.0000
position_predict: train acc 0.9067 p 0.7000 r 0.2188 f1 0.3333
step 50: train loss 0.5625 
cause_predict: train acc 0.8622 p 0.0000 r 0.0000 f1 0.0000
position_predict: train acc 0.9173 p 0.7727 r 0.5152 f1 0.6182
step 60: train loss 0.6437 
cause_predict: train acc 0.8178 p 0.0000 r 0.0000 f1 0.0000
position_predict: train acc 0.9111 p 0.7500 r 0.5625 f1 0.6429
step 70: train loss 0.5695 
cause_predict: train acc 0.8534 p 0.7500 r 0.0833 f1 0.1500
position_predict: train acc 0.9138 p 0.8095 r 0.5152 f1 0.6296

epoch 0: test loss 0.5292 cost time: 12.1s

cause_predict: test acc 0.8838 p 0.6492 r 0.3912 f1 0.4882
max_acc 0.8838 max_p 0.6492 max_r 0.3912 max_f1 0.4882

position_predict: test acc 0.9142 p 0.7596 r 0.4843 f1 0.5915
max_acc 0.9142 max_p 0.7596 max_r 0.4843 max_f1 0.5915

Average max cause: max_acc 0.8838 max_p 0.6492 max_r 0.3912 max_f1 0.4882
Average max pos: max_acc 0.9142 max_p 0.7596 max_r 0.4843 max_f1 0.5915

step 10: train loss 0.5090 
cause_predict: train acc 0.8855 p 0.8750 r 0.1944 f1 0.3182
position_predict: train acc 0.9275 p 0.7600 r 0.5938 f1 0.6667
step 20: train loss 0.5619 
cause_predict: train acc 0.8744 p 0.8333 r 0.4054 f1 0.5455
position_predict: train acc 0.9246 p 0.8400 r 0.6562 f1 0.7368
step 30: train loss 0.4856 
cause_predict: train acc 0.9031 p 0.8000 r 0.5882 f1 0.6780
position_predict: train acc 0.9337 p 0.8276 r 0.7500 f1 0.7869
step 40: train loss 0.4434 
cause_predict: train acc 0.8958 p 0.5625 r 0.2812 f1 0.3750
position_predict: train acc 0.9271 p 0.7037 r 0.5938 f1 0.6441
step 50: train loss 0.5789 
cause_predict: train acc 0.8830 p 0.6316 r 0.3333 f1 0.4364
position_predict: train acc 0.9019 p 0.6250 r 0.4688 f1 0.5357
step 60: train loss 0.5476 
cause_predict: train acc 0.8744 p 0.7059 r 0.3429 f1 0.4615
position_predict: train acc 0.9058 p 0.7727 r 0.5152 f1 0.6182
step 70: train loss 0.4112 
cause_predict: train acc 0.8728 p 0.5556 r 0.6061 f1 0.5797
position_predict: train acc 0.9386 p 0.8214 r 0.7188 f1 0.7667

epoch 1: test loss 0.4767 cost time: 12.2s

cause_predict: test acc 0.8878 p 0.6964 r 0.3691 f1 0.4825
max_acc 0.8838 max_p 0.6492 max_r 0.3912 max_f1 0.4882

position_predict: test acc 0.9254 p 0.7419 r 0.6411 f1 0.6879
max_acc 0.9254 max_p 0.7419 max_r 0.6411 max_f1 0.6879

Average max cause: max_acc 0.8878 max_p 0.6964 max_r 0.3691 max_f1 0.4825
Average max pos: max_acc 0.9254 max_p 0.7419 max_r 0.6411 max_f1 0.6879

step 10: train loss 0.4275 
cause_predict: train acc 0.9237 p 0.8182 r 0.5294 f1 0.6429
position_predict: train acc 0.9198 p 0.7200 r 0.5625 f1 0.6316
step 20: train loss 0.4077 
cause_predict: train acc 0.9066 p 0.8000 r 0.4444 f1 0.5714
position_predict: train acc 0.9183 p 0.8000 r 0.4848 f1 0.6038
step 30: train loss 0.4951 
cause_predict: train acc 0.8773 p 0.5294 r 0.2571 f1 0.3462
position_predict: train acc 0.9206 p 0.6786 r 0.5938 f1 0.6333
step 40: train loss 0.4317 
cause_predict: train acc 0.8963 p 0.5806 r 0.5455 f1 0.5625
position_predict: train acc 0.9407 p 0.8400 r 0.6364 f1 0.7241
step 50: train loss 0.5499 
cause_predict: train acc 0.8649 p 0.6875 r 0.3056 f1 0.4231
position_predict: train acc 0.9189 p 0.7692 r 0.6250 f1 0.6897
step 60: train loss 0.5040 
cause_predict: train acc 0.8904 p 0.6250 r 0.6061 f1 0.6154
position_predict: train acc 0.9079 p 0.7037 r 0.5938 f1 0.6441
step 70: train loss 0.4007 
cause_predict: train acc 0.8853 p 0.6250 r 0.2778 f1 0.3846
position_predict: train acc 0.9211 p 0.6562 r 0.6562 f1 0.6562

epoch 2: test loss 0.4709 cost time: 12.3s

cause_predict: test acc 0.8901 p 0.6940 r 0.4006 f1 0.5080
max_acc 0.8901 max_p 0.6940 max_r 0.4006 max_f1 0.5080

position_predict: test acc 0.9236 p 0.7132 r 0.6760 f1 0.6941
max_acc 0.9236 max_p 0.7132 max_r 0.6760 max_f1 0.6941

Average max cause: max_acc 0.8901 max_p 0.6940 max_r 0.4006 max_f1 0.5080
Average max pos: max_acc 0.9236 max_p 0.7132 max_r 0.6760 max_f1 0.6941

step 10: train loss 0.4360 
cause_predict: train acc 0.8584 p 0.6111 r 0.3143 f1 0.4151
position_predict: train acc 0.9452 p 0.8333 r 0.7812 f1 0.8065
step 20: train loss 0.4227 
cause_predict: train acc 0.8711 p 0.5789 r 0.3056 f1 0.4000
position_predict: train acc 0.9258 p 0.6857 r 0.7500 f1 0.7164
step 30: train loss 0.4522 
cause_predict: train acc 0.8929 p 0.7619 r 0.4571 f1 0.5714
position_predict: train acc 0.9509 p 0.8621 r 0.7812 f1 0.8197
step 40: train loss 0.4536 
cause_predict: train acc 0.9060 p 0.8500 r 0.4722 f1 0.6071
position_predict: train acc 0.9487 p 0.8125 r 0.8125 f1 0.8125
step 50: train loss 0.4580 
cause_predict: train acc 0.9149 p 0.8261 r 0.5429 f1 0.6552
position_predict: train acc 0.8936 p 0.6207 r 0.5625 f1 0.5902
step 60: train loss 0.4508 
cause_predict: train acc 0.8663 p 0.6923 r 0.4865 f1 0.5714
position_predict: train acc 0.9406 p 0.8929 r 0.7353 f1 0.8065
step 70: train loss 0.3626 
cause_predict: train acc 0.9052 p 0.7241 r 0.6000 f1 0.6562
position_predict: train acc 0.9483 p 0.7941 r 0.8438 f1 0.8182

epoch 3: test loss 0.4825 cost time: 12.2s

cause_predict: test acc 0.8914 p 0.6555 r 0.4921 f1 0.5622
max_acc 0.8914 max_p 0.6555 max_r 0.4921 max_f1 0.5622

position_predict: test acc 0.9231 p 0.7328 r 0.6307 f1 0.6779
max_acc 0.9236 max_p 0.7132 max_r 0.6760 max_f1 0.6941

Average max cause: max_acc 0.8914 max_p 0.6555 max_r 0.4921 max_f1 0.5622
Average max pos: max_acc 0.9231 max_p 0.7328 max_r 0.6307 max_f1 0.6779

step 10: train loss 0.3348 
cause_predict: train acc 0.9444 p 0.9200 r 0.6765 f1 0.7797
position_predict: train acc 0.9573 p 0.9600 r 0.7273 f1 0.8276
step 20: train loss 0.3880 
cause_predict: train acc 0.8712 p 0.7143 r 0.3846 f1 0.5000
position_predict: train acc 0.9442 p 0.8065 r 0.7812 f1 0.7937
step 30: train loss 0.3126 
cause_predict: train acc 0.9132 p 0.6667 r 0.5625 f1 0.6102
position_predict: train acc 0.9396 p 0.7500 r 0.7500 f1 0.7500
step 40: train loss 0.3868 
cause_predict: train acc 0.8974 p 0.7778 r 0.6000 f1 0.6774
position_predict: train acc 0.9487 p 0.8929 r 0.7812 f1 0.8333
step 50: train loss 0.5175 
cause_predict: train acc 0.8982 p 0.7778 r 0.6562 f1 0.7119
position_predict: train acc 0.9102 p 0.7931 r 0.7188 f1 0.7541
step 60: train loss 0.4209 
cause_predict: train acc 0.8884 p 0.7333 r 0.5366 f1 0.6197
position_predict: train acc 0.9339 p 0.7931 r 0.6970 f1 0.7419
step 70: train loss 0.4445 
cause_predict: train acc 0.8705 p 0.5455 r 0.4615 f1 0.5000
position_predict: train acc 0.9209 p 0.6667 r 0.6250 f1 0.6452

epoch 4: test loss 0.4760 cost time: 12.3s

cause_predict: test acc 0.8923 p 0.6473 r 0.5268 f1 0.5809
max_acc 0.8923 max_p 0.6473 max_r 0.5268 max_f1 0.5809

position_predict: test acc 0.9223 p 0.7287 r 0.6272 f1 0.6742
max_acc 0.9236 max_p 0.7132 max_r 0.6760 max_f1 0.6941

Average max cause: max_acc 0.8923 max_p 0.6473 max_r 0.5268 max_f1 0.5809
Average max pos: max_acc 0.9223 max_p 0.7287 max_r 0.6272 max_f1 0.6742

step 10: train loss 0.4115 
cause_predict: train acc 0.9352 p 0.8966 r 0.7027 f1 0.7879
position_predict: train acc 0.9259 p 0.7500 r 0.7500 f1 0.7500
step 20: train loss 0.2338 
cause_predict: train acc 0.9478 p 0.7941 r 0.7941 f1 0.7941
position_predict: train acc 0.9590 p 0.9259 r 0.7353 f1 0.8197
step 30: train loss 0.3895 
cause_predict: train acc 0.9036 p 0.7931 r 0.5610 f1 0.6571
position_predict: train acc 0.9438 p 0.7647 r 0.8125 f1 0.7879
step 40: train loss 0.3668 
cause_predict: train acc 0.8851 p 0.6774 r 0.5122 f1 0.5833
position_predict: train acc 0.9425 p 0.8462 r 0.6667 f1 0.7458
step 50: train loss 0.3652 
cause_predict: train acc 0.9071 p 0.7600 r 0.5000 f1 0.6032
position_predict: train acc 0.9480 p 0.8462 r 0.6875 f1 0.7586
step 60: train loss 0.2898 
cause_predict: train acc 0.9379 p 0.8750 r 0.5676 f1 0.6885
position_predict: train acc 0.9542 p 0.8214 r 0.7188 f1 0.7667
step 70: train loss 0.3400 
cause_predict: train acc 0.9121 p 0.8148 r 0.6667 f1 0.7333
position_predict: train acc 0.9505 p 0.8966 r 0.8125 f1 0.8525

epoch 5: test loss 0.5063 cost time: 12.5s

cause_predict: test acc 0.8923 p 0.6727 r 0.4669 f1 0.5512
max_acc 0.8923 max_p 0.6473 max_r 0.5268 max_f1 0.5809

position_predict: test acc 0.9223 p 0.7384 r 0.6098 f1 0.6679
max_acc 0.9236 max_p 0.7132 max_r 0.6760 max_f1 0.6941

Average max cause: max_acc 0.8923 max_p 0.6473 max_r 0.5268 max_f1 0.5809
Average max pos: max_acc 0.9223 max_p 0.7287 max_r 0.6272 max_f1 0.6742

step 10: train loss 0.2327 
cause_predict: train acc 0.9500 p 0.8857 r 0.7750 f1 0.8267
position_predict: train acc 0.9462 p 0.8000 r 0.7500 f1 0.7742
step 20: train loss 0.2957 
cause_predict: train acc 0.9005 p 0.7500 r 0.6000 f1 0.6667
position_predict: train acc 0.9716 p 0.9062 r 0.9062 f1 0.9062
step 30: train loss 0.4226 
cause_predict: train acc 0.8829 p 0.7241 r 0.5676 f1 0.6364
position_predict: train acc 0.9463 p 0.8108 r 0.8824 f1 0.8451
step 40: train loss 0.3094 
cause_predict: train acc 0.9059 p 0.7037 r 0.5429 f1 0.6129
position_predict: train acc 0.9686 p 0.9000 r 0.8438 f1 0.8710
step 50: train loss 0.3098 
cause_predict: train acc 0.8904 p 0.6579 r 0.6944 f1 0.6757
position_predict: train acc 0.9726 p 1.0000 r 0.8125 f1 0.8966
step 60: train loss 0.3881 
cause_predict: train acc 0.9167 p 0.8077 r 0.6176 f1 0.7000
position_predict: train acc 0.9259 p 0.7353 r 0.7812 f1 0.7576
step 70: train loss 0.2743 
cause_predict: train acc 0.9264 p 0.7692 r 0.7895 f1 0.7792
position_predict: train acc 0.9524 p 0.8889 r 0.7500 f1 0.8136

epoch 6: test loss 0.5161 cost time: 12.2s

cause_predict: test acc 0.8811 p 0.5853 r 0.5521 f1 0.5682
max_acc 0.8923 max_p 0.6473 max_r 0.5268 max_f1 0.5809

position_predict: test acc 0.9218 p 0.7044 r 0.6725 f1 0.6881
max_acc 0.9236 max_p 0.7132 max_r 0.6760 max_f1 0.6941

Average max cause: max_acc 0.8811 max_p 0.5853 max_r 0.5521 max_f1 0.5682
Average max pos: max_acc 0.9218 max_p 0.7044 max_r 0.6725 max_f1 0.6881

step 10: train loss 0.1692 
cause_predict: train acc 0.9492 p 0.8529 r 0.8056 f1 0.8286
position_predict: train acc 0.9873 p 0.9394 r 0.9688 f1 0.9538
step 20: train loss 0.1719 
cause_predict: train acc 0.9696 p 0.8966 r 0.7647 f1 0.8254
position_predict: train acc 0.9751 p 0.8750 r 0.8485 f1 0.8615
step 30: train loss 0.2571 
cause_predict: train acc 0.9467 p 0.9259 r 0.7143 f1 0.8065
position_predict: train acc 0.9556 p 0.8966 r 0.7879 f1 0.8387
step 40: train loss 0.2855 
cause_predict: train acc 0.9595 p 0.9412 r 0.8205 f1 0.8767
position_predict: train acc 0.9324 p 0.7742 r 0.7500 f1 0.7619
step 50: train loss 0.2237 
cause_predict: train acc 0.9458 p 0.8108 r 0.8824 f1 0.8451
position_predict: train acc 0.9754 p 0.9091 r 0.9375 f1 0.9231
step 60: train loss 0.3020 
cause_predict: train acc 0.9204 p 0.7222 r 0.7647 f1 0.7429
position_predict: train acc 0.9602 p 0.9259 r 0.7812 f1 0.8475
step 70: train loss 0.3025 
cause_predict: train acc 0.9320 p 0.8065 r 0.7576 f1 0.7812
position_predict: train acc 0.9369 p 0.7714 r 0.8438 f1 0.8060

epoch 7: test loss 0.5383 cost time: 12.3s

cause_predict: test acc 0.8686 p 0.5401 r 0.4890 f1 0.5132
max_acc 0.8923 max_p 0.6473 max_r 0.5268 max_f1 0.5809

position_predict: test acc 0.9240 p 0.7112 r 0.6864 f1 0.6986
max_acc 0.9240 max_p 0.7112 max_r 0.6864 max_f1 0.6986

Average max cause: max_acc 0.8811 max_p 0.5853 max_r 0.5521 max_f1 0.5682
Average max pos: max_acc 0.9218 max_p 0.7044 max_r 0.6725 max_f1 0.6881

step 10: train loss 0.1785 
cause_predict: train acc 0.9609 p 0.8485 r 0.8485 f1 0.8485
position_predict: train acc 0.9570 p 0.8387 r 0.8125 f1 0.8254
step 20: train loss 0.1871 
cause_predict: train acc 0.9565 p 0.9000 r 0.7500 f1 0.8182
position_predict: train acc 0.9638 p 0.8667 r 0.8125 f1 0.8387
step 30: train loss 0.2423 
cause_predict: train acc 0.9462 p 0.9000 r 0.6923 f1 0.7826
position_predict: train acc 0.9713 p 0.8529 r 0.9062 f1 0.8788
step 40: train loss 0.2555 
cause_predict: train acc 0.8926 p 0.7143 r 0.6098 f1 0.6579
position_predict: train acc 0.9876 p 0.9394 r 0.9688 f1 0.9538
step 50: train loss 0.2203 
cause_predict: train acc 0.9412 p 0.7895 r 0.8108 f1 0.8000
position_predict: train acc 0.9529 p 0.8621 r 0.7576 f1 0.8065
step 60: train loss 0.2240 
cause_predict: train acc 0.9581 p 0.9091 r 0.8333 f1 0.8696
position_predict: train acc 0.9581 p 0.8710 r 0.8438 f1 0.8571
step 70: train loss 0.2603 
cause_predict: train acc 0.9541 p 0.8788 r 0.8529 f1 0.8657
position_predict: train acc 0.9388 p 0.8125 r 0.8125 f1 0.8125

epoch 8: test loss 0.5580 cost time: 12.5s

cause_predict: test acc 0.8825 p 0.6047 r 0.4921 f1 0.5426
max_acc 0.8923 max_p 0.6473 max_r 0.5268 max_f1 0.5809

position_predict: test acc 0.9133 p 0.6655 r 0.6516 f1 0.6585
max_acc 0.9240 max_p 0.7112 max_r 0.6864 max_f1 0.6986

Average max cause: max_acc 0.8811 max_p 0.5853 max_r 0.5521 max_f1 0.5682
Average max pos: max_acc 0.9218 max_p 0.7044 max_r 0.6725 max_f1 0.6881

step 10: train loss 0.1876 
cause_predict: train acc 0.9739 p 0.9143 r 0.9143 f1 0.9143
position_predict: train acc 0.9652 p 0.8529 r 0.9062 f1 0.8788
step 20: train loss 0.1385 
cause_predict: train acc 0.9671 p 0.8788 r 0.8788 f1 0.8788
position_predict: train acc 0.9712 p 0.9032 r 0.8750 f1 0.8889
step 30: train loss 0.1824 
cause_predict: train acc 0.9782 p 0.9189 r 0.9444 f1 0.9315
position_predict: train acc 0.9651 p 0.8750 r 0.8750 f1 0.8750
step 40: train loss 0.1803 
cause_predict: train acc 0.9628 p 0.8611 r 0.8857 f1 0.8732
position_predict: train acc 0.9587 p 0.8438 r 0.8438 f1 0.8438
step 50: train loss 0.1329 
cause_predict: train acc 0.9788 p 1.0000 r 0.8571 f1 0.9231
position_predict: train acc 0.9788 p 0.9091 r 0.9375 f1 0.9231
step 60: train loss 0.1716 
cause_predict: train acc 0.9469 p 0.9032 r 0.7368 f1 0.8116
position_predict: train acc 0.9755 p 0.9655 r 0.8485 f1 0.9032
step 70: train loss 0.2019 
cause_predict: train acc 0.9489 p 0.8750 r 0.7778 f1 0.8235
position_predict: train acc 0.9787 p 0.9655 r 0.8750 f1 0.9180

epoch 9: test loss 0.6050 cost time: 12.4s

cause_predict: test acc 0.8937 p 0.6725 r 0.4858 f1 0.5641
max_acc 0.8923 max_p 0.6473 max_r 0.5268 max_f1 0.5809

position_predict: test acc 0.9191 p 0.6949 r 0.6585 f1 0.6762
max_acc 0.9240 max_p 0.7112 max_r 0.6864 max_f1 0.6986

Average max cause: max_acc 0.8811 max_p 0.5853 max_r 0.5521 max_f1 0.5682
Average max pos: max_acc 0.9218 max_p 0.7044 max_r 0.6725 max_f1 0.6881

step 10: train loss 0.2124 
cause_predict: train acc 0.9567 p 0.8750 r 0.8333 f1 0.8537
position_predict: train acc 0.9675 p 0.8710 r 0.8438 f1 0.8571
step 20: train loss 0.1344 
cause_predict: train acc 0.9706 p 0.9412 r 0.8421 f1 0.8889
position_predict: train acc 0.9890 p 0.9394 r 0.9688 f1 0.9538
step 30: train loss 0.1299 
cause_predict: train acc 0.9596 p 0.9333 r 0.8235 f1 0.8750
position_predict: train acc 0.9899 p 0.9688 r 0.9688 f1 0.9688
step 40: train loss 0.1833 
cause_predict: train acc 0.9567 p 0.8286 r 0.8056 f1 0.8169
position_predict: train acc 0.9700 p 0.8966 r 0.8125 f1 0.8525
step 50: train loss 0.2393 
cause_predict: train acc 0.9552 p 0.8710 r 0.8182 f1 0.8438
position_predict: train acc 0.9641 p 0.8788 r 0.8788 f1 0.8788
step 60: train loss 0.2318 
cause_predict: train acc 0.9604 p 0.8421 r 0.9143 f1 0.8767
position_predict: train acc 0.9383 p 0.7647 r 0.8125 f1 0.7879
step 70: train loss 0.2773 
cause_predict: train acc 0.9412 p 0.7778 r 0.8485 f1 0.8116
position_predict: train acc 0.9502 p 0.8182 r 0.8438 f1 0.8308

epoch 10: test loss 0.6043 cost time: 12.2s

cause_predict: test acc 0.8838 p 0.5947 r 0.5647 f1 0.5793
max_acc 0.8923 max_p 0.6473 max_r 0.5268 max_f1 0.5809

position_predict: test acc 0.9178 p 0.6770 r 0.6864 f1 0.6817
max_acc 0.9240 max_p 0.7112 max_r 0.6864 max_f1 0.6986

Average max cause: max_acc 0.8838 max_p 0.5947 max_r 0.5647 max_f1 0.5793
Average max pos: max_acc 0.9178 max_p 0.6770 max_r 0.6864 max_f1 0.6817

step 10: train loss 0.1168 
cause_predict: train acc 0.9841 p 0.9375 r 0.9375 f1 0.9375
position_predict: train acc 0.9761 p 0.8824 r 0.9375 f1 0.9091
step 20: train loss 0.1193 
cause_predict: train acc 0.9810 p 0.9459 r 0.9211 f1 0.9333
position_predict: train acc 0.9886 p 0.9394 r 0.9688 f1 0.9538
step 30: train loss 0.1320 
cause_predict: train acc 0.9794 p 0.9667 r 0.8788 f1 0.9206
position_predict: train acc 0.9671 p 0.9000 r 0.8438 f1 0.8710
step 40: train loss 0.1324 
cause_predict: train acc 0.9754 p 0.9459 r 0.8974 f1 0.9211
position_predict: train acc 0.9713 p 0.8788 r 0.9062 f1 0.8923
step 50: train loss 0.1422 
cause_predict: train acc 0.9656 p 0.8571 r 0.8571 f1 0.8571
position_predict: train acc 0.9794 p 0.9091 r 0.9091 f1 0.9091
step 60: train loss 0.2122 
cause_predict: train acc 0.9524 p 0.8235 r 0.8485 f1 0.8358
position_predict: train acc 0.9567 p 0.8438 r 0.8438 f1 0.8438
step 70: train loss 0.2676 
cause_predict: train acc 0.9719 p 0.8718 r 0.9189 f1 0.8947
position_predict: train acc 0.9404 p 0.7419 r 0.7188 f1 0.7302

epoch 11: test loss 0.6510 cost time: 12.3s

cause_predict: test acc 0.8874 p 0.6080 r 0.5773 f1 0.5922
max_acc 0.8874 max_p 0.6080 max_r 0.5773 max_f1 0.5922

position_predict: test acc 0.9182 p 0.6844 r 0.6725 f1 0.6784
max_acc 0.9240 max_p 0.7112 max_r 0.6864 max_f1 0.6986

Average max cause: max_acc 0.8874 max_p 0.6080 max_r 0.5773 max_f1 0.5922
Average max pos: max_acc 0.9182 max_p 0.6844 max_r 0.6725 max_f1 0.6784

step 10: train loss 0.0851 
cause_predict: train acc 0.9837 p 1.0000 r 0.8889 f1 0.9412
position_predict: train acc 0.9878 p 0.9394 r 0.9688 f1 0.9538
step 20: train loss 0.1120 
cause_predict: train acc 0.9724 p 0.9429 r 0.8684 f1 0.9041
position_predict: train acc 0.9843 p 1.0000 r 0.8788 f1 0.9355
step 30: train loss 0.1559 
cause_predict: train acc 0.9615 p 0.9655 r 0.7778 f1 0.8615
position_predict: train acc 0.9872 p 0.9189 r 1.0000 f1 0.9577
step 40: train loss 0.1359 
cause_predict: train acc 0.9653 p 0.8108 r 0.9091 f1 0.8571
position_predict: train acc 0.9792 p 0.8824 r 0.9375 f1 0.9091
step 50: train loss 0.1253 
cause_predict: train acc 0.9583 p 0.9118 r 0.8378 f1 0.8732
position_predict: train acc 0.9907 p 0.9697 r 0.9697 f1 0.9697
step 60: train loss 0.3011 
cause_predict: train acc 0.9298 p 0.7778 r 0.8750 f1 0.8235
position_predict: train acc 0.9532 p 0.8750 r 0.8750 f1 0.8750
step 70: train loss 0.1577 
cause_predict: train acc 0.9660 p 0.8857 r 0.8611 f1 0.8732
position_predict: train acc 0.9811 p 0.9355 r 0.9062 f1 0.9206

epoch 12: test loss 0.6555 cost time: 12.5s

cause_predict: test acc 0.8883 p 0.6245 r 0.5300 f1 0.5734
max_acc 0.8874 max_p 0.6080 max_r 0.5773 max_f1 0.5922

position_predict: test acc 0.9200 p 0.6929 r 0.6760 f1 0.6843
max_acc 0.9240 max_p 0.7112 max_r 0.6864 max_f1 0.6986

Average max cause: max_acc 0.8874 max_p 0.6080 max_r 0.5773 max_f1 0.5922
Average max pos: max_acc 0.9182 max_p 0.6844 max_r 0.6725 max_f1 0.6784

step 10: train loss 0.1673 
cause_predict: train acc 0.9732 p 0.9688 r 0.8611 f1 0.9118
position_predict: train acc 0.9598 p 0.8966 r 0.8125 f1 0.8525
step 20: train loss 0.1250 
cause_predict: train acc 0.9575 p 0.9143 r 0.8421 f1 0.8767
position_predict: train acc 0.9858 p 0.9394 r 0.9688 f1 0.9538
step 30: train loss 0.1184 
cause_predict: train acc 0.9764 p 0.9688 r 0.8857 f1 0.9254
position_predict: train acc 0.9811 p 0.9375 r 0.9375 f1 0.9375
step 40: train loss 0.1690 
cause_predict: train acc 0.9667 p 0.8824 r 0.8824 f1 0.8824
position_predict: train acc 0.9667 p 0.8750 r 0.8750 f1 0.8750
step 50: train loss 0.2125 
cause_predict: train acc 0.9531 p 0.8788 r 0.7838 f1 0.8286
position_predict: train acc 0.9531 p 0.8333 r 0.7812 f1 0.8065
step 60: train loss 0.1617 
cause_predict: train acc 0.9684 p 0.8889 r 0.8889 f1 0.8889
position_predict: train acc 0.9526 p 0.8235 r 0.8235 f1 0.8235
step 70: train loss 0.1917 
cause_predict: train acc 0.9602 p 0.8250 r 0.9167 f1 0.8684
position_predict: train acc 0.9602 p 0.8438 r 0.8438 f1 0.8438

epoch 13: test loss 0.6786 cost time: 12.5s

cause_predict: test acc 0.8829 p 0.5939 r 0.5489 f1 0.5705
max_acc 0.8874 max_p 0.6080 max_r 0.5773 max_f1 0.5922

position_predict: test acc 0.9164 p 0.6799 r 0.6585 f1 0.6690
max_acc 0.9240 max_p 0.7112 max_r 0.6864 max_f1 0.6986

Average max cause: max_acc 0.8874 max_p 0.6080 max_r 0.5773 max_f1 0.5922
Average max pos: max_acc 0.9182 max_p 0.6844 max_r 0.6725 max_f1 0.6784

step 10: train loss 0.0867 
cause_predict: train acc 0.9870 p 0.9688 r 0.9394 f1 0.9538
position_predict: train acc 0.9870 p 0.9677 r 0.9375 f1 0.9524
step 20: train loss 0.1145 
cause_predict: train acc 0.9793 p 0.9231 r 0.9474 f1 0.9351
position_predict: train acc 0.9917 p 0.9688 r 0.9688 f1 0.9688
step 30: train loss 0.0809 
cause_predict: train acc 0.9818 p 0.9118 r 0.9688 f1 0.9394
position_predict: train acc 0.9773 p 0.9118 r 0.9394 f1 0.9254
step 40: train loss 0.1626 
cause_predict: train acc 0.9746 p 0.9143 r 0.9412 f1 0.9275
position_predict: train acc 0.9645 p 0.9310 r 0.8438 f1 0.8852
step 50: train loss 0.0943 
cause_predict: train acc 0.9780 p 0.8919 r 0.9429 f1 0.9167
position_predict: train acc 0.9744 p 0.8788 r 0.9062 f1 0.8923
step 60: train loss 0.1201 
cause_predict: train acc 0.9775 p 0.9714 r 0.8947 f1 0.9315
position_predict: train acc 0.9730 p 0.9062 r 0.9062 f1 0.9062
step 70: train loss 0.1672 
cause_predict: train acc 0.9644 p 0.9211 r 0.8750 f1 0.8974
position_predict: train acc 0.9822 p 0.9394 r 0.9394 f1 0.9394

epoch 14: test loss 0.7035 cost time: 12.3s

cause_predict: test acc 0.8914 p 0.6480 r 0.5110 f1 0.5714
max_acc 0.8874 max_p 0.6080 max_r 0.5773 max_f1 0.5922

position_predict: test acc 0.9182 p 0.6769 r 0.6934 f1 0.6850
max_acc 0.9240 max_p 0.7112 max_r 0.6864 max_f1 0.6986

Average max cause: max_acc 0.8874 max_p 0.6080 max_r 0.5773 max_f1 0.5922
Average max pos: max_acc 0.9182 max_p 0.6844 max_r 0.6725 max_f1 0.6784

write pair_data/Ind_BiLSTM_2/fold_9_test.txt done
write pair_data/Ind_BiLSTM_2/fold_9_train.txt done
Optimization Finished!

############# fold 9 end ###############
############# fold 10 begin ###############
load data_file: data_combine_en/fold_10_train.txt
y_position.shape (2275, 75, 2)
y_cause.shape (2275, 75, 2)
x.shape (2275, 75, 30)
sen_len.shape (2275, 75)
doc_len.shape (2275,)
n_cut 107
load data done!

load data_file: data_combine_en/fold_10_test.txt
y_position.shape (284, 75, 2)
y_cause.shape (284, 75, 2)
x.shape (284, 75, 30)
sen_len.shape (284, 75)
doc_len.shape (284,)
n_cut 22
load data done!

train docs: 2275    test docs: 284
step 10: train loss 0.8256 
cause_predict: train acc 0.8325 p 0.0000 r 0.0000 f1 0.0000
position_predict: train acc 0.8424 p 0.0000 r 0.0000 f1 0.0000
step 20: train loss 0.8847 
cause_predict: train acc 0.7962 p 0.0000 r 0.0000 f1 0.0000
position_predict: train acc 0.8483 p 0.0000 r 0.0000 f1 0.0000
step 30: train loss 0.6418 
cause_predict: train acc 0.8769 p 1.0000 r 0.0857 f1 0.1579
position_predict: train acc 0.8731 p 0.0000 r 0.0000 f1 0.0000
step 40: train loss 0.5516 
cause_predict: train acc 0.8764 p 1.0000 r 0.0833 f1 0.1538
position_predict: train acc 0.9026 p 0.7143 r 0.3125 f1 0.4348
step 50: train loss 0.5654 
cause_predict: train acc 0.8559 p 1.0000 r 0.1795 f1 0.3043
position_predict: train acc 0.9144 p 0.7407 r 0.6250 f1 0.6780
step 60: train loss 0.4936 
cause_predict: train acc 0.8824 p 0.6667 r 0.0606 f1 0.1111
position_predict: train acc 0.9265 p 0.7000 r 0.6562 f1 0.6774
step 70: train loss 0.5294 
cause_predict: train acc 0.8571 p 0.6667 r 0.1951 f1 0.3019
position_predict: train acc 0.9266 p 0.8095 r 0.5312 f1 0.6415

epoch 0: test loss 0.5131 cost time: 12.3s

cause_predict: test acc 0.8825 p 0.7500 r 0.2555 f1 0.3812
max_acc 0.8825 max_p 0.7500 max_r 0.2555 max_f1 0.3812

position_predict: test acc 0.9187 p 0.7143 r 0.6098 f1 0.6579
max_acc 0.9187 max_p 0.7143 max_r 0.6098 max_f1 0.6579

Average max cause: max_acc 0.8825 max_p 0.7500 max_r 0.2555 max_f1 0.3812
Average max pos: max_acc 0.9187 max_p 0.7143 max_r 0.6098 max_f1 0.6579

step 10: train loss 0.4942 
cause_predict: train acc 0.8745 p 0.7059 r 0.3243 f1 0.4444
position_predict: train acc 0.9163 p 0.7407 r 0.6061 f1 0.6667
step 20: train loss 0.4343 
cause_predict: train acc 0.8821 p 0.8182 r 0.2647 f1 0.4000
position_predict: train acc 0.9520 p 0.9231 r 0.7273 f1 0.8136
step 30: train loss 0.3908 
cause_predict: train acc 0.9085 p 0.7857 r 0.3056 f1 0.4400
position_predict: train acc 0.9346 p 0.7000 r 0.6562 f1 0.6774
step 40: train loss 0.5142 
cause_predict: train acc 0.8845 p 0.8462 r 0.2895 f1 0.4314
position_predict: train acc 0.9004 p 0.6061 r 0.6250 f1 0.6154
step 50: train loss 0.4390 
cause_predict: train acc 0.9139 p 0.8750 r 0.4000 f1 0.5490
position_predict: train acc 0.9139 p 0.6364 r 0.6562 f1 0.6462
step 60: train loss 0.4674 
cause_predict: train acc 0.8746 p 0.4500 r 0.2727 f1 0.3396
position_predict: train acc 0.9247 p 0.7000 r 0.6364 f1 0.6667
step 70: train loss 0.3944 
cause_predict: train acc 0.8980 p 0.7500 r 0.4737 f1 0.5806
position_predict: train acc 0.9569 p 0.8387 r 0.8125 f1 0.8254

epoch 1: test loss 0.4672 cost time: 12.5s

cause_predict: test acc 0.8937 p 0.7337 r 0.3912 f1 0.5103
max_acc 0.8937 max_p 0.7337 max_r 0.3912 max_f1 0.5103

position_predict: test acc 0.9205 p 0.7057 r 0.6516 f1 0.6775
max_acc 0.9205 max_p 0.7057 max_r 0.6516 max_f1 0.6775

Average max cause: max_acc 0.8937 max_p 0.7337 max_r 0.3912 max_f1 0.5103
Average max pos: max_acc 0.9205 max_p 0.7057 max_r 0.6516 max_f1 0.6775

step 10: train loss 0.5265 
cause_predict: train acc 0.8857 p 0.6818 r 0.4688 f1 0.5556
position_predict: train acc 0.8952 p 0.6786 r 0.5938 f1 0.6333
step 20: train loss 0.4559 
cause_predict: train acc 0.8789 p 0.5909 r 0.3714 f1 0.4561
position_predict: train acc 0.9375 p 0.7500 r 0.7500 f1 0.7500
step 30: train loss 0.4670 
cause_predict: train acc 0.8685 p 0.6000 r 0.2195 f1 0.3214
position_predict: train acc 0.9273 p 0.7407 r 0.5882 f1 0.6557
step 40: train loss 0.5589 
cause_predict: train acc 0.8443 p 0.6429 r 0.4390 f1 0.5217
position_predict: train acc 0.9151 p 0.7500 r 0.6562 f1 0.7000
step 50: train loss 0.7600 
cause_predict: train acc 0.8511 p 0.6538 r 0.4722 f1 0.5484
position_predict: train acc 0.8777 p 0.6923 r 0.5455 f1 0.6102
step 60: train loss 0.5108 
cause_predict: train acc 0.8778 p 0.7500 r 0.4054 f1 0.5263
position_predict: train acc 0.9231 p 0.8333 r 0.6061 f1 0.7018
step 70: train loss 0.4983 
cause_predict: train acc 0.8759 p 0.7500 r 0.2791 f1 0.4068
position_predict: train acc 0.9255 p 0.7600 r 0.5588 f1 0.6441

epoch 2: test loss 0.4613 cost time: 12.1s

cause_predict: test acc 0.8887 p 0.6977 r 0.3785 f1 0.4908
max_acc 0.8937 max_p 0.7337 max_r 0.3912 max_f1 0.5103

position_predict: test acc 0.9258 p 0.7300 r 0.6690 f1 0.6982
max_acc 0.9258 max_p 0.7300 max_r 0.6690 max_f1 0.6982

Average max cause: max_acc 0.8887 max_p 0.6977 max_r 0.3785 max_f1 0.4908
Average max pos: max_acc 0.9258 max_p 0.7300 max_r 0.6690 max_f1 0.6982

step 10: train loss 0.3524 
cause_predict: train acc 0.9169 p 0.7407 r 0.5000 f1 0.5970
position_predict: train acc 0.9631 p 0.8182 r 0.8182 f1 0.8182
step 20: train loss 0.4071 
cause_predict: train acc 0.9005 p 0.7333 r 0.6111 f1 0.6667
position_predict: train acc 0.9321 p 0.7742 r 0.7500 f1 0.7619
step 30: train loss 0.4326 
cause_predict: train acc 0.9079 p 0.6875 r 0.6471 f1 0.6667
position_predict: train acc 0.9247 p 0.7333 r 0.6875 f1 0.7097
step 40: train loss 0.4077 
cause_predict: train acc 0.9139 p 0.7778 r 0.3590 f1 0.4912
position_predict: train acc 0.9199 p 0.6061 r 0.5882 f1 0.5970
step 50: train loss 0.4026 
cause_predict: train acc 0.8712 p 0.5652 r 0.3514 f1 0.4333
position_predict: train acc 0.9470 p 0.8750 r 0.6562 f1 0.7500
step 60: train loss 0.3872 
cause_predict: train acc 0.9132 p 0.8947 r 0.4722 f1 0.6182
position_predict: train acc 0.9339 p 0.7857 r 0.6875 f1 0.7333
step 70: train loss 0.4671 
cause_predict: train acc 0.8857 p 0.6957 r 0.4324 f1 0.5333
position_predict: train acc 0.9020 p 0.6333 r 0.5938 f1 0.6129

epoch 3: test loss 0.4656 cost time: 12.4s

cause_predict: test acc 0.8798 p 0.5923 r 0.4858 f1 0.5338
max_acc 0.8798 max_p 0.5923 max_r 0.4858 max_f1 0.5338

position_predict: test acc 0.9285 p 0.7343 r 0.6934 f1 0.7133
max_acc 0.9285 max_p 0.7343 max_r 0.6934 max_f1 0.7133

Average max cause: max_acc 0.8798 max_p 0.5923 max_r 0.4858 max_f1 0.5338
Average max pos: max_acc 0.9285 max_p 0.7343 max_r 0.6934 max_f1 0.7133

step 10: train loss 0.4062 
cause_predict: train acc 0.8621 p 0.6842 r 0.3714 f1 0.4815
position_predict: train acc 0.9360 p 0.8125 r 0.7879 f1 0.8000
step 20: train loss 0.3908 
cause_predict: train acc 0.9048 p 0.8000 r 0.4444 f1 0.5714
position_predict: train acc 0.9286 p 0.7778 r 0.6364 f1 0.7000
step 30: train loss 0.4264 
cause_predict: train acc 0.9212 p 0.8000 r 0.4571 f1 0.5818
position_predict: train acc 0.9315 p 0.7241 r 0.6364 f1 0.6774
step 40: train loss 0.4744 
cause_predict: train acc 0.8950 p 0.8400 r 0.5526 f1 0.6667
position_predict: train acc 0.9150 p 0.7857 r 0.6667 f1 0.7213
step 50: train loss 0.4499 
cause_predict: train acc 0.8687 p 0.5333 r 0.4444 f1 0.4848
position_predict: train acc 0.9266 p 0.7241 r 0.6562 f1 0.6885
step 60: train loss 0.3776 
cause_predict: train acc 0.9449 p 0.8966 r 0.7222 f1 0.8000
position_predict: train acc 0.9322 p 0.8333 r 0.6250 f1 0.7143
step 70: train loss 0.4270 
cause_predict: train acc 0.9178 p 0.6818 r 0.4688 f1 0.5556
position_predict: train acc 0.9144 p 0.6538 r 0.5152 f1 0.5763

epoch 4: test loss 0.4587 cost time: 12.0s

cause_predict: test acc 0.8887 p 0.6635 r 0.4353 f1 0.5257
max_acc 0.8798 max_p 0.5923 max_r 0.4858 max_f1 0.5338

position_predict: test acc 0.9267 p 0.7412 r 0.6585 f1 0.6974
max_acc 0.9285 max_p 0.7343 max_r 0.6934 max_f1 0.7133

Average max cause: max_acc 0.8798 max_p 0.5923 max_r 0.4858 max_f1 0.5338
Average max pos: max_acc 0.9285 max_p 0.7343 max_r 0.6934 max_f1 0.7133

step 10: train loss 0.3040 
cause_predict: train acc 0.9393 p 0.9200 r 0.6765 f1 0.7797
position_predict: train acc 0.9206 p 0.7419 r 0.7188 f1 0.7302
step 20: train loss 0.3662 
cause_predict: train acc 0.9283 p 0.8387 r 0.6500 f1 0.7324
position_predict: train acc 0.9472 p 0.7812 r 0.7812 f1 0.7812
step 30: train loss 0.2013 
cause_predict: train acc 0.9368 p 0.7838 r 0.7436 f1 0.7632
position_predict: train acc 0.9719 p 0.9000 r 0.8438 f1 0.8710
step 40: train loss 0.4113 
cause_predict: train acc 0.8996 p 0.6667 r 0.4848 f1 0.5614
position_predict: train acc 0.9076 p 0.6562 r 0.6364 f1 0.6462
step 50: train loss 0.3120 
cause_predict: train acc 0.9327 p 0.8800 r 0.6471 f1 0.7458
position_predict: train acc 0.9462 p 0.8333 r 0.7812 f1 0.8065
step 60: train loss 0.3040 
cause_predict: train acc 0.9107 p 0.6538 r 0.5000 f1 0.5667
position_predict: train acc 0.9656 p 0.9231 r 0.7500 f1 0.8276
step 70: train loss 0.4305 
cause_predict: train acc 0.8918 p 0.6897 r 0.5556 f1 0.6154
position_predict: train acc 0.9307 p 0.7500 r 0.7500 f1 0.7500

epoch 5: test loss 0.4894 cost time: 12.0s

cause_predict: test acc 0.8919 p 0.6531 r 0.5047 f1 0.5694
max_acc 0.8919 max_p 0.6531 max_r 0.5047 max_f1 0.5694

position_predict: test acc 0.9214 p 0.6947 r 0.6899 f1 0.6923
max_acc 0.9285 max_p 0.7343 max_r 0.6934 max_f1 0.7133

Average max cause: max_acc 0.8919 max_p 0.6531 max_r 0.5047 max_f1 0.5694
Average max pos: max_acc 0.9214 max_p 0.6947 max_r 0.6899 max_f1 0.6923

step 10: train loss 0.3089 
cause_predict: train acc 0.9486 p 0.9600 r 0.6667 f1 0.7869
position_predict: train acc 0.9447 p 0.8214 r 0.7188 f1 0.7667
step 20: train loss 0.2415 
cause_predict: train acc 0.9627 p 0.9655 r 0.7778 f1 0.8615
position_predict: train acc 0.9627 p 0.8485 r 0.8750 f1 0.8615
step 30: train loss 0.3435 
cause_predict: train acc 0.9255 p 0.7714 r 0.8182 f1 0.7941
position_predict: train acc 0.9255 p 0.8125 r 0.7647 f1 0.7879
step 40: train loss 0.3581 
cause_predict: train acc 0.9300 p 0.8286 r 0.7838 f1 0.8056
position_predict: train acc 0.9400 p 0.8333 r 0.7812 f1 0.8065
step 50: train loss 0.3481 
cause_predict: train acc 0.9170 p 0.8261 r 0.5000 f1 0.6230
position_predict: train acc 0.9350 p 0.7778 r 0.6364 f1 0.7000
step 60: train loss 0.4145 
cause_predict: train acc 0.9020 p 0.6786 r 0.5588 f1 0.6129
position_predict: train acc 0.9102 p 0.6562 r 0.6562 f1 0.6562
step 70: train loss 0.2868 
cause_predict: train acc 0.9310 p 0.9000 r 0.6750 f1 0.7714
position_predict: train acc 0.9612 p 0.8966 r 0.8125 f1 0.8525

epoch 6: test loss 0.5105 cost time: 12.5s

cause_predict: test acc 0.8865 p 0.6245 r 0.4984 f1 0.5544
max_acc 0.8919 max_p 0.6531 max_r 0.5047 max_f1 0.5694

position_predict: test acc 0.9227 p 0.7021 r 0.6899 f1 0.6960
max_acc 0.9285 max_p 0.7343 max_r 0.6934 max_f1 0.7133

Average max cause: max_acc 0.8919 max_p 0.6531 max_r 0.5047 max_f1 0.5694
Average max pos: max_acc 0.9214 max_p 0.6947 max_r 0.6899 max_f1 0.6923

step 10: train loss 0.2152 
cause_predict: train acc 0.9375 p 0.8621 r 0.7353 f1 0.7937
position_predict: train acc 0.9615 p 0.9032 r 0.8485 f1 0.8750
step 20: train loss 0.1916 
cause_predict: train acc 0.9565 p 0.8056 r 0.8788 f1 0.8406
position_predict: train acc 0.9644 p 0.8485 r 0.8750 f1 0.8615
step 30: train loss 0.2925 
cause_predict: train acc 0.9298 p 0.8621 r 0.6757 f1 0.7576
position_predict: train acc 0.9430 p 0.7879 r 0.8125 f1 0.8000
step 40: train loss 0.2386 
cause_predict: train acc 0.9450 p 0.8333 r 0.6944 f1 0.7576
position_predict: train acc 0.9553 p 0.8519 r 0.7188 f1 0.7797
step 50: train loss 0.2521 
cause_predict: train acc 0.9309 p 0.7647 r 0.7429 f1 0.7536
position_predict: train acc 0.9675 p 0.8750 r 0.8750 f1 0.8750
step 60: train loss 0.3322 
cause_predict: train acc 0.9139 p 0.8214 r 0.5897 f1 0.6866
position_predict: train acc 0.9549 p 0.8387 r 0.8125 f1 0.8254
step 70: train loss 0.2849 
cause_predict: train acc 0.9335 p 0.7000 r 0.6176 f1 0.6562
position_predict: train acc 0.9456 p 0.7188 r 0.7188 f1 0.7188

epoch 7: test loss 0.5843 cost time: 12.0s

cause_predict: test acc 0.8785 p 0.5856 r 0.4858 f1 0.5310
max_acc 0.8919 max_p 0.6531 max_r 0.5047 max_f1 0.5694

position_predict: test acc 0.9120 p 0.6562 r 0.6585 f1 0.6574
max_acc 0.9285 max_p 0.7343 max_r 0.6934 max_f1 0.7133

Average max cause: max_acc 0.8919 max_p 0.6531 max_r 0.5047 max_f1 0.5694
Average max pos: max_acc 0.9214 max_p 0.6947 max_r 0.6899 max_f1 0.6923

step 10: train loss 0.2015 
cause_predict: train acc 0.9283 p 0.8182 r 0.6750 f1 0.7397
position_predict: train acc 0.9736 p 0.9032 r 0.8750 f1 0.8889
step 20: train loss 0.2208 
cause_predict: train acc 0.9472 p 0.9062 r 0.7436 f1 0.8169
position_predict: train acc 0.9593 p 0.8235 r 0.8750 f1 0.8485
step 30: train loss 0.1001 
cause_predict: train acc 0.9772 p 0.8857 r 0.9394 f1 0.9118
position_predict: train acc 0.9886 p 0.9394 r 0.9688 f1 0.9538
step 40: train loss 0.2615 
cause_predict: train acc 0.9239 p 0.9565 r 0.6111 f1 0.7458
position_predict: train acc 0.9797 p 0.9375 r 0.9375 f1 0.9375
step 50: train loss 0.3169 
cause_predict: train acc 0.9390 p 0.9355 r 0.7250 f1 0.8169
position_predict: train acc 0.9437 p 0.8182 r 0.8182 f1 0.8182
step 60: train loss 0.2749 
cause_predict: train acc 0.9298 p 0.7812 r 0.7353 f1 0.7576
position_predict: train acc 0.9474 p 0.8125 r 0.8125 f1 0.8125
step 70: train loss 0.3107 
cause_predict: train acc 0.9163 p 0.7222 r 0.6842 f1 0.7027
position_predict: train acc 0.9582 p 0.8182 r 0.8438 f1 0.8308

epoch 8: test loss 0.5867 cost time: 12.5s

cause_predict: test acc 0.8852 p 0.6034 r 0.5521 f1 0.5766
max_acc 0.8852 max_p 0.6034 max_r 0.5521 max_f1 0.5766

position_predict: test acc 0.9155 p 0.6678 r 0.6794 f1 0.6736
max_acc 0.9285 max_p 0.7343 max_r 0.6934 max_f1 0.7133

Average max cause: max_acc 0.8919 max_p 0.6531 max_r 0.5047 max_f1 0.5694
Average max pos: max_acc 0.9214 max_p 0.6947 max_r 0.6899 max_f1 0.6923

step 10: train loss 0.1270 
cause_predict: train acc 0.9665 p 0.8421 r 0.9412 f1 0.8889
position_predict: train acc 0.9833 p 0.9118 r 0.9688 f1 0.9394
step 20: train loss 0.1795 
cause_predict: train acc 0.9346 p 0.8000 r 0.6857 f1 0.7385
position_predict: train acc 0.9846 p 0.9118 r 0.9688 f1 0.9394
step 30: train loss 0.2135 
cause_predict: train acc 0.9540 p 0.8649 r 0.8421 f1 0.8533
position_predict: train acc 0.9623 p 0.8710 r 0.8438 f1 0.8571
step 40: train loss 0.1871 
cause_predict: train acc 0.9563 p 0.8485 r 0.8485 f1 0.8485
position_predict: train acc 0.9607 p 0.8750 r 0.8485 f1 0.8615
step 50: train loss 0.1642 
cause_predict: train acc 0.9559 p 0.9355 r 0.7838 f1 0.8529
position_predict: train acc 0.9736 p 0.9062 r 0.9062 f1 0.9062
step 60: train loss 0.2617 
cause_predict: train acc 0.9395 p 0.7778 r 0.7179 f1 0.7467
position_predict: train acc 0.9459 p 0.7500 r 0.7273 f1 0.7385
step 70: train loss 0.2538 
cause_predict: train acc 0.9440 p 0.8387 r 0.7429 f1 0.7879
position_predict: train acc 0.9440 p 0.7647 r 0.8125 f1 0.7879

epoch 9: test loss 0.5990 cost time: 12.5s

cause_predict: test acc 0.8856 p 0.6151 r 0.5142 f1 0.5601
max_acc 0.8852 max_p 0.6034 max_r 0.5521 max_f1 0.5766

position_predict: test acc 0.9173 p 0.6723 r 0.6934 f1 0.6827
max_acc 0.9285 max_p 0.7343 max_r 0.6934 max_f1 0.7133

Average max cause: max_acc 0.8919 max_p 0.6531 max_r 0.5047 max_f1 0.5694
Average max pos: max_acc 0.9214 max_p 0.6947 max_r 0.6899 max_f1 0.6923

step 10: train loss 0.1677 
cause_predict: train acc 0.9661 p 0.8857 r 0.8857 f1 0.8857
position_predict: train acc 0.9661 p 0.8788 r 0.8788 f1 0.8788
step 20: train loss 0.1191 
cause_predict: train acc 0.9818 p 0.8947 r 0.9714 f1 0.9315
position_predict: train acc 0.9781 p 0.9333 r 0.8750 f1 0.9032
step 30: train loss 0.1315 
cause_predict: train acc 0.9737 p 0.9211 r 0.9211 f1 0.9211
position_predict: train acc 0.9693 p 0.8571 r 0.9375 f1 0.8955
step 40: train loss 0.0936 
cause_predict: train acc 0.9747 p 0.9688 r 0.8611 f1 0.9118
position_predict: train acc 0.9958 p 1.0000 r 0.9688 f1 0.9841
step 50: train loss 0.2299 
cause_predict: train acc 0.9614 p 0.8889 r 0.8889 f1 0.8889
position_predict: train acc 0.9517 p 0.8710 r 0.8182 f1 0.8438
step 60: train loss 0.2013 
cause_predict: train acc 0.9553 p 0.8056 r 0.8286 f1 0.8169
position_predict: train acc 0.9416 p 0.7353 r 0.7576 f1 0.7463
step 70: train loss 0.1549 
cause_predict: train acc 0.9798 p 0.9750 r 0.9070 f1 0.9398
position_predict: train acc 0.9555 p 0.8182 r 0.8438 f1 0.8308

epoch 10: test loss 0.6332 cost time: 12.1s

cause_predict: test acc 0.8878 p 0.6260 r 0.5174 f1 0.5665
max_acc 0.8852 max_p 0.6034 max_r 0.5521 max_f1 0.5766

position_predict: test acc 0.9196 p 0.6974 r 0.6585 f1 0.6774
max_acc 0.9285 max_p 0.7343 max_r 0.6934 max_f1 0.7133

Average max cause: max_acc 0.8919 max_p 0.6531 max_r 0.5047 max_f1 0.5694
Average max pos: max_acc 0.9214 max_p 0.6947 max_r 0.6899 max_f1 0.6923

step 10: train loss 0.0970 
cause_predict: train acc 0.9867 p 0.9487 r 0.9737 f1 0.9610
position_predict: train acc 0.9823 p 0.9375 r 0.9375 f1 0.9375
step 20: train loss 0.0503 
cause_predict: train acc 0.9917 p 0.9706 r 0.9706 f1 0.9706
position_predict: train acc 0.9876 p 0.9412 r 0.9697 f1 0.9552
step 30: train loss 0.0756 
cause_predict: train acc 0.9784 p 0.9167 r 0.9429 f1 0.9296
position_predict: train acc 1.0000 p 1.0000 r 1.0000 f1 1.0000
step 40: train loss 0.1292 
cause_predict: train acc 0.9669 p 0.8571 r 0.8824 f1 0.8696
position_predict: train acc 0.9779 p 0.9333 r 0.8750 f1 0.9032
step 50: train loss 0.1711 
cause_predict: train acc 0.9634 p 0.8537 r 0.9211 f1 0.8861
position_predict: train acc 0.9675 p 0.8750 r 0.8750 f1 0.8750
step 60: train loss 0.1847 
cause_predict: train acc 0.9533 p 0.9259 r 0.7576 f1 0.8333
position_predict: train acc 0.9486 p 0.8621 r 0.7812 f1 0.8197
step 70: train loss 0.1532 
cause_predict: train acc 0.9802 p 0.9143 r 0.9412 f1 0.9275
position_predict: train acc 0.9722 p 0.8788 r 0.9062 f1 0.8923

epoch 11: test loss 0.6830 cost time: 12.5s

cause_predict: test acc 0.8861 p 0.6123 r 0.5331 f1 0.5700
max_acc 0.8852 max_p 0.6034 max_r 0.5521 max_f1 0.5766

position_predict: test acc 0.9155 p 0.6828 r 0.6376 f1 0.6595
max_acc 0.9285 max_p 0.7343 max_r 0.6934 max_f1 0.7133

Average max cause: max_acc 0.8919 max_p 0.6531 max_r 0.5047 max_f1 0.5694
Average max pos: max_acc 0.9214 max_p 0.6947 max_r 0.6899 max_f1 0.6923

step 10: train loss 0.1150 
cause_predict: train acc 0.9650 p 0.8571 r 0.8571 f1 0.8571
position_predict: train acc 0.9790 p 0.9062 r 0.9062 f1 0.9062
step 20: train loss 0.2482 
cause_predict: train acc 0.9405 p 0.8378 r 0.8857 f1 0.8611
position_predict: train acc 0.9464 p 0.8710 r 0.8438 f1 0.8571
step 30: train loss 0.1882 
cause_predict: train acc 0.9811 p 0.9444 r 0.9444 f1 0.9444
position_predict: train acc 0.9717 p 0.8824 r 0.9375 f1 0.9091
step 40: train loss 0.1157 
cause_predict: train acc 0.9808 p 0.9706 r 0.8919 f1 0.9296
position_predict: train acc 0.9808 p 0.9355 r 0.9062 f1 0.9206
step 50: train loss 0.1692 
cause_predict: train acc 0.9670 p 0.8718 r 0.8947 f1 0.8831
position_predict: train acc 0.9524 p 0.7941 r 0.8182 f1 0.8060
step 60: train loss 0.0901 
cause_predict: train acc 0.9786 p 0.9667 r 0.8788 f1 0.9206
position_predict: train acc 0.9829 p 0.9394 r 0.9394 f1 0.9394
step 70: train loss 0.1688 
cause_predict: train acc 0.9821 p 0.9412 r 0.9412 f1 0.9412
position_predict: train acc 0.9507 p 0.8387 r 0.8125 f1 0.8254

epoch 12: test loss 0.6928 cost time: 12.4s

cause_predict: test acc 0.8811 p 0.5882 r 0.5363 f1 0.5611
max_acc 0.8852 max_p 0.6034 max_r 0.5521 max_f1 0.5766

position_predict: test acc 0.9151 p 0.6633 r 0.6864 f1 0.6747
max_acc 0.9285 max_p 0.7343 max_r 0.6934 max_f1 0.7133

Average max cause: max_acc 0.8919 max_p 0.6531 max_r 0.5047 max_f1 0.5694
Average max pos: max_acc 0.9214 max_p 0.6947 max_r 0.6899 max_f1 0.6923

step 10: train loss 0.0791 
cause_predict: train acc 0.9910 p 0.9714 r 0.9714 f1 0.9714
position_predict: train acc 0.9864 p 0.9677 r 0.9375 f1 0.9524
step 20: train loss 0.0713 
cause_predict: train acc 0.9925 p 0.9722 r 0.9722 f1 0.9722
position_predict: train acc 0.9888 p 0.9677 r 0.9375 f1 0.9524
step 30: train loss 0.0952 
cause_predict: train acc 0.9919 p 0.9737 r 0.9737 f1 0.9737
position_predict: train acc 0.9919 p 0.9688 r 0.9688 f1 0.9688
step 40: train loss 0.1088 
cause_predict: train acc 0.9792 p 0.9697 r 0.8889 f1 0.9275
position_predict: train acc 0.9875 p 0.9394 r 0.9688 f1 0.9538
step 50: train loss 0.0554 
cause_predict: train acc 0.9860 p 0.9412 r 0.9697 f1 0.9552
position_predict: train acc 1.0000 p 1.0000 r 1.0000 f1 1.0000
step 60: train loss 0.1080 
cause_predict: train acc 0.9757 p 0.9375 r 0.9091 f1 0.9231
position_predict: train acc 0.9854 p 0.9394 r 0.9688 f1 0.9538
step 70: train loss 0.1103 
cause_predict: train acc 0.9784 p 0.9677 r 0.8824 f1 0.9231
position_predict: train acc 0.9870 p 0.9394 r 0.9688 f1 0.9538

epoch 13: test loss 0.6975 cost time: 11.9s

cause_predict: test acc 0.8932 p 0.6373 r 0.5710 f1 0.6023
max_acc 0.8932 max_p 0.6373 max_r 0.5710 max_f1 0.6023

position_predict: test acc 0.9231 p 0.7076 r 0.6829 f1 0.6950
max_acc 0.9285 max_p 0.7343 max_r 0.6934 max_f1 0.7133

Average max cause: max_acc 0.8932 max_p 0.6373 max_r 0.5710 max_f1 0.6023
Average max pos: max_acc 0.9231 max_p 0.7076 max_r 0.6829 max_f1 0.6950

step 10: train loss 0.0963 
cause_predict: train acc 0.9614 p 0.9429 r 0.8462 f1 0.8919
position_predict: train acc 0.9903 p 0.9688 r 0.9688 f1 0.9688
step 20: train loss 0.0924 
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/oycj/.conda/envs/pytorch/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
cause_predict: train acc 0.9853 p 0.9412 r 0.9412 f1 0.9412
position_predict: train acc 0.9779 p 0.8824 r 0.9375 f1 0.9091
step 30: train loss 0.0878 
cause_predict: train acc 0.9928 p 0.9459 r 1.0000 f1 0.9722
position_predict: train acc 0.9713 p 0.8529 r 0.9062 f1 0.8788
step 40: train loss 0.0589 
cause_predict: train acc 0.9926 p 1.0000 r 0.9459 f1 0.9722
position_predict: train acc 0.9853 p 0.9394 r 0.9394 f1 0.9394
step 50: train loss 0.1201 
cause_predict: train acc 0.9658 p 0.9189 r 0.8500 f1 0.8831
position_predict: train acc 0.9886 p 0.9394 r 0.9688 f1 0.9538
step 60: train loss 0.1820 
cause_predict: train acc 0.9535 p 0.8611 r 0.8611 f1 0.8611
position_predict: train acc 0.9581 p 0.8485 r 0.8750 f1 0.8615
step 70: train loss 0.0603 
cause_predict: train acc 1.0000 p 1.0000 r 1.0000 f1 1.0000
position_predict: train acc 0.9857 p 0.9375 r 0.9375 f1 0.9375

epoch 14: test loss 0.7924 cost time: 12.4s

cause_predict: test acc 0.8794 p 0.5867 r 0.5016 f1 0.5408
max_acc 0.8932 max_p 0.6373 max_r 0.5710 max_f1 0.6023

position_predict: test acc 0.9214 p 0.7033 r 0.6690 f1 0.6857
max_acc 0.9285 max_p 0.7343 max_r 0.6934 max_f1 0.7133

Average max cause: max_acc 0.8932 max_p 0.6373 max_r 0.5710 max_f1 0.6023
Average max pos: max_acc 0.9231 max_p 0.7076 max_r 0.6829 max_f1 0.6950

write pair_data/Ind_BiLSTM_2/fold_10_test.txt done
write pair_data/Ind_BiLSTM_2/fold_10_train.txt done
Optimization Finished!

############# fold 10 end ###############


>>>>>>>>>>>>>>>>>>>>TRAINING INFO:

batch-32, lr-0.005, kb1-0.8, kb2-1.0, l2_reg-1e-05
training_iter-15, scope-Ind_BiLSTM_2


cause_predict: test f1 in 10 fold: [[0.56283186]
 [0.59440559]
 [0.59696459]
 [0.58528428]
 [0.54391892]
 [0.56630824]
 [0.56716418]
 [0.56684492]
 [0.59223301]
 [0.60232945]]
average : acc 0.8895 p 0.6308 r 0.5344 f1 0.5778

position_predict: test f1 in 10 fold: [[0.69244936]
 [0.68676717]
 [0.66324786]
 [0.69982238]
 [0.70212766]
 [0.70546737]
 [0.67702936]
 [0.71504425]
 [0.67838313]
 [0.69503546]]
average : acc 0.9214 p 0.6979 r 0.6861 f1 0.6915


----------2024-07-08 01:04:23----------
